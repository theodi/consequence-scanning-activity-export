{"version":3,"file":"adapt.min.js","sources":["../../core/js/wait.js","../../core/js/models/lockingModel.js","../../core/js/adapt.js","../../core/js/offlineStorage.js","../../core/js/device.js","../../core/js/location.js","../../core/js/a11y/browserFocus.js","../../core/js/a11y/focusOptions.js","../../core/js/a11y/keyboardFocusOutline.js","../../core/js/enums/logLevelEnum.js","../../core/js/logging.js","../../core/js/a11y/log.js","../../core/js/a11y/scroll.js","../../core/js/a11y/wrapFocus.js","../../core/js/a11y/popup.js","../../core/js/enums/defaultAriaLevels.js","../../core/js/a11y/deprecated.js","../../core/js/components.js","../../core/js/collections/adaptCollection.js","../../core/js/models/buildModel.js","../../core/js/models/configModel.js","../../core/js/data.js","../../core/js/a11y.js","../../core/js/views/drawerItemView.js","../../core/js/views/drawerView.js","../../core/js/drawer.js","../../core/js/collections/adaptSubsetCollection.js","../../core/js/modelEvent.js","../../core/js/models/adaptModel.js","../../core/js/models/contentObjectModel.js","../../core/js/models/articleModel.js","../../core/js/models/blockModel.js","../../core/js/models/componentModel.js","../../core/js/models/menuModel.js","../../core/js/models/courseModel.js","../../core/js/models/pageModel.js","../../core/js/childEvent.js","../../core/js/templateRenderEvent.js","../../core/js/reactHelpers.js","../../core/js/views/adaptView.js","../../core/js/views/contentObjectView.js","../../core/js/views/pageView.js","../../core/js/views/articleView.js","../../core/js/views/blockView.js","../../core/js/mpabc.js","../../core/js/views/notifyPushView.js","../../core/js/models/notifyModel.js","../../core/js/collections/notifyPushCollection.js","../../core/js/views/notifyPopupView.js","../../core/js/views/notifyView.js","../../core/js/notify.js","../../core/js/models/routerModel.js","../../core/js/router.js","../../core/js/scrolling.js","../../core/js/startController.js","../../core/js/enums/completionStateEnum.js","../../core/js/tracking.js","../../core/js/deprecated.js","../../core/js/templates.js","../../core/js/fixes/img.lazyload.js","../../core/js/fixes/reactHelpers.html.js","../../core/js/helpers.js","../../core/js/views/headingView.js","../../core/js/headings.js","../../core/js/views/navigationView.js","../../core/js/navigation.js","../../core/js/views/componentView.js","../../components/adapt-contrib-graphic/js/GraphicView.js","../../components/adapt-contrib-graphic/js/GraphicModel.js","../../components/adapt-contrib-graphic/js/adapt-contrib-graphic.js","../../components/adapt-contrib-text/js/TextView.js","../../components/adapt-contrib-text/js/TextModel.js","../../components/adapt-contrib-text/js/adapt-contrib-text.js","../../core/js/enums/buttonStateEnum.js","../../core/js/views/buttonsView.js","../../core/js/models/questionModel.js","../../core/js/views/questionView.js","../../components/adapt-dnd-multiple/js/DndMultipleView.js","../../components/adapt-dnd-multiple/js/DndMultipleModel.js","../../components/adapt-dnd-multiple/js/adapt-dnd-multiple.js","../../components/adapt-formatted-openTextInput/js/openTextInputModel.js","../../components/adapt-formatted-openTextInput/js/openTextInputView.js","../../components/adapt-formatted-openTextInput/js/adapt-formatted-openTextInput.js","../../components/adapt-trialogue/js/TrialogueView.js","../../core/js/models/itemModel.js","../../core/js/models/itemsComponentModel.js","../../components/adapt-trialogue/js/TrialogueModel.js","../../components/adapt-trialogue/js/adapt-trialogue.js","../../extensions/adapt-contrib-aboutPage/js/adapt-contrib-aboutPage.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel.js","../../extensions/adapt-contrib-assessment/js/assessment.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension.js","../../extensions/adapt-contrib-branching/js/correctness.js","../../extensions/adapt-contrib-branching/js/BranchingSet.js","../../extensions/adapt-contrib-branching/js/adapt-contrib-branching.js","../../extensions/adapt-contrib-pageLevelProgress/js/completionCalculations.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView.js","../../extensions/adapt-contrib-pageLevelProgress/js/getPageLevelProgressItems.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView.js","../../extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress.js","../../extensions/adapt-contrib-spoor/js/scorm/logger.js","../../extensions/adapt-contrib-spoor/js/scorm/error.js","../../extensions/adapt-contrib-spoor/js/scorm/wrapper.js","../../extensions/adapt-contrib-spoor/js/serializers/SCORMSuspendData.js","../../extensions/adapt-contrib-spoor/js/serializers/ComponentSerializer.js","../../extensions/adapt-contrib-spoor/js/adapt-stateful-session.js","../../extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm.js","../../extensions/adapt-contrib-spoor/js/adapt-contrib-spoor.js","../../extensions/adapt-contrib-trickle/js/models.js","../../extensions/adapt-contrib-trickle/js/controller.js","../../extensions/adapt-contrib-trickle/js/TrickleButtonView.js","../../extensions/adapt-contrib-trickle/js/TrickleButtonModel.js","../../extensions/adapt-contrib-trickle/js/trickleButton.js","../../extensions/adapt-contrib-trickle/js/adapt-contrib-trickle.js","../../extensions/adapt-contrib-tutor/js/TUTOR_TYPE.js","../../extensions/adapt-contrib-tutor/js/TutorModel.js","../../extensions/adapt-contrib-tutor/js/TutorNotify.js","../../extensions/adapt-contrib-tutor/js/TutorView.js","../../extensions/adapt-contrib-tutor/js/adapt-contrib-tutor.js","../../extensions/adapt-courseNotes/js/CourseNotesView.js","../../extensions/adapt-courseNotes/js/CourseNotesNavView.js","../../extensions/adapt-courseNotes/js/adapt-courseNotes.js","../../extensions/adapt-devtools/js/devtools-model.js","../../extensions/adapt-devtools/js/hinting.js","../../extensions/adapt-devtools/js/is-question-supported.js","../../extensions/adapt-devtools/js/auto-answer.js","../../extensions/adapt-devtools/js/pass-half-fail.js","../../extensions/adapt-devtools/js/toggle-banking.js","../../extensions/adapt-devtools/js/map.js","../../extensions/adapt-devtools/js/utils.js","../../extensions/adapt-devtools/js/end-trickle.js","../../extensions/adapt-devtools/js/toggle-feedback.js","../../extensions/adapt-devtools/js/helpers.js","../../extensions/adapt-devtools/js/toggle-alt-text.js","../../extensions/adapt-devtools/js/unlock.js","../../extensions/adapt-devtools/js/enable.js","../../extensions/adapt-devtools/js/toggle-trace-focus.js","../../extensions/adapt-devtools/js/toggle-completion.js","../../extensions/adapt-devtools/js/adapt-devtools.js","../../extensions/adapt-graphicExpand/js/graphicExpandView.js","../../extensions/adapt-graphicExpand/js/adapt-graphicExpand.js","../../extensions/adapt-odi-footerLink/js/adapt-odi-footerLink.js","../../extensions/adapt-odi-licence/js/adapt-odi-licence.js","../../core/js/views/menuItemView.js","../../core/js/views/menuView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuItemView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuGroupView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuView.js","../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu.js","../../theme/adapt-theme-odi/js/themeView.js","../../theme/adapt-theme-odi/js/themePageView.js","../../theme/adapt-theme-odi/js/themeArticleView.js","../../theme/adapt-theme-odi/js/themeBlockView.js","../../theme/adapt-theme-odi/js/theme.js","../../core/templates/header.jsx","../../core/templates/image.jsx","../../components/adapt-contrib-graphic/templates/graphic.jsx","../../components/adapt-contrib-text/templates/text.jsx","../../components/adapt-dnd-multiple/templates/dndMultiple.jsx","../../components/adapt-dnd-multiple/templates/dndMultipleDraggable.jsx","../../components/adapt-dnd-multiple/templates/dndMultipleDroppable.jsx","../../components/adapt-trialogue/templates/trialogue.jsx","../../components/adapt-trialogue/templates/trialogueBottomBar.jsx","../../components/adapt-trialogue/templates/trialogueMessage.jsx","../../components/adapt-trialogue/templates/trialogueMessagesHistory.jsx","../../extensions/adapt-contrib-pageLevelProgress/templates/pageLevelProgress.jsx","../../extensions/adapt-contrib-pageLevelProgress/templates/pageLevelProgressItem.jsx","../../extensions/adapt-courseNotes/templates/courseNotes.jsx","../../extensions/adapt-courseNotes/templates/courseNotesNav.jsx","../../extensions/adapt-graphicExpand/templates/graphic-expand.jsx","../../core/js/app.js"],"sourcesContent":["class Wait extends Backbone.Controller {\n\n  initialize() {\n    this._waitCount = 0;\n    this._callbackHandle = null;\n    this.being = this.begin.bind(this);\n    this.end = this.end.bind(this);\n  }\n\n  /**\n   * Returns true if there are items in the waiting count.\n   *\n   * @return {Boolean}\n   */\n  isWaiting() {\n    return (this._waitCount !== 0);\n  }\n\n  /**\n   * Add one item to the waiting count.\n   *\n   * @return {Object}\n   */\n  begin() {\n    if (!this.isWaiting()) this.trigger('wait');\n\n    this._waitCount++;\n\n    if (this._callbackHandle) {\n      clearTimeout(this._callbackHandle);\n      this._callbackHandle = null;\n    }\n\n    return this;\n  }\n\n  /**\n   * Remove an item from the waiting count and trigger ready asynchronously if no more items are waiting.\n   *\n   * @return {Object}\n   */\n  end() {\n    if (!this.isWaiting()) return this;\n\n    this._waitCount--;\n\n    if (this.isWaiting() || this._callbackHandle) return this;\n\n    this._callbackHandle = setTimeout(function() {\n      this._callbackHandle = null;\n      this.trigger('ready');\n    }.bind(this), 0);\n\n    return this;\n  }\n\n  /**\n   * Queue this function until all open waits have been ended.\n   *\n   * @param  {Function} [callback]\n   * @return {Object|Promise}\n   */\n  queue(callback) {\n    if (!callback) {\n      this.begin();\n\n      return new Promise(resolve => {\n        this.once('ready', resolve);\n        this.end();\n      });\n    }\n\n    this.begin();\n    this.once('ready', callback);\n    this.end();\n\n    return this;\n  }\n\n  /**\n   * Wait for this asynchronous function to execute before triggering ready event.\n   *\n   * @param  {Function} callback   [ Function to execute whilst holding queued callback. Once complete run first argument, done(). ]\n   * @return {Object}\n   */\n  for(callback) {\n    this.begin();\n    _.defer(() => callback(_.once(this.end)));\n    return this;\n  }\n\n}\n\nconst wait = new Wait();\n\nexport default wait;\n","export default class LockingModel extends Backbone.Model {\n\n  set(attrName, attrVal, options = {}) {\n    const stopProcessing = (typeof attrName === 'object' || typeof attrVal !== 'boolean' || !this.isLocking(attrName));\n    if (stopProcessing) return super.set(...arguments);\n\n    const isSettingValueForSpecificPlugin = options?.pluginName;\n    if (!isSettingValueForSpecificPlugin) {\n      console.error('Must supply a pluginName to change a locked attribute');\n      options.pluginName = 'compatibility';\n    }\n\n    const pluginName = options.pluginName;\n    if (this.defaults[attrName] !== undefined) {\n      this._lockedAttributes[attrName] = !this.defaults[attrName];\n    }\n    const lockingValue = this._lockedAttributes[attrName];\n    const isAttemptingToLock = (lockingValue === attrVal);\n\n    if (isAttemptingToLock) {\n      this.setLockState(attrName, true, { pluginName: pluginName, skipcheck: true });\n      return super.set(attrName, lockingValue);\n    }\n\n    this.setLockState(attrName, false, { pluginName: pluginName, skipcheck: true });\n\n    const totalLockValue = this.getLockCount(attrName, { skipcheck: true });\n    if (totalLockValue === 0) {\n      return super.set(attrName, !lockingValue);\n    }\n\n    return this;\n\n  }\n\n  setLocking(attrName, defaultLockValue) {\n    if (this.isLocking(attrName)) return;\n    if (!this._lockedAttributes) this._lockedAttributes = {};\n    this._lockedAttributes[attrName] = defaultLockValue;\n  }\n\n  unsetLocking(attrName) {\n    if (!this.isLocking(attrName)) return;\n    if (!this._lockedAttributes) return;\n    delete this._lockedAttributes[attrName];\n    delete this._lockedAttributesValues[attrName];\n    if (Object.keys(this._lockedAttributes).length === 0) {\n      delete this._lockedAttributes;\n      delete this._lockedAttributesValues;\n    }\n  }\n\n  isLocking(attrName) {\n    const isCheckingGeneralLockingState = (attrName === undefined);\n    const isUsingLockedAttributes = Boolean(this.lockedAttributes || this._lockedAttributes);\n\n    if (isCheckingGeneralLockingState) {\n      return isUsingLockedAttributes;\n    }\n\n    if (!isUsingLockedAttributes) return false;\n\n    if (!this._lockedAttributes) {\n      this._lockedAttributes = _.result(this, 'lockedAttributes');\n    }\n\n    const isAttributeALockingAttribute = this._lockedAttributes.hasOwnProperty(attrName);\n    if (!isAttributeALockingAttribute) return false;\n\n    if (!this._lockedAttributesValues) {\n      this._lockedAttributesValues = {};\n    }\n\n    if (!this._lockedAttributesValues[attrName]) {\n      this._lockedAttributesValues[attrName] = {};\n    }\n\n    return true;\n  }\n\n  isLocked(attrName, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return;\n    }\n\n    return this.getLockCount(attrName) > 0;\n  }\n\n  getLockCount(attrName, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return;\n    }\n\n    const isGettingValueForSpecificPlugin = options?.pluginName;\n    if (isGettingValueForSpecificPlugin) {\n      return this._lockedAttributesValues[attrName][options.pluginName] ? 1 : 0;\n    }\n\n    const lockingAttributeValues = Object.values(this._lockedAttributesValues[attrName]);\n    const lockingAttributeValuesSum = lockingAttributeValues.reduce((sum, value) => sum + (value ? 1 : 0), 0);\n\n    return lockingAttributeValuesSum;\n  }\n\n  setLockState(attrName, value, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return this;\n    }\n\n    const isSettingValueForSpecificPlugin = options?.pluginName;\n    if (!isSettingValueForSpecificPlugin) {\n      console.error('Must supply a pluginName to set a locked attribute lock value');\n      options.pluginName = 'compatibility';\n    }\n\n    if (value) {\n      this._lockedAttributesValues[attrName][options.pluginName] = value;\n    } else {\n      delete this._lockedAttributesValues[attrName][options.pluginName];\n    }\n\n    return this;\n\n  }\n\n}\n","import wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\n\nclass AdaptSingleton extends LockingModel {\n\n  initialize() {\n    this.loadScript = window.__loadScript;\n  }\n\n  defaults() {\n    return {\n      _canScroll: true, // to stop scrollTo behaviour,\n      _outstandingCompletionChecks: 0,\n      _pluginWaitCount: 0,\n      _isStarted: false,\n      _shouldDestroyContentObjects: true\n    };\n  }\n\n  lockedAttributes() {\n    return {\n      _canScroll: false\n    };\n  }\n\n  async init() {\n    this.addDirection();\n    this.disableAnimation();\n    this.trigger('adapt:preInitialize');\n    await wait.queue();\n\n    // wait until no more completion checking\n    this.deferUntilCompletionChecked(async () => {\n\n      // start adapt in a full restored state\n      this.trigger('adapt:start');\n      await wait.queue();\n\n      if (!Backbone.History.started) {\n        Backbone.history.start();\n      }\n\n      this.set('_isStarted', true);\n\n      this.trigger('adapt:initialize');\n      await wait.queue();\n\n    });\n  }\n\n  /**\n   * call when entering an asynchronous completion check\n   */\n  checkingCompletion() {\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\n    this.set('_outstandingCompletionChecks', outstandingChecks + 1);\n  }\n\n  /**\n   * call when exiting an asynchronous completion check\n   */\n  checkedCompletion() {\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\n    this.set('_outstandingCompletionChecks', outstandingChecks - 1);\n  }\n\n  /**\n   * wait until there are no outstanding completion checks\n   * @param {Function} [callback] Function to be called after all completion checks have been completed\n   */\n  async deferUntilCompletionChecked(callback = () => {}) {\n    if (this.get('_outstandingCompletionChecks') === 0) return callback();\n    return new Promise(resolve => {\n      const checkIfAnyChecksOutstanding = (model, outstandingChecks) => {\n        if (outstandingChecks !== 0) return;\n        this.off('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\n        callback();\n        resolve();\n      };\n      this.on('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\n    });\n  }\n\n  isWaitingForPlugins() {\n    this.log.deprecated('Use wait.isWaiting() as Adapt.isWaitingForPlugins() will be removed in the future');\n    return wait.isWaiting();\n  }\n\n  checkPluginsReady() {\n    this.log.deprecated('Use wait.isWaiting() as Adapt.checkPluginsReady() will be removed in the future');\n    if (this.isWaitingForPlugins()) {\n      return;\n    }\n    this.trigger('plugins:ready');\n  }\n\n  /**\n   * Relative strings describe the number and type of hops in the model hierarchy\n   * @param {string} relativeString\n   * Trickle uses this function to determine where it should scrollTo after it unlocks.\n   * Branching uses this function to determine where it should branch to.\n   * This function would return the following for a single offset directive:\n   * {\n   *     type: \"component\",\n   *     offset: 1,\n   *     inset: null\n   * }\n   * \"@component+1\" returns the next component outside this container, or undefined\n   * \"@component-1\" returns the previous component outside of this container, or undefined\n   * \"@block+0\" or \"@block\" returns this block, the first ancestor block, or undefined\n   * \"@type+0\" or \"@type\" returns this of type, the first ancestor of type, or undefined\n   * This function would return the following for a single inset directive:\n   * {\n   *     type: \"component\",\n   *     offset: null,\n   *     inset: 0\n   * }\n   * \"@article=0\" returns the first article inside this container, or undefined\n   * \"@article=-1\" returns the last article inside this container, or undefined\n   * \"@type=n\" returns the relatively positioned of type inside this container, or undefined\n   * This function would return the following for multiple inset and offset directives:\n   * [\n   *   {\n   *     type: \"block\",\n   *     offset: 2,\n   *     inset: null\n   *   },\n   *   {\n   *     type: \"component\",\n   *     offset: null,\n   *     inset: 0\n   *   }\n   * ]\n   * \"@block+2 @component=0\" move two blocks forward and return its first component\n   * \"@block-1 @component=-2\" move one block backward and return its second to last component\n   * \"@article+2 @block=1 @component=-1\" move two articles forward, find the second block and return its last component\n   * \"@article @component=-1\" find the first ancestor article and return its last component\n   */\n  parseRelativeString(relativeString) {\n    const parts = relativeString\n      .replace(/\\s*([+\\-=]+\\d+){1}/g, '$1') // Remove whitespace before symbol +/-/=\n      .split(/[@ ]/) // Find all sections\n      .filter(Boolean); // Remove empty sections\n    const parsed = parts.map(part => {\n      let splitIndex = part.search(/[+\\-=\\d]{1}/);\n      if (splitIndex === -1) splitIndex = part.length;\n      const symbol = part.slice(splitIndex, splitIndex + 1);\n      const type = part.slice(0, splitIndex).replace(/^@/, '');\n      let offset = null;\n      let inset = null;\n      switch (symbol) {\n        case '=':\n          inset = parseInt(part.slice(splitIndex + 1).trim() || 0);\n          break;\n        default:\n          offset = parseInt(part.slice(splitIndex).trim() || 0);\n          break;\n      }\n      return {\n        type,\n        offset,\n        inset\n      };\n    });\n    return parsed.length === 1\n      ? parsed[0]\n      : parsed;\n  }\n\n  addDirection() {\n    const defaultDirection = this.config.get('_defaultDirection');\n\n    $('html')\n      .addClass('dir-' + defaultDirection)\n      .attr('dir', defaultDirection);\n  }\n\n  disableAnimation() {\n    const disableAnimationArray = this.config.get('_disableAnimationFor');\n    const disableAnimation = this.config.get('_disableAnimation');\n\n    // Check if animations should be disabled\n    if (disableAnimationArray) {\n      for (let i = 0, l = disableAnimationArray.length; i < l; i++) {\n        if (!$('html').is(disableAnimationArray[i])) continue;\n        this.config.set('_disableAnimation', true);\n        $('html').addClass('disable-animation');\n        console.log('Animation disabled.');\n      }\n      return;\n    }\n\n    $('html').toggleClass('disable-animation', (disableAnimation === true));\n  }\n\n  async remove() {\n    const currentView = this.parentView;\n    if (currentView) {\n      currentView.model.setOnChildren({\n        _isReady: false,\n        _isRendered: false\n      });\n    }\n    this.trigger('preRemove', currentView);\n    await wait.queue();\n    // Facilitate contentObject transitions\n    if (currentView && this.get('_shouldDestroyContentObjects')) {\n      currentView.destroy();\n    }\n    this.trigger('remove', currentView);\n    _.defer(this.trigger.bind(this), 'postRemove', currentView);\n  }\n\n  /**\n   * @deprecated Please use core/js/a11y instead\n   */\n  get a11y() {}\n\n  /**\n   * @deprecated Please use core/js/components instead\n   */\n  get componentStore() {}\n\n  /**\n   * @deprecated Please use core/js/data instead\n   */\n  get data() {}\n\n  /**\n   * @deprecated Please use core/js/device instead\n   */\n  get device() {}\n\n  /**\n   * @deprecated Please use core/js/drawer instead\n   */\n  get drawer() {}\n\n  /**\n   * @deprecated Please use core/js/location instead\n   */\n  get location() {}\n\n  /**\n   * @deprecated Please use core/js/notify instead\n   */\n  get notify() {}\n\n  /**\n   * @deprecated Please use core/js/offlineStorage instead\n   */\n  get offlineStorage() {}\n\n  /**\n   * @deprecated Please use core/js/router instead\n   */\n  get router() {}\n\n  /**\n   * @deprecated Please use core/js/scrolling instead\n   */\n  get scrolling() {}\n\n  /**\n   * @deprecated Please use core/js/startController instead\n   */\n  get startController() {}\n\n  /**\n   * @deprecated Please use core/js/components instead\n   */\n  get store() {}\n\n  /**\n   * @deprecated Please use core/js/tracking instead\n   */\n  get tracking() {}\n\n  /**\n   * @deprecated Please use core/js/wait instead\n   */\n  get wait() {}\n\n  /**\n   * Allows a selector to be passed in and Adapt will navigate to this element. Resolves\n   * asynchronously when the element has been navigated to.  /**\n   * @deprecated Please use router.navigateToElement instead.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async navigateToElement() {}\n\n  /**\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\n   * asynchronously when the element has been navigated/scrolled to.\n   * @deprecated Please use router.navigateToElement instead.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async scrollTo() {}\n\n  /**\n   * Used to register models and views with `store`\n   * @deprecated Please use components.register instead.\n   * @param {string|Array} name The name(s) of the model/view to be registered\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\n   */\n  register(name, object) {}\n\n  /**\n   * Parses a view class name.\n   * @deprecated Please use components.getViewName instead.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   */\n  getViewName() {}\n\n  /**\n   * Fetches a view class from the store. For a usage example, see either HotGraphic or Narrative\n   * @deprecated Please use components.getViewClass instead.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   * @returns {Backbone.View} Reference to the view class\n   */\n  getViewClass() {}\n\n  /**\n   * Parses a model class name.\n   * @deprecated Please use components.getModelName instead.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\n   */\n  getModelName() {}\n\n  /**\n   * Fetches a model class from the store. For a usage example, see either HotGraphic or Narrative\n   * @deprecated Please use components.getModelClass instead.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\n   * @returns {Backbone.Model} Reference to the view class\n   */\n  getModelClass() {}\n\n  /**\n   * Looks up a model by its `_id` property\n   * @deprecated Please use data.findById instead.\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.Model}\n   */\n  findById() {}\n\n  /**\n   * Looks up a view by its model `_id` property\n   * @deprecated Please use data.findViewByModelId instead.\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.View}\n   */\n  findViewByModelId() {}\n\n  /**\n   * Returns the model represented by the trackingPosition.\n   * @deprecated Please use data.findByTrackingPosition instead.\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\n   * @returns {Backbone.Model}\n   */\n  findByTrackingPosition() {}\n\n}\n\nconst Adapt = new AdaptSingleton();\n\nexport default Adapt;\n","import Adapt from 'core/js/adapt';\n\n// Basic API for setting and getting name+value pairs\n// Allows registration of a single handler.\n\nclass OfflineStorage extends Backbone.Controller {\n\n  /**\n   * set .ready to false if an offlineStorage handler is being attached - we'll need to wait until the handler lets us know\n   * it's ready before we can safely use offlineStorage\n   */\n  initialize(handler) {\n    /**\n     * set to true initially so that if there are no offlineStorage handlers (i.e. if contrib-spoor is not installed)\n     * this can still be accessed OK\n     */\n    this.ready = true;\n    this._handler = undefined;\n\n    if (!handler) {\n      return;\n    }\n\n    this.ready = false;\n    this._handler = handler;\n  }\n\n  /**\n   * Flag to indicate if an offlineStorage handler has been defined.\n   * @returns {boolean} true if an offlineStorage handler has been defined, false otherwise\n   */\n  hasHandler() {\n    return this._handler !== undefined;\n  }\n\n  /**\n   * Causes state to be serialized and saved.\n   */\n  save() {\n    Adapt.trigger('tracking:save');\n    return this._handler?.save?.(...arguments);\n  }\n\n  /**\n   * Serializes nested arrays, booleans and numbers into an encoded string.\n   * @param {Array|boolean|number} value\n   * @returns {string}\n   */\n  serialize(value) {\n    if (this._handler?.serialize) {\n      return this._handler.serialize(...arguments);\n    }\n    return JSON.stringify(value);\n  }\n\n  /**\n   * Deserializes encoded strings back into nested arrays, booleans and numbers.\n   * @param {string} value\n   * @returns {Array|boolean|number}\n   */\n  deserialize(value) {\n    if (this._handler?.deserialize) {\n      return this._handler.deserialize(...arguments);\n    }\n    return JSON.parse(value);\n  }\n\n  set(name, value) {\n    if (this._handler?.set) {\n      return this._handler.set(...arguments);\n    }\n    // if no handler has been defined, just store the data locally\n    this[name] = value;\n  }\n\n  get(name) {\n    if (this._handler?.get) {\n      return this._handler.get(...arguments);\n    }\n    // if no handler has been defined, check local data store\n    return this[name];\n  }\n\n  clear() {\n    if (this._handler?.clear) {\n      return this._handler.clear(...arguments);\n    }\n    return false;\n  }\n\n  /**\n   * Some forms of offlineStorage could take time to initialise, this allows us to let plugins know when it's ready to be used\n   */\n  setReadyStatus() {\n    this.ready = true;\n    Adapt.trigger('offlineStorage:ready');\n  }\n\n}\n\nconst offlineStorage = new OfflineStorage();\nexport default offlineStorage;\n","import Adapt from 'core/js/adapt';\nimport Bowser from 'bowser';\nimport _ from 'underscore';\n\nclass Device extends Backbone.Controller {\n\n  initialize() {\n    _.bindAll(this, 'onWindowResize', 'calculateResize');\n    this.bowser = Bowser.parse(window.navigator.userAgent);\n    this.$html = $('html');\n    this.$window = $(window);\n    this.touch = Modernizr.touchevents;\n    this.screenWidth = this.getScreenWidth();\n    this.screenHeight = this.getScreenHeight();\n    this.setViewportHeight();\n    this.browser = (this.bowser.browser.name || '').toLowerCase();\n    this.version = (this.bowser.browser.version || '').toLowerCase();\n    this.OS = this.getOperatingSystem().toLowerCase();\n    this.osVersion = this.bowser.os.version || '';\n    this.renderingEngine = this.getRenderingEngine();\n    this.listenTo(Adapt, {\n      'configModel:dataLoaded': this.onConfigDataLoaded\n    });\n    const browser = this.browser.toLowerCase();\n    // Convert 'msie' and 'internet explorer' to 'ie'.\n    let browserString = browser.replace(/msie|internet explorer/, 'ie');\n    browserString += ` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;\n    // Legacy bad code, missing space after getAppleDevice and string replace is not global\n    browserString += browserString.replace('.', '-').toLowerCase();\n    browserString += ` ${browserString.replace(/\\./g, '-').toLowerCase()}`;\n    browserString += ` pixel-density-${this.pixelDensity()}`;\n    this.$html.addClass(browserString);\n  }\n\n  get orientation() {\n    return (this.screenWidth >= this.screenHeight) ? 'landscape' : 'portrait';\n  }\n\n  get aspectRatio() {\n    return this.screenWidth / this.screenHeight;\n  }\n\n  onConfigDataLoaded() {\n    this.screenSize = this.checkScreenSize();\n    this.$html.addClass('size-' + this.screenSize);\n    if (this.orientation) {\n      this.$html.addClass('orientation-' + this.orientation);\n    }\n    // As Adapt.config is available it's ok to bind the 'resize'.\n    this.$window.on('resize orientationchange', this.onWindowResize);\n  }\n\n  /**\n   * Compares the calculated screen width to the breakpoints defined in config.json.\n   *\n   * @returns {string} 'large', 'medium' or 'small'\n   */\n  checkScreenSize() {\n    const screenSizeConfig = Adapt.config.get('screenSize');\n    let screenSize;\n\n    const screensizeEmThreshold = 300;\n    const baseFontSize = 16;\n\n    // Check to see if the screen size value is larger than the em threshold\n    // If value is larger than em threshold, convert value (assumed px) to ems\n    // Otherwise assume value is in ems\n    const mediumEmBreakpoint = screenSizeConfig.medium > screensizeEmThreshold\n      ? screenSizeConfig.medium / baseFontSize\n      : screenSizeConfig.medium;\n    const smallEmBreakpoint = screenSizeConfig.small > screensizeEmThreshold\n      ? screenSizeConfig.small / baseFontSize\n      : screenSizeConfig.small;\n\n    const fontSize = parseFloat($('html').css('font-size'));\n    const screenSizeEmWidth = (window.innerWidth / fontSize);\n\n    // Check to see if client screen width is larger than medium em breakpoint\n    // If so apply large, otherwise check to see if client screen width is\n    // larger than small em breakpoint. If so apply medium, otherwise apply small\n    if (screenSizeEmWidth >= mediumEmBreakpoint) {\n      screenSize = 'large';\n    } else if (screenSizeEmWidth >= smallEmBreakpoint) {\n      screenSize = 'medium';\n    } else {\n      screenSize = 'small';\n    }\n\n    return screenSize;\n  }\n\n  getScreenWidth() {\n    return this.isAppleDevice()\n      ? this.getAppleScreenWidth()\n      : window.innerWidth || this.$window.width();\n  }\n\n  getScreenHeight() {\n    return this.isAppleDevice()\n      ? this.getAppleScreenHeight()\n      : window.innerHeight || this.$window.height();\n  }\n\n  setViewportHeight() {\n    document.documentElement.style.setProperty('--adapt-viewport-height', `${window.innerHeight}px`);\n  }\n\n  getOperatingSystem() {\n    let os = this.bowser.os.name.toLowerCase() || '';\n\n    if (os === '') {\n      // Fall back to using navigator.platform in case Bowser can't detect the OS.\n      const platform = navigator.platform.toLowerCase();\n      const match = platform.match(/win|mac|linux/);\n      if (match) os = match[0];\n      // Set consistency with the Bowser flags.\n      if (os === 'win') os = 'windows';\n      if (!os) os = '';\n    }\n\n    if (!os) os = 'platformunknown';\n\n    return os;\n  }\n\n  getRenderingEngine() {\n    return this.bowser.engine.name || '';\n  }\n\n  onWindowResize() {\n    if (this.hasWindowResized) return;\n    requestAnimationFrame(this.calculateResize);\n    this.hasWindowResized = true;\n  }\n\n  calculateResize() {\n    this.hasWindowResized = false;\n    // Calculate the screen properties.\n    const previousWidth = this.screenWidth;\n    const previousHeight = this.screenHeight;\n    this.screenWidth = this.getScreenWidth();\n    this.screenHeight = this.getScreenHeight();\n    this.setViewportHeight();\n\n    if (previousWidth === this.screenWidth && previousHeight === this.screenHeight) {\n      // Do not trigger a change if the viewport hasn't actually changed.  Scrolling on iOS will trigger a resize.\n      return;\n    }\n\n    if (this.orientation) {\n      this.$html.toggleClass('orientation-landscape', this.orientation === 'landscape');\n      this.$html.toggleClass('orientation-portrait', this.orientation === 'portrait');\n    }\n\n    const newScreenSize = this.checkScreenSize();\n    if (newScreenSize !== this.screenSize) {\n      this.screenSize = newScreenSize;\n      this.$html.toggleClass('size-small', this.screenSize === 'small');\n      this.$html.toggleClass('size-medium', this.screenSize === 'medium');\n      this.$html.toggleClass('size-large', this.screenSize === 'large');\n      Adapt.trigger('device:changed', this.screenSize);\n    }\n\n    Adapt.trigger('device:preResize device:resize device:postResize', this.screenWidth);\n  }\n\n  isAppleDevice() {\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) || (navigator.userAgent.match(/Mac/) && navigator?.maxTouchPoints > 2);\n  }\n\n  get shouldReportInvertedAppleScreenSize() {\n    const windowRatio = (window.innerWidth / window.innerHeight);\n    const screenRatio = (window.screen.width / window.screen.height);\n    const isWindowPortrait = (windowRatio < 1);\n    const isScreenPortrait = (screenRatio < 1);\n    const isDeviceBadlyReportingScreenOrientation = (isWindowPortrait !== isScreenPortrait);\n    return isDeviceBadlyReportingScreenOrientation;\n  }\n\n  getAppleScreenWidth() {\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.height : window.screen.width;\n  }\n\n  getAppleScreenHeight() {\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.width : window.screen.height;\n  }\n\n  getAppleDeviceType() {\n    const platformType = this.bowser.platform.type?.toLowerCase() || '';\n    const browserName = this.bowser.browser.name?.toLowerCase() || '';\n    const isIPhone = (platformType === 'mobile' && browserName === 'safari');\n    const isIPad = (platformType === 'tablet' && browserName === 'safari');\n    if (isIPhone) return 'iphone';\n    if (isIPad) return 'ipad';\n    return '';\n  }\n\n  pixelDensity() {\n    const pixelDensity = (window.devicePixelRatio || 1);\n\n    if (pixelDensity >= 3) {\n      return 'ultra-high';\n    } else if (pixelDensity >= 2) {\n      return 'high';\n    } else if (pixelDensity >= 1.5) {\n      return 'medium';\n    } else {\n      return 'low';\n    }\n  }\n\n}\n\nconst device = new Device();\nexport default device;\n","import Backbone from 'backbone';\n\nclass Location extends Backbone.Controller {\n\n  initialize() {\n    /**\n     * _id of previous contentobject\n     * @type {string}\n     */\n    this._previousId = null;\n    /**\n     * _type of previous contentobject\n     * @type {string}\n     */\n    this._previousContentType = null;\n    /**\n     * Model of previous contentobject\n     * @type {Backbone.Model}\n     */\n    this._previousModel = null;\n    /**\n     * _htmlClasses of previous contentobject\n     * @type {string}\n     */\n    this._previousClasses = null;\n    /**\n     * Alias for _previousContentType\n     * @type {string}\n     */\n    this._lastVisitedType = null;\n    /**\n     * _id of last menu\n     * @type {string}\n     * */\n    this._lastVisitedMenu = null;\n    /**\n     * _id of last page\n     * @type {string}\n     * */\n    this._lastVisitedPage = null;\n    /**\n     * _id of current contentobject\n     * @type {string}\n     */\n    this._currentId = null;\n    /**\n     * Model of current contentobject\n     * @type {Backbone.Model}\n     */\n    this._currentModel = null;\n    /**\n     * Current url querystring\n     * @type {string}\n     */\n    this._currentLocation = null;\n    /**\n     * Current contentobject type\n     * @type {string}\n     */\n    this._contentType = null;\n  }\n\n}\n\nconst location = new Location();\nexport default location;\n","import Adapt from 'core/js/adapt';\n\n/**\n * Browser modifications to focus handling.\n * @class\n */\nexport default class BrowserFocus extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._onBlur = this._onBlur.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this.$body = $('body');\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    this.$body\n      .on('blur', '*', this._onBlur)\n      .on('blur', this._onBlur);\n    // 'Capture' event attachment for click\n    this.$body[0].addEventListener('click', this._onClick, true);\n  }\n\n  /**\n   * When any element in the document receives a blur event,\n   * check to see if it needs the `data-a11y-force-focus` attribute removing\n   * and check to see if it was blurred because a disabled attribute was added.\n   * If a disabled attribute was added, the focus will be moved forward.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onBlur(event) {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isFocusNextOnDisabled) {\n      return;\n    }\n    const $element = $(event.target);\n    if ($element.is('[data-a11y-force-focus]')) {\n      $element.removeAttr('tabindex data-a11y-force-focus');\n    }\n    // From here, only check source elements\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n    // Check if element losing focus is losing focus\n    // due to the addition of a disabled class\n    if (!$element.is('[disabled]') && $element.css('display') !== 'none' && $element.css('visibility') !== 'hidden') {\n      return;\n    }\n    // Move focus to next readable element\n    this.a11y.focusNext($element);\n  }\n\n  /**\n   * Force focus when clicked on a tabbable element,\n   * making sure `document.activeElement` is updated.\n   * Stop event handling on aria-disabled elements.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onClick(event) {\n    const $element = $(event.target);\n    // search element and parents for aria-disabled - see https://github.com/adaptlearning/adapt_framework/issues/3097\n    const isAriaDisabled = $element.closest('[aria-disabled=true]').length === 1;\n    if (isAriaDisabled) {\n      event.preventDefault();\n      event.stopImmediatePropagation();\n    }\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isFocusOnClickEnabled) {\n      return;\n    }\n    const $stack = $([...$element.toArray(), ...$element.parents().toArray()]);\n    const $focusable = $stack.filter(config._options._tabbableElements);\n    if (!$focusable.length) {\n      return;\n    }\n    // Force focus for screen reader enter / space press\n    $focusable[0].focus();\n  }\n\n}\n","export default class FocusOptions {\n\n  /**\n   * Options parser for focus functions.\n   * @param {Object} options\n   * @param {boolean} [options.preventScroll=false] Stops the browser from scrolling to the focused point. https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\n   * @param {boolean} [options.defer=false] Add a defer to the focus call, allowing for user interface settling.\n   */\n  constructor({\n    preventScroll = false,\n    defer = false\n  } = {}) {\n    /**\n    * Stops the browser from scrolling to the focused point.\n    * https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\n    * @type {boolean}\n    */\n    this.preventScroll = preventScroll;\n    /**\n     * Add a defer to the focus call, allowing for user interface settling.\n     * @type {boolean}\n     */\n    this.defer = defer;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Manages whether or not the focus outline should be entirely removed\n * or removed until a key is pressed on a tabbable element.\n * @class\n */\nexport default class KeyboardFocusOutline extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this.$html = $('html');\n    this.showOnKeys = {\n      9: true, // tab\n      13: true, // enter\n      32: true, // space\n      37: true, // arrow left\n      38: true, // arrow up\n      39: true, // arrow right\n      40: true // arrow down\n    };\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    document.addEventListener('keydown', this._onKeyDown);\n    this._start();\n  }\n\n  /**\n   * Add styling classes if required.\n   */\n  _start() {\n    const config = this.a11y.config;\n    if (config._options._isFocusOutlineDisabled) {\n      this.$html.addClass('a11y-disable-focusoutline');\n      return;\n    }\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled) {\n      return;\n    }\n    this.$html.addClass('a11y-disable-focusoutline');\n  }\n\n  /**\n   * Handle key down events for on a tabbable element.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onKeyDown(event) {\n    const config = this.a11y.config;\n    if (config._options._isFocusOutlineDisabled) {\n      this.$html.addClass('a11y-disable-focusoutline');\n      return;\n    }\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled || !this.showOnKeys[event.keyCode]) {\n      return;\n    }\n    const $element = $(event.target);\n    if (!$element.is(config._options._tabbableElements) || $element.is(config._options._focusOutlineKeyboardOnlyIgnore)) {\n      return;\n    }\n    this.$html.removeClass('a11y-disable-focusoutline');\n  }\n\n}\n","// Used to determine if log call should be printed based on log level\nconst LOG_LEVEL = ENUM([\n  'DEBUG',\n  'INFO',\n  'WARN',\n  'ERROR',\n  'FATAL'\n]);\n\nexport default LOG_LEVEL;\n","import Adapt from 'core/js/adapt';\nimport LOG_LEVEL from 'core/js/enums/logLevelEnum';\n\nclass Logging extends Backbone.Controller {\n\n  initialize() {\n    this._config = {\n      _isEnabled: true,\n      _level: LOG_LEVEL.INFO.asLowerCase, // Default log level\n      _console: true, // Log to console\n      _warnFirstOnly: true // Show only first of identical removed and deprecated warnings\n    };\n    this._warned = {};\n    this.listenToOnce(Adapt, 'configModel:dataLoaded', this.onLoadConfigData);\n  }\n\n  onLoadConfigData() {\n\n    this.loadConfig();\n\n    this.debug('Logging config loaded');\n\n    this.trigger('log:ready');\n\n  }\n\n  loadConfig() {\n\n    if (Adapt.config.has('_logging')) {\n      this._config = Adapt.config.get('_logging');\n    }\n\n    this.checkQueryStringOverride();\n\n  }\n\n  checkQueryStringOverride() {\n\n    // Override default log level with level present in query string\n    const matches = window.location.search.match(/[?&]loglevel=([a-z]*)/i);\n    if (!matches || matches.length < 2) return;\n\n    const override = LOG_LEVEL(matches[1].toUpperCase());\n    if (!override) return;\n\n    this._config._level = override.asLowerCase;\n    this.debug('Loglevel override in query string:', this._config._level);\n\n  }\n\n  debug(...args) {\n    this._log(LOG_LEVEL.DEBUG, args);\n  }\n\n  info(...args) {\n    this._log(LOG_LEVEL.INFO, args);\n  }\n\n  warn(...args) {\n    this._log(LOG_LEVEL.WARN, args);\n  }\n\n  error(...args) {\n    this._log(LOG_LEVEL.ERROR, args);\n  }\n\n  fatal(...args) {\n    this._log(LOG_LEVEL.FATAL, args);\n  }\n\n  removed(...args) {\n    args = ['REMOVED'].concat(args);\n    this.warnOnce(...args);\n  }\n\n  deprecated(...args) {\n    args = ['DEPRECATED'].concat(args);\n    this.warnOnce(...args);\n  }\n\n  warnOnce(...args) {\n    if (this._hasWarned(args)) {\n      return;\n    }\n    this._log(LOG_LEVEL.WARN, args);\n  }\n\n  _log(level, data) {\n\n    const isEnabled = (this._config._isEnabled);\n    if (!isEnabled) return;\n\n    const configLevel = LOG_LEVEL(this._config._level.toUpperCase());\n\n    const isLogLevelAllowed = (level >= configLevel);\n    if (!isLogLevelAllowed) return;\n\n    this._logToConsole(level, data);\n\n    // Allow error reporting plugins to hook and report to logging systems\n    this.trigger('log', level, data);\n    this.trigger('log:' + level.asLowerCase, level, data);\n\n  }\n\n  _logToConsole(level, data) {\n\n    const shouldLogToConsole = (this._config._console);\n    if (!shouldLogToConsole) return;\n\n    const log = [level.asUpperCase + ':'];\n    data && log.push(...data);\n\n    // is there a matching console method we can use e.g. console.error()?\n    if (console[level.asLowerCase]) {\n      console[level.asLowerCase](...log);\n    } else {\n      console.log(...log);\n    }\n  }\n\n  _hasWarned(args) {\n    if (!this._config._warnFirstOnly) {\n      return false;\n    }\n    const hash = args.map(String).join(':');\n    if (this._warned[hash]) {\n      return true;\n    }\n    this._warned[hash] = true;\n    return false;\n  }\n\n}\n\nconst logging = new Logging();\nexport default logging;\n","import logging from 'core/js/logging';\n\n/**\n * Controller for managing accessibilty logging, specifically used for\n * controlling the display of removed or deprecated API warnings.\n */\nexport default class Log extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._warned = {};\n  }\n\n  _hasWarned(args) {\n    const config = this.a11y.config;\n    if (!config._options._warnFirstOnly) {\n      return false;\n    }\n    const hash = args.map(String).join(':');\n    if (this._warned[hash]) {\n      return true;\n    }\n    this._warned[hash] = true;\n    return false;\n  }\n\n  _canWarn() {\n    const config = this.a11y.config;\n    return Boolean(config._options._warn);\n  }\n\n  removed(...args) {\n    if (!this._canWarn) {\n      return;\n    }\n    args = ['A11Y'].concat(args);\n    if (this._hasWarned(args)) {\n      return;\n    }\n    logging.removed(...args);\n    return this;\n  }\n\n  deprecated(...args) {\n    if (!this._canWarn) {\n      return;\n    }\n    args = ['A11Y'].concat(args);\n    if (this._hasWarned(args)) {\n      return;\n    }\n    logging.deprecated(...args);\n    return this;\n  }\n\n}\n","/**\n * Controller for blocking scroll events on specified elements.\n * @class\n */\nexport default class Scroll extends Backbone.Controller {\n\n  initialize() {\n    this._onTouchStart = this._onTouchStart.bind(this);\n    this._onTouchEnd = this._onTouchEnd.bind(this);\n    this._onScrollEvent = this._onScrollEvent.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._scrollDisabledElements = $([]);\n    this.$window = $(window);\n    this.$body = $('body');\n    this._preventScrollOnKeys = {\n      37: true, // left\n      38: true, // up\n      39: true, // right\n      40: true // down\n    };\n    this._ignoreKeysOnElementsMatching = 'textarea, input, select';\n    this._isRunning = false;\n    this._touchStartEventObject = null;\n  }\n\n  /**\n   * Block scrolling on the given elements.\n   *\n   * @param {Object|string|Array} $elements\n   */\n  disable($elements) {\n    $elements = $($elements);\n    this._scrollDisabledElements = this._scrollDisabledElements.add($elements);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Stop blocking scrolling on the given elements.\n   *\n   * @param {Object|string|Array} $items\n   */\n  enable($elements) {\n    $elements = $($elements);\n    if (!$elements.length) {\n      this.clear();\n      return this;\n    }\n    this._scrollDisabledElements = this._scrollDisabledElements.not($elements);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Stop blocking all scrolling.\n   */\n  clear() {\n    this._scrollDisabledElements = $([]);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Start or stop listening for events to block if and when needed.\n   */\n  _checkRunning() {\n    if (!this._scrollDisabledElements.length) {\n      this._stop();\n      return;\n    }\n    this._start();\n  }\n\n  /**\n   * Start listening for events to block.\n   */\n  _start() {\n    if (this._isRunning) {\n      return;\n    }\n    this._isRunning = true;\n    window.addEventListener('touchstart', this._onTouchStart); // mobile\n    window.addEventListener('touchend', this._onTouchEnd); // mobile\n    window.addEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\n    window.addEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.addEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.addEventListener('keydown', this._onKeyDown);\n  }\n\n  /**\n   * Capture the touchstart event object for deltaY calculations.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onTouchStart(event) {\n    event = $.event.fix(event);\n    this._touchStartEventObject = event;\n    return true;\n  }\n\n  /**\n   * Clear touchstart event object.\n   */\n  _onTouchEnd() {\n    this._touchStartEventObject = null;\n    return true;\n  }\n\n  /**\n   * Process a native scroll event.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onScrollEvent(event) {\n    event = $.event.fix(event);\n    return this._preventScroll(event);\n  }\n\n  /**\n   * Process a native keydown event.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onKeyDown(event) {\n    event = $.event.fix(event);\n    if (!this._preventScrollOnKeys[event.keyCode]) {\n      return;\n    }\n    const $target = $(event.target);\n    if ($target.is(this._ignoreKeysOnElementsMatching)) {\n      return;\n    }\n    return this._preventScroll(event);\n  }\n\n  /**\n   * Process jquery event object.\n   *\n   * @param {JQuery.Event} event\n   */\n  _preventScroll(event) {\n    const isGesture = (event.touches?.length > 1);\n    if (isGesture) {\n      // allow multiple finger gestures through\n      // this will unfortunately allow two finger background scrolling on mobile devices\n      // one finger background scrolling will still be disabled\n      return;\n    }\n    const $target = $(event.target);\n    if (this._scrollDisabledElements.length) {\n      const scrollingParent = this._getScrollingParent(event, $target);\n      if (scrollingParent.filter(this._scrollDisabledElements).length === 0) {\n        this.$window.scroll();\n        return;\n      }\n    }\n    event.preventDefault();\n    return false;\n  }\n\n  /**\n   * Return the parent which will be scrolling from the current scroll event.\n   *\n   * @param {JQuery.Event} event\n   * @param {Object} $target jQuery element object.\n   */\n  _getScrollingParent(event, $target) {\n    const isTouchEvent = event.type === 'touchmove';\n    const hasTouchStartEvent = this._touchStartEventObject?.originalEvent;\n    if (isTouchEvent && !hasTouchStartEvent) {\n      return $target;\n    }\n    const directionY = this._getScrollDirection(event);\n    if (directionY === 'none') {\n      return this.$body;\n    }\n    // Make sure to check the element on which the scroll event was triggered\n    const parents = [$target[0], ...$target.parents()];\n    for (let i = 0, l = parents.length; i < l; i++) {\n      const $parent = $(parents[i]);\n      if ($parent.is('body')) {\n        return this.$body;\n      }\n      if (!this._isScrollable($parent)) {\n        continue;\n      }\n      if (!this._isScrolling($parent, directionY)) {\n        continue;\n      }\n      return $parent;\n    }\n    return this.$body;\n  }\n\n  /**\n   * Returns true if the specified target is scrollable.\n   *\n   * @param {Object} $target jQuery element object.\n   * @returns {boolean}\n   */\n  _isScrollable($target) {\n    const scrollType = $target.css('overflow-y');\n    if (scrollType !== 'auto' && scrollType !== 'scroll') {\n      return false;\n    }\n    const pointerEvents = $target.css('pointer-events');\n    if (pointerEvents === 'none') {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Returns true if the specified target is the scrolling target.\n   *\n   * @param {Object} $target jQuery element object.\n   * @param {string} directionY 'none' | 'up' | 'down'\n   *\n   * @returns {boolean}\n   */\n  _isScrolling($target, directionY) {\n    const scrollTop = Math.ceil($target.scrollTop());\n    const innerHeight = $target.outerHeight();\n    const scrollHeight = $target[0].scrollHeight;\n    let hasScrollingSpace = false;\n    switch (directionY) {\n      case 'down':\n        hasScrollingSpace = scrollTop + innerHeight < scrollHeight;\n        if (hasScrollingSpace) {\n          return true;\n        }\n        break;\n      case 'up':\n        hasScrollingSpace = scrollTop > 0;\n        if (hasScrollingSpace) {\n          return true;\n        }\n        break;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the vertical direction of scroll.\n   *\n   * @param {JQuery.Event} event\n   * @returns {string} 'none' | 'up' | 'down'\n   */\n  _getScrollDirection(event) {\n    const deltaY = this._getScrollDelta(event);\n    if (deltaY === 0) {\n      return 'none';\n    }\n    return deltaY > 0 ? 'up' : 'down';\n  }\n\n  /**\n   * Returns the number of pixels which is intended to be scrolled.\n   *\n   * @param {JQuery.Event} event\n   * @returns {number}\n   */\n  _getScrollDelta(event) {\n    let deltaY = 0;\n    const isTouchEvent = event.type === 'touchmove';\n    const originalEvent = event.originalEvent;\n    if (isTouchEvent) {\n      // Touch events\n      // iOS previous + current scroll pos\n      const startOriginalEvent = this._touchStartEventObject.originalEvent;\n      let currentY = originalEvent.pageY;\n      let previousY = startOriginalEvent.pageY;\n      if (currentY === 0 || currentY === previousY) {\n        // Android chrome current scroll pos\n        currentY = originalEvent.touches[0].pageY;\n        previousY = startOriginalEvent.touches[0].pageY;\n      }\n      // Touch: delta calculated from touchstart pos vs touchmove pos\n      deltaY = currentY - previousY;\n    } else {\n      // Mouse events\n      const hasDeltaY = (originalEvent.wheelDeltaY || originalEvent.deltaY !== undefined);\n      if (hasDeltaY) {\n        // Desktop: Firefox & IE delta inverted\n        deltaY = -originalEvent.deltaY;\n      } else {\n        // Desktop: Chrome & Safari wheel delta\n        deltaY = (originalEvent.wheelDelta || 0);\n      }\n    }\n    return deltaY;\n  }\n\n  /**\n   * Stop listening for events to block.\n   */\n  _stop() {\n    if (!this._isRunning) {\n      return;\n    }\n    this._isRunning = false;\n    window.removeEventListener('touchstart', this._onTouchStart); // mobile\n    window.removeEventListener('touchend', this._onTouchEnd); // mobile\n    // shouldn't need to supply 3rd arg when removing, but IE11 won't remove the event listener if you don't - see https://github.com/adaptlearning/adapt_framework/issues/2466\n    window.removeEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\n    window.removeEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.removeEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.removeEventListener('keydown', this._onKeyDown);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Controller for managing tab wrapping for popups.\n * @class\n */\nexport default class WrapFocus extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    _.bindAll(this, '_onWrapAround');\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    const config = this.a11y.config;\n    $('body').on('click focus', config._options._focusguard, this._onWrapAround);\n  }\n\n  /**\n   * If click or focus is received on any element with the focusguard class,\n   * loop focus around to the top of the document.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onWrapAround(event) {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupWrapFocusEnabled) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    this.a11y.focusFirst('body', { defer: false });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Tabindex and aria-hidden manager for popups.\n * @class\n */\nexport default class Popup extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    /**\n     * List of elements which form the base at which elements are generally tabbale\n     * and aria-hidden='false'.\n     *\n     * @type {Array<Object>}\n     */\n    this._floorStack = [$('body')];\n    /**\n     * List of elements to return the focus to once leaving each stack.\n     *\n     * @type {Array<Object>}\n     */\n    this._focusStack = [];\n    /**\n     * Hash of tabindex states for each tabbable element in the popup stack.\n     *\n     * @type {Object}\n     */\n    this._tabIndexes = {};\n    /**\n     * Hash of aria-hidden states for each tabbable element in the popup stack.\n     *\n     * @type {Object}\n     */\n    this._ariaHiddens = {};\n    /**\n     * Incremented unique ids for elements belonging to a popup stack with saved\n     * states,\n     */\n    this._elementUIDIndex = 0;\n    this.listenTo(Adapt, {\n      'popup:opened'($element, ignoreInternalTrigger) {\n        if (ignoreInternalTrigger) {\n          return;\n        }\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:opened\", $element) is replaced with a11y.popupOpened($element);');\n        this.opened($element, true);\n      },\n      'popup:closed'($target, ignoreInternalTrigger) {\n        if (ignoreInternalTrigger) {\n          return;\n        }\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:closed\", $target) is replaced with a11y.popupClosed($target);');\n        this.closed($target, true);\n      }\n    });\n  }\n\n  /**\n   * Reorganise the tabindex and aria-hidden attributes in the document to\n   * restrict user interaction to the element specified.\n   *\n   * @param {Object} [$popupElement] Element encapulating the popup.\n   * @returns {Object} Returns `a11y._popup`.\n   */\n  opened($popupElement, silent) {\n    // Capture currently active element or element specified\n    $popupElement = $popupElement || $(document.activeElement);\n    this._addPopupLayer($popupElement);\n    if (!silent) {\n      Adapt.trigger('popup:opened', $popupElement, true);\n    }\n    return this;\n  }\n\n  /**\n   * Restrict tabbing and screen reader access to selected element only.\n   *\n   * @param {Object} $popupElement Element encapulating the popup.\n   */\n  _addPopupLayer($popupElement) {\n    $popupElement = $($popupElement);\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled || $popupElement.length === 0) {\n      return $popupElement;\n    }\n    this._floorStack.push($popupElement);\n    this._focusStack.push($(document.activeElement));\n    let $elements = $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n    const $branch = $popupElement.add($popupElement.parents());\n    const $siblings = $branch.siblings().filter(config._options._tabbableElementsExcludes);\n    $elements = $elements.add($siblings);\n    $elements.each((index, item) => {\n      const $item = $(item);\n      if (typeof item.a11y_uid === 'undefined') {\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\n      }\n      const elementUID = item.a11y_uid;\n      if (this._tabIndexes[elementUID] === undefined) {\n        this._tabIndexes[elementUID] = [];\n      }\n      if (this._ariaHiddens[elementUID] === undefined) {\n        this._ariaHiddens[elementUID] = [];\n      }\n      const tabindex = $item.attr('tabindex');\n      const ariaHidden = $item.attr('aria-hidden');\n      this._tabIndexes[elementUID].push(tabindex === undefined ? '' : tabindex);\n      this._ariaHiddens[elementUID].push(ariaHidden === undefined ? '' : ariaHidden);\n      if (config._options._isPopupTabIndexManagementEnabled) {\n        $item.attr('tabindex', -1);\n      }\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\n        $item.attr('aria-hidden', true);\n      }\n    });\n    const $items = $popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n    if (config._options._isPopupTabIndexManagementEnabled) {\n      $items.attr('tabindex', 0);\n    }\n    if (config._options._isPopupAriaHiddenManagementEnabled) {\n      $items\n        .removeAttr('aria-hidden')\n        .removeClass('aria-hidden')\n        .parents(config._options._ariaHiddenExcludes)\n        .removeAttr('aria-hidden')\n        .removeClass('aria-hidden');\n    }\n  }\n\n  /**\n   * Close the last popup on the stack, restoring tabindex and aria-hidden\n   * attributes.\n   *\n   * @param {Object} [$focusElement] Element at which to move focus.\n   * @returns {Object} Returns `a11y._popup`.\n   */\n  closed($focusElement, silent) {\n    const $previousFocusElement = this._removeLastPopupLayer();\n    $focusElement = $focusElement || $previousFocusElement || $('body');\n    if (!silent) {\n      Adapt.trigger('popup:closed', $focusElement, true);\n    }\n    this.a11y.focusFirst($($focusElement), { preventScroll: true });\n    return this;\n  }\n\n  /**\n   * Restores tabbing and screen reader access to the state before the last\n   * `_addPopupLayer` call.\n   *\n   * @returns {Object} Returns previously active element.\n   */\n  _removeLastPopupLayer() {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled) {\n      return $(document.activeElement);\n    }\n    // the body layer is the first element and must always exist\n    if (this._floorStack.length <= 1) {\n      return;\n    }\n    this._floorStack.pop();\n    $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each((index, item) => {\n      const $item = $(item);\n      let previousTabIndex = '';\n      let previousAriaHidden = '';\n      if (typeof item.a11y_uid === 'undefined') {\n        // assign element a unique id\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\n      }\n      const elementUID = item.a11y_uid;\n      if (this._tabIndexes[elementUID]?.length) {\n        // get previous tabindex if saved\n        previousTabIndex = this._tabIndexes[elementUID].pop();\n        previousAriaHidden = this._ariaHiddens[elementUID].pop();\n      }\n      if (this._tabIndexes[elementUID]?.length) {\n        // delete element tabindex store if empty\n        delete this._tabIndexes[elementUID];\n        delete this._ariaHiddens[elementUID];\n      }\n      if (config._options._isPopupTabIndexManagementEnabled) {\n        if (previousTabIndex === '') {\n          $item.removeAttr('tabindex');\n        } else {\n          $item.attr({\n            tabindex: previousTabIndex\n          });\n        }\n      }\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\n        if (previousAriaHidden === '') {\n          $item.removeAttr('aria-hidden');\n        } else {\n          $item.attr({\n            'aria-hidden': previousAriaHidden\n          });\n        }\n      }\n    });\n    return this._focusStack.pop();\n  }\n\n  /**\n   * When a popup is open, this function makes it possible to swap the element\n   * that should receive focus on popup close.\n   *\n   * @param {Object} $focusElement Set a new element to focus on.\n   * @returns {Object} Returns previously set focus element.\n   */\n  setCloseTo($focusElement) {\n    const $original = this._focusStack.pop();\n    this._focusStack.push($focusElement);\n    return $original;\n  }\n\n}\n","export default {\n  _menu: 1,\n  _menuGroup: 2,\n  _menuItem: 2,\n  _page: 1,\n  _article: 2,\n  _block: 3,\n  _component: 4,\n  _componentItem: 5,\n  _notify: 1\n};\n","export default function(a11y) {\n\n  /**\n   * The old API is rerouted to the new API with warnings.\n   */\n\n  Object.assign($.fn, {\n\n    isFixedPostion() {\n      a11y.log.removed('$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.');\n      return false;\n    },\n\n    a11y_aria_label() {\n      a11y.log.removed('$(\"..\").a11y_aria_label was incorrect behaviour.');\n      return this;\n    },\n\n    limitedScrollTo() {\n      a11y.log.removed('$.limitedScrollTo had no impact on the screen reader cursor.');\n      return this;\n    },\n\n    a11y_text() {\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n      return this;\n    },\n\n    a11y_selected() {\n      a11y.log.removed('$(\"..\").a11y_selected is removed. Please use aria-live instead.');\n      return this;\n    },\n\n    a11y_on(isOn) {\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.findTabbable($element); and a11y.toggleAccessible($elements, isAccessible); instead.');\n      const $tabbable = a11y.findTabbable(this);\n      a11y.toggleAccessible($tabbable, isOn);\n      return this;\n    },\n\n    a11y_only() {\n      a11y.log.removed('$(\"..\").a11y_only, use a11y.popupOpened($popupElement); instead.');\n      return this;\n    },\n\n    scrollDisable() {\n      if (a11y.config._options._isScrollDisableEnabled === false) {\n        return this;\n      }\n      a11y.log.deprecated('$(\"..\").scrollDisable, use a11y.scrollDisable($elements); instead.');\n      a11y.scrollDisable(this);\n      return this;\n    },\n\n    scrollEnable() {\n      if (a11y.config._options._isScrollDisableEnabled === false) {\n        return this;\n      }\n      a11y.log.deprecated('$(\"..\").scrollEnable, use a11y.scrollEnable($elements); instead.');\n      a11y.scrollEnable(this);\n      return this;\n    },\n\n    a11y_popup() {\n      a11y.log.deprecated('$(\"..\").a11y_popup, use a11y.popupOpened($popupElement); instead.');\n      return a11y.popupOpened(this);\n    },\n\n    a11y_cntrl(isOn, withDisabled) {\n      a11y.log.deprecated('$(\"..\").a11y_cntrl, use a11y.toggleAccessible($elements, isAccessible); and if needed a11y.toggleEnabled($elements, isEnabled); instead.');\n      a11y.toggleAccessible(this, isOn);\n      if (withDisabled) a11y.toggleEnabled(this, isOn);\n      return this;\n    },\n\n    a11y_cntrl_enabled(isOn) {\n      a11y.log.deprecated('$(\"..\").a11y_cntrl_enabled, use a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.');\n      a11y.toggleAccessibleEnabled(this, isOn);\n      return this;\n    },\n\n    isReadable() {\n      a11y.log.deprecated('$(\"..\").isReadable, use a11y.isReadable($element); instead.');\n      return a11y.isReadable(this);\n    },\n\n    findForward(selector) {\n      a11y.log.removed('$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.');\n      return a11y._findFirstForward(this, selector);\n    },\n\n    findWalk(selector) {\n      a11y.log.removed('$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.');\n      return a11y._findFindForwardDescendant(this, selector);\n    },\n\n    focusNoScroll() {\n      a11y.log.deprecated('$(\"..\").focusNoScroll, use a11y.focus($element); instead.');\n      return a11y.focus(this);\n    },\n\n    focusNext(returnOnly) {\n      a11y.log.deprecated('$(\"..\").focusNext, use a11y.focusNext($element); or if needed a11y.findFirstReadable($element); instead.');\n      if (returnOnly) {\n        return a11y.findFirstReadable(this);\n      }\n      return a11y.focusNext(this);\n    },\n\n    focusOrNext(returnOnly) {\n      a11y.log.deprecated('$(\"..\").focusOrNext, use a11y.focusFirst($element); or if needed a11y.findFirstReadable($element); or a11y.isReadable($element); instead.');\n      if (returnOnly) {\n        if (a11y.isReadable(this)) return this;\n        return a11y.findFirstReadable(this);\n      }\n      return a11y.focusFirst(this);\n    },\n\n    a11y_focus(dontDefer) {\n      a11y.log.deprecated('$(\"..\").a11y_focus, use a11y.focusFirst($element, { defer: true }); instead.');\n      a11y.focusFirst(this, { defer: !dontDefer });\n      return this;\n    }\n\n  });\n\n  Object.assign($, {\n\n    a11y_alert() {\n      a11y.log.removed('$.a11y_alert is removed. Please use aria-live instead.');\n      return this;\n    },\n\n    a11y_update() {\n      a11y.log.removed('a11y_update is no longer required.');\n      return this;\n    },\n\n    a11y_text(text) {\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n      return text;\n    },\n\n    a11y_on(isOn, selector) {\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.toggleHidden($elements, isHidden); instead.');\n      return a11y.toggleHidden(selector, !isOn);\n    },\n\n    a11y_popdown($focusTarget) {\n      a11y.log.removed('$.a11y_popdown, use a11y.popupClosed($focusTarget); instead.');\n      return a11y.popupClosed($focusTarget);\n    },\n\n    a11y_focus(dontDefer) {\n      a11y.log.deprecated('$.a11y_focus, use a11y.focusFirst(\"body\", { defer: true }); instead.');\n      a11y.focusFirst('body', { defer: !dontDefer });\n      return this;\n    },\n\n    a11y_normalize(html) {\n      a11y.log.deprecated('$.a11y_normalize, use a11y.normalize(\"html\"); instead.');\n      return a11y.normalize(html);\n    },\n\n    a11y_remove_breaks(html) {\n      a11y.log.deprecated('$.a11y_remove_breaks, use a11y.removeBreaks(\"html\"); instead.');\n      return a11y.removeBreaks(html);\n    }\n\n  });\n}\n","import Backbone from 'backbone';\nimport logging from 'core/js/logging';\n\nclass Components extends Backbone.Controller {\n\n  initialize() {\n    this._register = {};\n    this.register = this.register.bind(this);\n    this.getViewName = this.getViewName.bind(this);\n    this.getViewClass = this.getViewClass.bind(this);\n    this.getModelName = this.getModelName.bind(this);\n    this.getModelClass = this.getModelClass.bind(this);\n  }\n\n  /**\n   * Used to register models and views\n   * @param {string|Array} name The name(s) of the model/view to be registered\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\n   */\n  register(name, object) {\n    if (Array.isArray(name)) {\n      // if an array is passed, iterate by recursive call\n      name.forEach(name => this.register(name, object));\n      return object;\n    }\n\n    if (name.split(' ').length > 1) {\n      // if name with spaces is passed, split and pass as array\n      this.register(name.split(' '), object);\n      return object;\n    }\n\n    if ((!object.view && !object.model) || object instanceof Backbone.View) {\n      logging.deprecated('View-only registrations are no longer supported');\n      object = { view: object };\n    }\n\n    if (object.view && !object.view.template) {\n      object.view.template = name;\n    }\n\n    const isModelSetAndInvalid = (object.model &&\n      !(object.model.prototype instanceof Backbone.Model) &&\n      !(object.model instanceof Function));\n    if (isModelSetAndInvalid) {\n      throw new Error('The registered model is not a Backbone.Model or Function');\n    }\n\n    const isViewSetAndInvalid = (object.view &&\n      !(object.view.prototype instanceof Backbone.View) &&\n      !(object.view instanceof Function));\n    if (isViewSetAndInvalid) {\n      throw new Error('The registered view is not a Backbone.View or Function');\n    }\n\n    this._register[name] = Object.assign({}, this._register[name], object);\n\n    return object;\n  }\n\n  /**\n   * Parses a view class name.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   */\n  getViewName(nameModelViewOrData) {\n    if (typeof nameModelViewOrData === 'string') {\n      return nameModelViewOrData;\n    }\n    if (nameModelViewOrData instanceof Backbone.Model) {\n      nameModelViewOrData = nameModelViewOrData.toJSON();\n    }\n    if (nameModelViewOrData instanceof Backbone.View) {\n      let foundName;\n      Object.entries(this._register).forEach(([key, entry]) => {\n        if (!entry?.view) return;\n        if (!(nameModelViewOrData instanceof entry.view)) return;\n        foundName = key;\n        return true;\n      });\n      return foundName;\n    }\n    if (nameModelViewOrData instanceof Object) {\n      const names = [\n        typeof nameModelViewOrData._view === 'string' && nameModelViewOrData._view,\n        typeof nameModelViewOrData._component === 'string' && nameModelViewOrData._component,\n        typeof nameModelViewOrData._type === 'string' && nameModelViewOrData._type\n      ].filter(Boolean);\n      if (names.length) {\n        // find first fitting view name\n        const name = names.find(name => this._register[name]?.view);\n        return name || names.pop(); // return last available if none found\n      }\n    }\n    throw new Error('Cannot derive view class name from input');\n  }\n\n  /**\n   * Fetches a view class from the components. For a usage example, see either HotGraphic or Narrative\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   * @returns {Backbone.View} Reference to the view class\n   */\n  getViewClass(nameModelViewOrData) {\n    const name = this.getViewName(nameModelViewOrData);\n    const object = this._register[name];\n    if (!object) {\n      logging.error(`A view for '${name}' isn't registered in your project`);\n      return;\n    }\n    const isBackboneView = (object.view?.prototype instanceof Backbone.View);\n    if (!isBackboneView && object.view instanceof Function) {\n      return object.view();\n    }\n    return object.view;\n  }\n\n  /**\n   * Parses a model class name.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\n   */\n  getModelName(nameModelOrData) {\n    if (typeof nameModelOrData === 'string') {\n      return nameModelOrData;\n    }\n    if (nameModelOrData instanceof Backbone.Model) {\n      nameModelOrData = nameModelOrData.toJSON();\n    }\n    if (nameModelOrData instanceof Object) {\n      const name = nameModelOrData._component;\n      const entry = this._register[name];\n      const isViewOnlyQuestion = entry && !entry.model && entry.view?._isQuestionType;\n      if (isViewOnlyQuestion) {\n        // Use question model by default\n        logging.deprecated(`Assuming a question model for a view-only question: ${name}`);\n        return 'question';\n      }\n      const names = [\n        typeof nameModelOrData._model === 'string' && nameModelOrData._model,\n        typeof nameModelOrData._component === 'string' && nameModelOrData._component,\n        typeof nameModelOrData._type === 'string' && nameModelOrData._type\n      ].filter(Boolean);\n      if (names.length) {\n        // find first fitting model name\n        const name = names.find(name => this._register[name]?.model);\n        return name || names.pop(); // return last available if none found\n      }\n    }\n    throw new Error('Cannot derive model class name from input');\n  }\n\n  /**\n   * Fetches a model class from the components. For a usage example, see either HotGraphic or Narrative\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\n   * @returns {Backbone.Model} Reference to the view class\n   */\n  getModelClass(nameModelOrData) {\n    const name = this.getModelName(nameModelOrData);\n    const object = this._register[name];\n    if (!object) {\n      logging.error(`A model for '${name}' isn't registered in your project`);\n      return;\n    }\n    const isBackboneModel = (object.model?.prototype instanceof Backbone.Model);\n    if (!isBackboneModel && object.model instanceof Function) {\n      return object.model();\n    }\n    return object.model;\n  }\n\n}\n\nconst components = new Components();\nexport default components;\n","import Adapt from 'core/js/adapt';\n\nexport default class AdaptCollection extends Backbone.Collection {\n\n  initialize(models, options) {\n    this.once('reset', this.loadedData, this);\n  }\n\n  loadedData() {\n    Adapt.trigger('adaptCollection:dataLoaded');\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport LockingModel from 'core/js/models/lockingModel';\nimport 'core/js/logging';\nimport semver from 'semver';\n\nexport default class BuildModel extends LockingModel {\n\n  defaults() {\n    return {\n      jsonext: 'json'\n    };\n  }\n\n  initialize(attrs, options) {\n    this.url = options.url;\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\n    // Then check if course files can load\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\n    this.fetch({\n      success: () => {\n        this.isLoaded = true;\n        Adapt.trigger('buildModel:dataLoaded');\n      },\n      error: () => {\n        console.log('Unable to load adapt/js/build.js');\n        Adapt.trigger('buildModel:dataLoaded');\n      }\n    });\n  }\n\n  isFrameworkVersion(version) {\n    return semver.satisfies(this.get('package').version, version, { includePrerelease: true });\n  }\n\n  isPluginInstalled(name, version = '*') {\n    const plugin = this.get('plugins').find(plugin => {\n      if (plugin.name !== name) return false;\n      return semver.satisfies(plugin.version, version, { includePrerelease: true });\n    });\n    return Boolean(plugin);\n  }\n\n  whenReady() {\n    if (this.isLoaded) return Promise.resolve();\n    return new Promise(resolve => {\n      Adapt.once('buildModel:dataLoaded', resolve);\n    });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\n\nexport default class ConfigModel extends LockingModel {\n\n  defaults() {\n    return {\n      screenSize: {\n        large: 900,\n        medium: 760,\n        small: 520\n      },\n      _forceRouteLocking: false,\n      _canLoadData: true,\n      _disableAnimation: false\n    };\n  }\n\n  /**\n   * Parse the incoming search queries for certain parameter values to use as defaults\n   */\n  setValuesFromURLParams() {\n    const paramMappings = {\n      dir: '_defaultDirection',\n      lang: '_defaultLanguage'\n    };\n\n    const params = new URLSearchParams(window.location.search);\n\n    Object.entries(paramMappings).forEach(([key, value]) => {\n      const passedVal = params.get(key);\n      if (!passedVal) return;\n      if (key === 'lang' && Adapt.build.get('availableLanguageNames')?.includes(passedVal) === false) return;\n      this.set(value, passedVal);\n    });\n  }\n\n  initialize(attrs, options) {\n    this.url = options.url;\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\n    // Then check if course files can load\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\n    this.fetch({\n      success: () => {\n        this.setValuesFromURLParams();\n\n        Adapt.trigger('offlineStorage:prepare');\n        wait.queue(() => {\n          Adapt.trigger('configModel:dataLoaded');\n          if (!this.get('_canLoadData')) return;\n          Adapt.trigger('configModel:loadCourseData');\n        });\n      },\n      error: () => logging.error('Unable to load course/config.json')\n    });\n  }\n\n  loadData() {}\n\n}\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport AdaptCollection from 'core/js/collections/adaptCollection';\nimport BuildModel from 'core/js/models/buildModel';\nimport ConfigModel from 'core/js/models/configModel';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\nimport _ from 'underscore';\n\nclass Data extends AdaptCollection {\n\n  model(json) {\n    const ModelClass = components.getModelClass(json);\n    if (!ModelClass) {\n      return new LockingModel(json);\n    }\n    return new ModelClass(json, { parse: true });\n  }\n\n  initialize() {\n    super.initialize();\n    this.findById = this.findById.bind(this);\n    this.findViewByModelId = this.findViewByModelId.bind(this);\n    this.findByTrackingPosition = this.findByTrackingPosition.bind(this);\n    this.on({\n      add: this.onAdded,\n      remove: this.onRemoved\n    });\n  }\n\n  async init () {\n    this.reset();\n    this._byAdaptID = {};\n    Adapt.build = new BuildModel(null, { url: 'adapt/js/build.min.js', reset: true });\n    await Adapt.build.whenReady();\n    $('html').attr('data-adapt-framework-version', Adapt.build.get('package').version);\n    this.loadConfigData();\n  }\n\n  onAdded(model) {\n    this._byAdaptID[model.get('_id')] = model;\n  }\n\n  onRemoved(model) {\n    delete this._byAdaptID[model.get('_id')];\n  }\n\n  loadConfigData() {\n    Adapt.config = new ConfigModel(null, { url: Adapt.build.get('coursedir') + '/config.' + Adapt.build.get('jsonext'), reset: true });\n    this.listenToOnce(Adapt, 'configModel:loadCourseData', this.onLoadCourseData);\n    this.listenTo(Adapt.config, {\n      'change:_activeLanguage': this.onLanguageChange,\n      'change:_defaultDirection': this.onDirectionChange\n    });\n  }\n\n  onDirectionChange(model, direction) {\n    if (direction === 'rtl') {\n      $('html').removeClass('dir-ltr').addClass('dir-rtl').attr('dir', 'rtl');\n    } else {\n      $('html').removeClass('dir-rtl').addClass('dir-ltr').attr('dir', 'ltr');\n    }\n  }\n\n  /**\n   * Before we actually go to load the course data, we first need to check to see if a language has been set\n   * If it has we can go ahead and start loading; if it hasn't, apply the defaultLanguage from config.json\n   */\n  onLoadCourseData() {\n    if (!Adapt.config.get('_activeLanguage')) {\n      Adapt.config.set('_activeLanguage', Adapt.config.get('_defaultLanguage'));\n      return;\n    }\n    this.loadCourseData();\n  }\n\n  async onLanguageChange(model, language) {\n    await wait.queue();\n    offlineStorage.set('lang', language);\n    // set `_isStarted` back to `false` when changing language so that the learner's answers\n    // to questions get restored in the new language when `_restoreStateOnLanguageChange: true`\n    // see https://github.com/adaptlearning/adapt_framework/issues/2977\n    if (Adapt.get('_isStarted')) {\n      Adapt.set('_isStarted', false);\n    }\n    this.loadCourseData(language);\n  }\n\n  async loadCourseData(newLanguage) {\n\n    // All code that needs to run before adapt starts should go here\n    const language = Adapt.config.get('_activeLanguage');\n\n    const courseFolder = Adapt.build.get('coursedir') + '/' + language + '/';\n\n    $('html').attr('lang', language);\n\n    await this.loadManifestFiles(courseFolder);\n    await this.triggerDataLoaded();\n    await this.triggerDataReady(newLanguage);\n    this.triggerInit();\n\n  }\n\n  getJSON(path) {\n    return new Promise((resolve, reject) => {\n      $.getJSON(path, data => {\n        // Add path to data in case it's necessary later\n        data.__path__ = path;\n        resolve(data);\n      }).fail(() => {\n        reject(new Error(`Unable to load ${path}`));\n      });\n    });\n  }\n\n  async loadManifestFiles(languagePath) {\n    this.trigger('loading');\n    this.reset();\n    const manifestPath = languagePath + 'language_data_manifest.js';\n    let manifest;\n    try {\n      manifest = await this.getJSON(manifestPath);\n    } catch (err) {\n      manifest = ['course.json', 'contentObjects.json', 'articles.json', 'blocks.json', 'components.json'];\n      logging.error(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(', ')}`);\n    }\n    let allFileData;\n    try {\n      allFileData = await Promise.all(manifest.map(filePath => {\n        return this.getJSON(`${languagePath}${filePath}`);\n      }));\n    } catch (error) {\n      logging.error(error);\n      return;\n    }\n    // Flatten all file data into a single array of model data\n    const allModelData = allFileData.reduce((result, fileData) => {\n      if (Array.isArray(fileData)) {\n        fileData.forEach((datum, index) => {\n          datum.__path__ = fileData.__path__;\n          datum.__index__ = index;\n      });\n        result.push(...fileData);\n      } else if (fileData instanceof Object) {\n        result.push(fileData);\n      } else {\n        logging.warnOnce(`File data isn't an array or object: ${fileData.__path__}`);\n      }\n      return result;\n    }, []);\n    // Add course model first to allow other model/views to utilize its settings\n    const course = allModelData.find(modelData => modelData._type === 'course');\n    if (!course) {\n      throw new Error('Expected a model data with \"_type\": \"course\", none found.');\n    }\n    Adapt.trigger('courseModel:dataLoading');\n    Adapt.course = this.push(course);\n    Adapt.trigger('courseModel:dataLoaded');\n    // Add other models\n    allModelData.forEach(modelData => {\n      if (modelData._type === 'course') {\n        return;\n      }\n      try {\n        components.getModelName(modelData);\n      } catch (error) {\n        logging.error(`Failed to load object ${modelData.__path__}${Object.prototype.hasOwnProperty.call(modelData, '__index__') ? `[${modelData.__index__}]` : ''}`)\n        logging.error(error);\n        return;\n      }\n      this.push(modelData);\n    });\n    this.checkData();\n    this.trigger('reset');\n    this.trigger('loaded');\n    await wait.queue();\n  }\n\n  async triggerDataLoaded() {\n    logging.debug('Firing app:dataLoaded');\n    try {\n      // Setup the newly added models\n      this.forEach(model => model.setupModel?.());\n      Adapt.trigger('app:dataLoaded');\n    } catch (e) {\n      logging.error('Error during app:dataLoading trigger', e);\n    }\n    await wait.queue();\n  }\n\n  async triggerDataReady(newLanguage) {\n    if (newLanguage) {\n      Adapt.trigger('app:languageChanged', newLanguage);\n      await wait.queue();\n    }\n    logging.debug('Firing app:dataReady');\n    try {\n      Adapt.trigger('app:dataReady');\n    } catch (e) {\n      logging.error('Error during app:dataReady trigger', e);\n    }\n    await wait.queue();\n  }\n\n  triggerInit() {\n    this.isReady = true;\n    this.trigger('ready');\n  }\n\n  whenReady() {\n    if (this.isReady) return Promise.resolve();\n    return new Promise(resolve => {\n      this.once('ready', resolve);\n    });\n  }\n\n  /**\n   * Checks if a model _id exists\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @returns {boolean}\n   */\n  hasId(id) {\n    return Boolean(this._byAdaptID[id]);\n  }\n\n  /**\n   * Looks up a model by its `_id` property\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.Model}\n   */\n  findById(id) {\n    const model = this._byAdaptID[id];\n    if (!model) {\n      console.warn(`data.findById() unable to find id: ${id}`);\n      return;\n    }\n    return model;\n  }\n\n  /**\n   * Looks up a view by its model `_id` property\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.View}\n   */\n  findViewByModelId(id) {\n    const model = this.findById(id);\n    if (!model || !Adapt.parentView) return;\n    const idPathToView = [id];\n    const currentLocationId = location._currentId;\n    const currentLocationModel = model.getAncestorModels().find(model => {\n      const modelId = model.get('_id');\n      if (modelId === currentLocationId) return true;\n      idPathToView.unshift(modelId);\n      return false;\n    });\n\n    if (!currentLocationModel) {\n      return console.warn(`data.findViewByModelId() unable to find view for model id: ${id}`);\n    }\n\n    const foundView = idPathToView.reduce((view, currentId) => {\n      if (!view) return null;\n      const childViews = view.getChildViews();\n      return childViews?.find(view => view.model.get('_id') === currentId);\n    }, Adapt.parentView);\n\n    return foundView;\n  }\n\n  /**\n   * Returns the model represented by the trackingPosition.\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\n   * @returns {Backbone.Model}\n   */\n  findByTrackingPosition(trackingPosition) {\n    const [ trackingId, indexInTrackingIdDescendants ] = trackingPosition;\n    const trackingIdModel = this.find(model => model.get('_trackingId') === trackingId);\n    if (!trackingIdModel) {\n      console.warn(`data.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);\n      return;\n    }\n    if (indexInTrackingIdDescendants >= 0) {\n      // Model is either the trackingId model or a descendant\n      let trackingIdDescendants = [trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));\n      trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\n      return trackingIdDescendants[indexInTrackingIdDescendants];\n    }\n    // Model is an ancestor of the trackingId model\n    const trackingIdAncestors = trackingIdModel.getAncestorModels();\n    const ancestorDistance = Math.abs(indexInTrackingIdDescendants) - 1;\n    return trackingIdAncestors[ancestorDistance];\n  }\n\n  logReadyError(view) {\n    const notReadyDescendants = view.model.getAllDescendantModels(true).filter(model => !model.get('_isReady'));\n    logging.error(`View ${notReadyDescendants.map(model => `${model.get('_id')} (${model.get('_component') ?? model.get('_type')})`).join(', ')} failed to become ready, forcing ready status.`);\n    notReadyDescendants.reverse().forEach(model => model.set('_isReady', true));\n  }\n\n  checkData() {\n    this.checkIds();\n    this.checkTrackingIds();\n  }\n\n  checkIds() {\n    const items = this.toJSON();\n    // Index and group\n    const idIndex = _.indexBy(items, '_id');\n    const idGroups = _.groupBy(items, '_id');\n    const parentIdGroups = _.groupBy(items, '_parentId');\n    // Setup error collection arrays\n    let orphanedIds = {};\n    let emptyIds = {};\n    let duplicateIds = {};\n    let missingIds = {};\n    items.forEach((o) => {\n      const isCourseType = (o._type === 'course');\n      const isComponentType = (o._type === 'component');\n      if (idGroups[o._id].length > 1) {\n        duplicateIds[o._id] = true; // Id has more than one item\n      }\n      if (!isComponentType && !parentIdGroups[o._id]) {\n        emptyIds[o._id] = true; // Course has no children\n      }\n      if (!isCourseType && (!o._parentId || !idIndex[o._parentId])) {\n        orphanedIds[o._id] = true; // Item has no defined parent id or the parent id doesn't exist\n      }\n      if (!isCourseType && o._parentId && !idIndex[o._parentId]) {\n        missingIds[o._parentId] = true; // Referenced parent item does not exist\n      }\n    });\n    orphanedIds = Object.keys(orphanedIds);\n    emptyIds = Object.keys(emptyIds);\n    duplicateIds = Object.keys(duplicateIds);\n    missingIds = Object.keys(missingIds);\n    // Output for each type of error\n    const hasErrored = orphanedIds.length || emptyIds.length || duplicateIds.length || missingIds.length;\n    if (orphanedIds.length) {\n      logging.error(`Orphaned _ids: ${orphanedIds.join(', ')}`);\n    }\n    if (missingIds.length) {\n      logging.error(`Missing _ids: ${missingIds.join(', ')}`);\n    }\n    if (emptyIds.length) {\n      logging.error(`Empty _ids: ${emptyIds.join(', ')}`);\n    }\n    if (duplicateIds.length) {\n      logging.error(`Duplicate _ids: ${duplicateIds.join(', ')}`);\n    }\n    // If any error has occured, stop processing.\n    if (hasErrored) {\n      const err = new Error('Oops, looks like you have some json errors.');\n      err.number = 10011;\n      throw err;\n    }\n  }\n\n  checkTrackingIds() {\n    const items = this.toJSON();\n    const trackingIdType = Adapt.build.get('trackingIdType') || 'block';\n    const trackingIdCounts = _.groupBy(items.filter(item => item._type === trackingIdType), '_trackingId');\n    const missingTrackingIds = items.filter(item => item._type === trackingIdType && item._trackingId === undefined).map(item => item._id);\n    if (missingTrackingIds.length) {\n      logging.error(`Missing _trackingIds: ${missingTrackingIds.join(', ')}`);\n    }\n    const duplicateTrackingIds = Object.entries(trackingIdCounts)\n      .filter(([id, group]) => group.length > 1)\n      .map(([id, group]) => `${id}:[${group.map(item => item._id).join(', ')}]`);\n    if (duplicateTrackingIds.length) {\n      logging.error(`Duplicate _trackingIds: ${duplicateTrackingIds.join(', ')}`);\n    }\n    const hasErrored = missingTrackingIds.length || duplicateTrackingIds.length;\n    // If any error has occured, stop processing.\n    if (hasErrored) {\n      const err = new Error('Oops, looks like you have some json errors with trackingIds.');\n      err.number = 10011;\n      throw err;\n    }\n  }\n\n}\n\nconst data = new Data();\nexport default data;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport device from 'core/js/device';\nimport location from 'core/js/location';\nimport BrowserFocus from 'core/js/a11y/browserFocus';\nimport FocusOptions from 'core/js/a11y/focusOptions';\nimport KeyboardFocusOutline from 'core/js/a11y/keyboardFocusOutline';\nimport Log from 'core/js/a11y/log';\nimport Scroll from 'core/js/a11y/scroll';\nimport WrapFocus from 'core/js/a11y/wrapFocus';\nimport Popup from 'core/js/a11y/popup';\nimport defaultAriaLevels from 'core/js/enums/defaultAriaLevels';\nimport deprecated from 'core/js/a11y/deprecated';\nimport logging from 'core/js/logging';\nimport data from './data';\n\nclass A11y extends Backbone.Controller {\n\n  defaults() {\n    return {\n      _isFocusOutlineKeyboardOnlyEnabled: true,\n      /**\n       * `_isFocusOutlineDisabled` ignores `_isEnabled` and can be used when all other\n       * accessibility features have been disabled.\n       */\n      _isFocusOutlineDisabled: false,\n      _isFocusAssignmentEnabled: true,\n      _isFocusOnClickEnabled: true,\n      _isFocusNextOnDisabled: true,\n      _isScrollDisableEnabled: true,\n      _isAriaHiddenManagementEnabled: true,\n      _isPopupManagementEnabled: true,\n      _isPopupWrapFocusEnabled: true,\n      _isPopupAriaHiddenManagementEnabled: true,\n      _isPopupTabIndexManagementEnabled: true,\n      /**\n       * Do not change aria-hidden on these elements.\n       */\n      _ariaHiddenExcludes: ':not(#wrapper):not(body)',\n      _tabbableElements: 'a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])',\n      _focusOutlineKeyboardOnlyIgnore: 'input,textarea',\n      /**\n       * Designate these elements as not tabbable.\n       */\n      _tabbableElementsExcludes: ':not(.a11y-ignore):not([data-a11y-force-focus])',\n      _focusableElements: 'a,button,input,select,textarea,[tabindex],label',\n      _readableElements: '[role=heading],[aria-label],[aria-labelledby],[alt]',\n      /**\n       * Prevent adapt from focusing forward onto these elements.\n       */\n      _focusForwardElementsExcludes: ':not([aria-labelledby][role=dialog],[aria-labelledby][role=main],[aria-labelledby][role=region],[aria-labelledby][role=radiogroup],[aria-labelledby][role=group],[aria-labelledby][role=tablist],[aria-labelledby][role=list],[aria-labelledby][role=tree],[aria-labelledby][role=treegrid],[aria-labelledby][role=table],[aria-labelledby][role=grid][aria-labelledby],[role=menu],[aria-labelledby][role=rowgroup])',\n      /**\n       * Selector for elements which cause tab wrapping.\n       */\n      _focusguard: '.a11y-focusguard',\n      /**\n       * Specifies all stylistic elements.\n       */\n      _wrapStyleElements: 'b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb',\n\n      /**\n       * Logging settings\n       */\n      _warnFirstOnly: true,\n      _warn: true\n    };\n  }\n\n  initialize() {\n    this.isFocusable = this.isFocusable.bind(this);\n    this.isReadable = this.isReadable.bind(this);\n    this.isTabbable = this.isTabbable.bind(this);\n    this.$html = $('html');\n    this._htmlCharRegex = /&.*;/g;\n    /** @type {Object} */\n    this.config = null;\n    this._browserFocus = new BrowserFocus({ a11y: this });\n    this._keyboardFocusOutline = new KeyboardFocusOutline({ a11y: this });\n    this._wrapFocus = new WrapFocus({ a11y: this });\n    this._popup = new Popup({ a11y: this });\n    this._scroll = new Scroll({ a11y: this });\n    this.log = new Log({ a11y: this });\n    deprecated(this);\n\n    this._removeLegacyElements();\n    this.listenToOnce(Adapt, {\n      'configModel:dataLoaded': this._onConfigDataLoaded,\n      'navigationView:postRender': this._removeLegacyElements\n    }, this);\n    Adapt.on('device:changed', this._setupNoSelect);\n    this.listenTo(Adapt, {\n      'router:location': this._onNavigationStart,\n      'contentObjectView:ready router:plugin': this._onNavigationEnd\n    });\n  }\n\n  _onConfigDataLoaded() {\n    this.config = Adapt.config.get('_accessibility');\n    this.config._isActive = false;\n    this.config._options = _.defaults(this.config._options || {}, this.defaults());\n    offlineStorage.set('a11y', false);\n    this.$html.toggleClass('has-accessibility', this.isEnabled());\n    this._setupNoSelect();\n    this._addFocuserDiv();\n    if (this._isReady) {\n      return;\n    }\n    this._isReady = true;\n    Adapt.trigger('accessibility:ready');\n  }\n\n  _setupNoSelect() {\n    if (!this.config?._disableTextSelectOnClasses) {\n      return;\n    }\n    const classes = this.config._disableTextSelectOnClasses.split(' ');\n    const isMatch = classes.some(className => this.$html.is(className));\n    this.$html.toggleClass('u-no-select', isMatch);\n  }\n\n  _addFocuserDiv() {\n    if ($('#a11y-focuser').length) {\n      return;\n    }\n    $('body').append($('<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>'));\n  }\n\n  _removeLegacyElements() {\n    const $legacyElements = $('body').children('#accessibility-toggle, #accessibility-instructions');\n    const $navigationElements = $('.nav').find('#accessibility-toggle, #accessibility-instructions');\n    if (!$legacyElements.length && !$navigationElements.length) {\n      return;\n    }\n    logging.warn('REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.');\n    $legacyElements.remove();\n    $navigationElements.remove();\n  }\n\n  _onNavigationStart() {\n    if (!this.isEnabled()) {\n      return;\n    }\n    // Stop document reading\n    _.defer(() => this.toggleHidden('.contentobject', true));\n  }\n\n  _onNavigationEnd(view) {\n    // Prevent sub-menu items provoking behaviour\n    if ((view?.model?.get('_id') !== location._currentId) || !this.isEnabled()) {\n      return;\n    }\n    // Allow document to be read\n    this.toggleHidden('.contentobject', false);\n  }\n\n  isActive() {\n    this.log.removed('Accessibility is now always active when enabled. Please unify your user experiences.');\n    return false;\n  }\n\n  isEnabled() {\n    return this.config?._isEnabled;\n  }\n\n  /**\n   * Calculate the aria level for a heading\n   * @param {object} [options]\n   * @param {string|number} [options.id] Used to automate the heading level when relative increments are used\n   * @param {string|number} [options.level] Specify a default level, \"component\" / \"menu\" / \"componentItem\" etc\n   * @param {string|number} [options.override] Override with a default level, an absolute value or a relative increment\n   * @returns {number}\n   * @notes\n   * Default levels come from config.json:_accessibility._ariaLevels attribute names, they are:\n   *  \"menu\", \"menuGroup\", \"menuItem\", \"page\", \"article\", \"block\", \"component\", \"componentItem\" and \"notify\"\n   * An absolute value would be \"1\" or \"2\" etc.\n   * A relative increment would be \"@page+1\" or \"@block+1\". They are calculated from ancestor values,\n   * respecting both _ariaLevel overrides and not incrementing for missing displayTitle values.\n   */\n  ariaLevel({\n    id = null,\n    level = '1',\n    override = null\n  } = {}) {\n    if (arguments.length === 2) {\n      // backward compatibility\n      level = arguments[0];\n      override = arguments[1];\n      id = null;\n    }\n    // get the global configuration from config.json\n    const ariaLevels = Adapt.config.get('_accessibility')?._ariaLevels ?? defaultAriaLevels;\n    /**\n     * Recursive function to calculate aria-level\n     * @param {string} id Model id\n     * @param {string} level Default name, relative increment or absolute level\n     * @param {number} [offset=0] Total offset count from first absolute value\n     * @returns\n     */\n    function calculateLevel(id = null, level, offset = 0) {\n      const isNumber = !isNaN(level);\n      const isTypeName = /[a-zA-z]/.test(level);\n      if (!isTypeName && isNumber) {\n        // if an absolute value is found, use it, adding the accumulated offset\n        return parseInt(level) + offset;\n      }\n      // parse the level value as a relative string\n      const relativeDescriptor = Adapt.parseRelativeString(level);\n      // lookup the default value from `config.json:_accessibility._ariaLevels`\n      const nextLevel = ariaLevels?.['_' + relativeDescriptor.type];\n      const hasModelId = Boolean(id);\n      if (!hasModelId) {\n        logging.warnOnce('Cannot calculate appropriate heading level, no model id was specified');\n        return calculateLevel(id, nextLevel, offset + relativeDescriptor.offset);\n      }\n      // try to find the next relevant ancestor, or use the specified model\n      const nextModel = data.findById(id)?.findAncestor(relativeDescriptor.type?.toLowerCase()) ?? data.findById(id);\n      const nextModelId = nextModel?.get('_id') ?? id;\n      // check overrides, check title existence, adjust offset accordingly\n      const hasNextTitle = Boolean(nextModel.get('displayTitle'));\n      const nextModelOverride = nextModel.get('_ariaLevel');\n      const accumulatedOffset = offset + (hasNextTitle ? relativeDescriptor.offset : 0);\n      const resolvedLevel = nextModelOverride ?? nextLevel;\n      // move towards the parents until an absolute value is found\n      return calculateLevel(nextModelId, resolvedLevel, accumulatedOffset);\n    }\n    return calculateLevel(id, override ?? level);\n  }\n\n  /**\n   * Adds or removes `aria-hidden` attribute to elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isHidden=true]\n   * @returns {Object} Chainable\n   */\n  toggleHidden($elements, isHidden = true) {\n    $elements = $($elements);\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled) {\n      return this;\n    }\n    if (isHidden === true) {\n      $elements.attr('aria-hidden', true);\n    } else {\n      $elements.removeAttr('aria-hidden');\n    }\n    return this;\n  }\n\n  /**\n   * Adds or removes `aria-hidden` and `disabled` attributes and `disabled`\n   * classes to elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isHidden=true]\n   * @returns {Object} Chainable\n   */\n  toggleAccessibleEnabled($elements, isAccessibleEnabled) {\n    this.toggleAccessible($elements, isAccessibleEnabled);\n    this.toggleEnabled($elements, isAccessibleEnabled);\n    return this;\n  }\n\n  /**\n   * Adds or removes `aria-hidden` attribute and disables `tabindex` on elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isReadable=true]\n   * @returns {Object} Chainable\n   */\n  toggleAccessible($elements, isReadable = true) {\n    $elements = $($elements);\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled || $elements.length === 0) {\n      return this;\n    }\n    if (!isReadable) {\n      $elements.attr({\n        tabindex: '-1',\n        'aria-hidden': 'true'\n      }).addClass('aria-hidden');\n    } else {\n      $elements.removeAttr('aria-hidden tabindex').removeClass('aria-hidden');\n      $elements.parents(config._options._ariaHiddenExcludes).removeAttr('aria-hidden').removeClass('aria-hidden');\n    }\n    return this;\n  }\n\n  /**\n   * Adds or removes `disabled` attribute and `disabled` class.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isEnabled=true]\n   * @returns {Object} Chainable\n   */\n  toggleEnabled($elements, isEnabled = true) {\n    $elements = $($elements);\n    if ($elements.length === 0) {\n      return this;\n    }\n    if (!isEnabled) {\n      $elements.attr({\n        'aria-disabled': 'true'\n      }).addClass('is-disabled');\n    } else {\n      $elements.removeAttr('aria-disabled').removeClass('is-disabled');\n    }\n    return this;\n  }\n\n  /**\n   * Toggles tabindexes off and on all tabbable descendants.\n   * @param {Object|string|Array} $element\n   * @param {boolean} isTabbable\n   * @returns {Object} Chainable\n   */\n  toggleTabbableDescendants($element, isTabbable = true) {\n    const $tabbable = this.findTabbable($element);\n    if (!isTabbable) {\n      $tabbable.each((index, element) => {\n        if (element.isAdaptTabHidden) return;\n        const $element = $(element);\n        element.isAdaptTabHidden = true;\n        element.adaptPreviousTabIndex = $element.attr('tabindex') ?? null;\n        $element.attr('tabindex', -1);\n      });\n      return this;\n    }\n    $tabbable.each((index, element) => {\n      if (!element.isAdaptTabHidden) return;\n      const $element = $(element);\n      if (element.adaptPreviousTabIndex === null) $element.removeAttr('tabindex');\n      else $element.attr('tabindex', element.adaptPreviousTabIndex);\n      delete element.isAdaptTabHidden;\n      delete element.adaptPreviousTabIndex;\n    });\n    return this;\n  }\n\n  /**\n   * Find the first tabbable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstTabbable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isTabbable);\n  }\n\n  /**\n   * Find the first readable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstReadable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isReadable);\n  }\n\n  /**\n   * Find the first focusable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstFocusable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isFocusable);\n  }\n\n  /**\n   * Find all tabbable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findTabbable($element) {\n    const config = this.config;\n    return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n  }\n\n  /**\n   * Find all readable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   */\n  findReadable($element) {\n    return $($element).find('*').filter((index, element) => this.isReadable(element));\n  }\n\n  /**\n   * Find all focusable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   */\n  findFocusable($element) {\n    return $($element).find('*').filter((index, element) => this.isFocusable(element));\n  }\n\n  /**\n   * Check if the element is natively or explicitly tabbable.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {boolean|undefined}\n   */\n  isTabbable($element) {\n    const config = this.config;\n    const value = $($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);\n    if (!value) {\n      return null; // Allow _findForward to descend\n    }\n    return value;\n  }\n\n  /**\n   * Check if the first item is readable by a screen reader.\n   *\n   * @param {Object|string|Array} $element\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\n   * @returns {boolean}\n   */\n  isReadable($element, checkParents = true) {\n    const config = this.config;\n    $element = $($element).first();\n\n    const $branch = checkParents\n      ? $element.add($element.parents())\n      : $element;\n\n    const isNotVisible = $branch.toArray().some(item => {\n      const $item = $(item);\n      // make sure item is not explicitly invisible\n      return $item.css('display') === 'none' ||\n        $item.css('visibility') === 'hidden' ||\n        $item.attr('aria-hidden') === 'true';\n    });\n    if (isNotVisible) {\n      return false;\n    }\n\n    // check that the component is natively tabbable or\n    // will be knowingly read by a screen reader\n    const hasReadableContent = (!/^\\s*$/.test($element.text()) ||\n      !/^\\s*$/.test($element.attr('aria-label') ?? '') ||\n      !/^\\s*$/.test($element.attr('aria-labelledby') ?? ''));\n    const hasNativeFocusOrIsScreenReadable = ($element.is(config._options._focusableElements) ||\n      $element.is(config._options._readableElements)) && hasReadableContent;\n    if (hasNativeFocusOrIsScreenReadable) {\n      return true;\n    }\n    const childNodes = $element[0].childNodes;\n    for (let c = 0, cl = childNodes.length; c < cl; c++) {\n      const childNode = childNodes[c];\n      const isTextNode = (childNode.nodeType === 3);\n      if (!isTextNode) {\n        continue;\n      }\n      const isOnlyWhiteSpace = /^\\s*$/.test(childNode.nodeValue);\n      if (isOnlyWhiteSpace) {\n        continue;\n      }\n      return true;\n    }\n    return null; // Allows _findForward to decend.\n  }\n\n  /**\n   * Check if the first item is readable by a screen reader.\n   *\n   * @param {Object|string|Array} $element\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\n   * @returns {boolean}\n   */\n  isFocusable($element, checkParents = true) {\n    const config = this.config;\n    $element = $($element).first();\n    if (!$element.is(config._options._focusForwardElementsExcludes)) return null;\n    return this.isReadable($element, checkParents);\n  }\n\n  /**\n   * Find forward in the DOM, descending and ascending to move forward\n   * as appropriate.\n   *\n   * If the selector is a function it should returns true, false or undefined.\n   * Returning true matches the item and returns it. Returning false means do\n   * not match or descend into this item, returning undefined means do not match,\n   * but descend into this item.\n   *\n   * @param {Object|string|Array} $element\n   * @param {string|function|undefined} selector\n   * @returns {Object} Returns found descendant.\n   */\n  _findFirstForward($element, selector) {\n    $element = $($element).first();\n\n    // make sure iterator is correct, use boolean or selector comparison\n    // appropriately\n    let iterator;\n    switch (typeof selector) {\n      case 'string':\n        // make selector iterator\n        iterator = function($tag) {\n          return $tag.is(selector) || undefined;\n        };\n        break;\n      case 'function':\n        iterator = selector;\n        break;\n      case 'undefined':\n        // find first next element\n        iterator = Boolean;\n    }\n\n    if ($element.length === 0) {\n      return $element.not('*');\n    }\n\n    // check children by walking the tree\n    let $found = this._findFirstForwardDescendant($element, iterator);\n    if ($found.length) {\n      return $found;\n    }\n\n    // check subsequent siblings\n    $element.nextAll().toArray().some(sibling => {\n      const $sibling = $(sibling);\n      const value = iterator($sibling);\n\n      // skip this sibling if explicitly instructed\n      if (value === false) {\n        return false;\n      }\n\n      if (value) {\n        // sibling matched\n        $found = $sibling;\n        return true;\n      }\n\n      // check parent sibling children by walking the tree\n      $found = this._findFirstForwardDescendant($sibling, iterator);\n      return Boolean($found.length);\n    });\n    if ($found.length) {\n      return $found;\n    }\n\n    // move through parents towards the body element\n    $element.add($element.parents()).toArray().reverse().some(parent => {\n      const $parent = $(parent);\n      if (iterator($parent) === false) {\n        // skip this parent if explicitly instructed\n        return false;\n      }\n\n      // move through parents nextAll siblings\n      return $parent.nextAll().toArray().some(sibling => {\n        const $sibling = $(sibling);\n        const value = iterator($sibling);\n\n        // skip this sibling if explicitly instructed\n        if (value === false) {\n          return false;\n        }\n\n        if (value) {\n          // sibling matched\n          $found = $sibling;\n          return true;\n        }\n\n        // check parent sibling children by walking the tree\n        $found = this._findFirstForwardDescendant($sibling, iterator);\n        return Boolean($found.length);\n      });\n    });\n\n    if (!$found.length) {\n      return $element.not('*');\n    }\n    return $found;\n  }\n\n  /**\n   * Find descendant in a DOM tree, work from selected to branch-end, through allowed\n   * branch structures in hierarchy order\n   *\n   * If the selector is a function it should returns true, false or undefined.\n   * Returning true matches the item and returns it. Returning false means do\n   * not match or descend into this item, returning undefined means do not match,\n   * but descend into this item.\n   *\n   * @param {Object|string|Array} $element jQuery element to start from.\n   * @param {string|function|undefined} selector\n   * @returns {Object} Returns found descendant.\n   */\n  _findFirstForwardDescendant($element, selector) {\n    $element = $($element).first();\n\n    // make sure iterator is correct, use boolean or selector comparison\n    // appropriately\n    let iterator;\n    switch (typeof selector) {\n      case 'string':\n        // make selector iterator\n        iterator = function($tag) {\n          return $tag.is(selector) || undefined;\n        };\n        break;\n      case 'function':\n        iterator = selector;\n        break;\n      case 'undefined':\n        // find first next element\n        iterator = Boolean;\n    }\n\n    const $notFound = $element.not('*');\n    if ($element.length === 0) {\n      return $notFound;\n    }\n\n    // keep walked+passed children in a stack\n    const stack = [{\n      item: $element[0],\n      value: undefined\n    }];\n    let stackIndexPosition = 0;\n    let childIndexPosition = stackIndexPosition + 1;\n    do {\n\n      const stackEntry = stack[stackIndexPosition];\n      const $stackItem = $(stackEntry.item);\n\n      // check current item\n      switch (stackEntry.value) {\n        case true:\n          return $stackItem;\n        case false:\n          return $notFound;\n      }\n\n      // get i stack children\n      $stackItem.children().toArray().forEach(item => {\n        const $item = $(item);\n        const value = iterator($item);\n\n        // item explicitly not allowed, don't add to stack,\n        // skip children\n        if (value === false) {\n          return;\n        }\n\n        // item passed or readable, add to stack before any parent\n        // siblings\n        stack.splice(childIndexPosition++, 0, {\n          item,\n          value\n        });\n      });\n\n      // move to next stack item\n      stackIndexPosition++;\n      // keep place to inject children\n      childIndexPosition = stackIndexPosition + 1;\n    } while (stackIndexPosition < stack.length);\n\n    return $notFound;\n  }\n\n  /**\n   * Assign focus to the next readable element.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object} Chainable\n   */\n  focusNext($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    $element = this.findFirstFocusable($element);\n    this.focus($element, options);\n    return this;\n  }\n\n  /**\n   * Assign focus to either the specified element if it is readable or the\n   * next readable element.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object}\n   */\n  focusFirst($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    if (this.isReadable($element)) {\n      this.focus($element, options);\n      return $element;\n    }\n    $element = this.findFirstFocusable($element);\n    this.focus($element, options);\n    return $element;\n  }\n\n  /**\n   * Force focus to the specified element with/without a defer or scroll.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object} Chainable\n   */\n  focus($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isFocusAssignmentEnabled || $element.length === 0) {\n      return this;\n    }\n    function perform() {\n      if ($element.attr('tabindex') === undefined) {\n        $element.attr({\n          // JAWS reads better with 0, do not use -1\n          tabindex: '0',\n          'data-a11y-force-focus': 'true'\n        });\n      }\n      if (options.preventScroll) {\n        const y = $(window).scrollTop();\n        try {\n          $element[0].focus({\n            preventScroll: true\n          });\n        } catch (e) {\n          // Drop focus errors as only happens when the element\n          // isn't attached to the DOM.\n        }\n        switch (device.browser) {\n          case 'internet explorer':\n          case 'microsoft edge':\n          case 'safari':\n            // return to previous scroll position due to no support for preventScroll\n            window.scrollTo(null, y);\n        }\n      } else {\n        $element[0].focus();\n      }\n    }\n    if (options.defer) {\n      _.defer(perform);\n    } else {\n      perform();\n    }\n    return this;\n  }\n\n  /**\n   * Used to convert html to text aria-labels.\n   *\n   * @param {string} htmls Any html strings.\n   * @returns {string} Returns text without markup or html encoded characters.\n   */\n  normalize(htmls) {\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\n    const text = $('<div>' + htmls + '</div>').text();\n    // Remove all html encoded characters, such as &apos;\n    return text.replace(this._htmlCharRegex, '');\n  }\n\n  /**\n   * Removes all html tags except stylistic elements.\n   * Useful for producing uninterrupted text for screen readers from\n   * any html.\n   *\n   * @param  {string} htmls Any html strings.\n   * @return {string} Returns html string without markup which would cause screen reader to pause.\n   */\n  removeBreaks(htmls) {\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\n    const $div = $('<div>' + htmls + '</div>');\n    const stack = [ $div[0] ];\n    let stackIndex = 0;\n    const outputs = [];\n    do {\n      if (stack[stackIndex].childNodes.length) {\n        const nodes = stack[stackIndex].childNodes;\n        const usable = nodes.filter(node => {\n          const isTextNode = (node.nodeType === 3);\n          if (isTextNode) {\n            return true;\n          }\n          const isStyleElement = $(node).is(this.config._options._wrapStyleElements);\n          if (isStyleElement) {\n            return true;\n          }\n          return false;\n        });\n        outputs.push.apply(outputs, usable);\n        stack.push.apply(stack, nodes);\n      }\n      stackIndex++;\n    } while (stackIndex < stack.length);\n    let rtnText = '';\n    outputs.forEach(function(item) {\n      rtnText += item.outerHTML || item.textContent;\n    });\n    return rtnText;\n  }\n\n  /**\n   * @param {Object|string|Array} $elements\n   * @returns {Object} Chainable\n   */\n  scrollEnable($elements) {\n    this._scroll.enable($elements);\n    return this;\n  }\n\n  /**\n   * @param {Object|string|Array} $elements\n   * @returns {Object} Chainable\n   */\n  scrollDisable($elements) {\n    this._scroll.disable($elements);\n    return this;\n  }\n\n  /**\n   * To apply accessibilty handling to a tag, isolating the user.\n   *\n   * @param {Object} $popupElement Element encapsulating the popup.\n   * @returns {Object} Chainable\n   */\n  popupOpened($popupElement) {\n    this._popup.opened($popupElement);\n    return this;\n  }\n\n  /**\n   * Remove the isolation applied with a call to `popupOpened`.\n   *\n   * @param {Object} [$focusElement] Element to move focus to.\n   * @returns {Object} Chainable\n   */\n  popupClosed($focusElement) {\n    this._popup.closed($focusElement);\n    return this;\n  }\n\n  /**\n   * When a popup is open, this function makes it possible to swap the element\n   * that should receive focus on popup close.\n   *\n   * @param {Object} $focusElement Set a new element to focus on.\n   * @returns {Object} Returns previously set focus element.\n   */\n  setPopupCloseTo($focusElement) {\n    return this._popup.setCloseTo($focusElement);\n  }\n\n}\n\nconst a11y = new A11y();\nexport default a11y;\n","import Adapt from 'core/js/adapt';\n\nclass DrawerItemView extends Backbone.View {\n\n  className() {\n    return 'drawer__menu drawer__item';\n  }\n\n  attributes() {\n    return {\n      role: 'listitem'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, 'drawer:empty', this.remove);\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .drawer__item-btn': 'onDrawerItemClicked'\n    };\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates['drawerItem'];\n    $(this.el).html(template(data)).appendTo('.drawer__holder');\n    return this;\n  }\n\n  onDrawerItemClicked(event) {\n    event.preventDefault();\n    const eventCallback = this.model.get('eventCallback');\n    Adapt.trigger(eventCallback);\n  }\n\n}\n\nDrawerItemView.type = 'drawerItem';\n\nexport default DrawerItemView;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport DrawerItemView from 'core/js/views/drawerItemView';\n\nclass DrawerView extends Backbone.View {\n\n  className() {\n    return 'drawer u-display-none';\n  }\n\n  attributes() {\n    return {\n      role: 'dialog',\n      'aria-modal': 'true',\n      'aria-labelledby': 'drawer-heading',\n      'aria-hidden': 'true'\n    };\n  }\n\n  initialize() {\n    this._isVisible = false;\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    this.drawerDir = Adapt.config.get('_defaultDirection') === 'rtl' ? 'left' : 'right';\n    this.drawerDuration = Adapt.config.get('_drawer')?._duration ?? 400;\n    this.setupEventListeners();\n    this.render();\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      'navigation:toggleDrawer': this.toggleDrawer,\n      'drawer:triggerCustomView': this.openCustomView,\n      'drawer:closeDrawer': this.onCloseDrawer,\n      remove: this.onRemove,\n      'drawer:remove': this.remove\n    });\n\n    this.onKeyUp = this.onKeyUp.bind(this);\n    this.setupEscapeKey();\n  }\n\n  setupEscapeKey() {\n    $(window).on('keyup', this.onKeyUp);\n  }\n\n  onKeyUp(event) {\n    if (event.which !== 27) return;\n    event.preventDefault();\n\n    this.onCloseDrawer();\n  }\n\n  events() {\n    return {\n      'click .drawer__back': 'onBackButtonClicked',\n      'click .drawer__close': 'onCloseClicked'\n    };\n  }\n\n  render() {\n    const template = Handlebars.templates.drawer;\n    $(this.el).html(template({ _globals: Adapt.course.get('_globals') })).prependTo('body');\n    const shadowTemplate = Handlebars.templates.shadow;\n    $(shadowTemplate()).prependTo('body');\n    _.defer(this.postRender.bind(this));\n    return this;\n  }\n\n  postRender() {\n    this.$('a, button, input, select, textarea').attr('tabindex', -1);\n\n    this.checkIfDrawerIsAvailable();\n  }\n\n  openCustomView(view, hasBackButton) {\n    this.$('.js-drawer-holder').removeAttr('role');\n    this._hasBackButton = hasBackButton;\n    this._isCustomViewVisible = true;\n    Adapt.trigger('drawer:empty');\n    this.showDrawer();\n    this.$('.drawer__holder').html(view);\n  }\n\n  checkIfDrawerIsAvailable() {\n    const isEmptyDrawer = (this.collection.length === 0);\n    $('.js-nav-drawer-btn').toggleClass('u-display-none', isEmptyDrawer);\n    if (isEmptyDrawer) {\n      Adapt.trigger('drawer:noItems');\n    }\n  }\n\n  onBackButtonClicked(event) {\n    event.preventDefault();\n    this.showDrawer(true);\n  }\n\n  onCloseClicked(event) {\n    event.preventDefault();\n    this.hideDrawer();\n  }\n\n  onCloseDrawer($toElement) {\n    this.hideDrawer($toElement);\n  }\n\n  onRemove() {\n    this.hideDrawer();\n  }\n\n  toggleDrawer() {\n    if (this._isVisible && this._isCustomViewVisible === false) {\n      this.hideDrawer();\n      return;\n    }\n    this.showDrawer(true);\n  }\n\n  showDrawer(emptyDrawer) {\n    this.$el.removeClass('u-display-none').removeAttr('aria-hidden');\n    // Only trigger popup:opened if drawer is visible, pass popup manager drawer element\n    if (!this._isVisible) {\n      a11y.popupOpened(this.$el);\n      a11y.scrollDisable('body');\n      this._isVisible = true;\n    }\n\n    // Sets tab index to 0 for all tabbable elements in Drawer\n    this.$('a, button, input, select, textarea').attr('tabindex', 0);\n\n    if (emptyDrawer) {\n      this.$('.drawer__back').addClass('u-display-none');\n      this._isCustomViewVisible = false;\n      this.emptyDrawer();\n      if (this.collection.models.length === 1) {\n        // This callback triggers openCustomView() and sets\n        // _isCustomViewVisible to true, causing toggleDrawer()\n        // to re-render the drawer on every toggle button press\n        Adapt.trigger(this.collection.models[0].get('eventCallback'));\n        // Set _isCustomViewVisible to false to prevent re-rendering\n        // the drawer and fix the toggle functionality on toggle button press\n        this._isCustomViewVisible = false;\n      } else {\n        this.renderItems();\n        Adapt.trigger('drawer:openedItemView');\n      }\n    } else {\n      const hideDrawerBackButton = (!this._hasBackButton || this.collection.models.length <= 1);\n      this.$('.drawer__back').toggleClass('u-display-none', hideDrawerBackButton);\n      Adapt.trigger('drawer:openedCustomView');\n    }\n\n    const complete = () => {\n      this.addShadowEvent();\n      $('.js-nav-drawer-btn').attr('aria-expanded', true);\n      Adapt.trigger('drawer:opened');\n\n      // focus on first tabbable element in drawer\n      a11y.focusFirst(this.$el, { defer: true });\n    };\n\n    // delay drawer animation until after background fadeout animation is complete\n    const direction = {};\n    if (this.disableAnimation) {\n      $('.js-shadow').removeClass('u-display-none');\n      $('.js-drawer-holder').scrollTop(0);\n\n      direction[this.drawerDir] = 0;\n      this.$el.css(direction);\n      complete();\n    } else {\n      $('.js-shadow').velocity({ opacity: 1 }, {\n        duration: this.drawerDuration,\n        begin: () => {\n          $('.js-shadow').removeClass('u-display-none');\n          $('.js-drawer-holder').scrollTop(0);\n          complete();\n        }\n      });\n\n      const easing = Adapt.config.get('_drawer')?._showEasing || 'easeOutQuart';\n      direction[this.drawerDir] = 0;\n      this.$el.velocity(direction, this.drawerDuration, easing);\n    }\n\n  }\n\n  emptyDrawer() {\n    this.$('.drawer__holder').empty();\n  }\n\n  renderItems() {\n    Adapt.trigger('drawer:empty');\n    this.emptyDrawer();\n    const isList = (this.collection.length > 1);\n    if (isList) this.$('.js-drawer-holder').attr('role', 'list');\n    else this.$('.js-drawer-holder').removeAttr('role');\n    this.collection.forEach(model => new DrawerItemView({ model }));\n  }\n\n  hideDrawer($toElement) {\n    if (!this._isVisible) return;\n\n    const direction = {};\n    a11y.popupClosed($toElement);\n    this._isVisible = false;\n    a11y.scrollEnable('body');\n\n    if (this.disableAnimation) {\n\n      direction[this.drawerDir] = -this.$el.width();\n      this.$el\n        .css(direction)\n        .addClass('u-display-none')\n        .attr('aria-hidden', 'true');\n\n      $('.js-shadow').addClass('u-display-none');\n      this.$('.js-drawer-holder').removeAttr('role');\n      Adapt.trigger('drawer:closed');\n      $('.js-nav-drawer-btn').attr('aria-expanded', false);\n\n    } else {\n      const easing = Adapt.config.get('_drawer')?._hideEasing || 'easeInQuart';\n\n      direction[this.drawerDir] = -this.$el.width();\n      this.$el.velocity(direction, this.drawerDuration, easing, () => {\n        this.$el\n          .addClass('u-display-none')\n          .attr('aria-hidden', 'true');\n        this.$('.js-drawer-holder').removeAttr('role');\n        $('.js-nav-drawer-btn').attr('aria-expanded', false);\n        Adapt.trigger('drawer:closed');\n      });\n\n      $('.js-shadow').velocity({ opacity: 0 }, {\n        duration: this.drawerDuration,\n        complete() {\n          $('.js-shadow').addClass('u-display-none');\n        }\n      });\n\n    }\n\n    this._isCustomViewVisible = false;\n    this.removeShadowEvent();\n\n  }\n\n  addShadowEvent() {\n    $('.js-shadow').one('click touchstart', () => this.onCloseDrawer());\n  }\n\n  removeShadowEvent() {\n    $('.js-shadow').off('click touchstart');\n  }\n\n  remove() {\n    super.remove();\n    $(window).off('keyup', this.onKeyUp);\n\n    Adapt.trigger('drawer:empty');\n    this.collection.reset();\n    $('.js-shadow').remove();\n  }\n\n}\n\nObject.assign(DrawerView, {\n  childContainer: '.js-drawer-holder',\n  childView: DrawerItemView\n});\n\nexport default DrawerView;\n","import Adapt from 'core/js/adapt';\nimport DrawerView from 'core/js/views/drawerView';\n\nconst DrawerCollection = new Backbone.Collection(null, { comparator: 'drawerOrder' });\nconst Drawer = {};\n\nDrawer.addItem = function(drawerObject, eventCallback) {\n  drawerObject.eventCallback = eventCallback;\n  DrawerCollection.add(drawerObject);\n};\n\nDrawer.triggerCustomView = function(view, hasBackButton) {\n  if (hasBackButton !== false) {\n    hasBackButton = true;\n  }\n  Adapt.trigger('drawer:triggerCustomView', view, hasBackButton);\n};\n\nAdapt.on({\n  'adapt:start'() {\n    new DrawerView({ collection: DrawerCollection });\n  },\n  'app:languageChanged'() {\n    Adapt.trigger('drawer:remove');\n  }\n});\n\nexport default Drawer;\n","import AdaptCollection from 'core/js/collections/adaptCollection';\n\nexport default class AdaptSubsetCollection extends AdaptCollection {\n\n  initialize(models, options) {\n    super.initialize(models, options);\n    this.parent = options.parent;\n    this.listenTo(this.parent, 'reset', this.loadSubset);\n  }\n\n  loadSubset() {\n    this.set(this.parent.filter(model => model instanceof this.model));\n    this._byAdaptID = this.groupBy('_id');\n  }\n\n}\n","export default class ModelEvent extends Backbone.Controller {\n\n  /**\n   * @param {string} type Event name / type\n   * @param {Backbone.Model} target Origin model\n   * @param {*} [value] Any value that should be carried through on the event\n   */\n  initialize(type, target, value) {\n    this.type = type;\n    this.target = target;\n    this.value = value;\n    this.canBubble = true;\n    this.deepPath = [target];\n    this.timeStamp = null;\n  }\n\n  stopPropagation() {\n    this.canBubble = false;\n  }\n\n  addPath(target) {\n    this.deepPath.unshift(target);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport ModelEvent from 'core/js/modelEvent';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\n\nexport default class AdaptModel extends LockingModel {\n\n  toJSON() {\n    // Perform shallow clone\n    const json = { ...this.attributes };\n    // Remove deprecated values as they are not true json\n    delete json._children;\n    delete json._parent;\n    // Perform deep clone\n    return $.extend(true, {}, json);\n  }\n\n  get(name) {\n    switch (name) {\n      case '_parent':\n      case '_children':\n        logging.deprecated('Use model.getChildren() or model.getParent() instead of model.get(\\'_children\\') or model.get(\\'_parent\\')');\n    }\n    return super.get(name);\n  }\n\n  defaults() {\n    return {\n      _canShowFeedback: true,\n      _classes: '',\n      _canReset: true,\n      _canRequestChild: false,\n      _isComplete: false,\n      _isInteractionComplete: false,\n      _isA11yRegionEnabled: false,\n      _isA11yCompletionDescriptionEnabled: true,\n      _requireCompletionOf: -1,\n      _isEnabled: true,\n      _isResetOnRevisit: false,\n      _isAvailable: true,\n      _isOptional: false,\n      _isRendered: false,\n      _isReady: false,\n      _isVisible: true,\n      _isVisited: false,\n      _isLocked: false,\n      _isHidden: false\n    };\n  }\n\n  /**\n   * Fetch an array representing the relative location of the model to the nearest _trackingId\n   * @returns {Array<Number, Number>}\n   */\n  get trackingPosition() {\n    const firstDescendant = this.getAllDescendantModels(false).concat([this])[0];\n    const nearestTrackingIdModel = [firstDescendant].concat(firstDescendant.getAncestorModels()).find(model => model.has('_trackingId'));\n    if (!nearestTrackingIdModel) return;\n    const trackingId = nearestTrackingIdModel.get('_trackingId');\n    let trackingIdDescendants = [nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));\n    trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\n    const indexInTrackingIdDescendants = trackingIdDescendants.findIndex(descendant => descendant === this);\n    if (indexInTrackingIdDescendants >= 0) {\n      // Is either the nearestTrackingIdModel (0) or one of its flattened descendants (>0)\n      return [ trackingId, indexInTrackingIdDescendants ];\n    }\n    // Is an ancestor of the nearestTrackingIdModel\n    const trackingIdAncestors = nearestTrackingIdModel.getAncestorModels();\n    const ancestorDistance = trackingIdAncestors.findIndex(ancestor => ancestor === this);\n    return [ trackingId, -(ancestorDistance + 1) ];\n  }\n\n  /**\n   * The AAT always sets the value of `_isResetOnRevisit` to a String\n   * which is fine for the 'soft' and 'hard' values - but 'false' needs\n   * converting to Boolean - see #2825\n   */\n  parse(data) {\n    if (data._isResetOnRevisit === 'false') {\n      data._isResetOnRevisit = false;\n    }\n    return data;\n  }\n\n  trackable() {\n    return [\n      '_id',\n      '_isComplete',\n      '_isInteractionComplete',\n      '_isVisited'\n    ];\n  }\n\n  trackableType() {\n    return [\n      String,\n      Boolean,\n      Boolean,\n      Boolean\n    ];\n  }\n\n  bubblingEvents() {\n    return [\n      'change:_isComplete',\n      'change:_isInteractionComplete',\n      'change:_isActive',\n      'change:_isVisited'\n    ];\n  }\n\n  setupModel() {\n    if (this.hasManagedChildren) {\n      this.setupChildListeners();\n    }\n    this.init();\n    _.defer(() => {\n      if (this.hasManagedChildren) {\n        this.checkCompletionStatus();\n        this.checkInteractionCompletionStatus();\n        this.checkLocking();\n        this.checkVisitedStatus();\n      }\n      this.setupTrackables();\n    });\n  }\n\n  setupTrackables() {\n\n    // Limit state trigger calls and make state change callbacks batched-asynchronous\n    const originalTrackableStateFunction = this.triggerTrackableState;\n    this.triggerTrackableState = _.compose(\n      () => {\n\n        // Flag that the function is awaiting trigger\n        this.triggerTrackableState.isQueued = true;\n\n      },\n      _.debounce(() => {\n\n        // Trigger original function\n        originalTrackableStateFunction.apply(this);\n\n        // Unset waiting flag\n        this.triggerTrackableState.isQueued = false;\n\n      }, 17)\n    );\n\n    // Listen to model changes, trigger trackable state change when appropriate\n    this.listenTo(this, 'change', ({ changed }) => {\n\n      // Skip if trigger queued or adapt hasn't started yet\n      if (this.triggerTrackableState.isQueued || !Adapt.attributes._isStarted) {\n        return;\n      }\n\n      // Check that property is trackable\n      const trackablePropertyNames = _.result(this, 'trackable', []);\n      const changedPropertyNames = Object.keys(changed);\n      const isTrackable = changedPropertyNames.find(item => {\n        return trackablePropertyNames.includes(item);\n      });\n\n      if (isTrackable) {\n        // Trigger trackable state change\n        this.triggerTrackableState();\n      }\n    });\n  }\n\n  setupChildListeners() {\n    const children = this.getChildren();\n    if (!children.length) {\n      return;\n    }\n\n    this.listenTo(children, {\n      all: this.onAll,\n      bubble: this.bubble,\n      'change:_isVisited': this.checkVisitedStatus,\n      'change:_isReady': this.checkReadyStatus,\n      'change:_isComplete': this.onIsComplete,\n      'change:_isInteractionComplete': this.checkInteractionCompletionStatus\n    });\n  }\n\n  init() {}\n\n  getTrackableState() {\n\n    const trackable = this.resultExtend('trackable', []);\n    const json = this.toJSON();\n\n    const args = trackable;\n    args.unshift(json);\n\n    return _.pick(...args);\n\n  }\n\n  setTrackableState(state) {\n\n    const trackable = this.resultExtend('trackable', []);\n\n    const args = trackable;\n    args.unshift(state);\n\n    state = _.pick(...args);\n\n    this.set(state);\n\n    return this;\n\n  }\n\n  triggerTrackableState() {\n\n    Adapt.trigger('state:change', this, this.getTrackableState());\n\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    if (!canReset) return false;\n    switch (type) {\n      case 'hard':\n      case true:\n        this.set({\n          _isEnabled: true,\n          _isComplete: false,\n          _isInteractionComplete: false\n        });\n        return true;\n      case 'soft':\n        this.set({\n          _isEnabled: true,\n          _isInteractionComplete: false\n        });\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Checks if any child models which have been _isRendered are not _isReady.\n   * If all rendered child models are marked ready then this model will be\n   * marked _isReady: true as well.\n   * @param {AdaptModel} [model]\n   * @param {boolean} [value]\n   * @returns {boolean}\n   */\n  checkReadyStatus(model, value) {\n    if (value === false) {\n      // Do not respond to _isReady: false as _isReady is unset throughout\n      // the rendering process\n      return false;\n    }\n    // Filter children based upon whether they are available\n    // Check if any _isRendered: true children return _isReady: false\n    // If not - set this model to _isReady: true\n    const children = this.getAvailableChildModels();\n    if (children.find(child => child.get('_isReady') === false && child.get('_isRendered'))) {\n      return false;\n    }\n\n    this.set('_isReady', true);\n    return true;\n  }\n\n  setReadyStatus() {\n    this.set('_isReady', true);\n  }\n\n  checkVisitedStatus() {\n    const children = this.getAvailableChildModels();\n    const isVisited = children.some(child => child.get('_isVisited') || child.get('_isComplete') || child.get('_isInteractionComplete'));\n    if (isVisited) this.set('_isVisited', true);\n    return isVisited;\n  }\n\n  setVisitedStatus() {\n    if (!this.get('_isReady') || !this.get('_isRendered')) return;\n    this.set('_isVisited', true);\n  }\n\n  setCompletionStatus() {\n    if (!this.get('_isVisible')) return;\n\n    this.set({\n      _isComplete: true,\n      _isInteractionComplete: true,\n      _isVisited: true\n    });\n  }\n\n  checkCompletionStatus() {\n    // defer to allow other change:_isComplete handlers to fire before cascading to parent\n    Adapt.checkingCompletion();\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isComplete');\n  }\n\n  checkInteractionCompletionStatus() {\n    // defer to allow other change:_isInteractionComplete handlers to fire before cascading to parent\n    Adapt.checkingCompletion();\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isInteractionComplete');\n  }\n\n  /**\n   * Function for checking whether the supplied completion attribute should be set to true or false.\n   * It iterates over our immediate children, checking the same completion attribute on any mandatory child\n   * to see if enough/all of them them have been completed. If enough/all have, we set our attribute to true;\n   * if not, we set it to false.\n   * @param {string} [completionAttribute] Either '_isComplete' or '_isInteractionComplete'. Defaults to '_isComplete' if not supplied.\n   */\n\n  checkCompletionStatusFor(completionAttribute = '_isComplete') {\n    let completed = false;\n    const children = this.getAvailableChildModels();\n    const requireCompletionOf = this.get('_requireCompletionOf');\n\n    if (requireCompletionOf === -1) { // a value of -1 indicates that ALL mandatory children must be completed\n      completed = children.every(child => {\n        return child.get(completionAttribute) || child.get('_isOptional');\n      });\n    } else {\n      completed = (children.filter(child => {\n        return child.get(completionAttribute) && !child.get('_isOptional');\n      }).length >= requireCompletionOf);\n    }\n\n    this.set(completionAttribute, completed);\n\n    Adapt.checkedCompletion();\n  }\n\n  /**\n   * Returns a string describing the type group of this model.\n   * Strings should be lowercase and not plurlaized.\n   * i.e. 'page', 'menu', 'contentobject', 'component', 'article', 'block'\n   * Override in inheritance chain.\n   * @returns {string}\n   */\n  getTypeGroup() {}\n\n  /**\n   * Returns true if this model is of the type group described.\n   * Automatically manages pluralization typeGroup and matches lowercase only.\n   * Pluralized typeGroups and uppercase characters in typeGroups are discouraged.\n   * @param {string} type Type group name i.e. course, contentobject, article, block, component\n   * @returns {boolean}\n   */\n  isTypeGroup(typeGroup) {\n    const hasUpperCase = /[A-Z]+/.test(typeGroup);\n    const isPluralized = typeGroup.slice(-1) === 's';\n    const lowerCased = typeGroup.toLowerCase();\n    const singular = isPluralized && lowerCased.slice(0, -1); // remove pluralization if ending in s\n    const singularLowerCased = (singular || lowerCased).toLowerCase();\n    if (isPluralized || hasUpperCase) {\n      logging.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`);\n    }\n    const pluralizedLowerCaseTypes = [\n      singularLowerCased,\n      !isPluralized && `${lowerCased}s` // pluralize if not ending in s\n    ].filter(Boolean);\n    const typeGroups = this.getTypeGroups();\n    if (_.intersection(pluralizedLowerCaseTypes, typeGroups).length) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns an array of strings describing the model type groups.\n   * All strings are lowercase and should not be pluralized.\n   * i.e. ['course', 'menu', 'contentobject'], ['page', 'contentobject'], ['component']\n   * @returns {[string]}\n   */\n  getTypeGroups() {\n    if (this._typeGroups) return this._typeGroups;\n    const typeGroups = [ this.get('_type') ];\n    let parentClass = this;\n    while ((parentClass = Object.getPrototypeOf(parentClass))) {\n      if (!Object.prototype.hasOwnProperty.call(parentClass, 'getTypeGroup')) continue;\n      typeGroups.push(parentClass.getTypeGroup.call(this));\n    }\n    return (this._typeGroups = _.uniq(typeGroups.filter(Boolean).map(s => s.toLowerCase())));\n  }\n\n  /**\n   * Searches the model's ancestors to find the first instance of the specified ancestor type\n   * @param {string} [ancestorType] Valid values are 'course', 'pages', 'contentObjects', 'articles' or 'blocks'.\n   * If left blank, the immediate ancestor (if there is one) is returned\n   * @return {object} Reference to the model of the first ancestor of the specified type that's found - or `undefined` if none found\n   */\n  findAncestor(ancestorType) {\n    const parent = this.getParent();\n    if (!parent) return;\n    if (!ancestorType || parent.isTypeGroup(ancestorType)) {\n      return parent;\n    }\n    return parent.findAncestor(ancestorType);\n  }\n\n  /**\n   * Returns all the descendant models of a specific type\n   * @param {string} descendants Valid values are 'contentobject', 'page', 'menu', 'article', 'block', 'component', 'question'\n   * @param {object} options an object that defines the search type and the properties/values to search on. Currently only the `where` search type (equivalent to `Backbone.Collection.where()`) is supported.\n   * @param {object} options.where\n   * @return {array}\n   * @example\n   * //find all available, non-optional components\n   * this.findDescendantModels('component', { where: { _isAvailable: true, _isOptional: false }});\n   */\n  findDescendantModels(descendants, options) {\n    const allDescendantsModels = this.getAllDescendantModels();\n    const returnedDescendants = allDescendantsModels.filter(model => {\n      return model.isTypeGroup(descendants);\n    });\n\n    if (!options) {\n      return returnedDescendants;\n    }\n\n    if (options.where) {\n      return returnedDescendants.filter(descendant => {\n        for (const property in options.where) {\n          const value = options.where[property];\n          if (descendant.get(property) !== value) {\n            return false;\n          }\n        }\n        return true;\n      });\n    }\n  }\n\n  /**\n   * Fetches the sub structure of a model as a flattened array\n   *\n   * Such that the tree:\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n   *\n   * will become the array (parent first = false):\n   *  [ c1, c2, b1, c3, c4, b2, a1, c5, c6, b3, a2 ]\n   *\n   * or (parent first = true):\n   *  [ a1, b1, c1, c2, b2, c3, c4, a2, b3, c5, c6 ]\n   *\n   * This is useful when sequential operations are performed on the menu/page/article/block/component hierarchy.\n   * @param {boolean} [isParentFirst]\n   * @return {array}\n   */\n  getAllDescendantModels(isParentFirst) {\n\n    const descendants = [];\n\n    if (!this.hasManagedChildren) {\n      return descendants;\n    }\n\n    const children = this.getChildren();\n\n    children.models.forEach(child => {\n\n      if (!child.hasManagedChildren) {\n        descendants.push(child);\n        return;\n      }\n\n      const subDescendants = child.getAllDescendantModels(isParentFirst);\n      if (isParentFirst === true) {\n        descendants.push(child);\n      }\n\n      descendants.push(...subDescendants);\n\n      if (isParentFirst !== true) {\n        descendants.push(child);\n      }\n    });\n\n    return descendants;\n\n  }\n\n  /**\n   * Returns a relative model from the Adapt hierarchy\n   *\n   * Such that in the tree:\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n   *\n   *  c1.findRelativeModel('@block+1') = b2;\n   *  c1.findRelativeModel('@component+4') = c5;\n   *  c1.findRelativeModel('@article+1 @component=-1') = c6;\n   *\n   * @see Adapt.parseRelativeString for a description of relativeStrings\n   * @param {string} relativeString\n   * @param {object} options Search configuration settings\n   * @param {boolean} options.limitParentId Constrain to a parent\n   * @param {function} options.filter Model filter\n   * @param {boolean} options.loop Allow offsets and insets to loop around to the beginning\n   * @return {array}\n   */\n  findRelativeModel(relativeString, options = {}) {\n    if (!relativeString) return this;\n\n    let relativeDescriptorObjects = Adapt.parseRelativeString(relativeString);\n    if (!Array.isArray(relativeDescriptorObjects)) relativeDescriptorObjects = [relativeDescriptorObjects];\n\n    const find = ({ type, offset, inset }) => {\n      const isInset = (inset !== null);\n      const isOffset = (offset !== null);\n      const rootModel = options.limitParentId\n        ? data.findById(options.limitParentId)\n        : isInset\n          ? this // For insets, the default parent constraint is this model\n          : Adapt.course; // For offsets, the default parent constraint is the course\n\n      const increment = isOffset\n        ? offset\n        : inset;\n\n      const searchBackwards = (increment < 0);\n      let moveBy = Math.abs(increment);\n      let movementCount = 0;\n\n      const hasDescendantsOfType = Boolean(this.findDescendantModels(type).length);\n      if (isInset && !hasDescendantsOfType) return undefined;\n      if (isOffset && hasDescendantsOfType) {\n        // Move by one less as first found is considered next.\n        // Should find descendants on either side but not inside.\n        moveBy--;\n      }\n      if (isInset && searchBackwards) {\n        // Move by one less as -1 should act like the last, -2 second from last\n        moveBy--;\n      }\n\n      const searchDescendants = searchBackwards\n        // Parents first [p1,a1,b1,c1,c2,a2,b2,c3,c4,p2,a3,b3,c6,c7,a4,b4,c8,c9]\n        // Reverse so that we don't need a forward and a backward iterating loop\n        // Reversed [c9,c8,b4,a4,c7,c6,b3,a3,p2,c4,c3,b2,a2,c2,c1,b1,a1,p1]\n        ? [rootModel, ...rootModel.getAllDescendantModels(true)].reverse()\n        // Children first [c1,c2,b1,a1,c3,c4,b2,a2,p1,c6,c7,b3,a3,c8,c9,b4,a4,p2]\n        : [...rootModel.getAllDescendantModels(false), rootModel];\n\n      const modelId = this.get('_id');\n      // Find the index of this model in the searchDescendants array\n      const searchFromIndex = isInset\n        ? 0 // On inset, this model will always be the first model in searchDescendants\n        : searchDescendants.findIndex(searchDescendant => (searchDescendant.get('_id') === modelId));\n\n      const hasFilterFunction = (typeof options.filter === 'function');\n\n      // Normalize the moveBy position to allow for overflow looping\n      if (options.loop) {\n        const totalOfType = searchDescendants.reduce((count, model) => {\n          if (!model.isTypeGroup(type)) return count;\n          return ++count;\n        }, 0);\n        // Take the remainder of moveBy after removing whole units of the type count\n        moveBy = moveBy % totalOfType;\n        // Double up the searchDescendant entries to allow for overflow looping\n        searchDescendants.push(...searchDescendants.slice(0));\n      }\n\n      for (let i = searchFromIndex, l = searchDescendants.length; i < l; i++) {\n        const descendant = searchDescendants[i];\n        if (!descendant.isTypeGroup(type)) continue;\n        const isSelf = (i === searchFromIndex);\n        // https://github.com/adaptlearning/adapt_framework/issues/3031\n        if (!isSelf && hasFilterFunction && !options.filter(descendant)) continue;\n        if (movementCount > moveBy) {\n          // There is no descendant which matches this relativeString\n          // Probably looking for a descendant +/-0\n          break;\n        }\n        if (movementCount === moveBy) {\n          return descendant;\n        }\n        movementCount++;\n      }\n    };\n\n    // Join the remaining descriptors together to pass to the next model\n    const nextDescriptor = relativeDescriptorObjects\n      .slice(1)\n      .reduce((output, { type, offset, inset }) => {\n        const isInset = (inset !== null);\n        const isOffset = (offset !== null);\n        if (isOffset) return `${output}@${type}${offset < 0 ? offset : `+${offset}`}`;\n        if (isInset) return `${output}@${type}=${inset}`;\n        return `${output}@${type}`;\n      }, '');\n\n    const foundModel = find(relativeDescriptorObjects[0]);\n    if (nextDescriptor) {\n      // Perform the lookup of the next descriptor on the found model\n      // Defer to that model as it may have overridden the findRelativeModel function\n      return foundModel?.findRelativeModel(nextDescriptor);\n    }\n    return foundModel;\n  }\n\n  get hasManagedChildren() {\n    return true;\n  }\n\n  getChildren() {\n    if (this._childrenCollection) {\n      return this._childrenCollection;\n    }\n\n    let childrenCollection;\n\n    if (!this.hasManagedChildren) {\n      childrenCollection = new Backbone.Collection();\n    } else {\n      const id = this.get('_id');\n      // Look up child by _parentId from data\n      const children = data.filter(model => model.get('_parentId') === id);\n      childrenCollection = new Backbone.Collection(children);\n    }\n\n    if (this.get('_type') === 'block' &&\n      childrenCollection.length === 2 &&\n      childrenCollection.models[0].get('_layout') !== 'left') {\n      // Components may have a 'left' or 'right' _layout,\n      // so ensure they appear in the correct order\n      // Re-order component models to correct it\n      childrenCollection.comparator = '_layout';\n      childrenCollection.sort();\n    }\n\n    this.setChildren(childrenCollection);\n    return this._childrenCollection;\n  }\n\n  setChildren(children) {\n    this._childrenCollection = children;\n    // Setup deprecated reference\n    this.set('_children', children);\n  }\n\n  getAvailableChildModels() {\n    return this.getChildren().where({\n      _isAvailable: true\n    });\n  }\n\n  getParent() {\n    if (this._parentModel) {\n      return this._parentModel;\n    }\n    const parentId = this.get('_parentId');\n    if (!parentId) return;\n    // Look up parent by id from data\n    this.setParent(data.findById(parentId));\n    return this._parentModel;\n  }\n\n  setParent(parent) {\n    this._parentModel = parent;\n    this.set('_parentId', this._parentModel.get('_id'));\n    // Set up deprecated reference\n    this.set('_parent', this._parentModel);\n  }\n\n  getAncestorModels(shouldIncludeChild) {\n    const parents = [];\n    let context = this;\n\n    if (shouldIncludeChild) parents.push(context);\n\n    while (context.has('_parentId')) {\n      context = context.getParent();\n      parents.push(context);\n    }\n\n    return parents.length ? parents : null;\n  }\n\n  getSiblings(passSiblingsAndIncludeSelf) {\n    const id = this.get('_id');\n    const parentId = this.get('_parentId');\n    let siblings;\n    if (!passSiblingsAndIncludeSelf) {\n      // returns a collection of siblings excluding self\n      if (this._hasSiblingsAndSelf === false) {\n        return this.get('_siblings');\n      }\n      siblings = data.filter(model => {\n        return model.get('_parentId') === parentId &&\n          model.get('_id') !== id;\n      });\n\n      this._hasSiblingsAndSelf = false;\n\n    } else {\n      // returns a collection of siblings including self\n      if (this._hasSiblingsAndSelf) {\n        return this.get('_siblings');\n      }\n\n      siblings = data.filter(model => {\n        return model.get('_parentId') === parentId;\n      });\n      this._hasSiblingsAndSelf = true;\n    }\n\n    const siblingsCollection = new Backbone.Collection(siblings);\n    this.set('_siblings', siblingsCollection);\n    return siblingsCollection;\n  }\n\n  /**\n   * @param  {string} key\n   * @param  {any} value\n   * @param  {Object} options\n   */\n  setOnChildren(...args) {\n\n    this.set(...args);\n\n    if (!this.hasManagedChildren) return;\n\n    const children = this.getChildren();\n    children.models.forEach(child => child.setOnChildren(...args));\n\n  }\n\n  /**\n   * @deprecated since v3.2.3 - please use `model.set('_isOptional', value)` instead\n   */\n  setOptional(value) {\n    logging.deprecated('Use model.set(\\'_isOptional\\', value) as setOptional() may be removed in the future');\n    this.set({ _isOptional: value });\n  }\n\n  checkLocking() {\n    const lockType = this.get('_lockType');\n\n    if (!lockType) return;\n\n    switch (lockType) {\n      case 'sequential':\n        this.setSequentialLocking();\n        break;\n      case 'unlockFirst':\n        this.setUnlockFirstLocking();\n        break;\n      case 'lockLast':\n        this.setLockLastLocking();\n        break;\n      case 'custom':\n        this.setCustomLocking();\n        break;\n      default:\n        console.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get('_id')}`);\n    }\n  }\n\n  setSequentialLocking() {\n    const children = this.getAvailableChildModels();\n    // Start from second child\n    children.slice(1).forEach((child, index) => {\n      const previousChild = children[index];\n      // If previous was locked, all subsequent will be locked.\n      const isLockedByPreviousChild = previousChild.get('_isLocked') ||\n        (\n          !previousChild.get('_isComplete') &&\n          !previousChild.get('_isOptional')\n        );\n      child.set('_isLocked', isLockedByPreviousChild);\n    }, false);\n  }\n\n  setUnlockFirstLocking() {\n    const children = this.getAvailableChildModels();\n    const firstChild = children.shift();\n    const isLockedByFirstChild = (!firstChild.get('_isComplete') && !firstChild.get('_isOptional'));\n    children.forEach(child => child.set('_isLocked', isLockedByFirstChild));\n  }\n\n  setLockLastLocking() {\n    const children = this.getAvailableChildModels();\n    const lastChild = children.pop();\n    const isLockedByChildren = children.some(child => (!child.get('_isComplete') && !child.get('_isOptional')));\n    lastChild.set('_isLocked', isLockedByChildren);\n  }\n\n  setCustomLocking() {\n    const children = this.getAvailableChildModels();\n    children.forEach(child => child.set('_isLocked', this.shouldLock(child)));\n  }\n\n  shouldLock(child) {\n    const lockedBy = child.get('_lockedBy');\n    if (!lockedBy) return false;\n    return lockedBy.some(id => {\n      try {\n        const anotherModel = data.findById(id);\n        return anotherModel.get('_isAvailable') &&\n          (\n            anotherModel.get('_isLocked') ||\n            (\n              !anotherModel.get('_isComplete') &&\n              !anotherModel.get('_isOptional')\n            )\n          );\n      } catch (e) {\n        console.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get('_id')}`);\n        return false;\n      }\n    });\n  }\n\n  onIsComplete() {\n    this.checkCompletionStatus();\n\n    this.checkLocking();\n  }\n\n  /**\n   * Used before a model is rendered to determine if it should be reset to its\n   * default values.\n   */\n  checkIfResetOnRevisit() {\n    const isResetOnRevisit = this.get('_isResetOnRevisit');\n    this.reset(isResetOnRevisit);\n  }\n\n  /**\n   * Clones this model and all managed children returning a new branch.\n   * Assign new unique ids to each cloned model.\n   * @param {Function} [modifier] A callback function for each child to allow for custom modifications\n   * @returns {AdaptModel}\n   */\n  deepClone(modifier = null) {\n    // Fetch the class\n    const ModelClass = this.constructor;\n    // Clone the model\n    const clonedModel = new ModelClass(this.toJSON());\n    // Run the custom modifier on the clone\n    if (modifier) {\n      modifier(clonedModel, this);\n    }\n    let clonedId = clonedModel.get('_id');\n    const hasId = Boolean(clonedId);\n    const shouldAssignUniqueId = (this.get('_id') === clonedId);\n    if (hasId && shouldAssignUniqueId) {\n      // Create a unique id if none was set by the modifier\n      const cid = _.uniqueId(ModelClass.prototype.cidPrefix || 'c');\n      clonedId = `${clonedId}_${cid}`;\n      clonedModel.set('_id', clonedId);\n    }\n    // Add the cloned model to data for data.findById resolution\n    if (hasId) {\n      data.add(clonedModel);\n    }\n    // Clone any children\n    if (this.hasManagedChildren) {\n      this.getChildren().each(child => {\n        if (!child.deepClone) {\n          throw new Error('Cannot deepClone child.');\n        }\n        child.deepClone((clone, child) => {\n          if (hasId) {\n            // Set the cloned child parent id\n            clone.set('_parentId', clonedId);\n          }\n          if (modifier) {\n            // Run the custom modifier function on the cloned child\n            modifier(clone, child);\n          }\n        });\n      });\n    }\n    // Add the cloned model to its parent for model.findDescendants resolution\n    clonedModel.getParent().getChildren().add(clonedModel);\n    // Setup the cloned model after setting the id, the parent and adding any children\n    clonedModel.setupModel();\n    return clonedModel;\n  }\n\n  /**\n   * Internal event handler for all module events. Triggers event bubbling\n   * through the module hierarchy when the event is included in\n   * `this.bubblingEvents`.\n   * @param {string} type Event name / type\n   * @param {Backbone.Model} model Origin backbone model\n   * @param {*} value New property value\n   */\n  onAll(type, model, value) {\n    if (!_.result(this, 'bubblingEvents').includes(type)) return;\n    const event = new ModelEvent(type, model, value);\n    this.bubble(event);\n  }\n\n  /**\n   * Internal event handler for bubbling events.\n   * @param {ModelEvent} event\n   */\n  bubble(event) {\n    if (!event.canBubble) return;\n    event.addPath(this);\n    this.trigger(`bubble:${event.type} bubble`, event);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nexport default class ContentObjectModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON');\n    const isParentCourse = (this.get('_parentId') === Adapt.course.get('_id'));\n    if (isParentCourse) {\n      return 'course';\n    }\n    return 'contentObjects';\n  }\n\n  get _siblings() {\n    logging.deprecated('contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  get _children() {\n    logging.deprecated('contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON');\n    return null;\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'contentobject';\n  }\n\n}\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass ArticleModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  get _siblings() {\n    logging.deprecated('articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'articles';\n  }\n\n  get _children() {\n    logging.deprecated('articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'blocks';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'article';\n  }\n\n}\n\ncomponents.register('article', { model: ArticleModel });\n\nexport default ArticleModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass BlockModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON');\n    return 'articles';\n  }\n\n  get _siblings() {\n    logging.deprecated('blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'blocks';\n  }\n\n  get _children() {\n    logging.deprecated('blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'components';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'block';\n  }\n\n}\n\ncomponents.register('block', { model: BlockModel });\n\nexport default BlockModel;\n","import components from 'core/js/components';\nimport Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass ComponentModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON');\n    return 'blocks';\n  }\n\n  get _siblings() {\n    logging.deprecated('componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'components';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'component';\n  }\n\n  defaults() {\n    return AdaptModel.resultExtend('defaults', {\n      _isA11yComponentDescriptionEnabled: true,\n      _shouldStoreAttempts: true,\n      _userAnswer: null,\n      _attemptStates: null\n    });\n  }\n\n  trackable() {\n    return AdaptModel.resultExtend('trackable', [\n      '_userAnswer',\n      '_attemptStates'\n    ]);\n  }\n\n  trackableType() {\n    return AdaptModel.resultExtend('trackableType', [\n      Array,\n      Array\n    ]);\n  }\n\n  get hasManagedChildren() {\n    return false;\n  }\n\n  init() {\n    if (Adapt.get('_isStarted')) {\n      this.onAdaptInitialize();\n      return;\n    }\n    this.listenToOnce(Adapt, 'adapt:initialize', this.onAdaptInitialize);\n  }\n\n  onAdaptInitialize() {\n    this.restoreUserAnswers();\n  }\n\n  /**\n   * Restore the user's answer from the _userAnswer property.\n   * The _userAnswer value must be in the form of arrays containing\n   * numbers, booleans or arrays only.\n   */\n  restoreUserAnswers() {}\n\n  /**\n   * Store the user's answer in the _userAnswer property.\n   * The _userAnswer value must be in the form of arrays containing\n   * numbers, booleans or arrays only.\n   */\n  storeUserAnswer() {}\n\n  resetUserAnswer() {\n    this.set('_userAnswer', null);\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    this.resetUserAnswer();\n    return true;\n  }\n\n  /**\n   * Returns the current attempt state raw data or the raw data from the supplied attempt state object.\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\n   * @returns {Array}\n   */\n  getAttemptState(object = this.toJSON()) {\n    const trackables = this.trackable();\n    const types = this.trackableType();\n    trackables.find((name, index) => {\n      // Exclude _attemptStates as it's trackable but isn't needed here\n      if (name !== '_attemptStates') return false;\n      trackables.splice(index, 1);\n      types.splice(index, 1);\n      return true;\n    });\n    const values = trackables.map(n => object[n]);\n    const booleans = values.filter((v, i) => types[i] === Boolean).map(Boolean);\n    const numbers = values.filter((v, i) => types[i] === Number).map(v => Number(v) || 0);\n    const arrays = values.filter((v, i) => types[i] === Array);\n    return [\n      numbers,\n      booleans,\n      arrays\n    ];\n  }\n\n  /**\n   * Returns an attempt object representing the current state or a formatted version of the raw state object supplied.\n   * @param {Array} [state] JSON object representing the component state, defaults to current state returned from getAttemptState().\n   * @returns {Object}\n   */\n  getAttemptObject(state = this.getAttemptState()) {\n    const trackables = this.trackable();\n    const types = this.trackableType();\n    trackables.find((name, index) => {\n      // Exclude _attemptStates as it's trackable but isn't needed here\n      if (name !== '_attemptStates') return false;\n      trackables.splice(index, 1);\n      types.splice(index, 1);\n      return true;\n    });\n    const numbers = (state[0] || []).slice(0);\n    const booleans = (state[1] || []).slice(0);\n    const arrays = (state[2] || []).slice(0);\n    const object = {};\n    trackables.forEach((n, i) => {\n      if (n === '_id') return;\n      switch (types[i]) {\n        case Number:\n          object[n] = numbers.shift();\n          break;\n        case Boolean:\n          object[n] = booleans.shift();\n          break;\n        case Array:\n          object[n] = arrays.shift();\n          break;\n      }\n    });\n    return object;\n  }\n\n  /**\n   * Sets the current attempt state from the supplied attempt state object.\n   * @param {Object} object JSON object representing the component state.\n   * @param {boolean} silent Stops change events from triggering\n   */\n  setAttemptObject(object, silent = true) {\n    this.set(object, { silent });\n  }\n\n  /**\n   * Adds the current attempt state object or the supplied state object to the attempts store.\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\n   */\n  addAttemptObject(object = this.getAttemptObject()) {\n    const attemptStates = this.get('_attemptStates') || [];\n    const state = this.getAttemptState(object);\n    attemptStates.push(state);\n    this.set('_attemptStates', attemptStates);\n  }\n\n  /**\n   * Returns an array of the previous state objects. The most recent state is last in the list.\n   * @returns {Array}\n   */\n  getAttemptObjects() {\n    const states = this.get('_attemptStates') || [];\n    return states.map(state => this.getAttemptObject(state));\n  }\n\n}\n\n// This abstract model needs to registered to support deprecated view-only components\ncomponents.register('component', { model: ComponentModel });\n\nexport default ComponentModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\n\nclass MenuModel extends ContentObjectModel {\n\n  get _children() {\n    logging.deprecated('menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'menu';\n  }\n\n  setCustomLocking() {\n    const children = this.getAvailableChildModels();\n    children.forEach(child => {\n      child.set('_isLocked', this.shouldLock(child));\n      if (!(child instanceof MenuModel)) return;\n      child.checkLocking();\n    });\n  }\n\n}\n\ncomponents.register('menu', { model: MenuModel });\n\nexport default MenuModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport MenuModel from 'core/js/models/menuModel';\n\nclass CourseModel extends MenuModel {\n\n  get _parent() {\n    logging.deprecated('courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON');\n    return null;\n  }\n\n  get _siblings() {\n    logging.deprecated('courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON');\n    return null;\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'course';\n  }\n\n}\n\ncomponents.register('course', { model: CourseModel });\n\nexport default CourseModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\n\nclass PageModel extends ContentObjectModel {\n\n  get _children() {\n    logging.deprecated('pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'articles';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'page';\n  }\n\n}\n\ncomponents.register('page', { model: PageModel });\n\nexport default PageModel;\n","import logging from 'core/js/logging';\n\n/**\n * Event object triggered for controlling child view rendering.\n * Sent with 'view:addChild' and 'view:requestChild' events.\n * All plugins receive the same object reference in their event handler and\n * as such, this object becomes a place of consensus for plugins to decide how\n * to handle rendering for this child.\n */\nexport default class ChildEvent extends Backbone.Controller {\n\n  /**\n   * @param {string} type Event type\n   * @param {AdaptView} target Parent view\n   * @param {AdaptModel} model Child model\n   */\n  initialize(type, target, model) {\n    /** @type {string} */\n    this.type = type;\n    /** @type {AdaptView} */\n    this.target = target;\n    /** @type {boolean} Force the child model to render */\n    this.isForced = false;\n    /** @type {boolean} Stop rendering before the child model */\n    this.isStoppedImmediate = false;\n    /** @type {boolean} Stop rendering after the child model */\n    this.isStoppedNext = false;\n    /** @type {boolean} Contains a model to render in response to a requestChild event */\n    this.hasRequestChild = false;\n    this._model = model;\n  }\n\n  /**\n   * Get the model to be rendered.\n   * @returns {AdaptModel}\n   */\n  get model() {\n    return this._model;\n  }\n\n  /**\n   * Set the model to render in response to a 'view:requestChild' event.\n   * @param {AdaptModel}\n   */\n  set model(model) {\n    if (this.type !== 'requestChild') {\n      logging.warn(`Cannot change model in ${this.type} event.`);\n      return;\n    }\n    if (this._model) {\n      logging.warn(`Cannot inject two models in one sitting. ${model.get('_id')} attempts to overwrite ${this._model.get('_id')}`);\n      return;\n    }\n    this._model = model;\n    this.hasRequestChild = true;\n  }\n\n  /**\n   * Reset all render stops.\n   */\n  reset() {\n    this.isStoppedImmediate = false;\n    this.isStoppedNext = false;\n  }\n\n  /**\n   * Force model to render.\n   */\n  force() {\n    this.isForced = true;\n  }\n\n  /**\n   * General stop. Stop immediately or stop next with flag to false.\n   * @param {boolean} [immediate=true] Flag to stop immediate or next.\n   */\n  stop(immediate = true) {\n    if (!immediate) {\n      return this.stopNext();\n    }\n    this.isStoppedImmediate = true;\n  }\n\n  /**\n   * Shortcut to stop(false). Stop the render after the contained model is rendered.\n   */\n  stopNext() {\n    this.isStoppedNext = true;\n  }\n\n  /**\n   * Trigger an event to signify that a final decision has been reached.\n   */\n  close() {\n    this.trigger('closed');\n  }\n\n}\n","export default class TemplateRenderEvent extends Backbone.Controller {\n\n  /**\n   * Template render event\n   * @param {string} type Event type\n   * @param {string} name Template name\n   * @param {string} mode \"template\" / \"partial\"\n   * @param {string} value Rendered template string\n   * @param {[*]} args Arguments passed to template for render\n   */\n  initialize(type, name, mode, value, args) {\n    /** @type {string} Event type */\n    this.type = type;\n    /** @type {string} Template name */\n    this.name = name;\n    /** @type {string} \"template\" / \"partial\" */\n    this.mode = mode;\n    /** @type {string} Rendered template string */\n    this.value = value;\n    /** @type {[*]} Arguments passed to template for render */\n    this.args = args;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\nimport React from 'react';\nimport logging from 'core/js/logging';\n\n/**\n * Used by babel plugin babel-plugin-transform-react-templates to inject react templates\n */\nexport default function register(name, component) {\n  templates[name] = (...args) => {\n    // Trap render calls to emit preRender and postRender events\n    const mode = 'reactTemplate';\n    // Send preRender event to allow modification of args\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\n    // Execute template\n    const value = component(...preRenderEvent.args);\n    // Send postRender event to allow modification of rendered template\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\n    // Return rendered, modified template\n    return postRenderEvent.value;\n  };\n};\n\n/**\n * Override React.createElement to allow trapping and modification of react\n * template elements.\n */\n(function () {\n  const original = React.createElement;\n  React.createElement = (...args) => {\n    const name = args[0];\n    // Trap render calls to emit preRender and postRender events\n    const mode = 'reactElement';\n    // Send preRender event to allow modification of args\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\n    // Execute element creation\n    const value = original(...preRenderEvent.args);\n    // Send postRender event to allow modification of rendered element\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\n    // Return rendered, modified element\n    return postRenderEvent.value;\n  };\n})();\n\n/**\n * Storage for react templates\n */\nexport const templates = {};\n\n/**\n * Convert html strings to react dom, equivalent to handlebars {{{html}}}\n * @param {string} html\n * @deprecated since v6.0.4, please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\n */\nexport function html(html) {\n  if (!html) return;\n  logging.deprecated('reactHelpers.html please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml');\n  return { __html: html };\n}\n\n/**\n * Handlebars compile integration\n * @param {string} name Handlebars template\n * @param {...any} args Template arguments\n */\nexport function compile(template, ...args) {\n  const output = Handlebars.compile(template)(...args);\n  return output;\n};\n\n/**\n * Handlebars partials integration\n * @param {string} name Partial name\n * @param {...any} args Partial arguments\n */\nexport function partial(name, ...args) {\n  const output = Handlebars.partials[name](...args);\n  return output;\n};\n\n/**\n * Handlebars helpers integration\n * @param {string} name Helper name\n * @param {...any} args Helper arguments\n */\nexport function helper(name, ...args) {\n  const output = Handlebars.helpers[name].call(args[0]);\n  return (output && output.string) || output;\n};\n\n/**\n * Helper for a list of classes, filtering out falsies and duplicates, and joining with spaces\n * @param  {...any} args List or arrays of classes\n */\nexport function classes(...args) {\n  return _.uniq(_.flatten(args).filter(Boolean).join(' ').split(' ')).join(' ');\n};\n\n/**\n * Helper for prefixing a list of classes, filtering out falsies and duplicates and joining with spaces\n * @param  {[...string]} prefixes Array of class prefixes\n * @param  {...any} args List or arrays of classes\n */\nexport function prefixClasses(prefixes, ...args) {\n  const classes = _.flatten(args).filter(Boolean);\n  const prefixed = _.flatten(prefixes.map(prefix => classes.map(className => `${prefix}${className}`)));\n  return _.uniq(prefixed.join(' ').split(' ')).join(' ');\n};\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport ChildEvent from 'core/js/childEvent';\nimport { templates } from 'core/js/reactHelpers';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport location from 'core/js/location';\nimport logging from 'core/js/logging';\n\nclass AdaptView extends Backbone.View {\n\n  attributes() {\n    return {\n      'data-adapt-id': this.model.get('_id'),\n      role: 'presentation'\n    };\n  }\n\n  initialize() {\n    this.listenTo(this.model, {\n      'change:_isVisible': this.toggleVisibility,\n      'change:_isHidden': this.toggleHidden,\n      'change:_isComplete': this.onIsCompleteChange\n    });\n    this.isJSX = (this.constructor.template || '').includes('.jsx');\n    if (this.isJSX) {\n      this._classSet = new Set(_.result(this, 'className').trim().split(/\\s+/));\n      this.listenTo(this.model, 'all', this.changed);\n      const children = this.model?.getChildren?.();\n      children && this.listenTo(children, 'all', this.changed);\n      // Facilitate adaptive react views\n      this.listenTo(Adapt, 'device:changed', this.changed);\n    }\n    this.model.set({\n      _globals: Adapt.course.get('_globals'),\n      _isReady: false\n    });\n    this._isRemoved = false;\n\n    if (location._currentId === this.model.get('_id')) {\n      Adapt.parentView = this;\n    }\n\n    this.preRender();\n    this.render();\n    this.setupOnScreenHandler();\n  }\n\n  preRender() {}\n\n  async postRender() {\n    await this.addChildren();\n  }\n\n  render() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRender view:preRender`, this);\n\n    if (this.isJSX) {\n      this.changed();\n    } else {\n      const data = this.model.toJSON();\n      data.view = this;\n      const template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    }\n\n    Adapt.trigger(`${type}View:render view:render`, this);\n\n    _.defer(async () => {\n      // don't call postRender after remove\n      if (this._isRemoved) return;\n\n      await this.postRender();\n      Adapt.trigger(`${type}View:postRender view:postRender`, this);\n    });\n\n    return this;\n  }\n\n  /**\n   * Re-render a react template\n   * @param {string} eventName=null Backbone change event name\n   */\n  changed(eventName = null) {\n    if (!this.isJSX) {\n      throw new Error('Cannot call changed on a non-react view');\n    }\n    if (typeof eventName === 'string' && eventName.startsWith('bubble')) {\n      // Ignore bubbling events as they are outside of this view's scope\n      return;\n    }\n    const props = {\n      // Add view own properties, bound functions etc\n      ...this,\n      // Add model json data\n      ...this.model.toJSON(),\n      // Add globals\n      _globals: Adapt.course.get('_globals')\n    };\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\n    this.updateViewProperties();\n    ReactDOM.render(<Template {...props} />, this.el);\n  }\n\n  updateViewProperties() {\n    const classesToAdd = _.result(this, 'className').trim().split(/\\s+/);\n    classesToAdd.forEach(i => this._classSet.add(i));\n    const classesToRemove = [ ...this._classSet ].filter(i => !classesToAdd.includes(i));\n    classesToRemove.forEach(i => this._classSet.delete(i));\n    this._setAttributes({ ..._.result(this, 'attributes'), id: _.result(this, 'id') });\n    this.$el.removeClass(classesToRemove).addClass(classesToAdd);\n  }\n\n  setupOnScreenHandler() {\n    const onscreen = this.model.get('_onScreen');\n\n    if (!onscreen?._isEnabled) return;\n\n    this.$el.addClass(`has-animation ${onscreen._classes}-before`);\n    this.$el.on('onscreen.adaptView', (e, m) => {\n      if (!m.onscreen) return;\n      const minVerticalInview = onscreen._percentInviewVertical || 33;\n      if (m.percentInviewVertical < minVerticalInview) return;\n      this.$el.addClass(`${onscreen._classes}-after`).off('onscreen.adaptView');\n    });\n  }\n\n  /**\n   * Add children and descendant views, first-child-first. Wait until all possible\n   * views are added before resolving asynchronously.\n   * Will trigger 'view:addChild'(ChildEvent), 'view:requestChild'(ChildEvent)\n   * and 'view:childAdded'(ParentView, ChildView) accordingly.\n   * @returns {number} Count of views added\n   */\n  async addChildren() {\n    this.nthChild = this.nthChild || 0;\n    // Check descendants first\n    let addedCount = await this.addDescendants(false);\n    // Iterate through existing available children and/or request new children\n    // if required and allowed\n    while (true) {\n      const models = this.model.getAvailableChildModels();\n      const event = this._getAddChildEvent(models[this.nthChild]);\n      if (!event) {\n        break;\n      }\n      if (event.isForced) {\n        event.reset();\n      }\n      if (event.isStoppedImmediate || !event.model) {\n        // If addChild has been stopped before it is added then\n        // set all subsequent models and their children as not rendered\n        const subsequentModels = models.slice(this.nthChild);\n        subsequentModels.forEach(model => model.setOnChildren('_isRendered', false));\n        break;\n      }\n      // Set model state\n      const model = event.model;\n      model.set({\n        _isRendered: true,\n        _nthChild: ++this.nthChild\n      });\n      // Create child view\n      const ChildView = this.constructor.childView || components.getViewClass(model);\n      if (!ChildView) {\n        throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`);\n      }\n      const childView = new ChildView({ model });\n      this.addChildView(childView);\n      addedCount++;\n      if (event.isStoppedNext) {\n        break;\n      }\n    }\n\n    if (!addedCount) {\n      return addedCount;\n    }\n\n    // Children were added, unset _isReady\n    this.model.set('_isReady', false);\n    return addedCount;\n  }\n\n  /**\n   * Child views can be added with '_renderPosition': 'outer-append' or\n   * 'inner-append' (default). Each child view will trigger a\n   * 'view:childAdded'(ParentView, ChildView) event and be added to the\n   * this.getChildViews() array on this parent.\n   * @param {AdaptView} childView\n   * @returns {AdaptView} Returns this childView\n   */\n  addChildView(childView) {\n    const childViews = this.getChildViews() || [];\n    childViews.push(childView);\n    this.setChildViews(childViews);\n    const $parentContainer = this.$(this.constructor.childContainer);\n    switch (childView.model.get('_renderPosition')) {\n      case 'outer-append':\n        // Useful for trickle buttons, inline feedback etc\n        this.$el.append(childView.$el);\n        break;\n      case 'inner-append':\n      default:\n        $parentContainer.append(childView.$el);\n        break;\n    }\n    // Signify that a child has been added to the view to enable updates to status bars\n    Adapt.trigger('view:childAdded', this, childView);\n    return childView;\n  }\n\n  /**\n   * Iterates through existing childViews and runs addChildren on them, resolving\n   * the total count of views added asynchronously.\n   * @returns {number} Count of views added\n   */\n  async addDescendants() {\n    let addedDescendantCount = 0;\n    const childViews = this.getChildViews();\n    if (!childViews) {\n      return addedDescendantCount;\n    }\n    for (let i = 0, l = childViews.length; i < l; i++) {\n      const view = childViews[i];\n      addedDescendantCount = view.addChildren ? await view.addChildren() : 0;\n      if (addedDescendantCount) {\n        break;\n      }\n    }\n    if (!addedDescendantCount) {\n      this.model.checkReadyStatus();\n      return addedDescendantCount;\n    }\n    // Descendants were added, unset _isReady\n    this.model.set('_isReady', false);\n    return addedDescendantCount;\n  }\n\n  /**\n   * Resolves after outstanding asynchronous view additions are finished\n   * and ready.\n   */\n  async whenReady() {\n    if (this.model.get('_isReady')) return;\n    return new Promise(resolve => {\n      const onReadyChange = (model, value) => {\n        if (!value) return;\n        this.stopListening(this.model, 'change:_isReady', onReadyChange);\n        resolve();\n      };\n      this.listenTo(this.model, 'change:_isReady', onReadyChange);\n      this.model.checkReadyStatus();\n    });\n  }\n\n  /**\n   * Triggers and returns a new ChildEvent object for render control.\n   * This function is used by addChildren to manage event triggering.\n   * @param {AdaptModel} model\n   * @returns {ChildEvent}\n   */\n  _getAddChildEvent(model) {\n    const isRequestChild = (!model);\n    const event = new ChildEvent(null, this, model);\n    if (isRequestChild) {\n      // No model has been supplied, we are at the end of the available child list\n      const canRequestChild = this.model.get('_canRequestChild');\n      if (!canRequestChild) {\n        // This model cannot request children\n        return;\n      }\n      event.type = 'requestChild';\n      // Send a request asking for a new model\n      Adapt.trigger('view:requestChild', event);\n      if (!event.hasRequestChild) {\n        // No new model was supplied\n        // Close the event so that the final state can be scrutinized\n        event.close();\n        return;\n      }\n      // A new model has been supplied for the end of the list.\n    }\n    // Trigger an event to signify that a new model is to be added\n    event.type = 'addChild';\n    Adapt.trigger('view:addChild', event);\n    // Close the event so that the final state can be scrutinized\n    event.close();\n    return event;\n  }\n\n  /**\n   * Return an array of all child and descendant views.\n   * @param {boolean} [isParentFirst=false] Array returns with parents before children\n   * @returns {[AdaptView]}\n   */\n  findDescendantViews(isParentFirst) {\n    const descendants = [];\n    const childViews = this.getChildViews();\n    childViews?.forEach(view => {\n      if (isParentFirst) descendants.push(view);\n      const children = view.findDescendantViews?.(isParentFirst);\n      if (children) descendants.push(...children);\n      if (!isParentFirst) descendants.push(view);\n    });\n    return descendants;\n  }\n\n  setReadyStatus() {\n    this.model.setReadyStatus();\n  }\n\n  setCompletionStatus() {\n    this.model.setCompletionStatus();\n  }\n\n  resetCompletionStatus(type) {\n    if (!this.model.get('_canReset')) return;\n\n    const descendantComponents = this.model.findDescendantModels('component');\n    if (descendantComponents.length === 0) {\n      this.model.reset(type);\n    } else {\n      descendantComponents.forEach(model => model.reset(type));\n    }\n  }\n\n  preRemove() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRemove view:preRemove`, this);\n  }\n\n  remove() {\n    const type = this.constructor.type;\n    this.preRemove();\n    Adapt.trigger(`${type}View:remove view:remove`, this);\n    this._isRemoved = true;\n    this.stopListening();\n\n    wait.for(end => {\n      if (this.isJSX) {\n        ReactDOM.unmountComponentAtNode(this.el);\n      }\n      this.$el.off('onscreen.adaptView');\n      super.remove();\n      _.defer(() => {\n        Adapt.trigger(`${type}View:postRemove view:postRemove`, this);\n      });\n      end();\n    });\n\n    return this;\n  }\n\n  setVisibility() {\n    return this.model.get('_isVisible') ? '' : 'u-visibility-hidden';\n  }\n\n  toggleVisibility() {\n    this.$el.toggleClass('u-visibility-hidden', !this.model.get('_isVisible'));\n  }\n\n  setHidden() {\n    return this.model.get('_isHidden') ? 'u-display-none' : '';\n  }\n\n  toggleHidden() {\n    this.$el.toggleClass('u-display-none', this.model.get('_isHidden'));\n  }\n\n  onIsCompleteChange(model, isComplete) {\n    this.$el.toggleClass('is-complete', isComplete);\n  }\n\n  /**\n   * @returns {[AdaptView]}\n   */\n  getChildViews() {\n    if (!this._childViews) return this._childViews;\n    // Allow both a deprecated id/view map or a new array of child views\n    return Object.entries(this._childViews).map(([key, value]) => value);\n  }\n\n  /**\n   * @param {[AdaptView]} value\n   */\n  setChildViews(value) {\n    this._childViews = value;\n  }\n\n  /**\n   * Returns an indexed by id list of child views.\n   * @deprecated since 5.7.0\n   * @returns {{<string, AdaptView}}\n   */\n  get childViews() {\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\n    if (Array.isArray(this._childViews)) {\n      return _.indexBy(this._childViews, view => view.model.get('_id'));\n    }\n    return this._childViews;\n  }\n\n  /**\n   * Sets an indexed by id list of child views.\n   * @deprecated since 5.7.0\n   */\n  set childViews(value) {\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\n    this.setChildViews(value);\n  }\n\n}\n\nAdaptView.className = '';\n\nexport default AdaptView;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport AdaptView from 'core/js/views/adaptView';\nimport ReactDOM from 'react-dom';\nimport data from 'core/js/data';\n\nexport default class ContentObjectView extends AdaptView {\n\n  attributes() {\n    return AdaptView.resultExtend('attributes', {\n      role: 'main'\n    }, this);\n  }\n\n  className() {\n    return [\n      this.constructor.type,\n      'contentobject',\n      this.constructor.className,\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].filter(Boolean).join(' ');\n  }\n\n  preRender() {\n    $.inview.lock(this.constructor.type + 'View');\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    this.$el.css('opacity', 0);\n    this.listenTo(this.model, 'change:_isReady', this.isReady);\n    this._loadingErrorTimeout = setTimeout(() => data.logReadyError(this), 10000);\n  }\n\n  render() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`, this);\n\n    if (this.isReact) {\n      this.changed();\n    } else {\n      const data = this.model.toJSON();\n      data.view = this;\n      const template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    }\n\n    Adapt.trigger(`${type}View:render contentObjectView:render view:render`, this);\n\n    _.defer(() => {\n      // don't call postRender after remove\n      if (this._isRemoved) return;\n\n      this.postRender();\n      Adapt.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`, this);\n    });\n\n    return this;\n  }\n\n  async isReady() {\n    if (!this.model.get('_isReady') || this._isTriggeredReady) return;\n    this._isTriggeredReady = true;\n    clearTimeout(this._loadingErrorTimeout);\n    delete this._loadingErrorTimeout;\n    const type = this.constructor.type;\n    const performIsReady = async () => {\n      Adapt.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`, this);\n      await wait.queue();\n      $('.js-loading').hide();\n      if (Adapt.get('_shouldContentObjectScrollTop') !== false) {\n        $(window).scrollTop(0);\n      }\n      Adapt.trigger(`${type}View:ready contentObjectView:ready view:ready`, this);\n      $.inview.unlock(`${type}View`);\n      const styleOptions = { opacity: 1 };\n      if (this.disableAnimation) {\n        this.$el.css(styleOptions);\n        $.inview();\n        _.defer(() => {\n          Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\n        });\n      } else {\n        this.$el.velocity(styleOptions, {\n          duration: 'fast',\n          complete: () => {\n            $.inview();\n            Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\n          }\n        });\n      }\n      $(window).scroll();\n    };\n\n    _.defer(performIsReady);\n  }\n\n  /**\n   * Force render up to specified id. Resolves when views are ready.\n   * @param {string} id\n   */\n  async renderTo(id) {\n    const isRenderToSelf = (id === this.model.get('_id'));\n    if (isRenderToSelf) return;\n    let models = this.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable'));\n    const index = models.findIndex(model => model.get('_id') === id);\n    if (index === -1) {\n      throw new Error(`Cannot renderTo \"${id}\" as it isn't a descendant.`);\n    }\n    // Return early if the model is already rendered and ready\n    const model = models[index];\n    if (model.get('_isRendered') && model.get('_isReady')) {\n      return;\n    }\n    // Force all models up until the id to render\n    models = models.slice(0, index + 1);\n    const isLocked = models.some(model => model.get('_isLocked'));\n    if (isLocked) throw new Error(`Cannot renderTo ${id} as it is preceded by locked content`);\n    const ids = _.indexBy(models, (model) => model.get('_id'));\n    const forceUntilId = (event) => {\n      const addingId = event.model.get('_id');\n      if (!ids[addingId]) return;\n      event.force();\n      if (addingId !== id) return;\n      Adapt.off('view:addChild', forceUntilId);\n    };\n    Adapt.on('view:addChild', forceUntilId);\n    // Trigger addChildren cascade\n    await this.addChildren();\n    await this.whenReady();\n    // Error if model isn't rendered and ready\n    if (!model.get('_isRendered') || !model.get('_isReady')) {\n      throw new Error(`Cannot renderTo \"${id}\".`);\n    }\n  }\n\n  preRemove() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`, this);\n  }\n\n  remove() {\n    const type = this.constructor.type;\n    this.preRemove();\n    Adapt.trigger(`${type}View:remove contentObjectView:remove view:remove`, this);\n    this._isRemoved = true;\n\n    wait.for(end => {\n      if (this.isReact) {\n        ReactDOM.unmountComponentAtNode(this.el);\n      }\n      this.$el.off('onscreen.adaptView');\n      this.findDescendantViews().reverse().forEach(view => {\n        view.remove();\n      });\n      this.setChildViews(null);\n      super.remove();\n      _.defer(() => {\n        Adapt.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`, this);\n        this.trigger('postRemove');\n      });\n      end();\n    });\n\n    return this;\n  }\n\n  destroy() {\n    this.remove();\n    if (Adapt.parentView === this) {\n      Adapt.parentView = null;\n    }\n  }\n\n}\n","import components from 'core/js/components';\nimport ContentObjectView from 'core/js/views/contentObjectView';\n\nclass PageView extends ContentObjectView {\n\n  remove() {\n    if (this.$pageLabel) {\n      this.$pageLabel.remove();\n    }\n    super.remove();\n  }\n\n}\n\nObject.assign(PageView, {\n  childContainer: '.article__container',\n  type: 'page',\n  template: 'page'\n});\n\ncomponents.register('page', { view: PageView });\n\nexport default PageView;\n","import components from 'core/js/components';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass ArticleView extends AdaptView {\n\n  className() {\n    return [\n      'article',\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n}\n\nObject.assign(ArticleView, {\n  childContainer: '.block__container',\n  type: 'article',\n  template: 'article'\n});\n\ncomponents.register('article', { view: ArticleView });\n\nexport default ArticleView;\n","import components from 'core/js/components';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass BlockView extends AdaptView {\n\n  className() {\n    return [\n      'block',\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n}\n\nObject.assign(BlockView, {\n  childContainer: '.component__container',\n  type: 'block',\n  template: 'block'\n});\n\ncomponents.register('block', { view: BlockView });\n\nexport default BlockView;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport Data from 'core/js/data';\nimport AdaptSubsetCollection from 'core/js/collections/adaptSubsetCollection';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\nimport ArticleModel from 'core/js/models/articleModel';\nimport BlockModel from 'core/js/models/blockModel';\nimport ComponentModel from 'core/js/models/componentModel';\n\nimport 'core/js/models/courseModel';\nimport 'core/js/models/menuModel';\nimport 'core/js/models/pageModel';\nimport 'core/js/views/pageView';\nimport 'core/js/views/articleView';\nimport 'core/js/views/blockView';\n\nclass MPABC extends Backbone.Controller {\n\n  initialize() {\n    // Example of how to cause the data loader to wait for another module to setup\n    this.listenTo(Data, {\n      loading: this.waitForDataLoaded,\n      loaded: this.onDataLoaded\n    });\n    this.setupSubsetCollections();\n  }\n\n  waitForDataLoaded() {\n    // Tell the data loader to wait\n    wait.begin();\n  }\n\n  onDataLoaded() {\n    // Tell the data loader that we have finished\n    wait.end();\n  }\n\n  setupSubsetCollections() {\n    Adapt.contentObjects = new AdaptSubsetCollection(null, { parent: Data, model: ContentObjectModel });\n    Adapt.articles = new AdaptSubsetCollection(null, { parent: Data, model: ArticleModel });\n    Adapt.blocks = new AdaptSubsetCollection(null, { parent: Data, model: BlockModel });\n    Adapt.components = new AdaptSubsetCollection(null, { parent: Data, model: ComponentModel });\n  }\n\n}\n\nconst mpabc = new MPABC();\nexport default mpabc;\n","import Adapt from 'core/js/adapt';\n\nexport default class NotifyPushView extends Backbone.View {\n\n  className() {\n    const classes = [\n      'notify-push',\n      this.model.get('_classes'),\n      this.model.get('_type') === 'a11y-push' && 'aria-label'\n    ].filter(Boolean).join('.');\n    return classes;\n  }\n\n  attributes() {\n    return {\n      role: 'dialog',\n      'aria-labelledby': 'notify-push-heading',\n      'aria-modal': 'false'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, {\n      'notify:pushShown notify:pushRemoved': this.updateIndexPosition,\n      remove: this.remove\n    });\n\n    this.listenTo(this.model.collection, {\n      remove: this.updateIndexPosition,\n      'change:_index': this.updatePushPosition\n    });\n\n    this.preRender();\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .js-notify-push-close-btn': 'closePush',\n      'click .js-notify-push-inner': 'triggerEvent'\n    };\n  }\n\n  preRender() {\n    this.hasBeenRemoved = false;\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.notifyPush;\n    this.$el.html(template(data)).appendTo('.notify__push-container');\n\n    _.defer(this.postRender.bind(this));\n\n    return this;\n  }\n\n  postRender() {\n    this.$el.addClass('is-active');\n\n    _.delay(this.closePush.bind(this), this.model.get('_timeout'));\n\n    Adapt.trigger('notify:pushShown');\n  }\n\n  closePush(event) {\n    if (event) {\n      event.preventDefault();\n    }\n\n    // Check whether this view has been removed as the delay can cause it to be fired twice\n    if (this.hasBeenRemoved === false) {\n\n      this.hasBeenRemoved = true;\n\n      this.$el.removeClass('is-active');\n\n      _.delay(() => {\n        this.model.collection.remove(this.model);\n        Adapt.trigger('notify:pushRemoved', this);\n        this.remove();\n      }, 600);\n    }\n  }\n\n  triggerEvent(event) {\n    Adapt.trigger(this.model.get('_callbackEvent'));\n    this.closePush();\n  }\n\n  updateIndexPosition() {\n    if (this.hasBeenRemoved) return;\n    const models = this.model.collection.models;\n    models.forEach((model, index) => {\n      if (!model.get('_isActive')) return;\n      model.set('_index', index);\n      this.updatePushPosition();\n    });\n  }\n\n  updatePushPosition() {\n    if (this.hasBeenRemoved) {\n      return;\n    }\n\n    if (typeof this.model.get('_index') !== 'undefined') {\n      const elementHeight = this.$el.height();\n      const offset = 20;\n      const navigationHeight = $('.nav').height();\n      const currentIndex = this.model.get('_index');\n      let flippedIndex = (currentIndex === 0) ? 1 : 0;\n\n      if (this.model.collection.where({ _isActive: true }).length === 1) {\n        flippedIndex = 0;\n      }\n\n      const positionLowerPush = (elementHeight + offset) * flippedIndex + navigationHeight + offset;\n      this.$el.css('top', positionLowerPush);\n    }\n  }\n}\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class NotifyModel extends LockingModel {\n\n  defaults() {\n    return {\n      _isActive: false,\n      _showIcon: false,\n      _timeout: 3000\n    };\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport NotifyPushView from 'core/js/views/notifyPushView';\nimport NotifyModel from 'core/js/models/notifyModel';\n\n// Build a collection to store push notifications\nexport default class NotifyPushCollection extends Backbone.Collection {\n\n  initialize() {\n    this.model = NotifyModel;\n    this.listenTo(this, 'add', this.onPushAdded);\n    this.listenTo(Adapt, 'notify:pushRemoved', this.onRemovePush);\n  }\n\n  onPushAdded(model) {\n    this.checkPushCanShow(model);\n  }\n\n  checkPushCanShow(model) {\n    if (!this.canShowPush()) return;\n    model.set('_isActive', true);\n    this.showPush(model);\n  }\n\n  canShowPush() {\n    const availablePushNotifications = this.where({ _isActive: true });\n    return (availablePushNotifications.length < 2);\n  }\n\n  showPush(model) {\n    new NotifyPushView({\n      model: model\n    });\n  }\n\n  onRemovePush(view) {\n    const inactivePushNotifications = this.where({ _isActive: false });\n    if (inactivePushNotifications.length > 0) {\n      this.checkPushCanShow(inactivePushNotifications[0]);\n    }\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport AdaptView from 'core/js/views/adaptView';\nimport Backbone from 'backbone';\n\nexport default class NotifyPopupView extends Backbone.View {\n\n  className() {\n    return `notify ${this.model.get('_classes') || ''}`;\n  }\n\n  attributes() {\n    return Object.assign({\n      role: 'dialog',\n      'aria-labelledby': 'notify-heading',\n      'aria-modal': 'true'\n    }, this.model.get('_attributes'));\n  }\n\n  events() {\n    return {\n      'click .js-notify-btn-alert': 'onAlertButtonClicked',\n      'click .js-notify-btn-prompt': 'onPromptButtonClicked',\n      'click .js-notify-close-btn': 'onCloseButtonClicked',\n      'click .js-notify-shadow-click': 'onShadowClicked'\n    };\n  }\n\n  initialize({ notify }) {\n    this.notify = notify;\n    _.bindAll(this, 'resetNotifySize', 'onKeyUp');\n    this.disableAnimation = Adapt.config.get('_disableAnimation') || false;\n    this.isOpen = false;\n    this.hasOpened = false;\n    this.setupEventListeners();\n    this.render();\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      remove: this.closeNotify,\n      'notify:resize': this.resetNotifySize,\n      'notify:cancel': this.cancelNotify,\n      'notify:close': this.closeNotify,\n      'device:resize': this.resetNotifySize\n    });\n    this.setupEscapeKey();\n  }\n\n  setupEscapeKey() {\n    $(window).on('keyup', this.onKeyUp);\n  }\n\n  onKeyUp(event) {\n    if (event.which !== 27) return;\n    event.preventDefault();\n    this.cancelNotify();\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.notifyPopup;\n    // hide notify container\n    this.$el.css('visibility', 'hidden');\n    // attach popup + shadow\n    this.$el.html(template(data)).appendTo('.notify__popup-container');\n    // hide popup\n    this.$('.notify__popup').css('visibility', 'hidden');\n    // show notify container\n    this.$el.css('visibility', 'visible');\n    this.showNotify();\n    return this;\n  }\n\n  onAlertButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger(this.model.get('_callbackEvent'), this);\n  }\n\n  onPromptButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger($(event.currentTarget).attr('data-event'), this);\n  }\n\n  onCloseButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.cancelNotify();\n  }\n\n  onShadowClicked(event) {\n    event.preventDefault();\n    if (this.model.get('_closeOnShadowClick') === false) return;\n    this.cancelNotify();\n  }\n\n  cancelNotify() {\n    if (this.model.get('_isCancellable') === false) return;\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger('notify:cancelled', this);\n  }\n\n  resetNotifySize() {\n    if (!this.hasOpened) return;\n    this.resizeNotify();\n  }\n\n  resizeNotify() {\n    const windowHeight = $(window).height();\n    const notifyHeight = this.$('.notify__popup-inner').outerHeight();\n    const isFullWindow = (notifyHeight >= windowHeight);\n    this.$('.notify__popup').css({\n      height: isFullWindow ? '100%' : 'auto',\n      top: isFullWindow ? 0 : '',\n      'margin-top': isFullWindow ? '' : -(notifyHeight / 2),\n      'overflow-y': isFullWindow ? 'scroll' : '',\n      '-webkit-overflow-scrolling': isFullWindow ? 'touch' : ''\n    });\n  }\n\n  async showNotify() {\n    this.isOpen = true;\n    await this.addSubView();\n    // Add to the list of open popups\n    this.notify.stack.push(this);\n    // Keep focus from previous action\n    this.$previousActiveElement = $(document.activeElement);\n    Adapt.trigger('notify:opened', this);\n    this.$el.imageready(this.onLoaded.bind(this));\n  }\n\n  onLoaded() {\n    if (this.disableAnimation) {\n      this.$('.notify__shadow').css('display', 'block');\n    } else {\n      this.$('.notify__shadow').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\n        duration: 400,\n        begin: () => {\n          this.$('.notify__shadow').css('display', 'block');\n        }\n      });\n    }\n    this.resizeNotify();\n    if (this.disableAnimation) {\n      this.$('.notify__popup').css('visibility', 'visible');\n      this.onOpened();\n    } else {\n      this.$('.notify__popup').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\n        duration: 400,\n        begin: () => {\n          // Make sure to make the notify visible and then set\n          // focus, disabled scroll and manage tabs\n          this.$('.notify__popup').css('visibility', 'visible');\n          this.onOpened();\n        }\n      });\n    }\n  }\n\n  onOpened() {\n    $.inview();\n    this.hasOpened = true;\n    // Allows popup manager to control focus\n    a11y.popupOpened(this.$el);\n    a11y.scrollDisable('body');\n    $('html').addClass('notify');\n    // Set focus to first accessible element\n    a11y.focusFirst(this.$('.notify__popup'), { defer: false });\n  }\n\n  async addSubView() {\n    this.subView = this.model.get('_view');\n    if (this.model.get('_shouldRenderId') && this.model.get('_id')) {\n      // Automatically render the specified id\n      const model = data.findById(this.model.get('_id'));\n      const View = components.getViewClass(model);\n      this.subView = new View({ model });\n    }\n    if (!this.subView) return;\n    this.subView.$el.on('resize', this.resetNotifySize);\n    this.$('.notify__content-inner').append(this.subView.$el);\n    if (!(this.subView instanceof AdaptView) || this.subView.model.get('_isReady')) return;\n    // Wait for the AdaptView subview to be ready\n    return new Promise(resolve => {\n      const check = (model, value) => {\n        if (!value) return;\n        this.subView.model.off('change:_isReady', check);\n        resolve();\n      };\n      this.subView.model.on('change:_isReady', check);\n    });\n  }\n\n  closeNotify() {\n    // Make sure that only the top most notify is closed\n    const stackItem = this.notify.stack[this.notify.stack.length - 1];\n    if (this !== stackItem) return;\n    this.notify.stack.pop();\n    // Prevent from being invoked multiple times - see https://github.com/adaptlearning/adapt_framework/issues/1659\n    if (!this.isOpen) return;\n    this.isOpen = false;\n    // If closeNotify is called before showNotify has finished then wait\n    // until it's open.\n    if (this.hasOpened) {\n      this.onCloseReady();\n      return;\n    }\n    this.listenToOnce(Adapt, 'popup:opened', () => {\n      // Wait for popup:opened to finish processing\n      _.defer(this.onCloseReady.bind(this));\n    });\n  }\n\n  onCloseReady() {\n    if (this.disableAnimation) {\n      this.$('.notify__popup').css('visibility', 'hidden');\n      this.$el.css('visibility', 'hidden');\n      this.remove();\n    } else {\n      this.$('.notify__popup').velocity({ opacity: 0 }, {\n        duration: 400,\n        complete: () => {\n          this.$('.notify__popup').css('visibility', 'hidden');\n        }\n      });\n      this.$('.notify__shadow').velocity({ opacity: 0 }, {\n        duration: 400,\n        complete: () => {\n          this.$el.css('visibility', 'hidden');\n          this.remove();\n        }\n      });\n    }\n    a11y.scrollEnable('body');\n    $('html').removeClass('notify');\n    // Return focus to previous active element\n    a11y.popupClosed(this.$previousActiveElement);\n    // Return reference to the notify view\n    Adapt.trigger('notify:closed', this);\n  }\n\n  remove(...args) {\n    this.removeSubView();\n    $(window).off('keyup', this.onKeyUp);\n    super.remove(...args);\n  }\n\n  removeSubView() {\n    if (!this.subView) return;\n    this.subView.$el.off('resize', this.resetNotifySize);\n    if (this.subView instanceof AdaptView) {\n      // Clear up nested views and models\n      const views = [...this.subView.findDescendantViews(), this.subView];\n      views.forEach(view => {\n        view.model.set('_isReady', false);\n        view.remove();\n      });\n    } else {\n      this.subView.remove();\n    }\n    this.subView = null;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport NotifyPushCollection from 'core/js/collections/notifyPushCollection';\nimport NotifyPopupView from 'core/js/views/notifyPopupView';\nimport NotifyModel from 'core/js/models/notifyModel';\n\nexport default class NotifyView extends Backbone.View {\n\n  className() {\n    return 'notify__container';\n  }\n\n  initialize() {\n    this._stack = [];\n    this.notifyPushes = new NotifyPushCollection();\n    this.listenTo(Adapt, {\n      'notify:popup': this._deprecated.bind(this, 'popup'),\n      'notify:alert': this._deprecated.bind(this, 'alert'),\n      'notify:prompt': this._deprecated.bind(this, 'prompt'),\n      'notify:push': this._deprecated.bind(this, 'push')\n    });\n    this.render();\n  }\n\n  get stack() {\n    return this._stack;\n  }\n\n  get isOpen() {\n    return (this.stack.length > 0);\n  }\n\n  _deprecated(type, notifyObject) {\n    logging.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use notify.${type}(notifyObject);`);\n    return this.create(notifyObject, { _type: type });\n  }\n\n  render() {\n    const notifyTemplate = Handlebars.templates.notify;\n    this.$el.html(notifyTemplate());\n    this.$el.appendTo('body');\n  }\n\n  create(notifyObject, defaults) {\n    notifyObject = _.defaults({}, notifyObject, defaults, {\n      _type: 'popup',\n      _shouldRenderId: false,\n      _isCancellable: true,\n      _showCloseButton: true,\n      _closeOnShadowClick: true\n    });\n\n    switch (notifyObject._type) {\n      case 'a11y-push':\n      case 'push':\n        this.notifyPushes.push(notifyObject);\n        return;\n    }\n\n    return new NotifyPopupView({\n      model: new NotifyModel(notifyObject),\n      notify: this\n    });\n  }\n\n  /**\n   * Creates a 'popup' notify\n   * @param {Object} notifyObject An object containing all the settings for the popup\n   * @param {string} notifyObject.title Title of the popup\n   * @param {string} notifyObject.body Body of the popup\n   * @param {Boolean} [notifyObject._showCloseButton=true] If set to `false` the popup will not have a close button. The learner will still be able to dismiss the popup by clicking outside of it or by pressing the Esc key. This setting is typically used mainly for popups that have a subview (where the subview contains the close button)\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` the learner will not be able to close the popup - use with caution!\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  popup(notifyObject) {\n    return this.create(notifyObject, { _type: 'popup' });\n  }\n\n  /**\n   * Creates an 'alert' notify popup\n   * @param {Object} notifyObject An object containing all the settings for the alert popup\n   * @param {string} notifyObject.title Title of the alert popup\n   * @param {string} notifyObject.body Body of the alert popup\n   * @param {string} notifyObject.confirmText Label for the popup confirm button\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the popup\n   * @param {Boolean} [notifyObject._showIcon=false] If set to `true` an 'alert' icon will be displayed in the popup\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  alert(notifyObject) {\n    return this.create(notifyObject, { _type: 'alert' });\n  }\n\n  /**\n   * Creates a 'prompt dialog' notify popup\n   * @param {Object} notifyObject An object containing all the settings for the prompt dialog\n   * @param {string} notifyObject.title Title of the prompt\n   * @param {string} notifyObject.body Body of the prompt\n   * @param {Object[]} notifyObject._prompts Array of objects that each define a button (and associated callback event) that you want shown in the prompt\n   * @param {string} notifyObject._prompts[].promptText Label for this button\n   * @param {string} notifyObject._prompts[]._callbackEvent Event to be triggered when this button is clicked\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the prompt\n   * @param {Boolean} [notifyObject._showIcon=true] If set to `true` a 'query' icon will be displayed in the popup\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  prompt(notifyObject) {\n    return this.create(notifyObject, { _type: 'prompt' });\n  }\n\n  /**\n   * Creates a 'push notification'\n   * @param {Object} notifyObject An object containing all the settings for the push notification\n   * @param {string} notifyObject.title Title of the push notification\n   * @param {string} notifyObject.body Body of the push notification\n   * @param {Number} [notifyObject._timeout=3000] Length of time (in milliseconds) the notification should left on-screen before automatically fading away\n   * @param {string} notifyObject._callbackEvent Event to be triggered if the learner clicks on the push notification (not triggered if they use the close button)\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   */\n  push(notifyObject) {\n    return this.create(notifyObject, { _type: 'push' });\n  }\n\n}\n","import NotifyView from 'core/js/views/notifyView';\n\nconst notify = new NotifyView();\nexport default notify;\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class RouterModel extends LockingModel {\n\n  defaults() {\n    return {\n      _canNavigate: true,\n      _shouldNavigateFocus: true\n    };\n  }\n\n  lockedAttributes() {\n    return {\n      _canNavigate: false,\n      _shouldNavigateFocus: false\n    };\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport RouterModel from 'core/js/models/routerModel';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\n\nclass Router extends Backbone.Router {\n\n  routes() {\n    return {\n      '': 'handleRoute',\n      'id/:id': 'handleRoute',\n      ':pluginName(/*location)(/*action)': 'handleRoute'\n    };\n  }\n\n  initialize({ model }) {\n    this.navigateToElement = this.navigateToElement.bind(this);\n    this._isBackward = false;\n    this.model = model;\n    this._navigationRoot = null;\n    // Flag to indicate if the router has tried to redirect to the current location.\n    this._isCircularNavigationInProgress = false;\n    this.showLoading();\n    // Store #wrapper element and html to cache for later use.\n    this.$wrapper = $('#wrapper');\n    this.$html = $('html');\n    this.listenToOnce(Adapt, 'app:dataReady', this.setDocumentTitle);\n    this.listenTo(Adapt, 'router:navigateTo', this.navigateToArguments);\n  }\n\n  get rootModel() {\n    return this._navigationRoot || Adapt.course;\n  }\n\n  set rootModel(model) {\n    this._navigationRoot = model;\n  }\n\n  showLoading() {\n    $('.js-loading').show();\n  }\n\n  hideLoading() {\n    $('.js-loading').hide();\n  }\n\n  setDocumentTitle() {\n    const currentModel = location._currentModel;\n    const hasSubTitle = (currentModel && currentModel !== router.rootModel && currentModel.get('title'));\n    const title = [\n      this.rootModel.get('title'),\n      hasSubTitle && currentModel.get('title')\n    ].filter(Boolean).join(' | ');\n    this.listenToOnce(Adapt, 'contentObjectView:preRender', () => {\n      const escapedTitle = $(`<div>${title}</div>`).text();\n      document.title = escapedTitle;\n    });\n  }\n\n  navigateToArguments(args) {\n    args = args.filter(v => v !== null);\n    const options = { trigger: false, replace: false };\n    if (args.length === 1 && data.findById(args[0])) {\n      this.navigate('#/id/' + args[0], options);\n      return;\n    }\n    if (args.length <= 3) {\n      this.navigate('#/' + args.join('/'), options);\n      return;\n    }\n    logging.deprecated('Use Backbone.history.navigate or window.location.href instead of Adapt.trigger(\\'router:navigateTo\\')');\n    this.handleRoute(...args);\n  }\n\n  handleRoute(...args) {\n    args = args.filter(v => v !== null);\n\n    if (this.model.get('_canNavigate')) {\n      // Reset _isCircularNavigationInProgress protection as code is allowed to navigate away.\n      this._isCircularNavigationInProgress = false;\n    }\n\n    // Check if the current page is in the process of navigating to itself.\n    // It will redirect to itself if the URL was changed and _canNavigate is false.\n    if (this._isCircularNavigationInProgress === false) {\n      // Trigger an event pre 'router:location' to allow extensions to stop routing.\n      Adapt.trigger('router:navigate', args);\n    }\n\n    // Re-check as _canNavigate can be set to false on 'router:navigate' event.\n    if (this.model.get('_canNavigate')) {\n      // Disable navigation whilst rendering.\n      this.model.set('_canNavigate', false, { pluginName: 'adapt' });\n      this._isBackward = false;\n      if (args.length <= 1) {\n        return this.handleId(...args);\n      }\n      return this.handlePluginRouter(...args);\n    }\n\n    if (this._isCircularNavigationInProgress) {\n      // Navigation correction finished.\n      // Router has successfully re-navigated to the current _id as the URL was changed\n      // while _canNavigate: false\n      this._isCircularNavigationInProgress = false;\n      return;\n    }\n\n    // Cancel navigation to stay at the current location.\n    this._isCircularNavigationInProgress = true;\n    Adapt.trigger('router:navigationCancelled', args);\n\n    // Reset URL to the current one.\n    // https://github.com/adaptlearning/adapt_framework/issues/3061\n    Backbone.history.history[this._isBackward ? 'forward' : 'back']();\n    this._isBackward = false;\n  }\n\n  async handlePluginRouter(pluginName, location, action) {\n    const pluginLocation = [\n      pluginName,\n      location && `-${location}`,\n      action && `-${action}`\n    ].filter(Boolean).join('');\n    await this.updateLocation(pluginLocation, null, null, null);\n\n    Adapt.trigger('router:plugin:' + pluginName, pluginName, location, action);\n    Adapt.trigger('router:plugin', pluginName, location, action);\n    this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n  }\n\n  async handleId(id) {\n    const rootModel = router.rootModel;\n    let model = (!id) ? rootModel : data.findById(id);\n\n    if (!model) {\n      // Bad id\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      return;\n    }\n\n    // Keep the routed id incase it needs to be scrolled to later\n    const isContentObject = model.isTypeGroup?.('contentobject');\n    const navigateToId = model.get('_id');\n\n    // Ensure that the router is rendering a contentobject\n    model = isContentObject ? model : model.findAncestor('contentobject');\n    id = model.get('_id');\n\n    const isRoot = (model === rootModel);\n    if (isRoot && Adapt.course.has('_start')) {\n      // Do not allow access to the menu when the start controller is enabled.\n      const startController = Adapt.course.get('_start');\n      if (startController._isEnabled === true && startController._isMenuDisabled === true) {\n        return;\n      }\n    }\n\n    if (model.get('_isLocked') && Adapt.config.get('_forceRouteLocking')) {\n      // Locked id\n      logging.warn('Unable to navigate to locked id: ' + id);\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      if (location._previousId === undefined) {\n        return this.navigate('#/', { trigger: true, replace: true });\n      }\n      return this.navigateBack();\n    }\n\n    // Move to a content object\n    this.showLoading();\n    await Adapt.remove();\n\n    /**\n     * TODO:\n     * As the course object has separate location and type rules,\n     * it makes it more difficult to update the location object\n     * should stop doing this.\n     */\n    const isCourse = model.isTypeGroup?.('course');\n    const type = isCourse ? 'menu' : model.get('_type');\n    const newLocation = isCourse ? 'course' : `${type}-${id}`;\n\n    model.set('_isVisited', true);\n    await this.updateLocation(newLocation, type, id, model);\n\n    Adapt.once('contentObjectView:ready', () => {\n      // Allow navigation.\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      this.handleNavigationFocus();\n    });\n    Adapt.trigger(`router:${type} router:contentObject`, model);\n\n    const ViewClass = components.getViewClass(model);\n    const isMenu = model.isTypeGroup?.('menu');\n    if (!ViewClass && isMenu) {\n      logging.deprecated(`Using event based menu view instantiation for '${components.getViewName(model)}'`);\n      return;\n    }\n\n    if (!isMenu) {\n      // checkIfResetOnRevisit where exists on descendant models before render\n      _.invoke(model.getAllDescendantModels(), 'checkIfResetOnRevisit');\n      // wait for completion to settle\n      await Adapt.deferUntilCompletionChecked();\n    }\n\n    this.$wrapper.append(new ViewClass({ model }).$el);\n\n    if (!isContentObject && !this.isScrolling) {\n      // Scroll to element if not a content object or not already trying to\n      await this.navigateToElement('.' + navigateToId, { replace: true, duration: 400 });\n    }\n\n  }\n\n  async updateLocation(currentLocation, type, id, currentModel) {\n    // Handles updating the location.\n    location._previousModel = location._currentModel;\n    location._previousId = location._currentId;\n    location._previousContentType = location._contentType;\n\n    location._currentModel = currentModel;\n    location._currentId = id;\n    location._contentType = type;\n    location._currentLocation = currentLocation;\n\n    /**\n     * TODO:\n     * this if block should be removed,\n     * these properties are unused in the framework\n     */\n    if (type === 'menu') {\n      location._lastVisitedType = 'menu';\n      location._lastVisitedMenu = id;\n    } else if (type === 'page') {\n      location._lastVisitedType = 'page';\n      location._lastVisitedPage = id;\n    }\n\n    this.setDocumentTitle();\n    this.setGlobalClasses();\n\n    // Trigger event when location changes.\n    Adapt.trigger('router:location', location);\n\n    await wait.queue();\n  }\n\n  setGlobalClasses() {\n    const currentModel = location._currentModel;\n\n    const htmlClasses = currentModel?.get('_htmlClasses') || '';\n    const classes = (location._currentId) ?\n      `location-${location._contentType} location-id-${location._currentId}` :\n      `location-${location._currentLocation}`;\n    const currentClasses = `${classes} ${htmlClasses}`;\n\n    this.$html\n      .removeClass(location._previousClasses)\n      .addClass(currentClasses)\n      .attr('data-location', location._currentLocation);\n\n    this.$wrapper\n      .removeClass()\n      .addClass(classes)\n      .attr('data-location', location._currentLocation);\n\n    location._previousClasses = currentClasses;\n  }\n\n  handleNavigationFocus() {\n    if (!this.model.get('_shouldNavigateFocus')) return;\n    // Body will be forced to accept focus to start the\n    // screen reader reading the page.\n    a11y.focus('body');\n  }\n\n  navigateBack() {\n    this._isBackward = true;\n    Backbone.history.history.back();\n  }\n\n  navigateToCurrentRoute(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    if (!location._currentId) {\n      return;\n    }\n    const currentId = location._currentModel.get('_id');\n    const isRoot = (location._currentModel === this.rootModel);\n    const route = isRoot ? '#/' : '#/id/' + currentId;\n    this.navigate(route, { trigger: true, replace: true });\n  }\n\n  navigateToPreviousRoute(force) {\n    // Sometimes a plugin might want to stop the default navigation.\n    // Check whether default navigation has changed.\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    const currentModel = location._currentModel;\n    const previousModel = location._previousModel;\n    if (!currentModel) {\n      return this.navigateBack();\n    }\n    if (location._currentModel?.isTypeGroup('menu')) {\n      return this.navigateToParent();\n    }\n    if (previousModel) {\n      return this.navigateBack();\n    }\n    this.navigateToParent();\n  }\n\n  navigateToParent(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    const parentId = location._currentModel.get('_parentId');\n    const parentModel = data.findById(parentId);\n    const isRoot = (parentModel === this.rootModel);\n    const route = isRoot ? '#/' : '#/id/' + parentId;\n    this.navigate(route, { trigger: true });\n  }\n\n  navigateToHomeRoute(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    this.navigate('#/', { trigger: true });\n  }\n\n  /**\n   * Allows a selector or id to be passed in and Adapt will navigate to this element. Resolves\n   * asynchronously when the element has been navigated to.\n   * @param {JQuery|string} selector CSS selector or id of the Adapt element you want to navigate to e.g. `\".co-05\"` or `\"co-05\"`\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async navigateToElement(selector, settings = {}) {\n    const currentModelId = typeof selector === 'string' && selector.replace(/\\./g, '').split(' ')[0];\n    const isSelectorAnId = data.hasId(currentModelId);\n\n    if (isSelectorAnId) {\n      const currentModel = data.findById(currentModelId);\n      const contentObject = currentModel.isTypeGroup?.('contentobject') ? currentModel : currentModel.findAncestor('contentobject');\n      const contentObjectId = contentObject.get('_id');\n      const isNotInCurrentContentObject = (contentObjectId !== location._currentId);\n\n      if (currentModel && (!currentModel.get('_isRendered') || !currentModel.get('_isReady') || isNotInCurrentContentObject)) {\n        const shouldReplace = settings.replace || false;\n        if (isNotInCurrentContentObject) {\n          this.isScrolling = true;\n          this.navigate(`#/id/${currentModelId}`, { trigger: true, replace: shouldReplace });\n          this.model.set('_shouldNavigateFocus', false, { pluginName: 'adapt' });\n          await new Promise(resolve => Adapt.once('contentObjectView:ready', _.debounce(() => {\n            this.model.set('_shouldNavigateFocus', true, { pluginName: 'adapt' });\n            resolve();\n          }, 1)));\n          this.isScrolling = false;\n        }\n        await Adapt.parentView.renderTo(currentModelId);\n      }\n\n      // Correct selector when passed a pure id\n      if (currentModel && selector === currentModel.get('_id')) {\n        selector = `.${selector}`;\n      }\n    }\n\n    const isElementUnavailable = !$(selector).length;\n    if (isElementUnavailable) {\n      logging.warn(`router.navigateToElement, selector not found in document: ${selector}`);\n      return;\n    }\n\n    // Get the current location - this is set in the router\n    const newLocation = (location._contentType)\n      ? location._contentType\n      : location._currentLocation;\n    // Trigger initial scrollTo event\n    Adapt.trigger(`${newLocation}:scrollTo`, selector);\n    // Setup duration variable\n    const disableScrollToAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    if (disableScrollToAnimation) {\n      settings.duration = 0;\n    } else if (!settings.duration) {\n      settings.duration = $.scrollTo.defaults.duration;\n    }\n\n    const $wrapper = $('#wrapper');\n    // Work out offset from the top of the wrapper rather than the height of the navigation bar\n    let offsetTop = -parseInt($wrapper.css('padding-top'));\n    // Prevent scroll issue when component description aria-label coincident with top of component\n    if ($(selector).hasClass('component')) {\n      offsetTop -= $(selector).find('.aria-label').height() || 0;\n    }\n\n    if (!settings.offset) settings.offset = { top: offsetTop, left: 0 };\n    if (settings.offset.top === undefined) settings.offset.top = offsetTop;\n    if (settings.offset.left === undefined) settings.offset.left = 0;\n\n    if (settings.offset.left === 0) settings.axis = 'y';\n\n    if (Adapt.get('_canScroll') !== false) {\n      // Trigger scrollTo plugin\n      $.scrollTo(selector, settings);\n    }\n\n    // Trigger an event after animation\n    // 300 milliseconds added to make sure queue has finished\n    await new Promise(resolve => {\n      _.delay(() => {\n        a11y.focusNext(selector);\n        Adapt.trigger(`${location}:scrolledTo`, selector);\n        resolve();\n      }, settings.duration + 300);\n    });\n  }\n\n  get(...args) {\n    logging.deprecated('router.get, please use router.model.get');\n    return this.model.get(...args);\n  }\n\n  set(...args) {\n    logging.deprecated('router.set, please use router.model.set');\n    return this.model.set(...args);\n  }\n\n}\n\nconst router = new Router({\n  model: new RouterModel(null, { reset: true })\n});\nexport default router;\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport router from 'core/js/router';\n\n/**\n * This allows Adapt to:\n * - Be embedded in iframes on ios\n *   ios iframes assume the content height and no scrolling\n *   https://blog.codepen.io/2017/12/01/stupid-iframes-stupid-ios/\n *   https://stackoverflow.com/questions/23083462/how-to-get-an-iframe-to-be-responsive-in-ios-safari\n * - Prevent the 44px click region occluding trickle at the bottom of\n *   ios safari by keeping the controls always visible\n *   https://github.com/adaptlearning/adapt-contrib-trickle/issues/132\n *   https://www.eventbrite.com/engineering/mobile-safari-why/\n */\nclass Scrolling extends Backbone.Controller {\n\n  initialize() {\n    this.scrollTo = this.scrollTo.bind(this);\n    this.$html = $('html');\n    this.isLegacyScrolling = true;\n    Adapt.once('configModel:dataLoaded', this._loadConfig.bind(this));\n  }\n\n  _loadConfig() {\n    const config = Adapt.config.get('_scrollingContainer');\n    if (!config?._isEnabled) return;\n    const limitTo = config._limitToSelector;\n    const isIncluded = !limitTo || (this.$html.is(limitTo) || this.$html.hasClass(limitTo));\n    if (!isIncluded) return;\n    this.isLegacyScrolling = false;\n    this._windowScrollFix();\n    this._addStyling();\n    this._updateScrollbarWidth();\n    // Update the scrollbar width on zooming/resize as it changes in chrome and firefox\n    this.listenTo(Adapt, 'device:resize', this._updateScrollbarWidth);\n  }\n\n  _addStyling() {\n    this.$html.addClass('adapt-scrolling');\n  }\n\n  /**\n   * Set the --adapt-scrollbar-width css variable to be used to offset the navigation bar\n   * width against the body scrollbar\n   * The body scrollbar does not constrain the navigation width in the same way the viewport\n   * scrollbar does\n   * IE11 always defaults to 18px\n   * Chrome and firefox change based on zooming\n   * Safari has floating scrollbars, so 0px\n   */\n  _updateScrollbarWidth() {\n    const $tester = $('<div class=\"outer\" style=\"overflow:scroll; visibility: hidden; position:fixed; top: 0; left: 0;\"><div class=\"inner\"> </div></div>\"');\n    $('body').append($tester);\n    const scrollBarWidth = $tester.outerWidth() - $tester.find('.inner').outerWidth();\n    $tester.remove();\n    const documentStyle = document.documentElement.style;\n    documentStyle.setProperty('--adapt-scrollbar-width', `${scrollBarWidth}px`);\n  }\n\n  /**\n   * Correct scrolling to use the body element rather than the html element or viewport\n   */\n  _windowScrollFix() {\n    /** @type {HTMLDivElement} */\n    const body = document.body;\n    const html = Adapt.scrolling.$html[0];\n    const scrollY = {\n      get: () => body.scrollTop,\n      set: value => (body.scrollTop = value)\n    };\n    const scrollX = {\n      get: () => body.scrollLeft,\n      set: value => (body.scrollLeft = value)\n    };\n    const scrollHeight = {\n      get: () => body.scrollHeight,\n      set: value => (body.scrollHeight = value)\n    };\n    const scrollWidth = {\n      get: () => body.scrollWidth,\n      set: value => (body.scrollWidth = value)\n    };\n    // Fix window.scrollY, window.scrollX, window.pageYOffset and window.pageXOffset\n    Object.defineProperties(window, {\n      scrollY,\n      scrollX,\n      // Note: jQuery uses pageYOffset and pageXOffset instead of scrollY and scrollX\n      pageYOffset: scrollY,\n      pageXOffset: scrollX\n    });\n    // Fix html.scrollHeight and html.scrollWidth\n    Object.defineProperties(html, {\n      // Note: jQuery animate as used in scrollTo library, uses scrollHeight to determine animation maxiumum\n      scrollHeight,\n      scrollWidth\n    });\n    // Fix window.scrollTo\n    window.scrollTo = (...args) => {\n      const isObject = (args.length === 1 && typeof args[0] === 'object' && args[0] !== null);\n      const left = (isObject ? args[0].left : args[0]) ?? null;\n      const top = (isObject ? args[0].top : args[1]) ?? null;\n      left !== null && (body.scrollLeft = left);\n      top !== null && (body.scrollTop = top);\n    };\n    // Fix MouseEvent.prototype.pageX and MouseEvent.prototype.pageY\n    const MouseEvent = window.MouseEvent;\n    Object.defineProperties(MouseEvent.prototype, {\n      pageX: {\n        get: function() { return this.clientX + scrollX.get(); }\n      },\n      pageY: {\n        // Note: MediaElementJS uses event.pageY to work out the mouse position for the volume controls\n        get: function() { return this.clientY + scrollY.get(); }\n      }\n    });\n    // Trigger scroll events on window when scrolling\n    const $window = $(window);\n    $(document.body).on('scroll', () => $window.scroll());\n  }\n\n  /**\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\n   * asynchronously when the element has been navigated/scrolled to.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async scrollTo(selector, settings = {}) {\n    logging.deprecated('Adapt.scrollTo and Adapt.scrolling.scrollTo, use router.navigateToElement instead.');\n    return router.navigateToElement(selector, settings);\n  }\n\n}\n\nconst scrolling = new Scrolling();\nexport default scrolling;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\nimport router from 'core/js/router';\nimport data from 'core/js/data';\n\nclass StartController extends Backbone.Controller {\n\n  initialize(...args) {\n    super.initialize(...args);\n    this.model = null;\n  }\n\n  loadCourseData() {\n    this.model = new LockingModel(Adapt.course.get('_start'));\n  }\n\n  setStartLocation() {\n    if (!this.isEnabled()) return;\n    window.history.replaceState('', '', this.getStartHash());\n  }\n\n  returnToStartLocation() {\n    const startIds = this.model.get('_startIds');\n    if (startIds) {\n      // ensure we can return to the start page even if it is completed\n      startIds.forEach(startId => (startId._skipIfComplete = false));\n    }\n    window.location.hash = this.getStartHash(true);\n  }\n\n  /**\n   * Returns a string in URL.hash format representing the route that the course should be sent to\n   * @param {boolean} [alwaysForce] Ignore any route specified in location.hash and force use of the start page instead\n   * @return {string}\n   */\n  getStartHash(alwaysForce) {\n    const startId = this.getStartId();\n    const isRouteSpecified = window.location.href.indexOf('#') > -1;\n    const shouldForceStartId = alwaysForce || this.model.get('_force');\n    const shouldNavigateToStartId = startId && (!isRouteSpecified || shouldForceStartId);\n\n    if (shouldNavigateToStartId && startId !== Adapt.course.get('_id')) {\n      return '#/id/' + startId;\n    }\n\n    // If there's a route specified in location.hash, use that - otherwise go to main menu\n    return window.location.hash || '#/';\n  }\n\n  isEnabled() {\n    return Boolean(this.model?.get('_isEnabled'));\n  }\n\n  getStartId() {\n    let startId = this.model.get('_id');\n    const startIds = this.model.get('_startIds');\n\n    if (!startIds?.length) return startId;\n\n    const $html = $('html');\n    for (let i = 0, l = startIds.length; i < l; i++) {\n      const item = startIds[i];\n      const className = item._className;\n      const skipIfComplete = item._skipIfComplete;\n\n      const model = data.findById(item._id);\n\n      if (!model) {\n        console.log('startController: cannot find id', item._id);\n        continue;\n      }\n\n      if (skipIfComplete) {\n        if (model.get('_isComplete')) continue;\n      }\n\n      if (!className || $html.is(className) || $html.hasClass(className)) {\n        // See https://github.com/adaptlearning/adapt_framework/issues/1843\n        startId = item._id;\n        break;\n      }\n    }\n\n    return startId;\n  }\n\n}\n\nAdapt.once('adapt:start', () => {\n  startController.loadCourseData();\n  startController.setStartLocation();\n});\n\n/*\n* allows you to call returnToStartLocation either by calling `Adapt.trigger('navigation:returnToStart')`\n* or by including in the top navigation bar a button that has the attribute `data-event=\"returnToStart\"`\n*/\nAdapt.on('navigation:returnToStart', () => {\n  startController.returnToStartLocation();\n});\n\nAdapt.on('app:languageChanged', () => {\n  wait.for(done => {\n    startController.loadCourseData();\n    const hash = startController.isEnabled() ? startController.getStartHash(false) : '#/';\n    router.navigate(hash, { trigger: true, replace: true });\n    done();\n  });\n});\n\nconst startController = new StartController();\nexport default startController;\n","const COMPLETION_STATE = ENUM([\n  'INCOMPLETE',\n  'COMPLETED',\n  'PASSED',\n  'FAILED'\n]);\n\nexport default COMPLETION_STATE;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\n\nclass Tracking extends Backbone.Controller {\n\n  initialize() {\n    this._config = {\n      _requireContentCompleted: true,\n      _requireAssessmentCompleted: false,\n      _shouldSubmitScore: false\n    };\n    this._assessmentState = null;\n\n    Adapt.once('configModel:dataLoaded', this.loadConfig.bind(this));\n    Adapt.on('app:dataReady', this.setupEventListeners.bind(this));\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      'assessment:complete': this.onAssessmentComplete,\n      'assessment:restored': this.onAssessmentRestored\n    });\n\n    // Check if completion requires completing all content.\n    if (this._config._requireContentCompleted) {\n      this.listenTo(Adapt.course, 'change:_isComplete', this.checkCompletion);\n    }\n  }\n\n  /**\n   * Store the assessment state.\n   * @param {object} assessmentState - The object returned by Adapt.assessment.getState()\n   */\n  onAssessmentComplete(assessmentState) {\n    this._assessmentState = assessmentState;\n\n    this.submitScore();\n    // Check if completion requires passing an assessment.\n    if (this._config._requireAssessmentCompleted) {\n      this.checkCompletion();\n    }\n  }\n\n  submitScore() {\n    if (!this._config._shouldSubmitScore) return;\n\n    if (this._assessmentState.isPercentageBased) {\n      offlineStorage.set('score', this._assessmentState.scoreAsPercent, 0, 100);\n      return;\n    }\n\n    offlineStorage.set('score', this._assessmentState.score, this._assessmentState.minScore, this._assessmentState.maxScore);\n  }\n\n  /**\n   * Restores the _assessmentState object when an assessment is registered.\n   * @param {object} assessmentState - An object representing the overall assessment state\n   */\n  onAssessmentRestored(assessmentState) {\n    this._assessmentState = assessmentState;\n  }\n\n  /**\n   * Evaluate the course and assessment completion.\n   */\n  checkCompletion() {\n    const completionData = this.getCompletionData();\n\n    if (completionData.status === COMPLETION_STATE.INCOMPLETE) {\n      return;\n    }\n    \n    const canRetry = (completionData.assessment?.canRetry === true);\n    if (completionData.status === COMPLETION_STATE.FAILED && canRetry) {\n      return;\n    }\n\n    Adapt.trigger('tracking:complete', completionData);\n    logging.debug('tracking:complete', completionData);\n  }\n\n  /**\n   * The return value of this function should be passed to the trigger of 'tracking:complete'.\n   * @returns An object representing the user's course completion.\n   */\n  getCompletionData() {\n    const completionData = {\n      status: COMPLETION_STATE.INCOMPLETE,\n      assessment: null\n    };\n\n    // Course complete is required.\n    if (this._config._requireContentCompleted && !Adapt.course.get('_isComplete')) {\n      // INCOMPLETE: course not complete.\n      return completionData;\n    }\n\n    // Assessment completed required.\n    if (this._config._requireAssessmentCompleted) {\n      if (!this._assessmentState) {\n        // INCOMPLETE: assessment is not complete.\n        return completionData;\n      }\n\n      // PASSED/FAILED: assessment completed.\n      completionData.status = this._assessmentState.isPass ? COMPLETION_STATE.PASSED : COMPLETION_STATE.FAILED;\n      completionData.assessment = this._assessmentState;\n\n      return completionData;\n    }\n\n    // COMPLETED: criteria met, no assessment requirements.\n    completionData.status = COMPLETION_STATE.COMPLETED;\n\n    return completionData;\n  }\n\n  /**\n   * Set the _config object to the values retrieved from config.json.\n   */\n  loadConfig() {\n    this._config = Adapt.config.get('_completionCriteria') ?? this._config;\n    const newShouldSubmitScore = this._config._shouldSubmitScore;\n    const legacyShouldSubmitScore = Adapt.config.get('_spoor')?._tracking?._shouldSubmitScore;\n    // If the legacy property exists, use it for backward compatibility but warn in the console\n    if (legacyShouldSubmitScore !== undefined) logging.deprecated('config.json:_spoor._tracking._shouldSubmitScore, please use only config.json:_completionCriteria._shouldSubmitScore');\n    this._config._shouldSubmitScore = legacyShouldSubmitScore ?? newShouldSubmitScore ?? true;\n  }\n\n}\n\nconst tracking = new Tracking();\nexport default tracking;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport device from 'core/js/device';\nimport drawer from 'core/js/drawer';\nimport location from 'core/js/location';\nimport logging from 'core/js/logging';\nimport mpabc from 'core/js/mpabc';\nimport notify from 'core/js/notify';\nimport offlineStorage from 'core/js/offlineStorage';\nimport router from 'core/js/router';\nimport scrolling from 'core/js/scrolling';\nimport startController from 'core/js/startController';\nimport tracking from 'core/js/tracking';\nimport wait from 'core/js/wait';\n\n/** START REDUNDANT ADAPT WAIT BEHAVIOUR */\nconst beginWait = () => {\n  logging.deprecated('Use wait.begin() as Adapt.trigger(\\'plugin:beginWait\\') will be removed in the future');\n  wait.begin();\n};\n\nconst endWait = () => {\n  logging.deprecated('Use wait.end() as Adapt.trigger(\\'plugin:endWait\\') will be removed in the future');\n  wait.end();\n};\n\nconst ready = () => {\n  if (wait.isWaiting()) {\n    return;\n  }\n  const isEventListening = (Adapt._events['plugins:ready']);\n  if (!isEventListening) {\n    return;\n  }\n  logging.deprecated(\"Use wait.queue(callback) as Adapt.on('plugins:ready', callback) will be removed in the future\");\n  Adapt.trigger('plugins:ready');\n};\n\nAdapt.listenTo(wait, 'ready', ready);\nAdapt.on({\n  'plugin:beginWait': beginWait,\n  'plugin:endWait': endWait\n});\n/** END REDUNDANT ADAPT WAIT BEHAVIOUR */\n\nObject.defineProperties(Adapt, {\n  accessibility: {\n    get() {\n      a11y.log.deprecated('Adapt.accessibility has moved to a11y');\n      return a11y;\n    }\n  },\n  a11y: {\n    get() {\n      logging.deprecated('Adapt.a11y, please use core/js/a11y directly');\n      return a11y;\n    }\n  },\n  componentStore: {\n    get() {\n      logging.deprecated('Adapt.componentStore, please use core/js/components directly');\n      return components._register;\n    }\n  },\n  data: {\n    get() {\n      logging.deprecated('Adapt.data, please use core/js/data directly');\n      return data;\n    }\n  },\n  device: {\n    get() {\n      logging.deprecated('device, please use core/js/device directly');\n      return device;\n    }\n  },\n  drawer: {\n    get() {\n      logging.deprecated('Adapt.drawer, please use core/js/drawer directly');\n      return drawer;\n    }\n  },\n  findById: {\n    get() {\n      logging.deprecated('Adapt.findById, please use data.findById directly');\n      return data.findById;\n    }\n  },\n  findViewByModelId: {\n    get() {\n      logging.deprecated('Adapt.findViewByModelId, please use data.findViewByModelId directly');\n      return data.findViewByModelId;\n    }\n  },\n  findByTrackingPosition: {\n    get() {\n      logging.deprecated('Adapt.findByTrackingPosition, please use data.findByTrackingPosition directly');\n      return data.findByTrackingPosition;\n    }\n  },\n  getViewName: {\n    get() {\n      logging.deprecated('Adapt.getViewName, please use components.getViewName instead');\n      return components.getViewName;\n    }\n\n  },\n  getViewClass: {\n    get() {\n      logging.deprecated('Adapt.getViewClass, please use components.getViewClass instead');\n      return components.getViewClass;\n    }\n\n  },\n  getModelName: {\n    get() {\n      logging.deprecated('Adapt.getModelName, please use components.getModelName instead');\n      return components.getModelName;\n    }\n  },\n  getModelClass: {\n    get() {\n      logging.deprecated('Adapt.getModelClass, please use components.getModelClass instead');\n      return components.getModelClass;\n    }\n  },\n  location: {\n    get() {\n      logging.deprecated('Adapt.location, please use core/js/location directly');\n      return location;\n    }\n  },\n  log: {\n    get() {\n      logging.deprecated('Adapt.log, please use core/js/logging directly');\n      return logging;\n    }\n  },\n  mpabc: {\n    get() {\n      logging.deprecated('Adapt.mpabc, please use core/js/mpabc directly');\n      return mpabc;\n    }\n  },\n  notify: {\n    get() {\n      logging.deprecated('Adapt.notify, please use core/js/notify directly');\n      return notify;\n    }\n  },\n  offlineStorage: {\n    get() {\n      logging.deprecated('offlineStorage, please use src/core/offlineStorage instead');\n      return offlineStorage;\n    }\n  },\n  navigateToElement: {\n    get() {\n      logging.deprecated('Adapt.navigateToElement, please use router.navigateToElement');\n      return router.navigateToElement;\n    }\n  },\n  register: {\n    get() {\n      logging.deprecated('Adapt.register, please use components.register instead');\n      return components.register;\n    }\n  },\n  router: {\n    get() {\n      logging.deprecated('Adapt.router, please use core/js/router directly');\n      return router;\n    }\n  },\n  scrolling: {\n    get() {\n      logging.deprecated('Adapt.scrolling, please use core/js/scrolling directly');\n      return scrolling;\n    }\n  },\n  scrollTo: {\n    get() {\n      logging.deprecated('Adapt.scrollTo, please use router.navigateToElement');\n      return scrolling.scrollTo;\n    }\n  },\n  startController: {\n    get() {\n      logging.deprecated('Adapt.startController, please use core/js/startController directly');\n      return startController;\n    }\n  },\n  store: {\n    get() {\n      logging.deprecated('Adapt.store, please use core/js/components directly');\n      return components._register;\n    }\n  },\n  tracking: {\n    get() {\n      logging.deprecated('Adapt.tracking, please use core/js/tracking directly');\n      return tracking;\n    }\n  },\n  wait: {\n    get() {\n      logging.deprecated('Adapt.wait, please use src/core/wait instead');\n      return wait;\n    }\n  }\n});\n","import Adapt from 'core/js/adapt';\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\n\n/**\n * Adds template and partial, preRender and postRender events to Adapt\n */\n\nfunction onRender(cb) {\n  const intercept = (object, name, mode, cb) => {\n    return (object[name] = cb.bind(object, object[name], name, mode));\n  };\n  Object.keys(Handlebars.templates).forEach(name => {\n    intercept(Handlebars.templates, name, 'template', cb);\n  });\n  Object.keys(Handlebars.partials).forEach(name => {\n    intercept(Handlebars.partials, name, 'partial', cb);\n  });\n}\n\nonRender((template, name, mode, ...args) => {\n  // Send preRender event to allow modification of args\n  const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n  Adapt.trigger(preRenderEvent.type, preRenderEvent);\n\n  // Execute template\n  const value = template(...preRenderEvent.args);\n\n  // Send postRender event to allow modification of rendered template\n  const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n  Adapt.trigger(postRenderEvent.type, postRenderEvent);\n\n  // Return rendered, modified template\n  return postRenderEvent.value;\n});\n","import Adapt from 'core/js/adapt';\nimport 'core/js/templates';\n\n/**\n * 27 April 2020 https://github.com/adaptlearning/adapt_framework/issues/2734\n * Chrome on Android defers load events on images when lite mode is enabled\n * and as part of a data saving technique.\n *\n * Add a loading=\"eager\" attribute to all template and partial img tags where\n * the loading attribute is missing.\n */\nAdapt.on('app:dataReady', () => {\n  const config = Adapt.config.get('_fixes');\n  if (config?._imgLazyLoad === false) return;\n  applyImgLoadingFix();\n});\n\nfunction applyImgLoadingFix() {\n  const findImgTag = /<img([^>]*)>/gi;\n  const hasLoadingAttr = / loading=/gi;\n  Adapt.on('template:postRender partial:postRender', event => {\n    const imgTagsFound = event.value.match(findImgTag);\n    if (!imgTagsFound) {\n      return;\n    }\n    event.value = imgTagsFound.reduce((value, img) => {\n      if (hasLoadingAttr.test(img)) {\n        return value;\n      }\n      // Add loading=\"eager\" by default\n      return value.replace(img, img.replace(findImgTag, '<img loading=\"eager\"$1>'));\n    }, event.value);\n  });\n  Adapt.on('reactElement:preRender', event => {\n    if (event.name !== 'img') return;\n    const options = event.args[1] = event.args[1] || {};\n    if (options && options.hasOwnProperty('loading')) return;\n    options.loading = 'eager';\n  });\n}\n","import Adapt from 'core/js/adapt';\nimport HTMLReactParser from 'html-react-parser';\nimport 'core/js/templates';\nimport logging from 'core/js/logging';\n\n/**\n * 27 October 2021 https://github.com/adaptlearning/adapt_authoring/issues/2570\n * The function reactHelpers.html was stopping javascript generated in the AAT editor\n * from presenting correctly in the DOM.\n *\n * This file helps deprecate the function reactHelpers.html and instead recommends\n * replacing it with dangerouslySetInnerHTML, a native react property.\n * https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\n */\nAdapt.on('app:dataReady', () => {\n  const config = Adapt.config.get('_fixes');\n  if (config?._jsxReactHelpersHTML === false) return;\n  applyReactHelpersHTML();\n});\n\nfunction applyReactHelpersHTML() {\n  Adapt.on('reactElement:preRender', event => {\n    let [tagName, props, ...children] = event.args;\n    if (!children) return;\n    if (!Array.isArray(children)) children = [children];\n    children = children.filter(Boolean);\n    const hasSomeUnsafeConversions = children.some(c => c?.__html);\n    if (!hasSomeUnsafeConversions) return;\n    const hasManyChildren = (children.length > 1);\n    if (hasManyChildren) {\n      // Process reactHelpers.html() children amongst other nodes as a conversion from HTML strings to React nodes\n      // Warn as this is an unexpected use-case\n      event.args = event.args.map(child => {\n        if (!child || !child.__html) return child;\n        const attributes = Object.entries(props).map(([name, value]) => `${name}=\"${value}\"`).join(' ');\n        logging.warnOnce(`html() call should be the only child in its parent <${tagName} ${attributes}>`);\n        return child.__html ? HTMLReactParser(child.__html) : undefined;\n      });\n      return;\n    }\n    // Process one reactHelpers.html() child as dangerouslySetInnerHTML on the parent\n    // Allows html generated from the json to appear in the DOM in raw format\n    props = (event.args[1] = event.args[1] || {});\n    props.dangerouslySetInnerHTML = children[0];\n    event.args.length = 2;\n  });\n}\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport logging from './logging';\n\nconst helpers = {\n\n  lowercase(text) {\n    return text.toLowerCase();\n  },\n\n  capitalise(text) {\n    return text.charAt(0).toUpperCase() + text.slice(1);\n  },\n\n  inc(index) {\n    return index + 1;\n  },\n\n  dec(index) {\n    return index - 1;\n  },\n\n  odd (index) {\n    return (index + 1) % 2 === 0 ? 'even' : 'odd';\n  },\n\n  equals(value, text, block) {\n    return helpers.compare.call(this, value, '==', text, block);\n  },\n\n  compare(value, operator, text, block) {\n    // Comparison operators\n    switch (operator) {\n      case '===':\n        if (value === text) return block.fn(this);\n        break;\n      case '=': case '==':\n        // eslint-disable-next-line eqeqeq\n        if (value == text) return block.fn(this);\n        break;\n      case '>=':\n        if (value >= text) return block.fn(this);\n        break;\n      case '<=':\n        if (value <= text) return block.fn(this);\n        break;\n      case '>':\n        if (value > text) return block.fn(this);\n        break;\n      case '<':\n        if (value < text) return block.fn(this);\n        break;\n    }\n    return block.inverse(this);\n  },\n\n  math(lvalue, operator, rvalue, options) {\n    // Mathematical operators\n    lvalue = parseFloat(lvalue);\n    rvalue = parseFloat(rvalue);\n    switch (operator) {\n      case '+': return lvalue + rvalue;\n      case '-': return lvalue - rvalue;\n      case '*': return lvalue * rvalue;\n      case '/': return lvalue / rvalue;\n      case '%': return lvalue % rvalue;\n    }\n  },\n\n  /**\n   * Equivalent to:\n   *  if (conditionA || conditionB)\n   * @example\n   * {{#any displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/any}}\n   */\n  any(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Equivalent to:\n   *  if (conditionA && conditionB)\n   * @example\n   * {{#all displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/all}}\n   */\n  all(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return specified.every(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Equivalent to:\n   *  if (!conditionA && !conditionB)\n   * @example\n   * {{#none displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/none}}\n   */\n  none(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return !specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Allow JSON to be a template i.e. you can use handlebars {{expressions}} within your JSON\n   */\n  compile(template, context) {\n    if (!template) return '';\n    if (template instanceof Object) template = template.toString();\n    const data = (context?.data?.root ? this : context);\n    return Handlebars.compile(template)(data);\n  },\n\n  /**\n   * Allow JSON to be a template and accessible text\n   */\n  compile_a11y_text(template, context) {\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n    return helpers.compile.call(this, template, context);\n  },\n\n  /**\n   * Allow JSON to be a template and normalized text\n   */\n  compile_a11y_normalize(template, context) {\n    if (!template) {\n      return '';\n    }\n    if (template instanceof Object) template = template.toString();\n    return Handlebars.helpers.a11y_normalize.call(this, helpers.compile.call(this, template, context));\n  },\n\n  /**\n   * Remove all html tags except styling tags\n   */\n  compile_a11y_remove_breaks(template, context) {\n    if (!template) {\n      return '';\n    }\n    return Handlebars.helpers.a11y_remove_breaks.call(this, helpers.compile.call(this, template, context));\n  },\n\n  /**\n   * makes the _globals object in course.json available to a template\n   */\n  import_globals(context) {\n    if (context.data.root._globals) {\n      return '';\n    }\n    context.data.root._globals = Adapt.course.get('_globals');\n    return '';\n  },\n\n  /**\n   * makes the Adapt module data available to a template\n   */\n  import_adapt(context) {\n\n    if (context.data.root.Adapt) {\n      return;\n    }\n    const adapt = context.data.root.Adapt = {};\n\n    let i, l, name;\n\n    const directImport = ['config', 'course'];\n    for (i = 0, l = directImport.length; i < l; i++) {\n      name = directImport[i];\n      // convert the model to a json object and add to the current context\n      adapt[name] = Adapt[name].toJSON();\n    }\n\n    const indexedImport = ['contentObjects', 'articles', 'blocks', 'components'];\n    for (i = 0, l = indexedImport.length; i < l; i++) {\n      name = indexedImport[i];\n      // convert the collection of models to an array of json objects\n      const importArray = Adapt[name].toJSON();\n      // convert the array of json models to an object indexed by id\n      const importIndex = {};\n      for (let i1 = 0, l1 = importArray.length; i1 < l1; i1++) {\n        const item = importArray[i1];\n        importIndex[item._id] = item;\n      }\n      // add the indexed object to the current context\n      adapt[name] = importIndex;\n    }\n\n    return '';\n\n  },\n\n  /**\n   * Allow components to fetch their component description.\n   *\n   * Creates an aria label using the `a11y_aria_label` helper containing\n   * the component description specified in the\n   * `_globals._component[componentName].ariaRegion`. This value is defined\n   * in the `properties.schema:globals.ariaRegion`.\n   *\n   * @param {string} [override]\n   * @returns {string}\n   */\n  component_description(override, context) {\n    if (!this._isA11yComponentDescriptionEnabled) {\n      return;\n    }\n    const isNotDefined = !this._globals._components?.['_' + this._component];\n    if (isNotDefined) {\n      return;\n    }\n    const hasOverride = (arguments.length > 1);\n    let description;\n    if (hasOverride) {\n      description = override;\n      description = helpers.compile(description, context);\n    } else {\n      description = this._globals._components['_' + this._component].ariaRegion;\n      description = helpers.compile(description, override);\n    }\n    if (!description) {\n      return;\n    }\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + description + '</div>');\n  },\n\n  a11y_text(text) {\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n    return text;\n  },\n\n  /**\n   * Handlebars helper for `a11y.normalize(htmls)`.\n   *\n   * @param {string} htmls Any htmls.\n   * @returns {string}\n   */\n  a11y_normalize(htmls) {\n    return a11y.normalize.apply(a11y, arguments);\n  },\n\n  /**\n   * Handlebars helper for `a11y.removeBreaks(htmls)`.\n   *\n   * @param {string} htmls Any htmls.\n   * @returns {string}\n   */\n  a11y_remove_breaks(htmls) {\n    return a11y.removeBreaks.apply(a11y, arguments);\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text.\n   * It it absolutely positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} htmls\n   * @returns {string}\n   */\n  a11y_aria_label(htmls) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + values.join(' ') + '</div>');\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text.\n   * It it relatively positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} htmls Aria label texts.\n   * @returns {string}\n   */\n  a11y_aria_label_relative(htmls) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label relative\">' + values.join(' ') + '</div>');\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text and `role\"=img\"`.\n   * It is used for representing an image to a screen reader user in an\n   * order which cannot be represented in the DOM in a way that achieves the\n   * styling objectives.\n   * It it absolutely positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} texts Aria label texts.\n   * @returns {string}\n   */\n  a11y_aria_image(texts) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label\" role=\"img\" aria-label=\"' + values.join(' ') + '\"></div>');\n  },\n\n  /**\n   * Returns an `a` tag which when receiving focus causes the focus to wrap\n   * to the top of the readable document.\n   *\n   * @returns {string}\n   */\n  a11y_wrap_focus() {\n    const cfg = Adapt.config.get('_accessibility');\n    if (cfg._isPopupWrapFocusEnabled === false) return '';\n    return new Handlebars.SafeString('<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" tabindex=\"0\" role=\"presentation\">&nbsp;</a>');\n  },\n\n  /**\n   * Creates the attributes for a subject heading text. `role=\"heading\"` and\n   * `aria-level=\"#\"`. It will use the `_ariaLevel` attribute from the current\n   * context if specified, a number if given as the `levelOrType` parameter,\n   * or a name from the configured aria levels hash.\n   *\n   * @param {number|string} level\n   * @returns {string}\n   * @deprecated Please use a11y_aria_level or a11y.ariaLevel accordingly\n   */\n  a11y_attrs_heading(level) {\n    logging.deprecated('a11y_attrs_heading, please use a11y_aria_level or a11y.ariaLevel');\n    const resolvedLevel = a11y.ariaLevel({\n      id: this._id ?? Array.from(arguments).lastItem?.data?.root?._id,\n      level,\n      override: this._ariaLevel\n    });\n    return new Handlebars.SafeString(` role=\"heading\" aria-level=\"${resolvedLevel}\" `);\n  },\n\n  /**\n   * Creates the value of the aria-level attribute for a subject heading text.\n   *\n   * @param {number|string} id The originating model id\n   * @param {number|string} level An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\").\n   * @param {number|string} [override=null] An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\"), usually passed through from the config to override the default.\n   * @returns {string}\n   */\n  a11y_aria_level(id, level, override = null) {\n    const resolvedLevel = a11y.ariaLevel({ id, level, override });\n    return resolvedLevel;\n  },\n\n  a11y_attrs_tabbable() {\n    logging.deprecated('a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.');\n    return new Handlebars.SafeString(' role=\"region\" tabindex=\"0\" ');\n  },\n\n  /**\n   * Produce display text with alternative screen reader version.\n   * @param {string} visible Text that will be displayed on screen\n   * @param {string} alternatives Text that will be read by the screen reader (instead of what's displayed on screen)\n   * @example {{a11y_alt_text '$5bn' 'five billion dollars'}} or {{a11y_alt_text 'Here are some bits to read' 'There are' _items.length 'items to read'}}\n   */\n  a11y_alt_text(visible, alternatives) {\n    let values = Array.prototype.slice.call(arguments, 1, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<span aria-hidden=\"true\">' + visible + '</span><span class=\"aria-label\">' + values.join(' ') + '</span>');\n  }\n\n};\n\n// Compatibility references\nObject.assign(helpers, {\n\n  if_value_equals() {\n    logging.deprecated('if_value_equals, use equals instead.');\n    return helpers.equals.apply(this, arguments);\n  },\n\n  numbers() {\n    logging.deprecated('numbers, use inc instead.');\n    return helpers.inc.apply(this, arguments);\n  },\n\n  lowerCase() {\n    logging.deprecated('lowerCase, use lowercase instead.');\n    return helpers.lowercase.apply(this, arguments);\n  }\n\n});\n\nfor (const name in helpers) {\n  Handlebars.registerHelper(name, helpers[name]);\n}\n\nexport default helpers;\n","import Adapt from 'core/js/adapt';\n\nclass HeadingView extends Backbone.View {\n\n  initialize() {\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\n    this.listenTo(this.model, 'change:_isComplete', this.updateAria);\n    this.render();\n  }\n\n  render() {\n    const template = Handlebars.templates[this.constructor.template];\n    const data = this.model.toJSON();\n    const customHeadingType = this.$el.attr('data-a11y-heading-type');\n    if (customHeadingType) data._type = customHeadingType;\n    if (data._type === 'course') data._type = 'menu';\n    this.$el.html(template(data));\n    this.checkCompletion();\n  }\n\n  updateAria() {\n    const template = Handlebars.templates[this.constructor.template];\n    const data = this.model.toJSON();\n    const $rendered = $(`<div>${template(data)}</div>`);\n    this.$('.aria-label').html($rendered.find('.aria-label').html());\n    this.checkCompletion();\n  }\n\n  checkCompletion() {\n    const isComplete = this.model.get('_isComplete');\n    this.$el\n      .toggleClass('is-complete', isComplete)\n      .toggleClass('is-incomplete', !isComplete);\n  }\n\n}\n\nHeadingView.template = 'heading';\n\nexport default HeadingView;\n","import Adapt from 'core/js/adapt';\nimport HeadingView from 'core/js/views/headingView';\n\nclass Headings extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'view:render', this.onViewRender);\n  }\n\n  onViewRender(view) {\n    const $headingSeats = view.$('.js-heading');\n    $headingSeats.each((index, el) => new HeadingView({ el, model: view.model }));\n  }\n\n}\n\nexport default new Headings();\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport location from 'core/js/location';\nimport router from 'core/js/router';\nimport startController from 'core/js/startController';\n\nclass NavigationView extends Backbone.View {\n\n  className() {\n    return 'nav';\n  }\n\n  events() {\n    return {\n      'click [data-event]': 'triggerEvent'\n    };\n  }\n\n  attributes() {\n    return {\n      role: 'navigation'\n    };\n  }\n\n  initialize() {\n    this.sortNavigationButtons = _.debounce(this.sortNavigationButtons.bind(this), 1);\n    this.listenToOnce(Adapt, {\n      'courseModel:dataLoading': this.remove\n    });\n    this.listenTo(Adapt, 'router:menu router:page', this.onNavigate);\n    this.preRender();\n  }\n\n  preRender() {\n    Adapt.trigger('navigationView:preRender', this);\n    this.render();\n  }\n\n  render() {\n    const template = Handlebars.templates[this.constructor.template];\n    this.$el.html(template({\n      _globals: Adapt.course.get('_globals'),\n      _accessibility: Adapt.config.get('_accessibility')\n    })).insertBefore('#app');\n\n    _.defer(() => {\n      Adapt.trigger('navigationView:postRender', this);\n    });\n\n    return this;\n  }\n\n  triggerEvent(event) {\n    event.preventDefault();\n    const currentEvent = $(event.currentTarget).attr('data-event');\n    Adapt.trigger('navigation:' + currentEvent);\n    switch (currentEvent) {\n      case 'backButton':\n        router.navigateToPreviousRoute();\n        break;\n      case 'homeButton':\n        router.navigateToHomeRoute();\n        break;\n      case 'parentButton':\n        router.navigateToParent();\n        break;\n      case 'skipNavigation':\n        this.skipNavigation();\n        break;\n      case 'returnToStart':\n        startController.returnToStartLocation();\n        break;\n    }\n  }\n\n  skipNavigation() {\n    a11y.focusFirst('.' + location._contentType);\n  }\n\n  onNavigate(model) {\n    this.hideNavigationButton(model);\n    this.sortNavigationButtons();\n  }\n\n  hideNavigationButton(model) {\n    const shouldHide = (model.get('_type') === 'course');\n    this.$('.nav__back-btn, .nav__home-btn').toggleClass('u-display-none', shouldHide);\n  }\n\n  sortNavigationButtons() {\n    const container = this.$('.nav__inner')[0];\n    const items = [...container.children];\n    items\n      .sort((a, b) => parseFloat($(a).attr('data-order') || 0) - parseFloat($(b).attr('data-order') || 0))\n      .forEach(item => container.appendChild(item));\n  }\n\n  showNavigationButton() {\n    this.$('.nav__back-btn, .nav__home-btn').removeClass('u-display-none');\n  }\n\n}\n\nNavigationView.template = 'nav';\n\nexport default NavigationView;\n","import Adapt from 'core/js/adapt';\nimport NavigationView from 'core/js/views/navigationView';\n\nclass NavigationController extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'adapt:preInitialize', this.addNavigationBar);\n  }\n\n  addNavigationBar() {\n    const adaptConfig = Adapt.course.get('_navigation');\n\n    if (adaptConfig?._isDefaultNavigationDisabled) {\n      Adapt.trigger('navigation:initialize');\n      return;\n    }\n\n    Adapt.navigation = new NavigationView();// This should be triggered after 'app:dataReady' as plugins might want to manipulate the navigation\n  }\n\n}\n\nexport default new NavigationController();\n","import logging from 'core/js/logging';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass ComponentView extends AdaptView {\n\n  attributes() {\n    if (!this.model.get('_isA11yRegionEnabled')) {\n      return AdaptView.resultExtend('attributes', {}, this);\n    }\n    return AdaptView.resultExtend('attributes', {\n      'aria-labelledby': this.model.get('_id') + '-heading',\n      role: 'region'\n    }, this);\n  }\n\n  className() {\n    return [\n      'component',\n      this.model.get('_component').toLowerCase(),\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      'is-' + this.model.get('_layout'),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n  renderState() {\n    logging.removed('renderState is removed and moved to item title');\n  }\n\n  /**\n   * Allows components that want to use inview for completion to set that up\n   * @param {string} [inviewElementSelector] Allows to you to specify (via a selector) which DOM element to use for inview.\n   * Defaults to `'.component__inner'` if not supplied.\n   * @param {function} [callback] Allows you to specify what function is called when the component has been viewed, should\n   * you want to perform additional checks before setting the component to completed - see adapt-contrib-assessmentResults\n   * for an example. Defaults to `view.setCompletionStatus` if not specified.\n   */\n  setupInviewCompletion(inviewElementSelector = '.component__inner', callback = this.setCompletionStatus) {\n    this.$inviewElement = this.$(inviewElementSelector);\n    this.inviewCallback = callback;\n\n    this.$inviewElement.on('inview.componentView', this.onInview.bind(this));\n  }\n\n  removeInviewListener() {\n    if (!this.$inviewElement) return;\n    this.$inviewElement.off('inview.componentView');\n    this.$inviewElement = null;\n  }\n\n  onInview(event, visible, visiblePartX, visiblePartY) {\n    if (!visible) return;\n\n    switch (visiblePartY) {\n      case 'top':\n        this.hasSeenTop = true;\n        break;\n      case 'bottom':\n        this.hasSeenBottom = true;\n        break;\n      case 'both':\n        this.hasSeenTop = this.hasSeenBottom = true;\n    }\n\n    if (!this.hasSeenTop || !this.hasSeenBottom) return;\n\n    this.inviewCallback();\n\n    if (this.model.get('_isComplete')) {\n      this.removeInviewListener();\n    }\n  }\n\n  postRender() {}\n\n  remove() {\n    this.removeInviewListener();\n    super.remove();\n  }\n\n}\n\nComponentView.type = 'component';\n\nexport default ComponentView;\n","import ComponentView from 'core/js/views/componentView';\n\nclass GraphicView extends ComponentView {\n\n  className() {\n    return [\n      super.className(),\n      this.model.get('_isScrollable') && 'is-scrollable'\n    ].filter(Boolean).join(' ');\n  }\n\n  events() {\n    return {\n      'click .js-graphic-link': 'onClick',\n      'keydown .js-graphic-scrollbar': 'onKeyDown'\n    };\n  }\n\n  postRender() {\n    this.$('.graphic__widget').imageready(() => {\n      this.setReadyStatus();\n      this.setupInviewCompletion('.graphic__widget');\n      this.setupScrollable();\n    });\n  }\n\n  setupScrollable() {\n    if (!this.model.get('_isScrollable')) return;\n    this.onScroll = _.debounce(this.onScroll.bind(this), 17);\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    $scrollContainer.on('scroll', this.onScroll);\n    this.onKeyDown();\n  }\n\n  onScroll(event) {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    const { clientWidth, scrollWidth } = $scrollContainer[0];\n    const scrollableWidth = (scrollWidth - clientWidth);\n    const left = $scrollContainer.scrollLeft();\n    const calculatedScrollPercent = parseInt(left / scrollableWidth * 100);\n    this.model.set('_scrollPercent', calculatedScrollPercent);\n  }\n\n  onKeyDown(event) {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    const { clientWidth, scrollWidth } = $scrollContainer[0];\n    const scrollableWidth = (scrollWidth - clientWidth);\n    const step = (clientWidth * 0.1);\n    let left = $scrollContainer.scrollLeft();\n    const calculatedScrollPercent = parseInt(left / scrollableWidth * 100);\n    const definedScrollPercent = this.model.get('_scrollPercent') ?? 0;\n    if (definedScrollPercent !== calculatedScrollPercent) {\n      // set inital position\n      left = definedScrollPercent / 100 * scrollableWidth;\n    }\n    switch (event?.which) {\n      case 37: // left\n        left -= step;\n        break;\n      case 39: // right\n        left += step;\n        break;\n    }\n    left = _.max([0, _.min([scrollableWidth, left])]);\n    $scrollContainer.scrollLeft(left);\n  }\n\n  onClick(event) {\n    if (event) event.preventDefault();\n\n    const item = this.model.get('_graphic');\n    const { _url: url, _target: target = '_blank' } = item;\n\n    const isNewWindow = (target !== '_self');\n    if (isNewWindow) return window.open(url, target);\n    const isRouterNavigation = (url.substr(0, 1) === '#');\n    if (isRouterNavigation) return Backbone.history.navigate(url, { trigger: true });\n    window.location.href = url;\n  }\n\n  preRemove() {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    $scrollContainer.off('scroll', this.onScroll);\n  }\n\n}\n\nGraphicView.template = 'graphic.jsx';\n\nexport default GraphicView;\n","import ComponentModel from 'core/js/models/componentModel';\n\nexport default class GraphicModel extends ComponentModel {\n\n  init() {\n    this.set('_scrollPercent', this.get('_defaultScrollPercent'));\n  }\n\n}\n","import components from 'core/js/components';\nimport GraphicView from './GraphicView';\nimport GraphicModel from './GraphicModel';\n\nexport default components.register('graphic', {\n  model: GraphicModel,\n  view: GraphicView\n});\n","import ComponentView from 'core/js/views/componentView';\n\nclass TextView extends ComponentView {\n\n  postRender() {\n    this.setReadyStatus();\n    this.setupInview();\n  }\n\n  setupInview() {\n    const selector = this.getInviewElementSelector();\n    if (!selector) return this.setCompletionStatus();\n    this.setupInviewCompletion(selector);\n  }\n\n  /**\n   * determines which element should be used for inview logic - body, instruction or title - and returns the selector for that element\n   */\n  getInviewElementSelector() {\n    if (this.model.get('body')) return '.component__body';\n    if (this.model.get('instruction')) return '.component__instruction';\n    if (this.model.get('displayTitle')) return '.component__title';\n    return null;\n  }\n\n}\n\nTextView.template = 'text.jsx';\n\nexport default TextView;\n","import ComponentModel from 'core/js/models/componentModel';\n\nexport default class TextModel extends ComponentModel {}\n","import components from 'core/js/components';\nimport TextView from './TextView';\nimport TextModel from './TextModel';\n\nexport default components.register('text', {\n  model: TextModel,\n  view: TextView\n});\n","const BUTTON_STATE = ENUM([\n  'SUBMIT',\n  'CORRECT',\n  'INCORRECT',\n  'SHOW_CORRECT_ANSWER',\n  'HIDE_CORRECT_ANSWER',\n  'SHOW_FEEDBACK',\n  'RESET'\n]);\n\nexport default BUTTON_STATE;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\n\n// convert BUTTON_STATE to property name\nconst textPropertyName = {\n  SUBMIT: 'submit',\n  CORRECT: 'correct',\n  INCORRECT: 'incorrect',\n  SHOW_CORRECT_ANSWER: 'showCorrectAnswer',\n  HIDE_CORRECT_ANSWER: 'hideCorrectAnswer',\n  SHOW_FEEDBACK: 'showFeedback',\n  RESET: 'reset'\n};\n\nexport default class ButtonsView extends Backbone.View {\n\n  initialize(options) {\n    this.parent = options.parent;\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\n    this.listenTo(this.model, {\n      'change:_buttonState': this.onButtonStateChanged,\n      'change:feedbackMessage': this.onFeedbackMessageChanged,\n      'change:_attemptsLeft': this.onAttemptsChanged,\n      'change:_canSubmit': this.onCanSubmitChange\n    });\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .js-btn-action': 'onActionClicked',\n      'click .js-btn-feedback': 'onFeedbackClicked'\n    };\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.buttons;\n    _.defer(() => {\n      this.postRender();\n      Adapt.trigger('buttonsView:postRender', this);\n    });\n    this.$el.html(template(data));\n  }\n\n  postRender() {\n    this.refresh();\n  }\n\n  checkResetSubmittedState() {\n    const isSubmitted = this.model.get('_isSubmitted');\n    if (isSubmitted) {\n      this.$el.addClass('is-submitted');\n      return;\n    }\n\n    this.$('.js-btn-marking, .js-btn-marking-label').removeClass('is-incorrect is-correct').addClass('u-display-none');\n    this.$el.removeClass('is-submitted');\n    this.model.set('feedbackMessage', undefined);\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\n  }\n\n  onActionClicked() {\n    const buttonState = BUTTON_STATE(this.model.get('_buttonState'));\n    this.trigger('buttons:stateUpdate', buttonState);\n    this.checkResetSubmittedState();\n\n    if (buttonState === BUTTON_STATE.SHOW_CORRECT_ANSWER) {\n      const correctAnswer = this.model.getCorrectAnswerAsText?.();\n      this.updateAnswerLiveRegion(correctAnswer);\n    }\n\n    if (buttonState === BUTTON_STATE.HIDE_CORRECT_ANSWER) {\n      const userAnswer = this.model.getUserAnswerAsText?.();\n      this.updateAnswerLiveRegion(userAnswer);\n    }\n  }\n\n  onFeedbackClicked() {\n    this.trigger('buttons:stateUpdate', BUTTON_STATE.SHOW_FEEDBACK);\n  }\n\n  onFeedbackMessageChanged(model, changedAttribute) {\n    if (changedAttribute && this.model.get('_canShowFeedback')) {\n      // enable feedback button\n      a11y.toggleEnabled(this.$('.js-btn-feedback'), true);\n      return;\n    }\n    // disable feedback button\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\n  }\n\n  onCanSubmitChange() {\n    this.onButtonStateChanged(this.model, this.model.get('_buttonState'));\n  }\n\n  onButtonStateChanged(model, changedAttribute) {\n\n    this.updateAttemptsCount();\n\n    // Use 'correct' instead of 'complete' to signify button state\n    const $buttonsAction = this.$('.js-btn-action');\n    const buttonState = BUTTON_STATE(changedAttribute);\n    if (changedAttribute === BUTTON_STATE.CORRECT || changedAttribute === BUTTON_STATE.INCORRECT) {\n      // Both 'correct' and 'incorrect' states have no model answer, so disable the submit button\n      a11y.toggleEnabled($buttonsAction, false);\n      return;\n    }\n\n    const propertyName = textPropertyName[buttonState.asString];\n    const ariaLabel = this.model.get('_buttons')['_' + propertyName].ariaLabel;\n    const buttonText = this.model.get('_buttons')['_' + propertyName].buttonText;\n\n    // Enable the button, make accessible and update aria labels and text\n    a11y.toggleEnabled($buttonsAction, this.model.get('_canSubmit'));\n    $buttonsAction.html(buttonText).attr('aria-label', ariaLabel);\n  }\n\n  checkFeedbackState() {\n    const canShowFeedback = this.model.get('_canShowFeedback');\n\n    this.$('.js-btn-action').toggleClass('is-full-width', !canShowFeedback);\n    this.$('.js-btn-feedback').toggleClass('u-display-none', !canShowFeedback);\n    this.$('.js-btn-marking, .js-btn-marking-label').toggleClass('is-full-width u-display-none', !canShowFeedback);\n  }\n\n  updateAttemptsCount() {\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\n    const attemptsLeft = (this.model.get('_attemptsLeft')) ? this.model.get('_attemptsLeft') : this.model.get('_attempts');\n    const shouldDisplayAttempts = this.model.get('_shouldDisplayAttempts');\n    let attemptsString;\n\n    this.checkResetSubmittedState();\n\n    if (!isInteractionComplete && attemptsLeft >= 0) {\n      attemptsString = attemptsLeft + ' ';\n      attemptsString += attemptsLeft === 1 ?\n        this.model.get('_buttons').remainingAttemptText :\n        this.model.get('_buttons').remainingAttemptsText;\n    } else {\n      this.$('.js-display-attempts').addClass('u-visibility-hidden');\n      this.showMarking();\n    }\n\n    if (shouldDisplayAttempts) {\n      this.$('.js-insert-attempts-string').html(attemptsString);\n    }\n\n  }\n\n  /**\n   * Updates the ARIA 'live region' with the correct/user answer when that button\n   * is selected by the learner.\n   * @param {string} answer Textual representation of the correct/user answer\n   */\n  updateAnswerLiveRegion(answer) {\n    if (!answer) return;\n    this.$('.js-answer-live-region').html(answer);\n  }\n\n  showMarking() {\n    if (!this.model.shouldShowMarking) return;\n\n    const isCorrect = this.model.get('_isCorrect');\n    const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\n\n    const $marking = this.$('.js-btn-marking, .js-btn-marking-label')\n      .removeClass('u-display-none')\n      .addClass(isCorrect ? 'is-correct' : 'is-incorrect');\n\n    const $ariaLabel = this.$('.js-btn-marking-label');\n    const hasSpanAriaLabel = Boolean($ariaLabel.length);\n    if (!hasSpanAriaLabel) {\n      // Backward compability\n      $marking.attr('aria-label', isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\n      return;\n    }\n\n    $ariaLabel.html(isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\n  }\n\n  refresh() {\n    this.updateAttemptsCount();\n    this.checkResetSubmittedState();\n    this.checkFeedbackState();\n    this.onButtonStateChanged(null, this.model.get('_buttonState'));\n    this.onFeedbackMessageChanged(null, this.model.get('feedbackMessage'));\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport ComponentModel from 'core/js/models/componentModel';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\n\nclass QuestionModel extends ComponentModel {\n\n  /// ///\n  // Setup question types\n  /// /\n\n  // Used to set model defaults\n  defaults() {\n    // Extend from the ComponentModel defaults\n    return ComponentModel.resultExtend('defaults', {\n      _isQuestionType: true,\n      _shouldDisplayAttempts: false,\n      _shouldShowMarking: false,\n      _canShowModelAnswer: true,\n      _canShowFeedback: true,\n      _canShowMarking: true,\n      _canSubmit: true,\n      _isSubmitted: false,\n      _isCorrectAnswerShown: false,\n      _questionWeight: Adapt.config.get('_questionWeight'),\n      _hasItemScoring: false,\n      _items: []\n    });\n  }\n\n  // Extend from the ComponentModel trackable\n  trackable() {\n    return ComponentModel.resultExtend('trackable', [\n      '_isSubmitted',\n      '_score',\n      '_isCorrect',\n      '_attemptsLeft'\n    ]);\n  }\n\n  trackableType() {\n    return ComponentModel.resultExtend('trackableType', [\n      Boolean,\n      Number,\n      Boolean,\n      Number\n    ]);\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'question';\n  }\n\n  init() {\n    this.setupDefaultSettings();\n    this.setLocking('_canSubmit', true);\n    this.updateRawScore();\n    super.init();\n  }\n\n  // Calls default methods to setup on questions\n  setupDefaultSettings() {\n    // Not sure this is needed anymore, keeping to maintain API\n    this.setupWeightSettings();\n    this.setupButtonSettings();\n  }\n\n  // Used to setup either global or local button text\n  setupButtonSettings() {\n    const globalButtons = Adapt.course.get('_buttons');\n\n    // Check if  '_buttons' attribute exists and if not use the globally defined buttons.\n    if (!this.has('_buttons')) {\n      this.set('_buttons', globalButtons);\n    } else {\n      // Check all the components buttons.\n      // If they are empty use the global defaults.\n      const componentButtons = this.get('_buttons');\n\n      for (const key in componentButtons) {\n        if (typeof componentButtons[key] === 'object') {\n          // Button text.\n          if (!componentButtons[key].buttonText && globalButtons[key].buttonText) {\n            componentButtons[key].buttonText = globalButtons[key].buttonText;\n          }\n\n          // ARIA labels.\n          if (!componentButtons[key].ariaLabel && globalButtons[key].ariaLabel) {\n            componentButtons[key].ariaLabel = globalButtons[key].ariaLabel;\n          }\n        }\n\n        if (!componentButtons[key] && globalButtons[key]) {\n          componentButtons[key] = globalButtons[key];\n        }\n      }\n    }\n  }\n\n  // Used to setup either global or local question weight/score\n  setupWeightSettings() {\n    // Not needed as handled by model defaults, keeping to maintain API\n  }\n\n  /// ///\n  // Submit process\n  /// /\n\n  // Use to check if the user is allowed to submit the question\n  // Maybe the user has to select an item?\n  canSubmit() {}\n\n  checkCanSubmit() {\n    this.set('_canSubmit', this.canSubmit(), { pluginName: 'adapt' });\n  }\n\n  // Used to update the amount of attempts the user has left\n  updateAttempts() {\n    const attemptsLeft = this.get('_attemptsLeft') || this.get('_attempts');\n\n    this.set('_attemptsLeft', attemptsLeft - 1);\n  }\n\n  // Used to set _isEnabled and _isSubmitted on the model\n  setQuestionAsSubmitted() {\n    this.set({\n      _isEnabled: false,\n      _isSubmitted: true,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n  }\n\n  // Sets _isCorrect:true/false based upon isCorrect method below\n  markQuestion() {\n    this.set({\n      _isCorrect: this.isCorrect(),\n      _isPartlyCorrect: this.isPartlyCorrect()\n    });\n    this.updateRawScore();\n  }\n\n  // Should return a boolean based upon whether to question is correct or not\n  isCorrect() {}\n\n  /**\n   * Used to set the legacy _score property based upon the _questionWeight and correctness\n   * @deprecated Please use get score, get maxScore and get minScore instead\n   */\n  setScore() {\n    const questionWeight = this.get('_questionWeight');\n    const answeredCorrectly = this.get('_isCorrect');\n    const score = answeredCorrectly ? questionWeight : 0;\n    this.set('_score', score);\n  }\n\n  updateRawScore() {\n    this.set({\n      _rawScore: this.score,\n      _maxScore: this.maxScore,\n      _minScore: this.minScore\n    });\n  }\n\n  /**\n   * Returns a numerical value between maxScore and minScore\n   * @type {number}\n   */\n  get score() {\n    return this.get('_isCorrect') ? this.maxScore : 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get maxScore() {\n    return this.get('_questionWeight');\n  }\n\n  /**\n   * @type {number}\n   */\n  get minScore() {\n    return 0;\n  }\n\n  // Checks if the question should be set to complete\n  // Calls setCompletionStatus and adds complete classes\n  checkQuestionCompletion() {\n\n    const isComplete = (this.get('_isCorrect') || this.get('_attemptsLeft') === 0);\n\n    if (isComplete) {\n      this.setCompletionStatus();\n    }\n\n    return isComplete;\n\n  }\n\n  // Updates buttons based upon question state by setting\n  // _buttonState on the model which buttonsView listens to\n  updateButtons() {\n\n    const isInteractionComplete = this.get('_isInteractionComplete');\n    const isCorrect = this.get('_isCorrect');\n    const isEnabled = this.get('_isEnabled');\n    const buttonState = this.get('_buttonState');\n    const canShowModelAnswer = this.get('_canShowModelAnswer');\n\n    if (isInteractionComplete) {\n\n      if (isCorrect || !canShowModelAnswer) {\n        // Use correct instead of complete to signify button state\n        this.set('_buttonState', BUTTON_STATE.CORRECT);\n\n      } else {\n\n        switch (buttonState) {\n          case BUTTON_STATE.SUBMIT:\n          case BUTTON_STATE.HIDE_CORRECT_ANSWER:\n            this.set('_buttonState', BUTTON_STATE.SHOW_CORRECT_ANSWER);\n            break;\n          default:\n            this.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\n        }\n\n      }\n\n    } else {\n\n      if (isEnabled) {\n        this.set('_buttonState', BUTTON_STATE.SUBMIT);\n      } else {\n        this.set('_buttonState', BUTTON_STATE.RESET);\n      }\n    }\n\n  }\n\n  // Used to setup the correct, incorrect and partly correct feedback\n  setupFeedback() {\n    if (!this.has('_feedback')) return;\n\n    if (this.get('_isCorrect')) {\n      this.setupCorrectFeedback();\n    } else if (this.isPartlyCorrect()) {\n      this.setupPartlyCorrectFeedback();\n    } else {\n      this.setupIncorrectFeedback();\n    }\n  }\n\n  // Used by the question to determine if the question is incorrect or partly correct\n  // Should return a boolean\n  isPartlyCorrect() {}\n\n  setupCorrectFeedback() {\n    this.set({\n      feedbackTitle: this.getFeedbackTitle(),\n      feedbackMessage: Handlebars.compile(this.get('_feedback').correct)(this.toJSON())\n    });\n  }\n\n  setupPartlyCorrectFeedback() {\n    const feedback = this.get('_feedback')._partlyCorrect;\n\n    if (feedback?.final) {\n      this.setAttemptSpecificFeedback(feedback);\n    } else {\n      this.setupIncorrectFeedback();\n    }\n  }\n\n  setupIncorrectFeedback() {\n    this.setAttemptSpecificFeedback(this.get('_feedback')._incorrect);\n  }\n\n  setAttemptSpecificFeedback(feedback) {\n    const body = (this.get('_attemptsLeft') && feedback.notFinal) || feedback.final;\n\n    this.set({\n      altFeedbackTitle: this.getAltFeedbackTitle(),\n      feedbackTitle: this.getFeedbackTitle(),\n      feedbackMessage: Handlebars.compile(body)(this.toJSON())\n    });\n  }\n\n  getAltFeedbackTitle() {\n    return this.get('_feedback').altTitle || Adapt.course.get('_globals')._accessibility.altFeedbackTitle || '';\n  }\n\n  getFeedbackTitle() {\n    const title = this.get('_feedback').title || this.get('displayTitle') || this.get('title') || '';\n    return Handlebars.compile(title)(this.toJSON());\n  }\n\n  /**\n   * Used to determine whether the learner is allowed to interact with the question component or not.\n   * @return {Boolean}\n   */\n  isInteractive() {\n    return !this.get('_isComplete') || (this.get('_isEnabled') && !this.get('_isSubmitted'));\n  }\n\n  checkIfResetOnRevisit() {\n    super.checkIfResetOnRevisit();\n    // Setup button view state\n    this.set('_buttonState', this.get('_isInteractionComplete')\n      ? BUTTON_STATE.HIDE_CORRECT_ANSWER\n      : BUTTON_STATE.SUBMIT\n    );\n  }\n\n  /**\n   * Reset the model to let the user have another go (not the same as attempts)\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    const attempts = this.get('_attempts');\n    this.set({\n      _attemptsLeft: attempts,\n      _isCorrect: undefined,\n      _isPartlyCorrect: undefined,\n      _isCorrectAnswerShown: false,\n      _isSubmitted: false,\n      _buttonState: BUTTON_STATE.SUBMIT,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n    return true;\n  }\n\n  // Reset question for subsequent attempts\n  setQuestionAsReset() {\n    this.set({\n      _isEnabled: true,\n      _isSubmitted: false,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n    this.resetQuestion();\n  }\n\n  /**\n   * Used by the question view to reset the options of the component.\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\n   */\n  resetQuestion() {}\n\n  refresh() {\n    this.trigger('question:refresh');\n  }\n\n  getButtonState() {\n    if (this.get('_isCorrect')) {\n      return BUTTON_STATE.CORRECT;\n    }\n\n    if (this.get('_attemptsLeft') === 0) {\n      return this.get('_canShowModelAnswer') ? BUTTON_STATE.SHOW_CORRECT_ANSWER : BUTTON_STATE.INCORRECT;\n    }\n\n    return this.get('_isSubmitted') ? BUTTON_STATE.RESET : BUTTON_STATE.SUBMIT;\n  }\n\n  // Returns an object specific to the question type, e.g. if the question\n  // is a 'choice' this should contain an object with:\n  // - correctResponsesPattern[]\n  // - choices[]\n  getInteractionObject() {\n    return {};\n  }\n\n  // Returns a string detailing how the user answered the question.\n  getResponse() {}\n\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\n  getResponseType() {}\n\n  /**\n   * Called at the end of the onSubmitClicked view function.\n   */\n  onSubmitted() {\n    // Stores the current attempt state\n    if (this.get('_shouldStoreAttempts')) this.addAttemptObject();\n    this.set('_shouldShowMarking', this.shouldShowMarking);\n  }\n\n  /** @type {boolean} */\n  get shouldShowMarking() {\n    return (!this.isInteractive() && this.get('_canShowMarking') && this.get('_isInteractionComplete'));\n  }\n\n}\n\n// This abstract model needs to registered to support deprecated view-only questions\ncomponents.register('question', { model: QuestionModel });\n\nexport default QuestionModel;\n","import Adapt from 'core/js/adapt';\nimport ComponentView from 'core/js/views/componentView';\nimport ButtonsView from 'core/js/views/buttonsView';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\nimport a11y from 'core/js/a11y';\nimport log from 'core/js/logging';\nimport data from 'core/js/data';\nimport location from 'core/js/location';\nimport 'core/js/models/questionModel';\n\nclass QuestionView extends ComponentView {\n\n  className() {\n    return [\n      'component',\n      'is-question',\n      this.model.get('_component').toLowerCase(),\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      'is-' + this.model.get('_layout'),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : ''),\n      (this.model.get('_canShowModelAnswer') ? 'can-show-model-answer' : ''),\n      (this.model.get('_canShowFeedback') ? 'can-show-feedback' : ''),\n      (this.model.get('_canShowMarking') ? 'can-show-marking' : '')\n    ].join(' ');\n  }\n\n  initialize(...args) {\n    // Allow isInteractive to be used in jsx templates\n    this.isInteractive = this.isInteractive.bind(this);\n    super.initialize(...args);\n  }\n\n  /**\n   * Used to determine whether the learner is allowed to interact with the question component or not.\n   * @return {Boolean}\n   * @deprecated since v6.0.5 please use this.model.isInteractive, this.model.get('_shouldShowMarking') or this.model.shouldShowMarking\n  */\n  isInteractive() {\n    log.deprecated('questionView.isInteractive please use this.model.isInteractive, this.model.get(\\'_shouldShowMarking\\') or this.model.shouldShowMarking');\n    return this.model.isInteractive();\n  }\n\n  preRender() {\n    // Setup listener for _isEnabled\n    this.listenTo(this.model, 'change:_isEnabled', this.onEnabledChanged);\n\n    this.listenTo(this.model, 'question:refresh', this.refresh);\n\n    // Checks to see if the question should be reset on revisit\n    if (this.checkIfResetOnRevisit !== QuestionView.prototype.checkIfResetOnRevisit) {\n      log.deprecated('QuestionView.checkIfResetOnRevisit, please use QuestionModel.checkIfResetOnRevisit');\n    }\n    this.checkIfResetOnRevisit();\n    _.defer(() => this.ensureLegacyLifecycleState());\n    // This method helps setup default settings on the model\n    this._runModelCompatibleFunction('setupDefaultSettings');\n    // Blank method for setting up questions before rendering\n    this.setupQuestion();\n  }\n\n  // Used in the question view to disabled the question when _isEnabled has been set to false\n  onEnabledChanged(model, changedAttribute) {\n\n    // If isEnabled == false add disabled class\n    // else remove disabled class\n    if (!changedAttribute) {\n      this.$('.component__widget').addClass('is-disabled');\n      this.disableQuestion();\n    } else {\n      this.$('.component__widget').removeClass('is-disabled');\n      this.enableQuestion();\n    }\n\n  }\n\n  // Used by the question to disable the question during submit and complete stages\n  disableQuestion() {}\n\n  // Used by the question to enable the question during interactions\n  enableQuestion() {}\n\n  /**\n   * Used to check if the question should reset on revisit\n   * @deprecated since core v6.0.1 Please use QuestionModel.checkIfResetOnRevisit\n   */\n  checkIfResetOnRevisit() {\n    const canReset = (this.model.get('_canReset') !== false);\n    const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n    // If reset is enabled set defaults\n    // Call blank method for question to handle\n    if (!canReset || !isResetOnRevisit) return;\n    // Skip if calling the empty function definition\n    if (this.resetQuestionOnRevisit === QuestionView.prototype.resetQuestionOnRevisit) return;\n    // Warn if using a legacy resetQuestionOnRevisit\n    log.deprecated('QuestionView.resetQuestionOnRevisit, please QuestionModel.reset');\n    // Defer is added to allow the component to render\n    _.defer(() => {\n      this.resetQuestionOnRevisit(isResetOnRevisit);\n    });\n  }\n\n  /**\n   * Ensure the view is in the correct state on first render\n   * @private\n   */\n  ensureLegacyLifecycleState() {\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\n    if (isInteractionComplete) {\n      this.onHideCorrectAnswerClicked();\n      return;\n    }\n    this.onResetClicked();\n  }\n\n  /**\n   * Used by the question to reset the question when revisiting the component\n   * @param {string} type\n   * @deprecated since core v6.0.1 Please use QuestionModel.reset\n   */\n  resetQuestionOnRevisit(type) {}\n\n  // Left blank for question setup - should be used instead of preRender\n  setupQuestion() {}\n\n  // Calls default methods to setup after the question is rendered\n  postRender() {\n    this.addButtonsView();\n    this.onQuestionRendered();\n  }\n\n  // Used to setup buttonsView and sets up the internal events for the question\n  addButtonsView() {\n    this.buttonsView = new ButtonsView({ model: this.model, el: this.$('.btn__container') });\n\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonStateUpdate);\n\n  }\n\n  onButtonStateUpdate(buttonState) {\n\n    switch (buttonState) {\n      case BUTTON_STATE.SUBMIT:\n        this.onSubmitClicked();\n        break;\n      case BUTTON_STATE.RESET:\n        this.onResetClicked();\n        break;\n      case BUTTON_STATE.SHOW_CORRECT_ANSWER:\n        this.onShowCorrectAnswerClicked();\n        break;\n      case BUTTON_STATE.HIDE_CORRECT_ANSWER:\n        this.onHideCorrectAnswerClicked();\n        break;\n      case BUTTON_STATE.SHOW_FEEDBACK:\n        this.showFeedback();\n        break;\n    }\n\n  }\n\n  // Blank method used just like postRender is for presentational components\n  onQuestionRendered() {}\n\n  // Triggered when the submit button is clicked\n  onSubmitClicked() {\n    // canSubmit is setup in questions and should return a boolean\n    // If the question stops the user form submitting - show instruction error\n    // and give a blank method, onCannotSubmit to the question\n    const canSubmit = this._runModelCompatibleFunction('canSubmit');\n\n    if (!canSubmit) {\n      this.showInstructionError();\n      this.onCannotSubmit();\n      return;\n    }\n\n    // Used to update the amount of attempts the question has\n    this._runModelCompatibleFunction('updateAttempts');\n\n    // Used to set attributes on the model after being submitted\n    // Also adds a class of submitted\n    this._runModelCompatibleFunction('setQuestionAsSubmitted');\n\n    // Used to store the users answer for later\n    // This is a blank method given to the question\n    this._runModelCompatibleFunction('storeUserAnswer');\n\n    // Used to set question as correct:true/false\n    // Calls isCorrect which is blank for the question\n    // to fill out and return a boolean\n    this._runModelCompatibleFunction('markQuestion', 'isCorrect');\n\n    // Used by the question to set the score on the model\n    this._runModelCompatibleFunction('setScore');\n\n    // Used to check if the question is complete\n    // Triggers setCompletionStatus and adds class to widget\n    this._runModelCompatibleFunction('checkQuestionCompletion');\n\n    // Used by the question to display markings on the component\n    if (this.model.shouldShowMarking) {\n      this.showMarking();\n    }\n\n    this.recordInteraction();\n\n    // Used to setup the feedback by checking against\n    // question isCorrect or isPartlyCorrect\n    this._runModelCompatibleFunction('setupFeedback');\n\n    // Used to trigger an event so plugins can display feedback\n    // Do this before updating the buttons so that the focus can be\n    // shifted immediately\n    this.showFeedback();\n\n    // Force height re-calculations before the submit button\n    // becomes disabled.\n    $(window).resize();\n\n    // Used to update buttonsView based upon question state\n    // Update buttons happens before showFeedback to preserve tabindexes and after setupFeedback to allow buttons to use feedback attribute\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.model.onSubmitted();\n    this.onSubmitted();\n    Adapt.trigger('questionView:submitted', this);\n  }\n\n  showInstructionError() {\n    Adapt.trigger('questionView:showInstructionError', this);\n  }\n\n  // Blank method for question to fill out when the question cannot be submitted\n  onCannotSubmit() {}\n\n  // Blank method for question to fill out when the question was successfully submitted\n  onSubmitted() {}\n\n  // Used to set _isEnabled and _isSubmitted on the model\n  // Also adds a 'submitted' class to the widget\n  setQuestionAsSubmitted() {\n    this.model.setQuestionAsSubmitted();\n    this.$('.component__widget').addClass('is-submitted');\n  }\n\n  // This is important and should give the user feedback on how they answered the question\n  // Normally done through ticks and crosses by adding classes\n  showMarking() {}\n\n  // Checks if the question should be set to complete\n  // Calls setCompletionStatus and adds complete classes\n  checkQuestionCompletion() {\n\n    const isComplete = this.model.checkQuestionCompletion();\n\n    if (isComplete) {\n      this.$('.component__widget').addClass('is-complete show-user-answer');\n    }\n\n  }\n\n  recordInteraction() {\n    if (this.model.get('_recordInteraction') === true || !this.model.has('_recordInteraction')) {\n      Adapt.trigger('questionView:recordInteraction', this);\n    }\n  }\n\n  // Used to show feedback based upon whether _canShowFeedback is true\n  showFeedback() {\n\n    if (this.model.get('_canShowFeedback')) {\n      Adapt.trigger('questionView:showFeedback', this);\n    } else {\n      Adapt.trigger('questionView:disabledFeedback', this);\n    }\n\n  }\n\n  onResetClicked() {\n    this.setQuestionAsReset();\n\n    this._runModelCompatibleFunction('resetUserAnswer');\n\n    this.model.checkCanSubmit();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    // onResetClicked is called as part of the checkIfResetOnRevisit\n    // function and as a button click. if the view is already rendered,\n    // then the button was clicked, focus on the first tabbable element\n    if (!this.model.get('_isReady')) return;\n    // Attempt to get the current page location\n    const currentModel = data.findById(location._currentId);\n    // Make sure the page is ready\n    if (!currentModel?.get('_isReady')) return;\n    // Focus on the first readable item in this element\n    a11y.focusNext(this.$el, { preventScroll: true });\n  }\n\n  setQuestionAsReset() {\n    this.model.setQuestionAsReset();\n    this.resetQuestion();\n    this.$('.component__widget').removeClass('is-submitted');\n  }\n\n  /**\n   * Used by the question view to reset the look and feel of the component.\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\n   */\n  resetQuestion() {}\n\n  refresh() {\n    this.model.set('_buttonState', this.model.getButtonState());\n\n    if (this.model.shouldShowMarking) {\n      this.showMarking();\n    }\n\n    if (this.buttonsView) {\n      _.defer(this.buttonsView.refresh.bind(this.buttonsView));\n    }\n  }\n\n  onShowCorrectAnswerClicked() {\n    this.setQuestionAsShowCorrect();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.showCorrectAnswer();\n  }\n\n  setQuestionAsShowCorrect() {\n    this.$('.component__widget')\n      .addClass('is-submitted show-correct-answer')\n      .removeClass('show-user-answer');\n  }\n\n  // Used by the question to display the correct answer to the user\n  showCorrectAnswer() {\n    this.model.set('_isCorrectAnswerShown', true);\n  }\n\n  onHideCorrectAnswerClicked() {\n    this.setQuestionAsHideCorrect();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.hideCorrectAnswer();\n  }\n\n  setQuestionAsHideCorrect() {\n    this.$('.component__widget')\n      .addClass('is-submitted show-user-answer')\n      .removeClass('show-correct-answer');\n  }\n\n  // Used by the question to display the users answer and\n  // hide the correct answer\n  // Should use the values stored in storeUserAnswer\n  hideCorrectAnswer() {\n    this.model.set('_isCorrectAnswerShown', false);\n  }\n\n  // Time elapsed between the time the interaction was made available to the learner for response and the time of the first response\n  getLatency() {\n    return null;\n  }\n\n  // This function is overridden if useQuestionModeOnly: false. see below.\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\n    return this.model[name](); // questionModel Only\n  }\n}\n\nQuestionView._isQuestionType = true;\n\n/* BACKWARDS COMPATIBILITY SECTION\n* This section below is only for compatibility between the separated questionView+questionModel and the old questionView\n* Remove this section in when all components use questionModel and there is no need to have model behaviour in the questionView\n*/\n\nclass ViewOnlyQuestionViewCompatibilityLayer extends QuestionView {\n\n  /* All of these functions have been moved to the questionModel.js file.\n    * On the rare occasion that they have not been overridden by the component and\n          that they call the view only questionView version,\n          these functions are included as redirects to the new Question Model.\n          It is very unlikely that these are needed but they are included to ensure compatibility.\n    * If you need to override these in your component you should now make and register a component model.\n    * Please remove them from your question component's view.\n  */\n\n  // Returns an object specific to the question type.\n  getInteractionObject() {\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\n    return this.model.getInteractionObject();\n  }\n\n  // Retturns a string detailing how the user answered the question.\n  getResponse() {\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\n    return this.model.getResponse();\n  }\n\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\n  getResponseType() {\n    log.deprecated('QuestionView.getResponseType, please use QuestionModel.getResponseType');\n    return this.model.getResponseType();\n  }\n\n  // Calls default methods to setup on questions\n  setupDefaultSettings() {\n    log.deprecated('QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings');\n    return this.model.setupDefaultSettings();\n  }\n\n  // Used to setup either global or local button text\n  setupButtonSettings() {\n    log.deprecated('QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings');\n    return this.model.setupButtonSettings();\n  }\n\n  // Used to setup either global or local question weight/score\n  setupWeightSettings() {\n    log.deprecated('QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings');\n    return this.model.setupWeightSettings();\n  }\n\n  // Use to check if the user is allowed to submit the question\n  // Maybe the user has to select an item?\n  canSubmit() {\n    log.deprecated('QuestionView.canSubmit, please use QuestionModel.canSubmit');\n    return this.model.canSubmit();\n  }\n\n  // Used to update the amount of attempts the user has left\n  updateAttempts() {\n    log.deprecated('QuestionView.updateAttempts, please use QuestionModel.updateAttempts');\n    return this.model.updateAttempts();\n  }\n\n  // This is important for returning or showing the users answer\n  // This should preserve the state of the users answers\n  storeUserAnswer() {\n    log.deprecated('QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer');\n    return this.model.storeUserAnswer();\n  }\n\n  // Used by the question view to reset the stored user answer\n  resetUserAnswer() {\n    log.deprecated('QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer');\n    return this.model.resetUserAnswer();\n  }\n\n  // Sets _isCorrect:true/false based upon isCorrect method below\n  markQuestion() {\n\n    if (this._isInViewOnlyCompatibleMode('isCorrect')) {\n\n      if (this.isCorrect()) {\n        this.model.set('_isCorrect', true);\n      } else {\n        this.model.set('_isCorrect', false);\n      }\n\n      this.model.set({\n        _rawScore: this.model.get('_isCorrect') ? this.model.get('_questionWeight') : 0,\n        _maxScore: this.model.get('_questionWeight'),\n        _minScore: 0\n      });\n\n    } else {\n      return this.model.markQuestion();\n    }\n  }\n\n  // Should return a boolean based upon whether to question is correct or not\n  isCorrect() {\n    log.deprecated('QuestionView.isCorrect, please use QuestionModel.isCorrect');\n    return this.model.isCorrect();\n  }\n\n  // Used to set the score based upon the _questionWeight\n  setScore() {\n    log.deprecated('QuestionView.setScore, please use QuestionModel.setScore');\n    return this.model.setScore();\n  }\n\n  // Updates buttons based upon question state by setting\n  // _buttonState on the model which buttonsView listens to\n  updateButtons() {\n    log.deprecated('QuestionView.updateButtons, please use QuestionModel.updateButtons');\n    return this.model.updateButtons();\n  }\n\n  // Used to setup the correct, incorrect and partly correct feedback\n  setupFeedback() {\n\n    if (this._isInViewOnlyCompatibleMode('isPartlyCorrect')) {\n\n      // Use view based feedback where necessary\n      if (this.model.get('_isCorrect')) {\n        this._runModelCompatibleFunction('setupCorrectFeedback');\n      } else if (this.isPartlyCorrect()) {\n        this._runModelCompatibleFunction('setupPartlyCorrectFeedback');\n      } else {\n        this._runModelCompatibleFunction('setupIncorrectFeedback');\n      }\n\n    } else {\n      // Use model based feedback\n      this.model.setupFeedback();\n    }\n\n  }\n\n  // Used by the question to determine if the question is incorrect or partly correct\n  // Should return a boolean\n  isPartlyCorrect() {\n    log.deprecated('QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect');\n    return this.model.isPartlyCorrect();\n  }\n\n  setupCorrectFeedback() {\n    log.deprecated('QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback');\n    return this.model.setupCorrectFeedback();\n  }\n\n  setupPartlyCorrectFeedback() {\n    log.deprecated('QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback');\n    return this.model.setupPartlyCorrectFeedback();\n  }\n\n  setupIncorrectFeedback() {\n    log.deprecated('QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback');\n    return this.model.setupIncorrectFeedback();\n  }\n\n  // Helper functions for compatibility layer\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\n    if (this._isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction)) {\n      return this[name](); // questionView\n    } else {\n      return this.model[name](); // questionModel\n    }\n  }\n\n  _isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction) {\n    // return false uses the model function questionModel\n    // return true uses the view only function questionView\n\n    const checkForFunction = (lookForViewOnlyFunction || name);\n\n    // if the function does NOT exist on the view at all, use the model only\n    if (!this.constructor.prototype[checkForFunction]) return false; // questionModel\n\n    // if the function DOES exist on the view and MATCHES the compatibility function above, use the model only\n    const hasCompatibleVersion = (Object.prototype.hasOwnProperty.call(ViewOnlyQuestionViewCompatibilityLayer.prototype, checkForFunction));\n    const usingCompatibleVersion = (this.constructor.prototype[checkForFunction] === ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction]);\n    if (hasCompatibleVersion && usingCompatibleVersion) {\n      switch (checkForFunction) {\n        case 'setupFeedback':\n        case 'markQuestion':\n          return true; // questionView\n      }\n      return false; // questionModel\n    }\n\n    // if the function DOES exist on the view and does NOT match the compatibility function above, use the view function\n    return true; // questionView\n  }\n\n};\n\n// return question view class extended with the compatibility layer\nexport default ViewOnlyQuestionViewCompatibilityLayer;\n\n/* END OF BACKWARDS COMPATIBILITY SECTION */\n","import QuestionView from 'core/js/views/questionView';\n\nclass DndMultipleView extends QuestionView {\n  preinitialize() {\n    this.setItems = (...args) => this.model.setItems(...args);\n  }\n\n  initialize() {\n    super.initialize();\n    // Listen for changes in the _items attribute\n    this.listenTo(this.model, 'change:_items', this.render);\n  }\n\n\n  setupQuestion() {\n  }\n\n  onQuestionRendered() {\n    this.setReadyStatus();\n  }\n}\n\nDndMultipleView.template = 'dndMultiple.jsx';\n\nexport default DndMultipleView;\n","import QuestionModel from 'core/js/models/questionModel';\nimport Adapt from 'core/js/adapt';\n\nexport default class DnDMultipleModel extends QuestionModel {\n\n  init() {\n    super.init();\n    this.checkCanSubmit();\n    console.log(this.get('_items'));\n    const openTextComponent = Adapt.findById(this.get('textId'));\n    openTextComponent.on('change:_isComplete', this.onOpenTextComplete, this);\n    // check event trigger\n  }\n\n  // This function will be called when the Open Text component is completed\n  onOpenTextComplete(model, isComplete) {\n    console.log(isComplete ? 'Open Text is complete' : 'Open Text is not complete')\n    if (isComplete) {\n      // Update the DnDMultiple component's items and re-render the view\n      this.updateItems();\n    }\n  }\n\n  updateItems() {\n    // Get the updated values for the items from the Open Text component\n    const updatedValuesHtml = Adapt.findById(this.get('textId')).getUserAnswer();\n\n    if (!updatedValuesHtml) return;\n  \n    const newOptions = this.htmlToItems(updatedValuesHtml);\n    const existingItems = this.get('_items') || [];\n    console.log(newOptions)\n    console.log(existingItems)\n  \n    // Check if there is a first item in the existing items\n    if (existingItems.length > 0) {\n      // Update the _options property of the first item with the new options\n      existingItems[0]._options = newOptions;\n  \n      const updated = [...existingItems];\n      this.set({ _items: updated });\n  \n      this.setUpItems();\n      this.setUpItemsOptions();\n    }\n  }\n  \n\n  htmlToItems(htmlString) {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlString, 'text/html');\n    const liElements = doc.querySelectorAll('li');\n    const options = Array.from(liElements).map((li, index) => {\n      return {\n        title: li.textContent,\n        _graphic: {\n          src: \"\",\n          isBackground: false,\n          alt: \"\"\n        },\n        id: index,\n        _optionIndex: index,\n        _itemIndex: Math.floor(index / 3) + 1, // Assuming there are 3 options per item\n        _itemId: Math.floor(index / 3),\n        _isCorrect: true\n      };\n    });\n    return options;\n  }\n\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    this.set({\n      _isAtLeastOneCorrectSelection: false,\n      _isCorrect: null\n    });\n    return true;\n  }\n\n  setUpItems() {\n    let index = 0;\n    const items = JSON.parse(JSON.stringify(this.get('_items'))) || [];\n\n    items.forEach((item, itemIndex) => {\n      item.id = itemIndex + 1;\n      item.droppableId = item.id + '';\n      item._isCorrect = true;\n      item._userAnswer = [];\n      const itemOptions = item._options || [];\n      console.log(itemOptions)\n      itemOptions.forEach((option, optionIndex) => {\n        option.id = index++;\n        option._optionIndex = optionIndex;\n        option._itemIndex = item.id;\n        option._itemId = itemIndex;\n        option._isCorrect = true;\n      });\n    });\n\n    items.unshift({\n      title: this.get('_startText') || '',\n      _options: [],\n      id: 0,\n      droppableId: '0'\n    });\n    this.set({ _correctItems: items, _items: items });\n  }\n\n  setUpItemsOptions() {\n    const items = JSON.parse(JSON.stringify(this.get('_items'))) || [];\n    console.log(items);\n    const options = items.reduce((options, item, itemIndex) => {\n      const itemOptions = item._options || [];\n      options.push(...itemOptions);\n      return options;\n    }, []);\n    items.forEach((item) => {\n      if (item.id !== 0) {\n        item._options = [];\n      }\n    });\n\n    options.sort(() => Math.random() - 0.5);\n    items.filter((item) => item.id === 0)[0]._options.push(...options);\n    const intialItems = items.reduce((intialItems, item) => {\n      intialItems[item.id] = item;\n      return intialItems;\n    }, {});\n\n    this.set({ _items: intialItems, _allOptions: options });\n  }\n\n  restoreUserAnswers() {\n    if (!this.get('_isSubmitted')) return;\n\n    const userAnswer = this.get('_userAnswer');\n    const items = JSON.parse(JSON.stringify(this.get('_items')));\n\n    userAnswer.forEach((answer) => {\n      const itemId = answer[0];\n      const optionId = answer[1] - 1;\n      const option = items[0]._options.find((option) => {\n        return option.id === optionId;\n      });\n      items[itemId]._options.push(option);\n    });\n    items[0]._options = [];\n    this.set({ _items: items });\n    this.checkCanSubmit();\n    this.setQuestionAsSubmitted();\n    this.markQuestion();\n    this.markItems();\n    this.setScore();\n    this.setupFeedback();\n  }\n\n  canSubmit() {\n    return this.get('_items')[0]._options.length === 0;\n  }\n\n  setItems(items) {\n    this.set({ _items: items });\n    this.checkCanSubmit();\n  }\n\n  markItems() {\n    const objItems = this.get('_items');\n    const items = Object.keys(objItems).map((key) => objItems[key]);\n    items.forEach((item) => {\n      item._options.forEach((option, optionIndex) => {\n        if (this.get('_useStrictOrder')) {\n          option._isCorrect =\n            option._optionIndex === optionIndex &&\n            option._itemIndex === item.id;\n        } else {\n          option._isCorrect = option._itemIndex === item.id;\n        }\n      });\n      if (\n        item._options.every((option) => {\n          return option._isCorrect;\n        })\n      ) {\n        item._isCorrect = true;\n      } else {\n        item._isCorrect = false;\n      }\n    });\n    this.setItems(items);\n  }\n\n  storeUserAnswer() {\n    const items = this.getDraggableItems();\n    this.isCorrect();\n    this.markItems();\n    const userAnswer = items.reduce((userAnswer, item) => {\n      userAnswer.push(\n        ...item._options.map((option) => {\n          return [Number(item.droppableId), option.id + 1];\n        })\n      );\n      return userAnswer;\n    }, []);\n    this.set({\n      _userAnswer: userAnswer\n    });\n  }\n\n  getDraggableItems() {\n    const items = this.get('_items');\n    return Object.keys(items)\n      .filter((key) => key !== '0')\n      .map((key) => items[key]);\n  }\n\n  isCorrect() {\n    const hasAllCorrectAnswers = this.getDraggableItems().every((item) => {\n      return item._options.every((option, optionIndex) => {\n        if (this.get('_useStrictOrder')) {\n          return (\n            option._itemIndex === item.id && option._optionIndex === optionIndex\n          );\n        }\n        return option._itemIndex === item.id;\n      });\n    });\n    const hasIncorrectAnswers = this.getDraggableItems().some((item) => {\n      return item._options.some((option) => {\n        return option._itemIndex !== item.id;\n      });\n    });\n    const hasPartlyCorrectAnswers = this.getDraggableItems().some((item) => {\n      return item._options.some((option) => {\n        return option._itemIndex === item.id;\n      });\n    });\n\n    const _numberOfCorrectAnswers = this.getDraggableItems().reduce(\n      (numberOfCorrectAnswers, item) => {\n        return (\n          numberOfCorrectAnswers +\n          item._options.filter((option, optionIndex) => {\n            if (!option) return false;\n            if (this.get('_useStrictOrder')) {\n              return (\n                option._itemIndex === item.id &&\n                option._optionIndex === optionIndex\n              );\n            }\n            return option._itemIndex === item.id;\n          }).length\n        );\n      },\n      0\n    );\n    this.set({\n      _isAtLeastOneCorrectSelection: hasPartlyCorrectAnswers,\n      _numberOfCorrectAnswers\n    });\n    return hasAllCorrectAnswers && !hasIncorrectAnswers;\n  }\n\n  isPartlyCorrect() {\n    return this.get('_isAtLeastOneCorrectSelection');\n  }\n\n  setScore() {\n    const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\n    const questionWeight = this.get('_questionWeight');\n    const optionsLength = this.getDraggableItems().reduce(\n      (optionsLength, item) => {\n        return optionsLength + item._options.length;\n      },\n      0\n    );\n\n    const score = (questionWeight * numberOfCorrectAnswers) / optionsLength;\n    this.set('_score', score);\n  }\n\n  resetUserAnswer() {\n    this.set('_userAnswer', []);\n  }\n\n  resetItems() {\n    const objectItems = this.get('_items');\n    const items = Object.keys(this.get('_items')).map(\n      (key) => objectItems[key]\n    );\n    items.forEach((item) => {\n      item._isCorrect = true;\n      item._userAnswer = [];\n      item._options = [];\n    });\n    items[0]._options = this.get('_allOptions');\n    const intialItems = items.reduce((intialItems, item) => {\n      intialItems[item.id] = item;\n      return intialItems;\n    }, {});\n    this.setItems(intialItems);\n  }\n\n  resetQuestion() {\n    this.resetItems();\n  }\n  getResponse() {\n    const response = this.get('_userAnswer').map((option) => {\n      return option.join('.');\n    });\n    return response.join('#');\n  }\n\n  getResponseType() {\n    return 'matching';\n  }\n\n  getInteractionObject() {\n    return {};\n  }\n\n  getCorrectAnswerAsText() {\n    return '';\n  }\n\n  getUserAnswerAsText() {\n    return '';\n  }\n}\n","import components from 'core/js/components';\nimport DndMultipleView from './DndMultipleView';\nimport DndMultipleModel from './DndMultipleModel';\n\nexport default components.register('dnd-multiple', {\n  model: DndMultipleModel,\n  view: DndMultipleView\n});\n","/*\n * adapt-contrib-openTextInput\n * License - http://github.com/adaptlearning/adapt_framework/LICENSE\n * Maintainers\n * Brian Quinn <brian@learningpool.com>\n * Barry McKay <barry@learningpool.com>\n */\n\ndefine([\n  'core/js/models/questionModel',\n  'core/js/enums/buttonStateEnum'\n], function(QuestionModel, BUTTON_STATE) {\n\n  class OpenTextInputModel extends QuestionModel {\n\n    formatPlaceholder() {\n      // Replace quote marks in placeholder.\n      let placeholder = this.get('placeholder') || '';\n      placeholder = placeholder.replace(/\"/g, '\\'');\n\n      this.set('placeholder', placeholder);\n    }\n\n    setupQuestion(localUserAnswer) {\n      // Open Text Input cannot show feedback, but may have been set in older courses\n      this.set('_canShowFeedback', false);\n      this.set('_feedback', null);\n\n      this.formatPlaceholder();\n\n      if (localUserAnswer) {\n        this.setUserAnswer(localUserAnswer);\n      } else {\n        // Update the visible text\n        const answer = this.getUserAnswer();\n        this.set('userAnswerString', answer);\n      }\n\n      let modelAnswer = this.get('modelAnswer');\n      modelAnswer = modelAnswer ? modelAnswer.replace(/\\\\n|&#10;/g, '\\n') : '';\n\n      this.set('modelAnswer', modelAnswer);\n\n      let _buttonState = BUTTON_STATE.SUBMIT\n\n      if (this.get('_isComplete')) {\n        _buttonState =  BUTTON_STATE.CORRECT;\n\n        if (this.get('_canShowModelAnswer')) {\n          _buttonState = BUTTON_STATE.SHOW_CORRECT_ANSWER;\n        }\n      }\n\n      this.set('_buttonState', _buttonState);\n\n      // Some shim code to handle old/missing JSON.\n      const buttons = this.get('_buttons');\n\n      if (buttons['_hideCorrectAnswer'] === undefined) {\n        buttons._hideCorrectAnswer = buttons._showUserAnswer || 'Show User Answer';\n      }\n\n      if (buttons['_showCorrectAnswer'] === undefined) {\n        buttons._showCorrectAnswer = buttons._showModelAnswer || 'Show Model Answer';\n      }\n\n      this.set('_buttons', buttons);\n    }\n\n    getUserAnswer() {\n      // Turn the array of integers into a string\n      const answerArray = this.get('_userAnswer') || this.get('userAnswer') || [];\n\n      return String.fromCharCode(...answerArray);\n    }\n\n    setUserAnswer(answer) {\n      // Turn the string into an array of integers\n      const _userAnswer = [...answer].map((char, index) => {\n        return answer.codePointAt(index);\n      })\n\n      this.set('userAnswerString', answer);\n      this.set('_userAnswer', _userAnswer);\n    }\n\n    canSubmit() {\n      return !this.get('_exceededLimit') && this.get('_userAnswer');\n    }\n\n    isCorrect() {\n      return this.canSubmit();\n    }\n\n    /**\n     * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n     */\n    getResponse() {\n      return this.getUserAnswer();\n    }\n\n    /**\n     * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n     */\n    getResponseType() {\n      return 'fill-in';\n    }\n\n    getInteractionObject() {\n      return {\n        correctResponsesPattern: [\n          this.get('modelAnswer')\n        ]\n      };\n    }\n  };\n\n  return OpenTextInputModel;\n\n});\n","/*\n * adapt-contrib-openTextInput\n * License - http://github.com/adaptlearning/adapt_framework/LICENSE\n * Maintainers\n * Brian Quinn <brian@learningpool.com>\n * Barry McKay <barry@learningpool.com>\n */\n\ndefine([\n  'core/js/adapt',\n  'core/js/views/questionView',\n  'core/js/enums/buttonStateEnum',\n  'libraries/ckeditor'\n], function(Adapt, QuestionView, BUTTON_STATE, ClassicEditor) {\n\n  const HIDE_MODEL_ANSWER_CLASS = 'opentextinput__hide-modelanswer'\n  const SHOW_MODEL_ANSWER_CLASS = 'opentextinput__show-modelanswer'\n\n  class OpenTextInputView extends QuestionView {\n\n    events() {\n      return {\n        'keyup .ck-editor__editable': 'onKeyUpTextarea'\n      }\n    }\n\n    onKeyUpTextarea() {\n      const countandLimitCharacters = _.throttle(() => {\n        this.model.setUserAnswer(this.editor.getData());\n      }, 300);\n      countandLimitCharacters();\n      this.model.checkCanSubmit();\n      if(!this.model.get('_canSubmit')) {\n        $('.opentextinput__limit-prompt').show();\n      } else {\n        $('.opentextinput__limit-prompt').hide();\n      }\n    }\n\n    setupQuestion() {\n      this.listenTo(this.model, 'change:_isComplete', this.onCompleteChanged);\n      const localUserAnswer = this.loadLocalAnswer();\n      this.model.setupQuestion(localUserAnswer);\n    }\n\n    onCompleteChanged(isComplete, buttonState) {\n \n      // disable the ck5 editor on complete\n      this.editor.enableReadOnlyMode( 'my-feature-id' );\n\n\n      // on complete change can be called when submitting a correct answer\n      // we need to check if the textbox already has a value before\n      // attempting to prepopulate the answer field with the model user answer\n      if (this.$textbox.html() === '') {\n        this.$textbox.html(this.model.getUserAnswer().replace(/\\n/g, '<br>'));\n      }\n\n      if (!isComplete) return;\n\n      if (!this.model.get('_canShowModelAnswer')) return;\n\n      // Keep the action button enabled so we can show the model answer.\n      Adapt.a11y.toggleAccessibleEnabled(this.$('.btn__action'), true);\n      // Ensure count is not read out again\n      // Adapt.a11y.toggleAccessible(this.$('.opentextinput__count-amount'), false);\n\n      if (_.isEmpty(buttonState)) return;\n\n      let _buttonState = BUTTON_STATE.HIDE_CORRECT_ANSWER;\n\n      // Toggle the button.\n      if (buttonState === BUTTON_STATE.CORRECT || buttonState === BUTTON_STATE.HIDE_CORRECT_ANSWER || buttonState === BUTTON_STATE.SUBMIT) {\n        _buttonState = BUTTON_STATE.SHOW_CORRECT_ANSWER;\n      }\n\n      this.model.set('_buttonState', _buttonState);\n    }\n\n    isCorrect() {\n      return this.model.isCorrect();\n    }\n\n    onQuestionRendered() {\n      this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onActionClicked);\n\n      this.$textbox = this.$('.opentextinput__answer-container');\n      this.$countChars = this.$('.opentextinput__count-characters')\n      this.$modelAnswer = this.$('.opentextinput__item-modelanswer');\n\n      this.setReadyStatus();\n\n      if (this.model.get('_isComplete') && !this.model.get('_canShowModelAnswer')) {\n        // Model answer has been disabled.\n        // Force setting the correct/submitted state.\n        this.model.set('_buttonState', BUTTON_STATE.CORRECT);\n      }\n\n      if (!this.model.get('_isInteractionComplete')) return;\n      // this.$textbox.prop('disabled', true);\n    }\n\n    loadLocalAnswer() {\n      const identifier = this.model.get('_id') + '-OpenTextInput-UserAnswer';\n      let userAnswer = false;\n\n      if (this.supportsHtml5Storage() && !this.model.get('_isResetOnRevisit')) {\n        userAnswer = localStorage.getItem(identifier);\n      }\n\n      return userAnswer;\n    }\n\n    supportsHtml5Storage() {\n      // check for html5 local storage support\n      try {\n        return 'localStorage' in window && typeof window['localStorage'] !== 'undefined';\n      } catch (e) {\n        return false;\n      }\n    }\n\n    limitCharacters() {\n      const allowedCharacters = this.model.get('_allowedCharacters');\n      if (allowedCharacters !== null && this.$textbox.val().length > allowedCharacters) {\n        const substringValue = this.$textbox.val().substring(0, allowedCharacters);\n        this.$textbox.val(substringValue);\n      }\n    }\n\n    onSubmitted() {\n      const userAnswer = this.editor.getData();\n      this.model.setUserAnswer(userAnswer);\n      this.storeUserAnswer();\n    }\n\n    storeUserAnswer() {\n      // Use unique identifier to avoid collisions with other components\n      const identifier = this.model.get('_id') + '-OpenTextInput-UserAnswer';\n\n      if (this.supportsHtml5Storage() && !this.model.get('_isResetOnRevisit')) {\n        // Adding a try-catch here as certain browsers, e.g. Safari on iOS in Private mode,\n        // report as being able to support localStorage but fail when setItem() is called.\n        try {\n          localStorage.setItem(identifier, this.editor.getData());\n        } catch (e) {\n          console.log('ERROR: HTML5 localStorage.setItem() failed! Unable to save user answer.');\n        }\n      }\n\n      this.model.set('_isSaved', true);\n    }\n\n    onActionClicked(buttonState) {\n      // if (!this.model.get('_isComplete')) return;\n      this.onCompleteChanged(true, buttonState);\n    }\n\n    postRender() {\n      QuestionView.prototype.postRender.call(this);\n      const $container = this.$( '.opentextinput__widget');\n      const $progressCircle =  this.$( '.demo-update__chart__circle' );\n      const $charactersBox =  this.$( '.demo-update__chart__characters' );\n      const $wordsBox = this.$( '.demo-update__words' );\n      const $circleCircumference = Math.floor( 2 * Math.PI * $($progressCircle).attr( 'r' ) );\n      const sendButton =  this.$( '.demo-update__send' );\n\n      const maxCharacters = this.model.get('_allowedCharacters');\n\n      ClassicEditor.create ( document.querySelector( '#textbox__' + this.model.get('_id') ),{\n        wordCount: {\n          onUpdate: stats => {\n              const charactersProgress = stats.characters / maxCharacters * $circleCircumference;\n              const isLimitExceeded = stats.characters > maxCharacters;\n              const isCloseToLimit = !isLimitExceeded && stats.characters > maxCharacters * .8;\n              const circleDashArray = Math.min( charactersProgress, $circleCircumference );\n\n              // Set the stroke of the circle to show how many characters were typed.\n              $($progressCircle).attr( 'stroke-dasharray', `${ circleDashArray },${ $circleCircumference }` );\n\n              // Display the number of characters in the progress chart. When the limit is exceeded,\n              // display how many characters should be removed.\n              if ( isLimitExceeded ) {\n                  $charactersBox.textContent = `-${ stats.characters - maxCharacters }`;\n              } else {\n                  $charactersBox.textContent = stats.characters;\n              }\n\n              $wordsBox.textContent = `Words in the post: ${ stats.words }`;\n\n              // If the content length is close to the character limit, add a CSS class to warn the user.\n              $($container).toggleClass( 'demo-update__limit-close', isCloseToLimit );\n\n              // If the character limit is exceeded, add a CSS class that makes the content's background red.\n              $container.toggleClass( 'demo-update__limit-exceeded', isLimitExceeded );\n\n              // If the character limit is exceeded, disable the send button.\n              this.model.set( '_exceededLimit', isLimitExceeded );\n            }\n          }\n        } \n      )\n      .then( editor => {\n        this.editor = editor;\n        const wordCountPlugin = editor.plugins.get( 'WordCount' );\n        const wordCountWrapper = document.getElementById( 'word-count__' + this.model.get('_id'));\n\n        wordCountWrapper.appendChild( wordCountPlugin.wordCountContainer );\n      })\n      .catch ( error => {\n          console.error( error );\n      } );\n\n      this.$textbox.css('height', 'auto');\n      this.$countChars.css('height', 'auto');\n\n      this.$modelAnswer.addClass(HIDE_MODEL_ANSWER_CLASS);\n    }\n\n    showCorrectAnswer() {\n      this.model.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\n\n      this.$textbox.hide();\n      this.$countChars.hide();\n      this.$modelAnswer.addClass(SHOW_MODEL_ANSWER_CLASS).removeClass(HIDE_MODEL_ANSWER_CLASS);\n\n      // Give focus to Model Answer to be read by Screen Reader\n      Adapt.a11y.focusFirst(this.$('.opentextinput__item-modelanswer'));\n    }\n\n    hideCorrectAnswer() {\n      this.model.set('_buttonState', BUTTON_STATE.SHOW_CORRECT_ANSWER);\n\n      this.$textbox.show();\n      this.$countChars.show();\n      this.$('.opentextinput__item-modelanswer')\n        .addClass(HIDE_MODEL_ANSWER_CLASS)\n        .removeClass(SHOW_MODEL_ANSWER_CLASS);\n    }\n\n    /**\n     * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n     */\n    getResponse() {\n      return this.model.getResponse();\n    }\n\n    /**\n     * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n     */\n    getResponseType() {\n      return this.model.getResponseType();\n    }\n\n    getInteractionObject() {\n      return this.model.getInteractionObject();\n    }\n\n    /**\n     * Used by questionView. Clears the models on Revisit userAnswer so input appears blank\n     */\n    resetQuestionOnRevisit() {\n      this.resetQuestion();\n    }\n\n    /**\n     * Used by questionView. Clears the models userAnswer onResetClicked so input appears blank\n     */\n    resetQuestion() {\n      this.model.setUserAnswer('');\n    }\n  };\n\n  return OpenTextInputView;\n\n});\n","/*\n * adapt-contrib-openTextInput\n * License - http://github.com/adaptlearning/adapt_framework/LICENSE\n * Maintainers\n * Brian Quinn <brian@learningpool.com>\n * Barry McKay <barry@learningpool.com>\n */\n\ndefine([\n  'core/js/adapt',\n  './openTextInputModel',\n  './openTextInputView',\n], function(Adapt, OpenTextInputModel, OpenTextInputView) {\n\n  Adapt.once('adapt:start', restoreQuestionStatusPolyfill);\n\n  return Adapt.register('formattedOpenTextInput', {\n    view: OpenTextInputView,\n    model: OpenTextInputModel\n  });\n\n  /**\n   * Spoor cannot store text input values and so the completion status of this component does not get\n   * saved or restored properly. This function ensures that the question's completion status is\n   * restored in a way that other extensions e.g. learning objectives can obtain accurate data for processing\n   */\n  function restoreQuestionStatusPolyfill() {\n    Adapt.components.each(function(component) {\n      if (component.get('_component') !== 'formattedOpenTextInput') return;\n\n      if (!component.get('_isComplete')) return;\n\n      // If the component is complete then it must be correct\n      // _isInteractionComplete needs to be set to true so marking is restored correctly\n      component.set({\n        _isCorrect: true,\n        _isInteractionComplete: true\n      });\n\n      // Add a manual trigger just in case any extensions listening for this change have already loaded\n      component.trigger('change:_isComplete', component, true);\n    });\n  }\n\n});\n","import ComponentView from 'core/js/views/componentView';\n\nclass TrialogueView extends ComponentView {\n  preRender() {\n    this.onClick = this.onClick.bind(this);\n  }\n\n  postRender() {\n    this.setReadyStatus();\n    this.setupTrialogue();\n  }\n\n  setupTrialogue() {\n    const items = this.model.getChildren();\n    if (!items || !items.length) return;\n\n    let activeItem = this.model.getActiveItem();\n    if (!activeItem) {\n      activeItem = this.model.getItem(0);\n      activeItem.toggleActive(true);\n    } else {\n      // manually trigger change as it is not fired on reentry\n      items.trigger('change:_isActive', activeItem, true);\n    }\n  }\n\n  onClick(item, option) {\n    if (!item || !option) return;\n    if (option.text === 'restart') {\n      this.model.getChildren().forEach((item) => {\n        item.set('_isVisited', false);\n        item.toggleActive(false);\n        item.get('_options').forEach((option) => {\n          option._isSelected = false;\n        });\n      });\n      this.model.set('_userAnswer', []);\n      this.setupTrialogue();\n      return;\n    }\n    const itemModel = this.model.getItem(item._index);\n    itemModel.set('_isVisited', true);\n    const optionModel = itemModel.get('_options').find((optionModel) => optionModel._index === option._index);\n    optionModel._isSelected = true;\n    const items = this.model.getChildren();\n    // const lastItem = items.at(items.length - 1);\n    /* if (itemModel === lastItem) {\n\n    } else { */\n    const nextItem = items.find((item) => item.id === option.text);\n\n    if (nextItem) {\n      const isFeedback = nextItem.get('next') === 'feedback';\n      if (isFeedback) {\n        itemModel.toggleActive(false);\n        nextItem.toggleActive(true);\n        this.model.setCompletionStatus();\n      } else {\n        const hasSender = nextItem.get('sender');\n        if (hasSender) {\n          itemModel.toggleActive(false);\n          nextItem.toggleActive(true);\n        } else {\n          itemModel.toggleActive(false);\n          nextItem.toggleActive(true);\n        }\n      }\n    } else {\n      itemModel.toggleActive(false);\n    }\n  }\n}\n\nTrialogueView.template = 'trialogue.jsx';\n\nexport default TrialogueView;\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class ItemModel extends LockingModel {\n\n  defaults() {\n    return {\n      _isActive: false,\n      _isVisited: false,\n      _score: 0\n    };\n  }\n\n  reset() {\n    this.set({ _isActive: false, _isVisited: false });\n  }\n\n  toggleActive(isActive = !this.get('_isActive')) {\n    this.set('_isActive', isActive);\n  }\n\n  toggleVisited(isVisited = !this.get('_isVisited')) {\n    this.set('_isVisited', isVisited);\n  }\n\n}\n","import ComponentModel from 'core/js/models/componentModel';\nimport ItemModel from 'core/js/models/itemModel';\n\nexport default class ItemsComponentModel extends ComponentModel {\n\n  toJSON() {\n    const json = super.toJSON();\n    // Make sure _items is updated from child collection\n    json._items = this.getChildren().toJSON();\n    return json;\n  }\n\n  init() {\n    this.setUpItems();\n    this.listenTo(this.getChildren(), {\n      all: this.onAll,\n      'change:_isActive': this.setVisitedStatus,\n      'change:_isVisited': this.checkCompletionStatus\n    });\n    super.init();\n  }\n\n  restoreUserAnswers() {\n    const booleanArray = this.get('_userAnswer');\n    if (!booleanArray) return;\n    this.getChildren().forEach((child, index) => child.set('_isVisited', booleanArray[index]));\n  }\n\n  storeUserAnswer() {\n    const booleanArray = this.getChildren().map(child => child.get('_isVisited'));\n    this.set('_userAnswer', booleanArray);\n  }\n\n  setUpItems() {\n    // see https://github.com/adaptlearning/adapt_framework/issues/2480\n    const items = this.get('_items') || [];\n    items.forEach((item, index) => (item._index = index));\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\n  }\n\n  getItem(index) {\n    return this.getChildren().findWhere({ _index: index });\n  }\n\n  getVisitedItems() {\n    return this.getChildren().where({ _isVisited: true });\n  }\n\n  getActiveItems() {\n    return this.getChildren().where({ _isActive: true });\n  }\n\n  getActiveItem() {\n    return this.getChildren().findWhere({ _isActive: true });\n  }\n\n  areAllItemsCompleted() {\n    return this.getVisitedItems().length === this.getChildren().length;\n  }\n\n  checkCompletionStatus() {\n    this.setVisitedStatus();\n    this.storeUserAnswer();\n    if (!this.areAllItemsCompleted()) return;\n    this.setCompletionStatus();\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    this.getChildren().each(item => item.reset());\n    return true;\n  }\n\n  resetActiveItems() {\n    this.getChildren().each(item => item.toggleActive(false));\n  }\n\n  setActiveItem(index) {\n    const item = this.getItem(index);\n    if (!item) return;\n\n    const activeItem = this.getActiveItem();\n    if (activeItem) activeItem.toggleActive(false);\n    item.toggleActive(true);\n  }\n\n}\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\nimport ItemModel from 'core/js/models/itemModel';\nexport default class TrialogueModel extends ItemsComponentModel {\n  restoreUserAnswers() {\n    const booleanArray = this.get('_userAnswer');\n    if (!booleanArray) return;\n    this.getChildren().forEach((child, index) => child.set('_isVisited', booleanArray[index]));\n  }\n\n  storeUserAnswer() {\n    const booleanArray = this.getChildren().map((child) => child.get('_isVisited'));\n    this.set('_userAnswer', booleanArray);\n  }\n\n  setUpItems() {\n    const items = this.get('_items') || [];\n    items.forEach((item, index) => {\n      item._index = index;\n      item._options.forEach((option, index) => {\n        option._index = index;\n        option._itemIndex = item._index;\n\n        option._isSelected = false;\n      });\n    });\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\n  }\n}\n","import Adapt from 'core/js/adapt';\nimport TrialogueView from './TrialogueView';\nimport TrialogueModel from './TrialogueModel';\n\nexport default Adapt.register('trialogue', {\n  model: TrialogueModel,\n  view: TrialogueView\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n    var aboutPage = _.extend({\n  \n    initialize: function() {\n    \tthis.listenTo(Adapt, 'aboutPage:showAboutPage', this.showAboutPage);\n    \tthis.listenTo(Adapt, 'router:course', this.updateCourse);\n        this.listenTo(Adapt, 'pageView:ready', this.addLink);\n        this.listenTo(Adapt, 'menuView:ready', this.addLink);\n        this.listenTo(Adapt, 'router:page', this.updatePage);\n    },\n\n    updateCourse: function(target) {\n    \tthis.currentCourse = target;\n    },\n\n    updatePage: function(target) {\n        this.contentObject = target;\n    },\n\n    getPage: function() {\n        return this.contentObject;\n    },\n\n    getCourse: function() {\n    \treturn this.currentCourse;\n    },\n\n    addLink: function() {\n        var title = \"About\";\n        var contactEmail = \"\";\n        var contactLinkText = \"\";\n        \n        try { title = Adapt.course.get('_globals')._extensions._aboutPage.linkText; } catch(err) {}\n        \n        try { \n            var items = Adapt.course.get('_aboutPage')._items; \n        } catch(err) {\n            return;\n        }\n\n        try {\n        \tif( $('.about-links').prop('innerHTML').trim().length > 0) {\n            \t\t$('.about-links').append(' | ');\n        \t} \n        \t$('.about-links').append('<a class=\"about\" onClick=\"require(\\'core/js/adapt\\').trigger(\\'aboutPage:showAboutPage\\'); return false;\">'+title+'</a>');\n\t   } catch(err) {\n        \n       }\n\n       try {\n            contactEmail = Adapt.course.get('_globals')._extensions._aboutPage.contactEMail;\n            contactLinkText = Adapt.course.get('_globals')._extensions._aboutPage.contactLinkText;\n            if (contactLinkText != \"\" && contactEmail != \"\") {\n                console.log(contactEmail);\n                console.log(contactLinkText);\n                if( $('.about-links').prop('innerHTML').trim().length > 0) {\n                    $('.about-links').append(' | ');\n                }\n                $('.about-links').append('<a class=\"contact\" href=\"mailto:'+contactEmail+'\" target=\"_blank\">'+contactLinkText+'</a>');\n            }\n       } catch (err) {\n        console.log(err);\n       }\n\n       try {\n            var aboutcredit = this.contentObject.get('_aboutPage').aboutCredit;\n            if (aboutcredit != \"\") {\n                $('.about-credit').html(aboutcredit);\n            }\n        } catch(err) {\n        }\n\n        try {\n            var aboutSLtext = this.contentObject.get('_aboutPage').SL_text;\n            if (aboutSLtext != \"\") {\n                $('#about-SL-text').html(aboutSLtext);\n            }\n        } catch(err) {}\n    },\n\n    showAboutPage: function() {\n        var items = [];\n        try {\n            items = this.contentObject.get('_aboutPage')._items;\n        } catch(err) {}\n        if (items.length < 1) {\n            items = Adapt.course.get('_aboutPage')._items;\n        }\n        var title = \"About\";\n        try {\n            title = Adapt.course.get('_globals')._extensions._aboutPage.titleText;\n        } catch(err) {}\n    \tvar string = \"\";\n    \tvar count = 1;\n        _.each(items, function(item) {\n            var graphic = item._graphic;\n            if (graphic.src) {\n    \t\t\tstring += \"<div class='aboutPageGraphicElement'><img class='aboutPageGraphic' src='\" + graphic.src + \"'/></div>\";\n            }\n            string += \"<div class='aboutPageText'>\";\n            string += \"<h2>\" + item.title + \"</h2>\";\n            string += \"<p>\" + item.description + \"</p>\";\n            string += \"</div>\";\n            string += \"<hr class='aboutPageRule'/>\";\n    \t});\n        var alertObject = {\n            title: title,\n            body: string\n        };\n        \n        Adapt.once(\"notify:closed\", function() {\n            Adapt.trigger(\"tutor:closed\");\n        });\n\n        Adapt.trigger('notify:popup', alertObject);\n\n        Adapt.trigger('tutor:opened');\n    }\n\n  }, Backbone.Events);\n  \n  aboutPage.initialize();\n\n  return (aboutPage);\n});","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptArticleView from 'core/js/views/articleView';\n\nconst AssessmentView = {\n\n  postRender() {\n    AdaptArticleView.prototype.postRender.call(this);\n    if (this.model.isAssessmentEnabled()) {\n      this._setupEventListeners();\n\n      const config = this.model.getConfig();\n      if (config?._questions?._canShowMarking === false) {\n        this.$el.addClass('has-no-marking');\n      }\n    }\n    this.$el.addClass('is-assessment');\n  },\n\n  _setupEventListeners() {\n    this.listenTo(Adapt, {\n      'assessments:complete': this._onAssessmentComplete,\n      'assessments:reset': this._onAssessmentReset,\n      remove: this._onRemove\n    });\n  },\n\n  _removeEventListeners() {\n    this.stopListening(Adapt, {\n      'assessments:complete': this._onAssessmentComplete,\n      'assessments:reset': this._onAssessmentReset\n    });\n  },\n\n  _onAssessmentComplete(state, model) {\n    if (state.id !== this.model.get('_assessment')._id) return;\n\n    logging.info('assessment complete', state, model);\n  },\n\n  _onAssessmentReset(state, model) {\n    if (state.id !== this.model.get('_assessment')._id) return;\n\n    logging.info('assessment reset', state, model);\n\n  },\n\n  _onRemove() {\n    this._removeEventListeners();\n  }\n\n};\n\nexport default AssessmentView;\n","import data from 'core/js/data';\nimport logging from 'core/js/logging';\n\nclass QuestionBank {\n\n  constructor(quizBankId, articleId) {\n    this._bankId = quizBankId;\n    this._articleId = articleId;\n    this._unusedQuestionBlocks = null;\n    this._count = null;\n  }\n\n  calculateAvailableQuestionBlocks(count) {\n    this._count = parseInt(count);\n    const articleModel = data.findById(this._articleId);\n    const children = articleModel.getAvailableChildModels();\n    this._availableQuestionBlocks = children.map(blockModel => {\n      if (blockModel.get('_assessment')?._quizBankID !== this._bankId) return null;\n      return blockModel;\n    }).filter(Boolean);\n    const availableQuestionBlockIds = this._availableQuestionBlocks?.map(block => block.get('_id')) || [];\n    const unusedQuestionBlockIds = this._unusedQuestionBlocks?.map(block => block.get('_id')) || [];\n    const haveBlocksChanged = Boolean(_.difference(unusedQuestionBlockIds, availableQuestionBlockIds).length);\n    if (!haveBlocksChanged) return;\n    // Reset the unused question blocks if there are unused blocks which aren't available blocks\n    this._unusedQuestionBlocks = null;\n  }\n\n  getRandomQuestionBlocks() {\n    let count = this._count;\n\n    if (count > this.unusedQuestionBlocks.length) {\n      logging.warn(`Bank ID ${this._bankId}: Attempting to display ${count} question(s), but only ${this.unusedQuestionBlocks.length} available`);\n      count = this.unusedQuestionBlocks.length;\n    }\n\n    const questionBlocks = [];\n    let i = 0;\n\n    while (i++ < count) {\n      const nextBlock = this.unusedQuestionBlocks.shift();\n      questionBlocks.push(nextBlock);\n    }\n    return questionBlocks;\n  }\n\n  get unusedQuestionBlocks() {\n    const hasUnusedQuestion = Boolean(this._unusedQuestionBlocks?.length);\n    if (!hasUnusedQuestion) {\n      // Start again with all questions blocks, shuffled\n      this._unusedQuestionBlocks = _.shuffle(this._availableQuestionBlocks.slice(0));\n    }\n    return this._unusedQuestionBlocks;\n  }\n\n}\n\nexport default QuestionBank;\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\nimport router from 'core/js/router';\nimport QuestionBank from './adapt-assessmentQuestionBank';\n\nlet givenIdCount = 0;\nconst assessmentConfigDefaults = {\n  _isEnabled: true,\n  _questions: {\n    _resetType: 'soft',\n    _canShowFeedback: false,\n    _canShowMarking: false,\n    _canShowModelAnswer: false\n  },\n  _suppressMarking: false,\n  _isPercentageBased: true,\n  _scoreToPass: 100,\n  _correctToPass: 100,\n  _includeInTotalScore: true,\n  _assessmentWeight: 1,\n  _isResetOnRevisit: true,\n  _reloadPageOnReset: true,\n  _attempts: 'infinite',\n  _allowResetIfPassed: false\n};\n\nconst AssessmentModel = {\n\n  _getCurrentQuestionComponents() {\n    return this.findDescendantModels('block')\n      .filter(block => block.get('_isAvailable'))\n      .reduce((questions, block) => questions.concat(block.findDescendantModels('question')), []);\n  },\n\n  _getAllQuestionComponents() {\n    return this.findDescendantModels('question');\n  },\n\n  // Private functions\n  _postInitialize() {\n    if (!this.isAssessmentEnabled()) return;\n\n    const assessmentConfig = this.getConfig();\n\n    Object.assign(this, {\n      _originalChildModels: null,\n      _questionBanks: null,\n      _forceResetOnRevisit: false\n    });\n\n    let attemptsLeft;\n    switch (assessmentConfig._attempts) {\n      case 'infinite': case 0: case undefined: case -1: case null:\n        attemptsLeft = 'infinite';\n        break;\n      default:\n        attemptsLeft = assessmentConfig._attempts;\n        break;\n    }\n\n    this.set({\n      _assessmentCompleteInSession: false,\n      _attemptInProgress: false,\n      _isAssessmentComplete: false,\n      _numberOfQuestionsAnswered: 0,\n      _lastAttemptScoreAsPercent: 0,\n      _attempts: attemptsLeft,\n      _attemptsLeft: attemptsLeft,\n      _attemptsSpent: 0\n    });\n\n    this.listenToOnce(Adapt, 'app:dataReady', this._onDataReady);\n    this.listenTo(Adapt, 'remove', this._onRemove);\n\n  },\n\n  init() {\n    // save original children\n    this._originalChildModels = this.getChildren().models;\n\n    this.setupCurrentQuestionComponents();\n\n    this._setAssessmentOwnershipOnChildrenModels();\n\n    // ensure the _questions attribute is set up (see https://github.com/adaptlearning/adapt_framework/issues/2971)\n    this._updateQuestionsState();\n  },\n\n  setupCurrentQuestionComponents() {\n    const assessmentQuestionsConfig = this.getConfig()._questions;\n    this._getAllQuestionComponents().forEach(component => {\n      component.set({\n        _canShowFeedback: assessmentQuestionsConfig._canShowFeedback,\n        _canShowMarking: assessmentQuestionsConfig._canShowMarking,\n        _canShowModelAnswer: assessmentQuestionsConfig._canShowModelAnswer\n      });\n    });\n  },\n\n  _setAssessmentOwnershipOnChildrenModels() {\n    // mark all children components as belonging to an assessment\n    const assessmentConfig = this.get('_assessment');\n    const childConfig = {\n      _isPartOfAssessment: true,\n      _assessmentId: assessmentConfig._id\n    };\n\n    for (const blockModel of this._originalChildModels) {\n      blockModel.set(childConfig);\n      // make sure components are set to _isPartOfAssessment for plp checking\n      blockModel.setOnChildren(childConfig);\n    }\n  },\n\n  // prevent default\n  checkIfResetOnRevisit() {},\n\n  _onDataReady() {\n    // register assessment\n    Adapt.assessment.register(this);\n\n    // sanity check the data\n    const questions = this._getCurrentQuestionComponents();\n    if (this.get('_attemptInProgress') && questions.every(q => q.get('_isSubmitted')) && this.get('_requireCompletionOf') !== Number.POSITIVE_INFINITY) {\n      this.set('_attemptInProgress', false);\n      logging.warn(`Assessment ${this.get('_id')} _attemptInProgress corrected as all questions are submitted`);\n    }\n  },\n\n  _setupAssessmentData(force, callback) {\n    const assessmentConfig = this.getConfig();\n    const state = this.getState();\n    const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n    const isFirstAttempt = (state.attemptsSpent === 0);\n    const shouldResetOnRevisit = (isFirstAttempt || assessmentConfig._isResetOnRevisit) && !this.get('_attemptInProgress');\n    const shouldResetAssessment = (shouldResetOnRevisit && !state.isPass && hasAttemptsLeft) || force === true;\n    const shouldResetQuestions = (shouldResetOnRevisit && (state.allowResetIfPassed || !state.isPass)) || force === true;\n    if (shouldResetAssessment || shouldResetQuestions) {\n      Adapt.trigger('assessments:preReset', this.getState(), this);\n    }\n    let quizModels;\n    if (shouldResetAssessment) {\n      if (isFirstAttempt || assessmentConfig?._questions?._resetType === 'hard') {\n        this.set({\n          _numberOfQuestionsAnswered: 0,\n          _isAssessmentComplete: false,\n          _assessmentCompleteInSession: false,\n          _score: 0\n        });\n      } else {\n        this.set({\n          _assessmentCompleteInSession: false\n        });\n      }\n      this.getChildren().reset(this._originalChildModels);\n      if (assessmentConfig?._banks._isEnabled &&\n        assessmentConfig?._banks._split.length > 1) {\n        quizModels = this._setupBankedAssessment();\n      } else if (assessmentConfig?._randomisation._isEnabled) {\n        quizModels = this._setupRandomisedAssessment();\n      }\n    }\n    if (!quizModels) {\n      // leave the order as before, completed or not\n      quizModels = this.getChildren().models;\n    } else if (quizModels.length === 0) {\n      quizModels = this.getChildren().models;\n      logging.warn('assessment: Not enough unique questions to create a fresh assessment, using last selection');\n    }\n    this.getChildren().reset(quizModels);\n    this.setupCurrentQuestionComponents();\n    if (shouldResetAssessment || shouldResetQuestions) {\n      this._resetQuestions();\n      this.set('_attemptInProgress', true);\n      Adapt.trigger('assessments:reset', this.getState(), this);\n    }\n    if (!state.isComplete) {\n      this.set('_attemptInProgress', true);\n    }\n    this._overrideQuestionComponentSettings();\n    this._setupQuestionListeners();\n    this._checkNumberOfQuestionsAnswered();\n    this._updateQuestionsState();\n    Adapt.assessment.saveState();\n    this.trigger('reset');\n    if (shouldResetAssessment || shouldResetQuestions) {\n      Adapt.trigger('assessments:postReset', this.getState(), this);\n    }\n  },\n\n  _setupBankedAssessment() {\n    const assessmentConfig = this.getConfig();\n    this._setupBanks();\n    // Get random questions from banks\n    let questionModels = this._questionBanks.flatMap(questionBank => questionBank.getRandomQuestionBlocks());\n    // If overall question order should be randomized\n    if (assessmentConfig._banks._randomisation) {\n      questionModels = _.shuffle(questionModels);\n    }\n    return questionModels;\n  },\n\n  _setupBanks() {\n    const assessmentConfig = this.getConfig();\n    const bankSplits = assessmentConfig._banks._split.split(',');\n\n    this.findDescendantModels('block')\n      .filter(block => block.get('_isAvailable') && block.findDescendantModels('question').length > 0).forEach(block => {\n        const quizBankId = block.get('_assessment')?._quizBankId;\n\n        const isInvalidNumber = (isNaN(quizBankId) || quizBankId < 1);\n        const isOutOfBounds = (quizBankId > bankSplits.length);\n        if (isInvalidNumber) logging.warn(`Bank ID ${quizBankId} is not a valid number`);\n        if (isOutOfBounds) logging.warn(`Bank ID ${quizBankId} exceeds the number of available splits (${bankSplits.length})`);\n    });\n\n    const hasBankSplitsChanged = (bankSplits.length !== this._questionBanks?.length);\n    if (hasBankSplitsChanged) {\n      // Generate new question banks if the split has changed\n      this._questionBanks = [];\n    }\n    bankSplits.forEach((count, index) => {\n      const bankId = (index + 1);\n      const articleId = this.get('_id');\n      // Keep question bank instances to preserve unused blocks over multi asessment attempts inside a session\n      this._questionBanks[bankId] = (this._questionBanks[bankId] || new QuestionBank(bankId, articleId));\n      // Recalculate available blocks incase they have changed or the count has changed in the split\n      this._questionBanks[bankId].calculateAvailableQuestionBlocks(count);\n    });\n  },\n\n  _setupRandomisedAssessment() {\n    const assessmentConfig = this.getConfig();\n\n    const randomisationModel = assessmentConfig._randomisation;\n    const blockModels = this.getChildren().models;\n\n    let questionModels = _.shuffle(blockModels);\n\n    if (randomisationModel._blockCount > 0) {\n      questionModels = questionModels.slice(0, randomisationModel._blockCount);\n    }\n\n    return questionModels;\n  },\n\n  _overrideQuestionComponentSettings() {\n    const newSettings = this._getMarkingSettings();\n\n    // Add any additional setting overrides here\n    const questionConfig = this.getConfig()._questions;\n    if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowFeedback')) {\n      newSettings._canShowFeedback = questionConfig._canShowFeedback;\n    }\n\n    if (!_.isEmpty(newSettings)) {\n      const questionComponents = this._getAllQuestionComponents();\n      questionComponents.forEach(model => model.set(newSettings, { pluginName: '_assessment' }));\n    }\n  },\n\n  _setupQuestionListeners() {\n    this._removeQuestionListeners();\n    this.listenTo(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\n  },\n\n  _checkNumberOfQuestionsAnswered() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const numberOfQuestionsAnswered = questionComponents.filter(model => model.get('_isInteractionComplete')).length;\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n  },\n\n  _removeQuestionListeners() {\n    this.stopListening(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\n  },\n\n  _onCompletionEvent(event) {\n    if (event.target?.isTypeGroup('block')) return this._onBlockCompleted(event.target, event.value);\n    if (event.target?.isTypeGroup('question')) return this._onQuestionCompleted(event.target, event.value);\n  },\n\n  _onBlockCompleted(blockModel, value) {\n    if (value === false) return;\n    const questionModels = blockModel.findDescendantModels('question');\n    questionModels.forEach(questionModel => {\n      this._onQuestionCompleted(questionModel, value);\n    });\n    if (!blockModel.get('_isInteractionComplete')) return;\n    this._checkAssessmentComplete();\n  },\n\n  _onQuestionCompleted(questionModel, value) {\n    if (value === false) return;\n    if (!questionModel.get('_isInteractionComplete')) return;\n\n    const numberOfQuestionsAnswered = this._getCurrentQuestionComponents().reduce((count, question) => (count += question.get('_isSubmitted') ? 1 : 0), 0);\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n\n    this._updateQuestionsState();\n    Adapt.assessment.saveState();\n\n    this._checkAssessmentComplete();\n  },\n\n  _checkAssessmentComplete() {\n    const allQuestionsAdded = (this.get('_requireCompletionOf') !== Number.POSITIVE_INFINITY);\n    if (!allQuestionsAdded) return;\n    const numberOfQuestionsAnswered = this.get('_numberOfQuestionsAnswered');\n    const allQuestionsAnswered = (numberOfQuestionsAnswered >= this._getCurrentQuestionComponents().length);\n    if (!allQuestionsAnswered) return;\n    this._onAssessmentComplete();\n  },\n\n  _onAssessmentComplete() {\n    const wasAttemptInProgess = this.get('_attemptInProgress');\n    if (!wasAttemptInProgess) return;\n    this.set('_attemptInProgress', false);\n    this._spendAttempt();\n    const _scoreAsPercent = this._getScoreAsPercent();\n    const _score = this._getScore();\n    const _maxScore = this._getMaxScore();\n    const _minScore = this._getMinScore();\n    const _correctCount = this._getCorrectCount();\n    const _correctAsPercent = this._getCorrectAsPercent();\n    const _questionCount = this._getQuestionCount();\n    this.set({\n      _scoreAsPercent,\n      _score,\n      _maxScore,\n      _minScore,\n      _correctAsPercent,\n      _correctCount,\n      _questionCount,\n      _lastAttemptScoreAsPercent: _scoreAsPercent,\n      _assessmentCompleteInSession: true,\n      _isAssessmentComplete: true\n    });\n    this._updateQuestionsState();\n    this._checkIsPass();\n    this._removeQuestionListeners();\n    if (this._isMarkingSuppressionEnabled() && (!this._isAttemptsLeft() || this._isPassed())) {\n      _.defer(() => {\n        this._overrideMarkingSettings();\n        this._refreshQuestions();\n      });\n    }\n    Adapt.trigger('assessments:complete', this.getState(), this);\n  },\n\n  _updateQuestionsState() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const questions = questionComponents.map(model => ({\n      _id: model.get('_id'),\n      _isCorrect: model.get('_isCorrect') ?? null\n    }));\n    this.set('_questions', questions);\n  },\n\n  _checkIsPass() {\n    const assessmentConfig = this.getConfig();\n\n    const isPercentageBased = assessmentConfig._isPercentageBased;\n    const scoreToPass = assessmentConfig._scoreToPass;\n    const correctToPass = assessmentConfig._correctToPass || 0;\n\n    const scoreAsPercent = this.get('_scoreAsPercent');\n    const score = this.get('_score');\n    const correctAsPercent = this.get('_correctAsPercent');\n    const correctCount = this.get('_correctCount');\n\n    const isPass = isPercentageBased\n      ? (scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass)\n      : (score >= scoreToPass && correctCount >= correctToPass);\n\n    this.set('_isPass', isPass);\n  },\n\n  _getMarkingSettings() {\n    let markingSettings = {};\n\n    if (this._shouldSuppressMarking()) {\n      markingSettings = {\n        _canShowMarking: false,\n        _canShowModelAnswer: false\n      };\n    } else {\n      const questionConfig = this.getConfig()._questions;\n\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowModelAnswer')) {\n        markingSettings._canShowModelAnswer = questionConfig._canShowModelAnswer;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowMarking')) {\n        markingSettings._canShowMarking = questionConfig._canShowMarking;\n      }\n    }\n\n    return markingSettings;\n  },\n\n  _overrideMarkingSettings() {\n    const newMarkingSettings = this._getMarkingSettings();\n    const questionComponents = this._getAllQuestionComponents();\n    questionComponents.forEach(model => model.set(newMarkingSettings, { pluginName: '_assessment' }));\n  },\n\n  _refreshQuestions() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    questionComponents.forEach(model => model.refresh());\n  },\n\n  _shouldSuppressMarking() {\n    return this._isMarkingSuppressionEnabled() && this._isAttemptsLeft() && !this._isPassed();\n  },\n\n  _isMarkingSuppressionEnabled() {\n    const assessmentConfig = this.getConfig();\n    return assessmentConfig._suppressMarking;\n  },\n\n  _isAttemptsLeft() {\n    if (this.get('_attemptsLeft') === 0) return false;\n    return true;\n  },\n\n  _isPassed() {\n    return this.get('_isAssessmentComplete') && this.get('_isPass');\n  },\n\n  _spendAttempt() {\n    if (!this._isAttemptsLeft()) return false;\n\n    let attemptsSpent = this.get('_attemptsSpent');\n    this.set('_attemptsSpent', ++attemptsSpent);\n\n    if (this.get('_attempts') === 'infinite') return true;\n\n    let attemptsLeft = this.get('_attemptsLeft');\n    this.set('_attemptsLeft', --attemptsLeft);\n\n    return true;\n  },\n\n  _getScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const score = questionComponents.reduce((score, model) => (score += model.score || 0), 0);\n    return score;\n  },\n\n  _getMaxScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const maxScore = questionComponents.reduce((maxScore, model) => (maxScore += model.maxScore || 0), 0);\n    return maxScore;\n  },\n\n  _getMinScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const minScore = questionComponents.reduce((minScore, model) => (minScore += model.minScore || 0), 0);\n    return minScore;\n  },\n\n  _getScoreAsPercent() {\n    const minScore = this._getMinScore();\n    const maxScore = this._getMaxScore();\n    const score = this._getScore();\n    const range = (maxScore - minScore);\n    return (range === 0) ? 0 : Math.round(((score - minScore) / range) * 100);\n  },\n\n  _getCorrectCount() {\n    return this._getCurrentQuestionComponents().reduce((count, model) => (count += model.get('_isCorrect') ? 1 : 0), 0);\n  },\n\n  _getQuestionCount() {\n    return this._getCurrentQuestionComponents().length;\n  },\n\n  _getCorrectAsPercent() {\n    const questionCount = this._getQuestionCount();\n    return (questionCount === 0) ? 0 : Math.round((this._getCorrectCount() / questionCount) * 100);\n  },\n\n  _getLastAttemptScoreAsPercent() {\n    return this.get('_lastAttemptScoreAsPercent');\n  },\n\n  _checkReloadPage() {\n    if (!this.canResetInPage()) return false;\n\n    const parentId = this.getParent().get('_id');\n    const currentLocation = location._currentId;\n\n    // check if on assessment page and should rerender page\n    if (currentLocation !== parentId) return false;\n    if (!this.get('_isReady')) return false;\n\n    return true;\n  },\n\n  _reloadPage(callback) {\n    const assessmentConfig = this.getConfig();\n    this._forceResetOnRevisit = true;\n    this.listenToOnce(Adapt, 'pageView:ready', async () => {\n      if (assessmentConfig._scrollToOnReset) {\n        await router.navigateToElement(this.get('_id'));\n      }\n      callback();\n    });\n    _.delay(() => {\n      Backbone.history.navigate('#/id/' + location._currentId, { replace: true, trigger: true });\n    }, 250);\n  },\n\n  _resetQuestions() {\n    const assessmentConfig = this.getConfig();\n    const questionModels = this._getCurrentQuestionComponents();\n    questionModels.forEach(model => model.reset(assessmentConfig._questions._resetType, true));\n  },\n\n  _onRemove() {\n    this._removeQuestionListeners();\n  },\n\n  _setCompletionStatus() {\n    this.set({\n      _isComplete: true,\n      _isInteractionComplete: true\n    });\n  },\n\n  _checkIfQuestionsWereRestored() {\n    if (this.get('_assessmentCompleteInSession')) return;\n    if (!this.get('_isAssessmentComplete')) return;\n\n    // fix for courses that do not remember the user selections\n    // force assessment to reset if user revisits an assessment page in a new session which is completed\n    let wereQuestionsRestored = true;\n\n    const questions = this.get('_questions');\n    for (const question of questions) {\n      const questionModel = data.findById(question._id);\n      if (questionModel.get('_isAvailable') && !questionModel.get('_isSubmitted')) {\n        wereQuestionsRestored = false;\n        break;\n      }\n    }\n\n    if (!wereQuestionsRestored) {\n      this.set('_assessmentCompleteInSession', true);\n      return true;\n    }\n\n    return false;\n  },\n\n  // Public Functions\n  isAssessmentEnabled() {\n    if (this.get('_assessment')?._isEnabled) return true;\n    return false;\n  },\n\n  canResetInPage() {\n    const assessmentConfig = this.getConfig();\n    if (assessmentConfig._reloadPageOnReset === false) return false;\n    return true;\n  },\n\n  reset(force, callback) {\n\n    const assessmentConfig = this.getConfig();\n\n    // check if forcing reset via page revisit or force parameter\n    force = this._forceResetOnRevisit || force === true;\n    this._forceResetOnRevisit = false;\n\n    const isPageReload = this._checkReloadPage();\n\n    // stop resetting if not complete or not allowed\n    if (this.get('_assessmentCompleteInSession') &&\n      !assessmentConfig._isResetOnRevisit &&\n      !isPageReload &&\n      !force) {\n      // eslint-disable-next-line n/no-callback-literal\n      if (typeof callback === 'function') callback(false);\n      return false;\n    }\n\n    // check if new session and questions not restored\n    const wereQuestionsRestored = this._checkIfQuestionsWereRestored();\n    force = force || wereQuestionsRestored;\n    // the assessment is going to be reset so we must reset attempts\n    // otherwise assessment may not be set up properly in next session\n    if (force && !this._isAttemptsLeft()) {\n      this.set({\n        _attemptsLeft: this.get('_attempts'),\n        _attemptsSpent: 0\n      });\n    }\n\n    const allowResetIfPassed = this.get('_assessment')._allowResetIfPassed;\n    // stop resetting if no attempts left and allowResetIfPassed is false\n    if (!this._isAttemptsLeft() && !force && !allowResetIfPassed) {\n      // eslint-disable-next-line n/no-callback-literal\n      if (typeof callback === 'function') callback(false);\n      return false;\n    }\n\n    if (!isPageReload) {\n      this._setupAssessmentData(force);\n      // eslint-disable-next-line n/no-callback-literal\n      if (typeof callback === 'function') callback(true);\n    } else {\n      this._reloadPage(() => {\n        // eslint-disable-next-line n/no-callback-literal\n        if (typeof callback === 'function') callback(true);\n      });\n    }\n\n    return true;\n  },\n\n  getSaveState() {\n    const state = this.getState();\n    let blocks;\n    const cfg = this.getConfig();\n    const banksActive = cfg._banks?._isEnabled && cfg._banks._split.length > 1;\n    const randomisationActive = cfg._randomisation?._isEnabled;\n\n    if (!banksActive && !randomisationActive) {\n      // include presentation blocks in save state so that blocks without questions aren't removed\n      blocks = this.findDescendantModels('block');\n    } else {\n      blocks = state.questions.map(question => data.findById(question._id).getParent());\n    }\n    blocks = [...new Set(blocks)]\n      .filter(block => block.trackingPosition);\n    const blockTrackingPositions = blocks.map(block => block.trackingPosition);\n    const blockCompletion = blocks.map(block => {\n      const questions = block.findDescendantModels('question');\n      return questions.map(question => question.get('_isCorrect') || false);\n    });\n    const blockData = [blockTrackingPositions, blockCompletion];\n\n    const saveState = [\n      state.isComplete ? 1 : 0,\n      state.attemptsSpent,\n      state.maxScore || 0,\n      state.score,\n      state.attemptInProgress ? 1 : 0,\n      state.minScore || 0,\n      state.correctAsPercent || 0,\n      state.correctCount || 0,\n      state.questionCount || 0\n    ];\n\n    const dataPackage = [saveState, blockData];\n\n    return dataPackage;\n  },\n\n  setRestoreState(dataPackage) {\n    const restoreState = dataPackage[0];\n    const blockData = dataPackage[1];\n    const _isAssessmentComplete = restoreState[0] === 1;\n    const attempts = this.get('_attempts');\n    const _attemptsSpent = restoreState[1];\n    const maxScore = restoreState[2];\n    const score = restoreState[3];\n    const _scoreAsPercent = score ? Math.round(score / maxScore * 100) : 0;\n    const _attemptInProgress = restoreState[4] === 1;\n    const minScore = restoreState[5];\n    const correctAsPercent = restoreState[6];\n    const correctCount = restoreState[7];\n    const questionCount = restoreState[8];\n\n    const blocks = blockData[0].map(trackingPosition => {\n      if (typeof trackingPosition === 'number') {\n        // Backwards compability for courses which use _trackingId at block level\n        return data.findWhere({ _trackingId: trackingPosition });\n      }\n      return data.findByTrackingPosition(trackingPosition);\n    });\n\n    if (blocks.length) {\n      const nonBlockChildren = this.getChildren().models.filter(model => !model.isTypeGroup('block'));\n      this.getChildren().reset(blocks.concat(nonBlockChildren));\n    }\n\n    const _questions = [];\n    blocks.forEach((block, blockIndex) => {\n      const blockQuestions = block.findDescendantModels('question');\n      blockQuestions.forEach((question, questionIndex) => {\n        _questions.push({\n          _id: question.get('_id'),\n          _isCorrect: blockData[1][blockIndex][questionIndex]\n        });\n      });\n    });\n\n    this.set({\n      _isAssessmentComplete,\n      _assessmentCompleteInSession: false,\n      _attemptsSpent,\n      _attemptInProgress,\n      _attemptsLeft: (attempts === 'infinite' ? attempts : attempts - _attemptsSpent),\n      _maxScore: maxScore || this._getMaxScore(),\n      _minScore: minScore || this._getMinScore(),\n      _score: score || 0,\n      _scoreAsPercent,\n      _correctAsPercent: correctAsPercent || 0,\n      _correctCount: correctCount || 0,\n      _questions,\n      _questionCount: questionCount || 0,\n      _lastAttemptScoreAsPercent: _scoreAsPercent\n    });\n\n    if (_isAssessmentComplete) this._checkIsPass();\n\n    Adapt.trigger('assessments:restored', this.getState(), this);\n\n  },\n\n  getState() {\n    // return the current state of the assessment\n    // create snapshot of values so as not to create memory leaks\n    const assessmentConfig = this.getConfig();\n\n    const state = {\n      id: assessmentConfig._id,\n      type: 'article-assessment',\n      pageId: this.getParent().get('_id'),\n      articleId: this.get('_id'),\n      isEnabled: assessmentConfig._isEnabled,\n      isComplete: this.get('_isAssessmentComplete'),\n      isPercentageBased: assessmentConfig._isPercentageBased,\n      scoreToPass: assessmentConfig._scoreToPass,\n      score: this.get('_score'),\n      scoreAsPercent: this.get('_scoreAsPercent'),\n      maxScore: this.get('_maxScore'),\n      minScore: this.get('_minScore'),\n      correctCount: this.get('_correctCount'),\n      correctAsPercent: this.get('_correctAsPercent'),\n      correctToPass: assessmentConfig._correctToPass,\n      questionCount: this.get('_questionCount'),\n      isPass: this.get('_isPass'),\n      includeInTotalScore: assessmentConfig._includeInTotalScore,\n      assessmentWeight: assessmentConfig._assessmentWeight,\n      attempts: this.get('_attempts'),\n      attemptsSpent: this.get('_attemptsSpent'),\n      attemptsLeft: this.get('_attemptsLeft'),\n      attemptInProgress: this.get('_attemptInProgress'),\n      lastAttemptScoreAsPercent: this.get('_lastAttemptScoreAsPercent'),\n      questions: this.get('_questions'),\n      resetType: assessmentConfig._questions._resetType,\n      allowResetIfPassed: assessmentConfig._allowResetIfPassed,\n      questionModels: new Backbone.Collection(this._getCurrentQuestionComponents())\n    };\n\n    return state;\n  },\n\n  getConfig() {\n    let assessmentConfig = this.get('_assessment');\n\n    if (!assessmentConfig) {\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults);\n    } else {\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults, assessmentConfig);\n    }\n\n    if (assessmentConfig._id === undefined) {\n      assessmentConfig._id = 'givenId' + (givenIdCount++);\n    }\n\n    this.set('_assessment', assessmentConfig);\n\n    return assessmentConfig;\n  }\n};\n\nexport default AssessmentModel;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport wait from 'core/js/wait';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\n\n/*\n  * Here we setup a registry for all assessments\n  */\nconst assessmentsConfigDefaults = {\n  _isPercentageBased: true,\n  _scoreToPass: 100,\n  _isDefaultsLoaded: true\n};\n\nclass Assessment extends Backbone.Controller {\n\n  initialize() {\n    this._assessments = Object.assign([], {\n      _byPageId: {},\n      _byAssessmentId: {}\n    });\n    this.listenTo(Adapt, {\n      'assessments:complete': this._onAssessmentsComplete,\n      'router:location': this._checkResetAssessmentsOnRevisit,\n      'router:plugin': this._handleRoute,\n      'app:dataReady': this._onDataReady\n    });\n  }\n\n  _onAssessmentsComplete(state) {\n    const assessmentId = state.id;\n\n    state.isComplete = true;\n\n    if (assessmentId === undefined) return;\n\n    if (!this._getStateByAssessmentId(assessmentId)) {\n      logging.warn('assessments: state was not registered when assessment was created');\n    }\n\n    this.saveState();\n\n    this._setPageProgress();\n\n    this._checkAssessmentsComplete();\n\n  }\n\n  _restoreModelState(assessmentModel) {\n\n    if (!this._saveStateModel) {\n      this._saveStateModel = offlineStorage.get('a');\n    }\n    if (this._saveStateModel) {\n      const state = assessmentModel.getState();\n      if (this._saveStateModel[state.id]) {\n        assessmentModel.setRestoreState(offlineStorage.deserialize(this._saveStateModel[state.id]));\n      }\n    }\n\n  }\n\n  /*\n    * Allow navigating to an assessment via the URL.\n    */\n  _handleRoute(plugin, id) {\n    if ((plugin !== 'assessment' && plugin !== 'article-assessment') || id === undefined) {\n      return;\n    }\n\n    // Check the 'id' passed is that of an article.\n    if (!data.findById(id)) {\n      // The 'id' passed may have been the assessment _id/name, not the article _id.\n      const assessment = Adapt.assessment._assessments._byAssessmentId[id];\n      if (assessment) {\n        // Set 'id' to the article _id.\n        id = assessment.get('_id');\n      } else {\n        logging.warn('Assessment not found with _id: ' + id);\n        return;\n      }\n    }\n\n    _.defer(() => {\n      // Defer this call so that the router's _canNavigate flag is true.\n      Backbone.history.navigate('#/id/' + id, { trigger: true, replace: true });\n    });\n  }\n\n  _checkResetAssessmentsOnRevisit(toObject) {\n    /*\n      * Here we hijack router:location to reorganise the assessment blocks\n      * this must happen before trickle listens to block completion\n      */\n    if (toObject._contentType !== 'page') return;\n\n    // initialize assessment on page visit before pageView:preRender (and trickle)\n    const pageAssessmentModels = this._getAssessmentByPageId(toObject._currentId);\n    if (pageAssessmentModels === undefined) return;\n\n    /*\n      * Here we further hijack the router to ensure the asynchronous assessment\n      * reset completes before routing completes\n      */\n    wait.for(function resetAllAssessments(allAssessmentHaveReset) {\n\n      const numberOfAssessments = pageAssessmentModels.length;\n      let numberOfResetAssessments = 0;\n      const forceAssessmentReset = false;\n\n      pageAssessmentModels.forEach(model => {\n\n        model.reset(forceAssessmentReset, () => {\n          numberOfResetAssessments++;\n          const haveAllModelsReset = (numberOfResetAssessments === numberOfAssessments);\n          if (!haveAllModelsReset) {\n            return;\n          }\n          allAssessmentHaveReset();\n        });\n      });\n    });\n\n    this._setPageProgress();\n  }\n\n  _onDataReady() {\n    this._assessments = Object.assign([], {\n      _byPageId: {},\n      _byAssessmentId: {}\n    });\n\n    this._restoredCount = 0;\n  }\n\n  _checkAssessmentsComplete() {\n    let allAssessmentsComplete = true;\n    let assessmentToPostBack = 0;\n    const states = this._getStatesByAssessmentId();\n\n    const assessmentStates = [];\n\n    for (const id in states) {\n      const state = states[id];\n      if (!state.includeInTotalScore) continue;\n      if (!state.isComplete) {\n        allAssessmentsComplete = false;\n        break;\n      }\n      assessmentToPostBack++;\n      assessmentStates.push(state);\n    }\n\n    if (!allAssessmentsComplete || assessmentToPostBack === 0) return false;\n\n    if (assessmentToPostBack === 1) {\n      this._setupSingleAssessmentConfiguration(assessmentStates[0]);\n    }\n\n    _.defer(() => Adapt.trigger('assessment:complete', this.getState()));\n\n    return true;\n  }\n\n  _setupSingleAssessmentConfiguration(assessmentState) {\n    const assessmentsConfig = Adapt.course.get('_assessment');\n    $.extend(true, assessmentsConfig, {\n      _isPercentageBased: assessmentState.isPercentageBased,\n      _scoreToPass: assessmentState.scoreToPass\n    });\n    Adapt.course.set('_assessment', assessmentsConfig);\n  }\n\n  _getAssessmentByPageId(pageId) {\n    return this._assessments._byPageId[pageId];\n  }\n\n  _getStateByAssessmentId(assessmentId) {\n    if (assessmentId === undefined) {\n      return null;\n    }\n\n    return this._assessments._byAssessmentId[assessmentId].getState();\n  }\n\n  _getStatesByAssessmentId() {\n    const states = {};\n    for (const assessmentModel of this._assessments) {\n      if (!assessmentModel.get('_isAvailable')) continue;\n      const state = assessmentModel.getState();\n      states[state.id] = state;\n    }\n    return states;\n  }\n\n  _setPageProgress() {\n    // set _subProgressTotal and _subProgressComplete on pages that have assessment progress indicator requirements\n\n    for (const [ id, assessments ] of Object.entries(this._assessments._byPageId)) {\n\n      const availableAssessments = assessments.filter(model => model.get('_isAvailable'));\n\n      const assessmentsTotal = availableAssessments.length;\n      let assessmentsPassed = 0;\n\n      for (const assessment of availableAssessments) {\n        const assessmentState = assessment.getState();\n\n        if (assessmentState.includeInTotalScore && !assessmentState.isPass) continue;\n\n        if (assessmentState.isComplete) {\n          assessmentsPassed++;\n        }\n      }\n\n      const pageModel = data.findById(id);\n      pageModel?.set({\n        _subProgressTotal: assessmentsTotal,\n        _subProgressComplete: assessmentsPassed\n      });\n\n    }\n  }\n\n  _addToAssessmentIdMap(id, model) {\n    if (id === undefined) {\n      logging.warn('An assessment has been registered with an undefined value for \"_id\"');\n      return;\n    }\n\n    if (id === '') {\n      logging.warn('An assessment has been registered with an empty value for \"_id\"');\n    }\n\n    if (!this._assessments._byAssessmentId[id]) {\n      this._assessments._byAssessmentId[id] = model;\n    } else {\n      logging.warn('An assessment with an _id of \"' + id + '\" already exists!');\n    }\n  }\n\n  _setupQuestionNumbering() {\n    const getRelatedQuestions = data => {\n      const currentAssessmentId = data._assessmentId;\n      const currentAssessment = Adapt.assessment.get(currentAssessmentId);\n      return currentAssessment.getState().questions;\n    };\n\n    Handlebars.registerHelper('questionNumber', function getQuestionNumber() {\n      const data = this.view?.model.toJSON() || this;\n      if (!data._isPartOfAssessment) return;\n\n      const related = _.pluck(getRelatedQuestions(data), '_id');\n\n      return related.indexOf(data._id) + 1;\n    });\n\n    Handlebars.registerHelper('questionCount', function getTotalQuestions() {\n      const data = this.view ? this.view.model.toJSON() : this;\n      if (!data._isPartOfAssessment) return;\n      return getRelatedQuestions(data).length;\n    });\n  }\n\n  // Public functions\n  register(assessmentModel) {\n    const state = assessmentModel.getState();\n    const assessmentId = state.id;\n    const pageId = state.pageId;\n\n    if (this._assessments._byPageId[pageId] === undefined) {\n      this._assessments._byPageId[pageId] = [];\n    }\n\n    this._assessments._byPageId[pageId].push(assessmentModel);\n\n    this._addToAssessmentIdMap(assessmentId, assessmentModel);\n\n    this._assessments.push(assessmentModel);\n\n    this._restoreModelState(assessmentModel);\n    this._restoredCount++;\n\n    Adapt.trigger('assessments:register', state, assessmentModel);\n\n    this._setPageProgress();\n\n    this._setupQuestionNumbering();\n\n    if (this._restoredCount === this._assessments.length) {\n      // Since all assessments have been stored, broadcast an\n      // event which has the collated state.\n      Adapt.trigger('assessment:restored', this.getState());\n    }\n  }\n\n  get(id) {\n    return (id === undefined)\n      ? this._assessments.slice(0)\n      : this._assessments._byAssessmentId[id];\n  }\n\n  saveState() {\n\n    this._saveStateModel = {};\n    for (const assessmentModel of this._assessments) {\n      const state = assessmentModel.getState();\n      this._saveStateModel[state.id] = offlineStorage.serialize(assessmentModel.getSaveState());\n    }\n\n    offlineStorage.set('a', this._saveStateModel);\n  }\n\n  getConfig() {\n    let assessmentsConfig = Adapt.course.get('_assessment');\n\n    if (assessmentsConfig?._isDefaultsLoaded) {\n      return assessmentsConfig;\n    }\n\n    if (assessmentsConfig === undefined) {\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults);\n    } else {\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults, assessmentsConfig);\n    }\n\n    Adapt.course.set('_assessment', assessmentsConfig);\n\n    return assessmentsConfig;\n  }\n\n  getState() {\n    const assessmentsConfig = this.getConfig();\n\n    let score = 0;\n    let maxScore = 0;\n    let minScore = 0;\n    let correctCount = 0;\n    let questionCount = 0;\n    let assessments = 0;\n    const states = this._getStatesByAssessmentId();\n    let assessmentsComplete = 0;\n\n    for (const id in states) {\n      const state = states[id];\n      if (!state.includeInTotalScore) continue;\n      if (state.isComplete) assessmentsComplete++;\n      assessments++;\n      maxScore += state.maxScore / state.assessmentWeight;\n      minScore += state.minScore / state.assessmentWeight;\n      score += state.score / state.assessmentWeight;\n      correctCount += state.correctCount / state.assessmentWeight;\n      questionCount += state.questionCount / state.assessmentWeight;\n    }\n\n    const isComplete = assessmentsComplete === assessments;\n\n    const scoreRange = (maxScore - minScore);\n    const scoreAsPercent = (scoreRange === 0) ? 0 : Math.round(((score - minScore) / scoreRange) * 100);\n    const correctAsPercent = (questionCount === 0) ? 0 : Math.round((correctCount / questionCount) * 100);\n\n    if (assessmentsConfig._correctToPass === undefined) {\n      logging.warnOnce('Assessment course config is missing _correctToPass');\n    }\n\n    const scoreToPass = assessmentsConfig._scoreToPass;\n    const correctToPass = assessmentsConfig._correctToPass || scoreToPass;\n    const isPercentageBased = assessmentsConfig._isPercentageBased;\n\n    const isPass = isComplete && (isPercentageBased\n      ? scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass\n      : score >= scoreToPass && correctCount >= correctToPass);\n\n    const canRetry = Object.values(states).some(state => {\n      const isFailed = !state.isPass;\n      const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n      return (isFailed && hasAttemptsLeft);\n    });\n\n    return {\n      isComplete,\n      isPercentageBased,\n      isPass,\n      maxScore,\n      minScore,\n      score,\n      scoreToPass,\n      scoreAsPercent,\n      correctCount,\n      correctAsPercent,\n      correctToPass,\n      questionCount,\n      assessmentsComplete,\n      assessments,\n      canRetry\n    };\n  }\n}\n\nexport default (Adapt.assessment = new Assessment());\n","import ArticleView from 'core/js/views/articleView';\nimport ArticleModel from 'core/js/models/articleModel';\nimport AdaptAssessmentArticleView from './adapt-assessmentArticleView';\nimport AdaptAssessmentArticleModel from './adapt-assessmentArticleModel';\nimport './assessment';\n\n/*\n  * Here we are extending the articleView and articleModel in Adapt.\n  * This is to accomodate the assessment functionality on the article.\n  * The advantage of this method is that the assessment behaviour can utilize all of the predefined article behaviour in both the view and the model.\n  */\n\n// Extends core/js/views/articleView.js\nconst ArticleViewInitialize = ArticleView.prototype.initialize;\nArticleView.prototype.initialize = function(options) {\n  if (this.model.get('_assessment')?._isEnabled === true) {\n    // extend the articleView with new functionality\n    Object.assign(this, AdaptAssessmentArticleView);\n  }\n  // initialize the article in the normal manner\n  return ArticleViewInitialize.apply(this, arguments);\n};\n\n// Extends core/js/models/articleModel.js\nconst ArticleModelInitialize = ArticleModel.prototype.initialize;\nArticleModel.prototype.initialize = function(options) {\n  if (this.get('_assessment')?._isEnabled === true) {\n    // extend the articleModel with new functionality\n    Object.assign(this, AdaptAssessmentArticleModel);\n\n    // initialize the article in the normal manner\n    const returnValue = ArticleModelInitialize.apply(this, arguments);\n\n    // initialize assessment article\n    this._postInitialize();\n\n    return returnValue;\n  }\n\n  // initialize the article in the normal manner if no assessment\n  return ArticleModelInitialize.apply(this, arguments);\n};\n","import QuestionModel from 'core/js/models/questionModel';\n\nexport function getCorrectness(model) {\n  const questionModels = model.getAllDescendantModels().concat([model]).filter(model => model instanceof QuestionModel);\n  const numberOfCorrect = (questionModels.filter(child => (child.isCorrect()) && !child.get('_isOptional'))).length;\n  const numberOfPartlyCorrect = (questionModels.filter(child => (child.isPartlyCorrect()) && !child.get('_isOptional'))).length;\n  const isCorrect = questionModels.every(child => child.isCorrect() || child.get('_isOptional'));\n  const isPartlyCorrect = (numberOfCorrect > 0) || (numberOfPartlyCorrect > 0);\n  return isCorrect ?\n    'correct' :\n    isPartlyCorrect ?\n      'partlyCorrect' :\n      'incorrect';\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport ComponentModel from 'core/js/models/componentModel';\nimport {\n  getCorrectness\n} from './correctness';\nimport offlineStorage from 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\n\n/** @typedef {import(\"core/js/models/adaptModel\").default} AdaptModel */\n\nexport default class BranchingSet {\n\n  constructor(options = {}) {\n    /** @type {AdaptModel} */\n    this.model = options.model;\n    this.setupModels();\n  }\n\n  setupModels() {\n    const containerId = this.model.get('_id');\n    const children = [\n      ...this.model.getChildren(),\n      ...data.filter(model => model.get('_branching')?._containerId === containerId)\n    ].filter(Boolean);\n    // Hide all branching container original children as only clones will be displayed\n    children.forEach(child => {\n      const config = child.get('_branching');\n      if (!config) return;\n      config._containerId = config._containerId || containerId;\n      // Make direct children unavailable\n      const isDirectChild = (child.getParent().get('_id') === containerId);\n      if (isDirectChild) child.setOnChildren({ _isAvailable: false });\n      child.set({\n        _isBranchChild: true,\n        _isBranchClone: false\n      });\n      const descendants = [child].concat(child.getAllDescendantModels(true));\n      // Link all branch questions to their original ids ready for\n      // cloning and to facilitate save + restore\n      descendants.forEach(descendant => {\n        descendant.set('_branchOriginalModelId', descendant.get('_id'));\n        // Stop original items saving their own attemptStates as attemptStates are used to save/restore branching\n        if (descendant.isTypeGroup('component')) descendant.set('_shouldStoreAttempts', false);\n      });\n    });\n  }\n\n  initialize() {\n    this._wasInitialized = true;\n    this.disableParentCompletion();\n    const wasRestored = this.restore();\n    if (wasRestored) {\n      // Check if the next model needs loading, this will happen if the previous\n      // item was completed in a previous session and before the next item has loaded,\n      // such as when a trickle button is enabled but not yet clicked\n      const nextModel = this.getNextModel();\n      if (typeof nextModel !== 'object') return;\n      this.addNextModel(nextModel, true, false, true);\n      return;\n    }\n    this.addFirstModel();\n  }\n\n  disableParentCompletion() {\n    this.model.set({\n      _canRequestChild: true,\n      _requireCompletionOf: Number.POSITIVE_INFINITY\n    });\n  }\n\n  enableParentCompletion() {\n    this.model.set('_requireCompletionOf', -1);\n    // Synchronously check completion, this.model.checkCompletionStatus is async\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isComplete');\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isInteractionComplete');\n  }\n\n  get startId() {\n    return this.model.get('_branching')?._start;\n  }\n\n  set startId(modelId) {\n    const config = this.model.get('_branching');\n    if (!config) return;\n    config._start = modelId;\n  }\n\n  checkResetOnStartChange() {\n    const config = this.model.get('_branching');\n    if (!config._start) return;\n    const isAtCorrectStart = (this.isAtStart && this.branchedModels[0]?.get('_branchOriginalModelId') === config._start);\n    if (isAtCorrectStart || !this.isAtStart || this.isEffectivelyComplete) return;\n    this.reset({ removeViews: true });\n  }\n\n  restore() {\n    const branching = offlineStorage.get('b');\n    if (!branching) return;\n    const id = this.model.get('_id');\n    if (!branching[id]) return;\n    const trackingPositions = offlineStorage.deserialize(branching[id]);\n    trackingPositions.forEach((trackingPosition, index) => {\n      const isLast = (index === trackingPositions.length - 1);\n      const model = data.findByTrackingPosition(trackingPosition);\n      this.addNextModel(model, false, true, isLast);\n    });\n    if (this.isAtEnd) {\n      this.enableParentCompletion();\n    }\n    return true;\n  }\n\n  addFirstModel() {\n    // Find and add the first child if the container was not restored\n    const model = this.getNextModel();\n    this.addNextModel(model, true, false);\n  }\n\n  getNextModel({ isTheoretical = false } = {}) {\n    const config = this.model.get('_branching');\n    const branchingModels = this.models;\n    const branchedModels = this.branchedModels;\n\n    const isBeforeStart = !branchedModels.length;\n    if (isBeforeStart) {\n      const hasStartId = Boolean(config._start);\n      const firstModel = hasStartId ?\n        branchingModels.find(model => model.get('_id') === config._start) :\n        branchingModels[0];\n      return firstModel;\n    }\n\n    const lastChildModel = branchedModels[branchedModels.length - 1];\n    const isLastIncomplete = !lastChildModel.get('_isComplete') && !lastChildModel.get('_isOptional');\n    if (isLastIncomplete && !isTheoretical) {\n      return false;\n    }\n\n    const lastChildConfig = lastChildModel.get('_branching');\n    if (!lastChildConfig) return true;\n\n    // Branch from the last model's correctness, if configured\n    const correctness = getCorrectness(lastChildModel);\n    const nextId = lastChildConfig._force || lastChildConfig[`_${correctness}`];\n    if (!nextId) return true;\n\n    function findNextModel(nextId) {\n      const isRelativeId = nextId.includes('@');\n      if (!isRelativeId) {\n        return branchingModels.find(model => model.get('_id') === nextId);\n      }\n      const originalLastChildModel = data.findById(lastChildModel.get('_branchOriginalModelId'));\n      const nextModel = originalLastChildModel.findRelativeModel(nextId);\n      const wasModelAlreadyUsed = nextModel.get('_isAvailable');\n      if (wasModelAlreadyUsed) return true;\n      return nextModel;\n    }\n\n    const nextModel = findNextModel(nextId);\n    // Mark as finished\n    if (nextModel === true) return true;\n    if (nextModel === undefined) {\n      // Set the start block of a different branching set\n      const nextBranchingSet = Adapt.branching.getSubsetByModelId(nextId);\n      if (!nextBranchingSet) {\n        logging.error(`Cannot branch to a model that isn't contained in a branching set: ${nextId} from ${lastChildModel.get('_id')}`);\n        return true;\n      }\n      if (!isTheoretical) nextBranchingSet.startId = nextId;\n      // Mark as finished\n      return true;\n    }\n    // Provide the next model\n    return nextModel;\n  }\n\n  addNextModel(nextModel, shouldSave = true, shouldRestore = false, isLast = true) {\n    // Clear the set's current back() position\n    this.model.set({\n      _branchLastPreviousIndex: null\n    });\n    // Increment the original model's attempts\n    const attemptIndex = (nextModel.get('_branchAttempts') || 0);\n    nextModel.set('_branchAttempts', attemptIndex + 1);\n    let isAnyPartRestored = false;\n    const cloned = nextModel.deepClone((clone, model) => {\n      clone.set({\n        _id: `${model.get('_id')}_branching_${attemptIndex}`, // Replicable ids for bookmarking\n        _isAvailable: true,\n        _isBranchClone: true\n      });\n      if (model === nextModel) {\n        clone.set('_parentId', this.model.get('_id'));\n      }\n      // Remove tracking ids as these will change depending on the branches\n      // Clone attempt states are stored on the original model in their order of occurance\n      if (clone.has('_trackingId')) {\n        clone.unset('_trackingId');\n      }\n      if (clone instanceof ComponentModel) {\n        // Clear clone response history\n        clone.set('_attemptStates', false);\n        if (shouldRestore) {\n          // Restore the attempt state from the original model in occurance order\n          const attemptObjects = model.getAttemptObjects();\n          const hasAttemptRecord = (attemptObjects.length && attemptObjects[attemptIndex]);\n          if (hasAttemptRecord) {\n            clone.set(attemptObjects[attemptIndex]);\n            isAnyPartRestored = true;\n            return;\n          }\n          // If the clone is in the middle of a branching and does not have an\n          // attempt record, then the save must have failed or be missing\n          if (!isLast) {\n            clone.setCompletionStatus();\n            isAnyPartRestored = true;\n          }\n        }\n      }\n      // Reset if not restored or not a component\n      clone.reset('hard', true);\n    });\n    if (isAnyPartRestored) {\n      // Make sure to explicitly set the block to complete if complete\n      // This helps trickle setup locking correctly\n      const areAllDescendantsComplete = cloned.getAllDescendantModels(true).every(model => model.get('_isComplete') || model.get('_isOptional'));\n      if (areAllDescendantsComplete) {\n        cloned.setCompletionStatus();\n      }\n    }\n    if (shouldSave) {\n      this.saveNextModel(nextModel);\n    }\n    return cloned;\n  }\n\n  /**\n   * @param {AdaptModel} nextModel\n   */\n  saveNextModel(nextModel) {\n    const branching = offlineStorage.get('b') || {};\n    const id = this.model.get('_id');\n    const trackingIds = (branching[id] && offlineStorage.deserialize(branching[id])) || [];\n    trackingIds.push(nextModel.trackingPosition);\n    branching[id] = offlineStorage.serialize(trackingIds);\n    offlineStorage.set('b', branching);\n  }\n\n  get models() {\n    const containerId = this.model.get('_id');\n    return data.filter(model => {\n      if (model.get('_isBranchClone')) return false;\n      const config = model.get('_branching');\n      if (!config) return false;\n      return (config._containerId === containerId);\n    });\n  }\n\n  get branchedModels() {\n    const containerId = this.model.get('_id');\n    return data.filter(model => {\n      if (!model.get('_isBranchClone')) return false;\n      const config = model.get('_branching');\n      if (!config) return false;\n      return (config._containerId === containerId);\n    });\n  }\n\n  get isAtStart() {\n    const branchedModels = this.branchedModels;\n    const firstChild = branchedModels[0];\n    const lastChild = branchedModels[branchedModels.length - 1];\n    return (firstChild === lastChild);\n  }\n\n  get isEffectivelyComplete() {\n    const isEffectivelyComplete = this.branchedModels.every(childModel => {\n      const requireCompletionOf = childModel.get('_requireCompletionOf');\n      const hasStandardCompletionCriteria = (requireCompletionOf !== -1);\n      if (hasStandardCompletionCriteria) return false;\n      // Excludes non-trackable extension components, like trickle buttons\n      const areAllAvailableTrackableChildrenComplete = childModel.getChildren()\n        .filter(model => model.get('_isAvailable') && model.get('_isTrackable') !== false)\n        .every(model => model.get('_isComplete') || model.get('_isOptional'));\n      return areAllAvailableTrackableChildrenComplete;\n    });\n    return isEffectivelyComplete && this.isAtEnd;\n  }\n\n  get isAtEnd() {\n    return (this.getNextModel({ isTheoretical: true }) === true);\n  }\n\n  async reset({ removeViews = false } = {}) {\n    if (this._isInReset || !this._wasInitialized) return;\n    this._isInReset = true;\n    this.disableParentCompletion();\n    const parentView = data.findViewByModelId(this.model.get('_id'));\n    const childViews = parentView?.getChildViews();\n    const branchedModels = this.branchedModels;\n    branchedModels.forEach(model => {\n      if (Adapt.parentView && removeViews) {\n        const view = data.findViewByModelId(model.get('_id'));\n        if (view) {\n          view.remove();\n          childViews.splice(childViews.findIndex(v => v === view), 1);\n          parentView.nthChild--;\n        }\n      }\n      data.remove(model);\n    });\n    if (removeViews) parentView?.setChildViews(childViews);\n    this.model.getChildren().remove(branchedModels);\n    this.model.findDescendantModels('component').forEach(model => model.set('_attemptStates', []));\n    const branching = offlineStorage.get('b') || {};\n    const id = this.model.get('_id');\n    const trackingIds = [];\n    branching[id] = offlineStorage.serialize(trackingIds);\n    offlineStorage.set('b', branching);\n    this.addFirstModel();\n    await Adapt.parentView?.addChildren();\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isComplete');\n    this._isInReset = false;\n    return true;\n  }\n\n}\n","import Backbone from 'backbone';\nimport Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport ComponentModel from 'core/js/models/componentModel';\nimport offlineStorage from 'core/js/offlineStorage';\nimport BranchingSet from './BranchingSet';\n\nclass Branching extends Backbone.Controller {\n\n  initialize() {\n    /** @type {[BranchingSet]} */\n    this._rawSets = [];\n    this.openPopupCount = 0;\n    this.shouldContinueOnPopupClose = false;\n    this.listenTo(Adapt, {\n      'app:dataReady': this.onAppDataReady,\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed,\n      'assessments:reset': this.onAssessmentReset\n    });\n    this.listenTo(Adapt.articles, 'change:_isComplete', this.onArticleReset);\n  }\n\n  async onAppDataReady() {\n    const config = Adapt.course.get('_branching');\n    if (!config || !config._isEnabled) return;\n    // Wait for all other app:dataReady handlers to finish\n    if (this._isAwaitingDataReady) return;\n    this._isAwaitingDataReady = true;\n    await data.whenReady();\n    this.warnForSpoorMisconfiguration();\n    this._isAwaitingDataReady = false;\n    this.setupBranchingModels();\n    this.setupEventListeners();\n    Adapt.trigger('branching:dataReady');\n  }\n\n  warnForSpoorMisconfiguration() {\n    const config = Adapt.config.get('_spoor');\n    const isMisconfigured = (config?._isEnabled && config?._tracking?._shouldStoreAttempts === false);\n    if (!isMisconfigured) return;\n    logging.error('Branching: Spoor is misconfigured. Branching requires _spoor._tracking._shouldStoreAttempts = true');\n  }\n\n  setupBranchingModels() {\n    this._rawSets.length = 0;\n    const containerModels = data.filter(model => {\n      const type = model.get('_type');\n      if (type === 'course') return false;\n      const config = model.get('_branching');\n      if (!config || !config._isEnabled) return false;\n      if (type === 'article' && config._onChildren === undefined) {\n        // Assume this is the authoring tool and that an article\n        // is always a branching container.\n        config._onChildren = true;\n        model.set('_branching', config);\n      }\n      return (config._onChildren === true);\n    });\n    containerModels.forEach(containerModel => {\n      const set = new BranchingSet({ model: containerModel });\n      this._rawSets.push(set);\n    });\n    this._rawSets.forEach(set => set.initialize());\n  }\n\n  get subsets() {\n    return this._rawSets;\n  }\n\n  getSubsetByModelId(modelId) {\n    return this._rawSets.find(set => set.model.get('_id') === modelId || set.models.find(model => model.get('_id') === modelId));\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, 'view:requestChild', this.onRequestChild);\n    this.listenTo(data, 'change:_isComplete', this.onComplete);\n  }\n\n  onRequestChild(event) {\n    const set = this.getSubsetByModelId(event.target.model.get('_id'));\n    if (!set) return;\n    set.checkResetOnStartChange();\n    const nextModel = set.getNextModel();\n    if (nextModel === false) {\n      // Previous model isn't complete\n      return;\n    }\n    if (nextModel === true) {\n      // No further models, manually check completion of branching container\n      set.enableParentCompletion();\n      return;\n    }\n    const clonedModel = set.addNextModel(nextModel);\n    event.model = clonedModel;\n    // Stop rendering children in this parent to allow for user responses\n    event.stopNext();\n  }\n\n  onPopupOpened() {\n    this.openPopupCount++;\n  }\n\n  onPopupClosed() {\n    this.openPopupCount--;\n    if (!this.shouldContinueOnPopupClose || this.openPopupCount > 0) return;\n    this.shouldContinueOnPopupClose = false;\n    this.continue();\n  }\n\n  onArticleReset(model, isComplete) {\n    if (isComplete) return;\n    const set = this.getSubsetByModelId(model.get('_id'));\n    if (!set) return;\n    set.reset({ removeViews: true });\n  }\n\n  onAssessmentReset(state) {\n    const set = this.getSubsetByModelId(state.articleId);\n    if (!set) return;\n    set.reset({ removeViews: true });\n  }\n\n  async continue() {\n    if (!Adapt.parentView) return;\n\n    if (this.openPopupCount) {\n      this.shouldContinueOnPopupClose = true;\n      return;\n    }\n    await Adapt.parentView.addChildren();\n  }\n\n  onComplete(model, value) {\n    if (!value) return;\n    this.continueAfterBranchChild(model);\n    this.saveBranchQuestionAttemptHistory(model);\n  }\n\n  continueAfterBranchChild(model) {\n    this.checkIfIsEffectivelyComplete(model);\n    if (!model.get('_isBranchChild') || !model.get('_isAvailable')) return;\n    _.defer(() => this.continue());\n  }\n\n  /**\n   * Check if, excluding _isTrackable: false elements, that the branching is\n   * effectively complete and set completion criteria accordingly.\n   * @param {Backbone.model} model\n   */\n  checkIfIsEffectivelyComplete(model) {\n    const childModel = model.getParent();\n    if (!childModel) return;\n    const isBranchChild = childModel.get('_isBranchChild');\n    if (!isBranchChild) return;\n    const containerModel = childModel.getParent();\n    const set = this.getSubsetByModelId(containerModel.get('_id'));\n    if (!set?.isEffectivelyComplete) return;\n    // Allow assessment to complete at the end, before the last trickle button is clicked\n    set.enableParentCompletion();\n  }\n\n  saveBranchQuestionAttemptHistory(model) {\n    if (!(model instanceof ComponentModel)) return;\n    const branchOriginModelId = model.get('_branchOriginalModelId');\n    if (!branchOriginModelId) return;\n    const originModel = data.findById(branchOriginModelId);\n    originModel.addAttemptObject(model.getAttemptObject());\n    offlineStorage.save();\n  }\n\n}\n\nexport default (Adapt.branching = new Branching());\n","import Adapt from 'core/js/adapt';\nimport _ from 'underscore';\n\nclass Completion extends Backbone.Controller {\n\n  initialize() {\n    _.bindAll(this, 'calculatePercentageComplete');\n    this.subProgressCompleted = 0;\n    this.subProgressTotal = 0;\n    this.nonAssessmentCompleted = 0;\n    this.nonAssessmentTotal = 0;\n    this.assessmentCompleted = 0;\n    this.assessmentTotal = 0;\n  }\n\n  // Calculate completion of a contentObject\n  calculateCompletion(contentObjectModel, setGlobal = false) {\n    const completion = {};\n    const perform = contentObjectModel => {\n      const viewType = contentObjectModel.get('_type');\n      const isComplete = contentObjectModel.get('_isComplete') ? 1 : 0;\n      let children;\n      switch (viewType) {\n        case 'page': {\n          // If it's a page\n          children = contentObjectModel.getAllDescendantModels().filter(model => {\n            return model.get('_isAvailable') && !model.get('_isOptional');\n          });\n\n          const availableChildren = this.filterAvailableChildren(children);\n          const components = this.getPageLevelProgressEnabledModels(availableChildren);\n          const nonAssessmentComponents = this.getNonAssessmentComponents(components);\n\n          completion.nonAssessmentTotal += nonAssessmentComponents.length;\n          completion.nonAssessmentCompleted += this.getComponentsCompleted(nonAssessmentComponents).length;\n\n          const assessmentComponents = this.getAssessmentComponents(components);\n\n          completion.assessmentTotal += assessmentComponents.length;\n          completion.assessmentCompleted += this.getComponentsInteractionCompleted(assessmentComponents).length;\n\n          if (contentObjectModel.get('_pageLevelProgress')._excludeAssessments !== true) {\n            completion.subProgressCompleted += contentObjectModel.get('_subProgressComplete') || 0;\n            completion.subProgressTotal += contentObjectModel.get('_subProgressTotal') || 0;\n          }\n\n          const showPageCompletionCourse = Adapt.course.get('_pageLevelProgress')?._showPageCompletion !== false;\n          const showPageCompletionPage = contentObjectModel.get('_pageLevelProgress')?._showPageCompletion !== false;\n\n          if (showPageCompletionCourse && showPageCompletionPage) {\n            // optionally add one point extra for page completion to eliminate incomplete pages and full progress bars\n            // if _showPageCompletion is true then the progress bar should also consider it so add 1 to nonAssessmentTotal\n            completion.nonAssessmentCompleted += isComplete;\n            completion.nonAssessmentTotal += 1;\n          }\n\n          break;\n        }\n        case 'menu': case 'course': {\n          // If it's a sub-menu\n          children = contentObjectModel.getChildren().models;\n          children.forEach(perform);\n          break;\n        }\n      }\n    };\n    completion.subProgressCompleted = 0;\n    completion.subProgressTotal = 0;\n    completion.nonAssessmentTotal = 0;\n    completion.nonAssessmentCompleted = 0;\n    completion.assessmentTotal = 0;\n    completion.assessmentCompleted = 0;\n    perform(contentObjectModel);\n    if (setGlobal) Object.assign(Adapt.completion, completion);\n    return completion;\n  }\n\n  getNonAssessmentComponents(models) {\n    return models.filter(model => {\n      return !model.get('_isPartOfAssessment');\n    });\n  }\n\n  getAssessmentComponents(models) {\n    return models.filter(model => {\n      return model.get('_isPartOfAssessment');\n    });\n  }\n\n  getComponentsCompleted(models) {\n    return models.filter(item => {\n      return item.get('_isComplete');\n    });\n  }\n\n  getComponentsInteractionCompleted(models) {\n    return models.filter(item => {\n      return item.get('_isComplete');\n    });\n  }\n\n  // Get only those models who were enabled for pageLevelProgress\n  getPageLevelProgressEnabledModels(models) {\n    return models.filter(model => {\n      const config = model.get('_pageLevelProgress');\n      return config?._isEnabled;\n    });\n  }\n\n  unavailableInHierarchy(parents) {\n    if (!parents) return;\n    return parents.some(parent => {\n      return !parent.get('_isAvailable');\n    });\n  }\n\n  filterAvailableChildren(children) {\n    const availableChildren = [];\n\n    for (let i = 0, count = children.length; i < count; i++) {\n      const parents = children[i].getAncestorModels();\n      if (this.unavailableInHierarchy(parents)) continue;\n      availableChildren.push(children[i]);\n    }\n\n    return availableChildren;\n  }\n\n  calculatePercentageComplete(model, setGlobal = false) {\n    const completionObject = this.calculateCompletion(model, setGlobal);\n    // take all assessment, nonassessment and subprogress into percentage\n    // this allows the user to see if assessments have been passed, if assessment components can be retaken, and all other component's completion\n    const completed = completionObject.nonAssessmentCompleted + completionObject.assessmentCompleted + completionObject.subProgressCompleted;\n    const total = completionObject.nonAssessmentTotal + completionObject.assessmentTotal + completionObject.subProgressTotal;\n    const percentageComplete = Math.floor((completed / total) * 100);\n    return percentageComplete;\n  }\n\n}\n\nexport default (Adapt.completion = new Completion());\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport router from 'core/js/router';\nimport { templates } from 'core/js/reactHelpers';\n\nexport default class PageLevelProgressView extends Backbone.View {\n\n  className() {\n    return 'pagelevelprogress';\n  }\n\n  events() {\n    return {\n      'click .js-pagelevelprogress-item-click': 'scrollToPageElement'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, 'remove', this.remove);\n    this.render();\n  }\n\n  async scrollToPageElement(event) {\n    if (event && event.preventDefault) event.preventDefault();\n\n    const $target = $(event.currentTarget);\n    if ($target.is('.is-disabled')) return;\n\n    const id = $target.attr('data-pagelevelprogress-id');\n    const model = data.findById(id);\n    const isNavigateToContentObject = model.isTypeGroup('contentobject');\n\n    if (isNavigateToContentObject) {\n      router.navigateToElement(id, { duration: 400 });\n      Adapt.trigger('drawer:closeDrawer');\n      return;\n    }\n\n    if (!model.get('_isRendered')) {\n      try {\n        await Adapt.parentView.renderTo(id);\n      } catch (err) {\n        return;\n      }\n    }\n    const currentComponentSelector = `.${id}`;\n    Adapt.once('drawer:closed', () => {\n      router.navigateToElement(currentComponentSelector, { duration: 400 });\n    }).trigger('drawer:closeDrawer', $(currentComponentSelector));\n  }\n\n  render() {\n    const Component = templates.pageLevelProgress;\n    ReactDOM.render(<Component\n      _items={Array.isArray(this.collection) && this.collection}\n      _item={!Array.isArray(this.collection) && this.collection}\n      _globals={Adapt.course.get('_globals')}\n    />, this.el);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\nclass PageLevelProgressIndicatorView extends Backbone.View {\n\n  tagName() {\n    return 'span';\n  }\n\n  initialize(options) {\n    options = options || {};\n    this.parent = options.parent;\n    this.calculatePercentage = options.calculatePercentage || this.calculatePercentage;\n    this.ariaLabel = options.ariaLabel || '';\n    this.type = options.type || this.model.get('_type');\n    this.addClasses();\n    this.setUpEventListeners();\n    this.setPercentageComplete();\n    this.render();\n    this.refresh();\n  }\n\n  addClasses() {\n    this.$el.addClass([\n      'pagelevelprogress__indicator',\n      'is-' + this.type\n    ].join(' '));\n  }\n\n  checkAria() {\n    if (!this.ariaLabel) {\n      this.$el.attr('aria-hidden', true);\n      return;\n    }\n    const data = this.getRenderData();\n    this.$('.js-indicator-aria-label').html(Handlebars.compile(this.ariaLabel)(data));\n  }\n\n  setUpEventListeners() {\n    if (this.parent) {\n      this.listenToOnce(this.parent, 'postRemove', this.remove);\n    } else {\n      this.listenTo(Adapt, 'remove', this.remove);\n    }\n    this.listenTo(Adapt.course, 'bubble:change:_isComplete', this.refresh);\n  }\n\n  setPercentageComplete() {\n    const percentage = this.calculatePercentage();\n    this.model.set('percentageComplete', percentage);\n    return percentage;\n  }\n\n  calculatePercentage() {\n    return this.model.get('_isComplete') ? 100 : 0;\n  }\n\n  render() {\n    const data = this.getRenderData();\n    const template = Handlebars.templates[this.constructor.template];\n    this.$el.html(template(data));\n  }\n\n  getRenderData() {\n    const data = this.model.toJSON();\n    data.ariaLabel = this.ariaLabel;\n    data.type = this.type;\n    return data;\n  }\n\n  refresh() {\n    this.checkCompletion();\n    this.checkAria();\n    this.$('.js-indicator-bar').css({\n      width: this.calculatePercentage() + '%'\n    });\n  }\n\n  checkCompletion() {\n    const percentage = this.setPercentageComplete();\n    this.$el\n      .toggleClass('is-complete', percentage === 100)\n      .toggleClass('is-incomplete', percentage !== 100);\n  }\n\n}\n\nPageLevelProgressIndicatorView.template = 'pageLevelProgressIndicator';\n\nexport default PageLevelProgressIndicatorView;\n","import Adapt from 'core/js/adapt';\nimport completionCalculations from './completionCalculations';\n\nexport default function getPageLevelProgressItemsJSON(parentModel) {\n  const {\n    _showAtCourseLevel\n  } = Adapt.course.get('_pageLevelProgress');\n\n  const isInAPage = parentModel.isTypeGroup('page');\n\n  function addChildren(model) {\n    const allDescendants = model.getAllDescendantModels(true);\n    const currentPageItems = allDescendants.filter(descendant => {\n      const isDescendantContentObject = descendant.isTypeGroup('contentobject');\n      const isDescendantCurrentPage = (model === parentModel);\n      if (!isInAPage && !isDescendantContentObject) return false;\n      if (isInAPage && !isDescendantCurrentPage && !isDescendantContentObject) return false;\n      return (descendant.get('_isAvailable') === true);\n    });\n    const availableItems = completionCalculations.filterAvailableChildren(currentPageItems);\n    const enabledProgressItems = completionCalculations.getPageLevelProgressEnabledModels(availableItems);\n    if (!enabledProgressItems.length) {\n      return {\n        ...model.toJSON(),\n        _children: null\n      };\n    }\n    const _children = enabledProgressItems.map(model => addChildren(model));\n    return {\n      ...model.toJSON(),\n      _children\n    };\n  }\n\n  const jsonOutput = _showAtCourseLevel\n    ? addChildren(Adapt.course)\n    : addChildren(parentModel)._children;\n\n  return jsonOutput;\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport drawer from 'core/js/drawer';\nimport completionCalculations from './completionCalculations';\nimport PageLevelProgressView from './PageLevelProgressView';\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\nimport getPageLevelProgressItemsJSON from './getPageLevelProgressItems';\n\nexport default class PageLevelProgressNavigationView extends Backbone.View {\n\n  tagName() {\n    return 'button';\n  }\n\n  className() {\n    return 'btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn';\n  }\n\n  attributes() {\n    return {\n      'data-order': (Adapt.course.get('_globals')?._extensions?._pageLevelProgress?._navOrder || 0)\n    };\n  }\n\n  events() {\n    return {\n      click: 'onProgressClicked'\n    };\n  }\n\n  initialize() {\n    _.bindAll(this, 'updateProgressBar');\n    this.refreshProgressBar = _.debounce(this.refreshProgressBar.bind(this), 16);\n    this.setUpEventListeners();\n    this.render();\n    this.addIndicator();\n    this.deferredUpdate();\n  }\n\n  setUpEventListeners() {\n    this.listenTo(Adapt, {\n      remove: this.remove,\n      'router:location': this.updateProgressBar,\n      'view:childAdded pageLevelProgress:update': this.refreshProgressBar\n    });\n    this.listenTo(data, 'change:_isLocked change:_isComplete', this.refreshProgressBar);\n  }\n\n  render() {\n    const template = Handlebars.templates.pageLevelProgressNavigation;\n    this.$el.html(template({}));\n  }\n\n  addIndicator() {\n    this.indicatorView = new PageLevelProgressIndicatorView({\n      model: this.model,\n      calculatePercentage: this._getPageCompletionPercentage,\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar\n    });\n    this.$el.prepend(this.indicatorView.$el);\n  }\n\n  _getPageCompletionPercentage() {\n    return completionCalculations.calculatePercentageComplete(this.model, true);\n  }\n\n  deferredUpdate() {\n    _.defer(this.updateProgressBar);\n  }\n\n  updateProgressBar() {\n    this.indicatorView.refresh();\n  }\n\n  refreshProgressBar() {\n    this.collection = getPageLevelProgressItemsJSON(this.model);\n    this.updateProgressBar();\n  }\n\n  onProgressClicked(event) {\n    if (event && event.preventDefault) event.preventDefault();\n    drawer.triggerCustomView(new PageLevelProgressView({\n      collection: this.collection\n    }).$el, false);\n  }\n\n  remove() {\n    super.remove();\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport location from 'core/js/location';\nimport completionCalculations from './completionCalculations';\nimport PageLevelProgressNavigationView from './PageLevelProgressNavigationView';\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\nimport getPageLevelProgressItems from './getPageLevelProgressItems';\n\nclass PageLevelProgress extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, {\n      'app:dataReady': this.onDataReady,\n      'app:languageChanged': this.onLanguageChange\n    });\n  }\n\n  getCourseConfig() {\n    return Adapt.course.get('_pageLevelProgress');\n  }\n\n  onDataReady() {\n    // Do not proceed if pageLevelProgress is not enabled in course.json\n    const coursePLPConfig = this.getCourseConfig();\n    if (!coursePLPConfig?._isEnabled) return;\n    this.setUpEventListeners();\n  }\n\n  onLanguageChange() {\n    this.stopListening();\n    this.initialize();\n  }\n\n  setUpEventListeners() {\n    const headerIndicatorTypes = [\n      'menu',\n      'menuItem',\n      'page',\n      'article',\n      'block',\n      'component'\n    ];\n\n    const headerIndicatorEventNames = headerIndicatorTypes\n      .concat([''])\n      .join('View:render ');\n\n    this.listenTo(Adapt, headerIndicatorEventNames, this.renderHeaderIndicatorView);\n\n    this.listenTo(Adapt, {\n      'menuItemView:postRender': this.renderMenuItemIndicatorView,\n      'router:contentObject': this.renderNavigationView\n    });\n\n    this.listenTo(Adapt.course, 'bubble:change:_isComplete', this.onCompletionChange);\n  }\n\n  onCompletionChange(event) {\n    if (!location._currentId) return;\n\n    const currentModel = data.findById(location._currentId);\n    const completionState = {\n      currentLocation: completionCalculations.calculatePercentageComplete(currentModel),\n      course: completionCalculations.calculatePercentageComplete(Adapt.course)\n    };\n    const hasChanged = !_.isMatch(this._previousCompletionState, completionState);\n    if (!hasChanged) return;\n\n    this._previousCompletionState = completionState;\n    Adapt.trigger('pageLevelProgress:percentageCompleteChange', completionState);\n  }\n\n  renderHeaderIndicatorView(view) {\n    const model = view.model;\n    const config = model.get('_pageLevelProgress');\n    if (!config?._isEnabled || !config?._isCompletionIndicatorEnabled) return;\n\n    const pageModel = model.findAncestor('contentobject');\n    const pageConfig = pageModel && pageModel.get('_pageLevelProgress');\n    if (!pageConfig?._isEnabled) return;\n\n    const $headings = view.$('.js-heading');\n    $headings.each((index, el) => {\n      const $el = $(el);\n      const indicatorView = new PageLevelProgressIndicatorView({\n        parent: view,\n        model\n      });\n      const isBackwardCompatible = [...$el[0].classList].every(name => !name.includes('-inner'));\n      if (isBackwardCompatible) {\n        indicatorView.$el.insertAfter($el);\n        return;\n      }\n      indicatorView.$el.insertBefore($el);\n    });\n  }\n\n  // This should add/update progress on menuView\n  renderMenuItemIndicatorView(view) {\n    // Do not render on menu, only render on menu items\n    if (view.model.get('_id') === location._currentId) return;\n\n    // Progress bar should not render for course viewType\n    const viewType = view.model.get('_type');\n    if (viewType === 'course') return;\n\n    // Do not proceed if pageLevelProgress is not enabled for the content object\n    const pageLevelProgress = view.model.get('_pageLevelProgress');\n    if (!pageLevelProgress?._isEnabled) return;\n\n    view.$el.find('.js-menu-item-progress').append(new PageLevelProgressIndicatorView({\n      parent: view,\n      model: view.model,\n      type: 'menu-item',\n      calculatePercentage: this._getMenuItemCompletionPercentage.bind(view),\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar\n    }).$el);\n  }\n\n  _getMenuItemCompletionPercentage() {\n    return completionCalculations.calculatePercentageComplete(this.model);\n  }\n\n  // This should add/update progress on page navigation bar\n  renderNavigationView(pageModel) {\n    // Do not render if turned off at course level\n    const coursePLPConfig = this.getCourseConfig();\n    if (coursePLPConfig?._isShownInNavigationBar === false) return;\n\n    // Do not proceed if pageLevelProgress is not enabled for the content object\n    const pagePLPConfig = pageModel.get('_pageLevelProgress');\n    if (!pagePLPConfig?._isEnabled) return;\n\n    // Progress bar should not render for course viewType\n    const viewType = pageModel.get('_type');\n    if (viewType === 'course' && coursePLPConfig._showAtCourseLevel !== true) return;\n\n    const collection = getPageLevelProgressItems(pageModel);\n    if (collection.length === 0) return;\n\n    $('.nav__drawer-btn').after(new PageLevelProgressNavigationView({\n      model: pageModel,\n      collection\n    }).$el);\n  }\n\n}\n\nexport default (Adapt.pageLevelProgress = new PageLevelProgress());\n","class Logger {\n\n  constructor() {\n    this.logArr = [];\n    this.registeredViews = [];\n  }\n\n  static getInstance() {\n    if (Logger.instance === null) {\n      Logger.instance = new Logger();\n    }\n    return Logger.instance;\n  }\n\n  getEntries() {\n    return this.logArr;\n  }\n\n  getLastEntry() {\n    return this.logArr[this.logArr.length - 1];\n  }\n\n  info(str) {\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_INFO, time: Date.now() };\n    this.updateViews();\n  }\n\n  warn(str) {\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_WARN, time: Date.now() };\n    this.updateViews();\n  }\n\n  error(str) {\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_ERROR, time: Date.now() };\n    this.updateViews();\n  }\n\n  debug(str) {\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_DEBUG, time: Date.now() };\n    this.updateViews();\n  }\n\n  registerView(_view) {\n    this.registeredViews[this.registeredViews.length] = _view;\n  }\n\n  unregisterView(_view) {\n    for (let i = 0, l = this.registeredViews.length; i < l; i++) {\n      if (this.registeredViews[i] !== _view) continue;\n      this.registeredViews.splice(i, 1);\n      i--;\n    }\n  }\n\n  updateViews() {\n    for (let i = 0, l = this.registeredViews.length; i < l; i++) {\n      if (!this.registeredViews[i]) continue;\n      this.registeredViews[i].update(this);\n    }\n  }\n\n}\n\nLogger.instance = null;\nLogger.LOG_TYPE_INFO = 0;\nLogger.LOG_TYPE_WARN = 1;\nLogger.LOG_TYPE_ERROR = 2;\nLogger.LOG_TYPE_DEBUG = 3;\n\n// Assign global reference for debug window\nexport default (window.Logger = Logger);\n","class ScormError {\n\n  constructor(name, data = {}) {\n    this.name = name;\n    this.data = data;\n  }\n\n}\n\nScormError.CLIENT_COULD_NOT_CONNECT = 'CLIENT_COULD_NOT_CONNECT';\nScormError.SERVER_STATUS_UNSUPPORTED = 'SERVER_STATUS_UNSUPPORTED'; // status\nScormError.CLIENT_STATUS_UNSUPPORTED = 'CLIENT_STATUS_UNSUPPORTED'; // status\nScormError.CLIENT_COULD_NOT_COMMIT = 'CLIENT_COULD_NOT_COMMIT'; // errorCode, errorInfo, diagnosticInfo\nScormError.CLIENT_NOT_CONNECTED = 'CLIENT_NOT_CONNECTED';\nScormError.CLIENT_COULD_NOT_FINISH = 'CLIENT_COULD_NOT_FINISH'; // errorCode, errorInfo, diagnosticInfo\nScormError.CLIENT_COULD_NOT_GET_PROPERTY = 'CLIENT_COULD_NOT_GET_PROPERTY'; // property, errorCode, errorInfo, diagnosticInfo\nScormError.CLIENT_COULD_NOT_SET_PROPERTY = 'CLIENT_COULD_NOT_SET_PROPERTY'; // property, value, errorCode, errorInfo, diagnosticInfo\nScormError.CLIENT_INVALID_CHOICE_VALUE = 'CLIENT_INVALID_CHOICE_VALUE';\n\nScormError.defaultMessages = {\n  title: 'An error has occurred',\n  pressOk: 'Press \\'OK\\' to view detailed debug information to send to technical support.',\n  CLIENT_COULD_NOT_CONNECT: 'The course could not connect to the Learning Management System',\n  SERVER_STATUS_UNSUPPORTED: 'An invalid lesson status of \\'{{{status}}}\\' was received from Learning Management System',\n  CLIENT_STATUS_UNSUPPORTED: 'The status \\'{{{status}}}\\' is not supported.',\n  CLIENT_COULD_NOT_COMMIT: 'There was a problem saving data to the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n  CLIENT_NOT_CONNECTED: 'The course is not connected to the Learning Management System',\n  CLIENT_COULD_NOT_FINISH: 'The course was unable to terminate the learning session\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n  CLIENT_COULD_NOT_GET_PROPERTY: 'Unable to get the value of {{property}} from the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n  CLIENT_COULD_NOT_SET_PROPERTY: 'Unable to set {{property}} to: \\'{{{value}}}\\'\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n  CLIENT_INVALID_CHOICE_VALUE: 'Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2'\n};\n\nexport default ScormError;\n","import Adapt from 'core/js/adapt';\nimport notify from 'core/js/notify';\nimport pipwerks from 'libraries/SCORM_API_wrapper';\nimport Logger from './logger';\nimport ScormError from './error';\n\nconst {\n  CLIENT_COULD_NOT_CONNECT,\n  SERVER_STATUS_UNSUPPORTED,\n  CLIENT_STATUS_UNSUPPORTED,\n  CLIENT_COULD_NOT_COMMIT,\n  CLIENT_NOT_CONNECTED,\n  CLIENT_COULD_NOT_FINISH,\n  CLIENT_COULD_NOT_GET_PROPERTY,\n  CLIENT_COULD_NOT_SET_PROPERTY,\n  CLIENT_INVALID_CHOICE_VALUE\n} = ScormError;\n\n/**\n * IMPORTANT: This wrapper uses the Pipwerks SCORM wrapper and should therefore support both SCORM 1.2 and 2004. Ensure any changes support both versions.\n */\nclass ScormWrapper {\n\n  constructor() {\n    /* configuration */\n    this.setCompletedWhenFailed = true;// this only applies to SCORM 2004\n    /**\n     * whether to commit each time there's a change to lesson_status or not\n     */\n    this.commitOnStatusChange = true;\n    /**\n     * whether to commit each time there's a change to any value\n     */\n    this.commitOnAnyChange = false;\n    /**\n     * how frequently (in minutes) to commit automatically. set to 0 to disable.\n     */\n    this.timedCommitFrequency = 10;\n    /**\n     * how many times to retry if a commit fails\n     */\n    this.maxCommitRetries = 5;\n    /**\n     * time (in milliseconds) to wait between retries\n     */\n    this.commitRetryDelay = 1000;\n\n    /**\n     * prevents commit from being called if there's already a 'commit retry' pending.\n     */\n    this.commitRetryPending = false;\n    /**\n     * how many times we've done a 'commit retry'\n     */\n    this.commitRetries = 0;\n    /**\n     * not currently used - but you could include in an error message to show when data was last saved\n     */\n    this.lastCommitSuccessTime = null;\n    /**\n     * The exit state to use when course isn't completed yet\n     */\n    this.exitStateIfIncomplete = 'auto';\n    /**\n     * The exit state to use when the course has been completed/passed\n     */\n    this.exitStateIfComplete = 'auto';\n\n    this.timedCommitIntervalID = null;\n    this.retryCommitTimeoutID = null;\n    this.logOutputWin = null;\n    this.startTime = null;\n    this.endTime = null;\n\n    this.lmsConnected = false;\n    this.finishCalled = false;\n\n    this.logger = Logger.getInstance();\n    this.scorm = pipwerks.SCORM;\n    /**\n     * Prevent the Pipwerks SCORM API wrapper's handling of the exit status\n     */\n    this.scorm.handleExitMode = false;\n\n    this.suppressErrors = false;\n    this.debouncedCommit = _.debounce(this.commit.bind(this), 100);\n    if (window.__debug) {\n      this.showDebugWindow();\n    }\n\n    if (!(window.API?.__offlineAPIWrapper && window?.API_1484_11?.__offlineAPIWrapper)) return;\n    this.logger.error('Offline SCORM API is being used. No data will be reported to the LMS!');\n  }\n\n  // ******************************* public methods *******************************\n\n  static getInstance() {\n    if (ScormWrapper.instance === null) {\n      ScormWrapper.instance = new ScormWrapper();\n    }\n\n    return ScormWrapper.instance;\n  }\n\n  getVersion() {\n    return this.scorm.version;\n  }\n\n  setVersion(value) {\n    this.logger.debug(`ScormWrapper::setVersion: ${value}`);\n    this.scorm.version = value;\n  }\n\n  initialize() {\n    this.logger.debug('ScormWrapper::initialize');\n    this.lmsConnected = this.scorm.init();\n\n    if (!this.lmsConnected) {\n      this.handleError(new ScormError(CLIENT_COULD_NOT_CONNECT));\n      return this.lmsConnected;\n    }\n\n    this.startTime = new Date();\n    this.initTimedCommit();\n\n    return this.lmsConnected;\n  }\n\n  /**\n   * allows you to check if this is the user's first ever 'session' of a SCO, even after the lesson_status has been set to 'incomplete'\n   */\n  isFirstSession() {\n    return (this.getValue(this.isSCORM2004() ? 'cmi.entry' : 'cmi.core.entry') === 'ab-initio');\n  }\n\n  setIncomplete() {\n    this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'incomplete');\n\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n  }\n\n  setCompleted() {\n    this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'completed');\n\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n  }\n\n  setPassed() {\n    if (this.isSCORM2004()) {\n      this.setValue('cmi.completion_status', 'completed');\n      this.setValue('cmi.success_status', 'passed');\n    } else {\n      this.setValue('cmi.core.lesson_status', 'passed');\n    }\n\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n  }\n\n  setFailed() {\n    if (this.isSCORM2004()) {\n      this.setValue('cmi.success_status', 'failed');\n\n      if (this.setCompletedWhenFailed) {\n        this.setValue('cmi.completion_status', 'completed');\n      }\n    } else {\n      this.setValue('cmi.core.lesson_status', 'failed');\n    }\n\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n  }\n\n  getStatus() {\n    const status = this.getValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status');\n\n    switch (status.toLowerCase()) { // workaround for some LMSes (e.g. Arena) not adhering to the all-lowercase rule\n      case 'passed':\n      case 'completed':\n      case 'incomplete':\n      case 'failed':\n      case 'browsed':\n      case 'not attempted':\n      case 'not_attempted': // mentioned in SCORM 2004 docs but not sure it ever gets used\n      case 'unknown': // the SCORM 2004 version of not attempted\n        return status;\n      default:\n        this.handleError(new ScormError(SERVER_STATUS_UNSUPPORTED, { status }));\n        return null;\n    }\n  }\n\n  setStatus(status) {\n    switch (status.toLowerCase()) {\n      case 'incomplete':\n        this.setIncomplete();\n        break;\n      case 'completed':\n        this.setCompleted();\n        break;\n      case 'passed':\n        this.setPassed();\n        break;\n      case 'failed':\n        this.setFailed();\n        break;\n      default:\n        this.handleError(new ScormError(CLIENT_STATUS_UNSUPPORTED, { status }));\n    }\n  }\n\n  getScore() {\n    return this.getValue(this.isSCORM2004() ? 'cmi.score.raw' : 'cmi.core.score.raw');\n  }\n\n  setScore(score, minScore = 0, maxScore = 100) {\n    if (this.isSCORM2004()) {\n      this.setValue('cmi.score.raw', score);\n      this.setValue('cmi.score.min', minScore);\n      this.setValue('cmi.score.max', maxScore);\n\n      const range = maxScore - minScore;\n      const scaledScore = ((score - minScore) / range).toFixed(7);\n      this.setValue('cmi.score.scaled', scaledScore);\n      return;\n    }\n    // SCORM 1.2\n    this.setValue('cmi.core.score.raw', score);\n    if (this.isSupported('cmi.core.score.min')) this.setValue('cmi.core.score.min', minScore);\n    if (this.isSupported('cmi.core.score.max')) this.setValue('cmi.core.score.max', maxScore);\n  }\n\n  getLessonLocation() {\n    return this.getValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location');\n  }\n\n  setLessonLocation(location) {\n    this.setValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location', location);\n  }\n\n  getSuspendData() {\n    return this.getValue('cmi.suspend_data');\n  }\n\n  setSuspendData(data) {\n    this.setValue('cmi.suspend_data', data);\n  }\n\n  getStudentName() {\n    return this.getValue(this.isSCORM2004() ? 'cmi.learner_name' : 'cmi.core.student_name');\n  }\n\n  getStudentId() {\n    return this.getValue(this.isSCORM2004() ? 'cmi.learner_id' : 'cmi.core.student_id');\n  }\n\n  setLanguage(lang) {\n    if (this.isSCORM2004()) {\n      this.setValue('cmi.learner_preference.language', lang);\n      return;\n    }\n    if (!this.isSupported('cmi.student_preference.language')) return;\n    this.setValue('cmi.student_preference.language', lang);\n  }\n\n  commit() {\n    this.logger.debug('ScormWrapper::commit');\n\n    if (!this.lmsConnected) {\n      this.handleError(new ScormError(ScormError.CLIENT_NOT_CONNECTED));\n      return;\n    }\n\n    if (this.commitRetryPending) {\n      this.logger.debug('ScormWrapper::commit: skipping this commit call as one is already pending.');\n      return;\n    }\n\n    if (this.scorm.save()) {\n      this.commitRetries = 0;\n      this.lastCommitSuccessTime = new Date();\n      Adapt.trigger('spoor:commit', this);\n      return;\n    }\n\n    if (this.commitRetries < this.maxCommitRetries && !this.finishCalled) {\n      this.commitRetries++;\n      this.initRetryCommit();\n      return;\n    }\n\n    const errorCode = this.scorm.debug.getCode();\n    this.handleError(new ScormError(CLIENT_COULD_NOT_COMMIT, {\n      errorCode,\n      errorInfo: this.scorm.debug.getInfo(errorCode),\n      diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n    }));\n  }\n\n  finish() {\n    this.logger.debug('ScormWrapper::finish');\n\n    if (!this.lmsConnected || this.finishCalled) {\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n      return;\n    }\n\n    this.finishCalled = true;\n\n    if (this.timedCommitIntervalID !== null) {\n      window.clearInterval(this.timedCommitIntervalID);\n    }\n\n    if (this.commitRetryPending) {\n      window.clearTimeout(this.retryCommitTimeoutID);\n      this.commitRetryPending = false;\n    }\n\n    if (this.logOutputWin && !this.logOutputWin.closed) {\n      this.logOutputWin.close();\n    }\n\n    this.endTime = new Date();\n\n    if (this.isSCORM2004()) {\n      this.scorm.set('cmi.session_time', this.convertToSCORM2004Time(this.endTime.getTime() - this.startTime.getTime()));\n      this.scorm.set('cmi.exit', this.getExitState());\n    } else {\n      this.scorm.set('cmi.core.session_time', this.convertToSCORM12Time(this.endTime.getTime() - this.startTime.getTime()));\n      this.scorm.set('cmi.core.exit', this.getExitState());\n    }\n\n    // api no longer available from this point\n    this.lmsConnected = false;\n\n    if (this.scorm.quit()) return;\n    const errorCode = this.scorm.debug.getCode();\n    this.handleError(new ScormError(CLIENT_COULD_NOT_FINISH, {\n      errorCode,\n      errorInfo: this.scorm.debug.getInfo(errorCode),\n      diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n    }));\n  }\n\n  recordInteraction(id, response, correct, latency, type) {\n    if (!this.isSupported('cmi.interactions._count')) {\n      this.logger.info('ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...');\n      return;\n    }\n\n    switch (type) {\n      case 'choice':\n        this.recordInteractionMultipleChoice.apply(this, arguments);\n        break;\n\n      case 'matching':\n        this.recordInteractionMatching.apply(this, arguments);\n        break;\n\n      case 'numeric':\n        this.isSCORM2004() ? this.recordInteractionScorm2004.apply(this, arguments) : this.recordInteractionScorm12.apply(this, arguments);\n        break;\n\n      case 'fill-in':\n        this.recordInteractionFillIn.apply(this, arguments);\n        break;\n\n      default:\n        console.error(`ScormWrapper.recordInteraction: unknown interaction type of '${type}' encountered...`);\n    }\n  }\n\n  // ****************************** private methods ******************************\n\n  getValue(property) {\n    this.logger.debug(`ScormWrapper::getValue: _property=${property}`);\n\n    if (this.finishCalled) {\n      this.logger.debug('ScormWrapper::getValue: ignoring request as \\'finish\\' has been called');\n      return;\n    }\n\n    if (!this.lmsConnected) {\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n      return;\n    }\n\n    const value = this.scorm.get(property);\n    const errorCode = this.scorm.debug.getCode();\n\n    switch (errorCode) {\n      case 0:\n        break;\n      case 403:\n        // 403 errors are common (and normal) when targetting SCORM 2004 - they are triggered on any\n        // attempt to get the value of a data model element that hasn't yet been assigned a value.\n        this.logger.warn('ScormWrapper::getValue: data model element not initialized');\n        break;\n      default:\n        this.handleError(new ScormError(CLIENT_COULD_NOT_GET_PROPERTY, {\n          property,\n          errorCode,\n          errorInfo: this.scorm.debug.getInfo(errorCode),\n          diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n        }));\n    }\n    this.logger.debug(`ScormWrapper::getValue: returning ${value}`);\n    return value + '';\n  }\n\n  setValue(property, value) {\n    this.logger.debug(`ScormWrapper::setValue: _property=${property} _value=${value}`);\n\n    if (this.finishCalled) {\n      this.logger.debug('ScormWrapper::setValue: ignoring request as \\'finish\\' has been called');\n      return;\n    }\n\n    if (!this.lmsConnected) {\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n      return;\n    }\n\n    const success = this.scorm.set(property, value);\n    if (!success) {\n      // Some LMSes have an annoying tendency to return false from a set call even when it actually worked fine.\n      // So we should only throw an error if there was a valid error code...\n      const errorCode = this.scorm.debug.getCode();\n      if (errorCode !== 0) {\n        this.handleError(new ScormError(CLIENT_COULD_NOT_SET_PROPERTY, {\n          property,\n          value,\n          errorCode,\n          errorInfo: this.scorm.debug.getInfo(errorCode),\n          diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n        }));\n        return success;\n      }\n      this.logger.warn('ScormWrapper::setValue: LMS reported that the \\'set\\' call failed but then said there was no error!');\n    }\n\n    if (this.commitOnAnyChange) this.debouncedCommit();\n\n    return success;\n  }\n\n  /**\n   * used for checking any data field that is not 'LMS Mandatory' to see whether the LMS we're running on supports it or not.\n   * Note that the way this check is being performed means it wouldn't work for any element that is\n   * 'write only', but so far we've not had a requirement to check for any optional elements that are.\n   */\n  isSupported(property) {\n    this.logger.debug(`ScormWrapper::isSupported: _property=${property}`);\n\n    if (this.finishCalled) {\n      this.logger.debug('ScormWrapper::isSupported: ignoring request as \\'finish\\' has been called');\n      return;\n    }\n\n    if (!this.lmsConnected) {\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n      return false;\n    }\n\n    this.scorm.get(property);\n\n    return (this.scorm.debug.getCode() !== 401); // 401 is the 'not implemented' error code\n  }\n\n  initTimedCommit() {\n    this.logger.debug('ScormWrapper::initTimedCommit');\n\n    if (!this.commitOnAnyChange && this.timedCommitFrequency > 0) {\n      const delay = this.timedCommitFrequency * (60 * 1000);\n      this.timedCommitIntervalID = window.setInterval(this.commit.bind(this), delay);\n    }\n  }\n\n  initRetryCommit() {\n    this.logger.debug(`ScormWrapper::initRetryCommit ${this.commitRetries} out of ${this.maxCommitRetries}`);\n\n    this.commitRetryPending = true;// stop anything else from calling commit until this is done\n\n    this.retryCommitTimeoutID = window.setTimeout(this.doRetryCommit.bind(this), this.commitRetryDelay);\n  }\n\n  doRetryCommit() {\n    this.logger.debug('ScormWrapper::doRetryCommit');\n\n    this.commitRetryPending = false;\n\n    this.commit();\n  }\n\n  handleError(error) {\n\n    if (!Adapt.get('_isStarted')) {\n      Adapt.once('contentObjectView:ready', this.handleError.bind(this, error));\n      return;\n    }\n\n    if ('value' in error.data) {\n      // because some browsers (e.g. Firefox) don't like displaying very long strings in the window.confirm dialog\n      if (error.data.value.length && error.data.value.length > 80) error.data.value = error.data.value.slice(0, 80) + '...';\n      // if the value being set is an empty string, ensure it displays in the error as ''\n      if (error.data.value === '') error.data.value = '\\'\\'';\n    }\n\n    const config = Adapt.course.get('_spoor');\n    const messages = Object.assign({}, ScormError.defaultMessages, config && config._messages);\n    const message = Handlebars.compile(messages[error.name])(error.data);\n\n    switch (error.name) {\n      case CLIENT_COULD_NOT_CONNECT:\n        notify.popup({\n          _isCancellable: false,\n          title: messages.title,\n          body: message\n        });\n        return;\n    }\n\n    this.logger.error(message);\n\n    if (!this.suppressErrors && (!this.logOutputWin || this.logOutputWin.closed) && confirm(`${messages.title}:\\n\\n${message}\\n\\n${messages.pressOk}`)) {\n      this.showDebugWindow();\n    }\n\n  }\n\n  getInteractionCount() {\n    const count = this.getValue('cmi.interactions._count');\n    return count === '' ? 0 : count;\n  }\n\n  recordInteractionScorm12(id, response, correct, latency, type) {\n\n    id = id.trim();\n\n    const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\n\n    this.setValue(`${cmiPrefix}.id`, id);\n    this.setValue(`${cmiPrefix}.type`, type);\n    this.setValue(`${cmiPrefix}.student_response`, response);\n    this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'wrong');\n    if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM12Time(latency));\n    this.setValue(`${cmiPrefix}.time`, this.getCMITime());\n  }\n\n  recordInteractionScorm2004(id, response, correct, latency, type) {\n\n    id = id.trim();\n\n    const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\n\n    this.setValue(`${cmiPrefix}.id`, id);\n    this.setValue(`${cmiPrefix}.type`, type);\n    this.setValue(`${cmiPrefix}.learner_response`, response);\n    this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'incorrect');\n    if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM2004Time(latency));\n    this.setValue(`${cmiPrefix}.timestamp`, this.getISO8601Timestamp());\n  }\n\n  recordInteractionMultipleChoice(id, response, correct, latency, type) {\n\n    if (this.isSCORM2004()) {\n      response = response.replace(/,|#/g, '[,]');\n    } else {\n      response = response.replace(/#/g, ',');\n      response = this.checkResponse(response, 'choice');\n    }\n\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\n  }\n\n  recordInteractionMatching(id, response, correct, latency, type) {\n\n    response = response.replace(/#/g, ',');\n\n    if (this.isSCORM2004()) {\n      response = response.replace(/,/g, '[,]');\n      response = response.replace(/\\./g, '[.]');\n    } else {\n      response = this.checkResponse(response, 'matching');\n    }\n\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\n  }\n\n  recordInteractionFillIn(id, response, correct, latency, type) {\n\n    const maxLength = this.isSCORM2004() ? 250 : 255;\n\n    if (response.length > maxLength) {\n      response = response.substr(0, maxLength);\n\n      this.logger.warn(`ScormWrapper::recordInteractionFillIn: response data for ${id} is longer than the maximum allowed length of ${maxLength} characters; data will be truncated to avoid an error.`);\n    }\n\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\n  }\n\n  showDebugWindow() {\n\n    if (this.logOutputWin && !this.logOutputWin.closed) {\n      this.logOutputWin.close();\n    }\n\n    this.logOutputWin = window.open('log_output.html', 'Log', 'width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0');\n\n    if (!this.logOutputWin) return;\n    this.logOutputWin.focus();\n  }\n\n  convertToSCORM12Time(msConvert) {\n\n    const msPerSec = 1000;\n    const msPerMin = msPerSec * 60;\n    const msPerHour = msPerMin * 60;\n\n    const ms = msConvert % msPerSec;\n    msConvert = msConvert - ms;\n\n    let secs = msConvert % msPerMin;\n    msConvert = msConvert - secs;\n    secs = secs / msPerSec;\n\n    let mins = msConvert % msPerHour;\n    msConvert = msConvert - mins;\n    mins = mins / msPerMin;\n\n    const hrs = msConvert / msPerHour;\n\n    if (hrs > 9999) {\n      return '9999:99:99.99';\n    }\n\n    const str = [ this.padWithZeroes(hrs, 4), this.padWithZeroes(mins, 2), this.padWithZeroes(secs, 2) ].join(':');\n    return (`${str}.${Math.floor(ms / 10)}`);\n  }\n\n  /**\n   * Converts milliseconds into the SCORM 2004 data type 'timeinterval (second, 10,2)'\n   * this will output something like 'P1DT3H5M0S' which indicates a period of time of 1 day, 3 hours and 5 minutes\n   * or 'PT2M10.1S' which indicates a period of time of 2 minutes and 10.1 seconds\n   */\n  convertToSCORM2004Time(msConvert) {\n    let csConvert = Math.floor(msConvert / 10);\n    const csPerSec = 100;\n    const csPerMin = csPerSec * 60;\n    const csPerHour = csPerMin * 60;\n    const csPerDay = csPerHour * 24;\n\n    let days = Math.floor(csConvert / csPerDay);\n    csConvert -= days * csPerDay;\n    days = days ? days + 'D' : '';\n\n    let hours = Math.floor(csConvert / csPerHour);\n    csConvert -= hours * csPerHour;\n    hours = hours ? hours + 'H' : '';\n\n    let mins = Math.floor(csConvert / csPerMin);\n    csConvert -= mins * csPerMin;\n    mins = mins ? mins + 'M' : '';\n\n    let secs = Math.floor(csConvert / csPerSec);\n    csConvert -= secs * csPerSec;\n    secs = secs || '0';\n\n    let cs = csConvert;\n    cs = cs ? '.' + cs : '';\n\n    const seconds = secs + cs + 'S';\n\n    const hms = [ hours, mins, seconds ].join('');\n\n    return 'P' + days + 'T' + hms;\n  }\n\n  getCMITime() {\n\n    const date = new Date();\n\n    const hours = this.padWithZeroes(date.getHours(), 2);\n    const min = this.padWithZeroes(date.getMinutes(), 2);\n    const sec = this.padWithZeroes(date.getSeconds(), 2);\n\n    return [ hours, min, sec ].join(':');\n  }\n\n  /**\n   * returns the current date & time in the format YYYY-MM-DDTHH:mm:ss\n   */\n  getISO8601Timestamp() {\n    const date = new Date().toISOString();\n    return date.replace(/.\\d\\d\\dZ/, ''); // Date.toISOString returns the date in the format YYYY-MM-DDTHH:mm:ss.sssZ so we need to drop the last bit to make it SCORM 2004 conformant\n  }\n\n  padWithZeroes(numToPad, padBy) {\n\n    let len = padBy;\n\n    while (--len) {\n      numToPad = '0' + numToPad;\n    }\n\n    return numToPad.slice(-padBy);\n  }\n\n  isSCORM2004() {\n    return this.scorm.version === '2004';\n  }\n\n  /**\n   * SCORM 1.2 requires that the identifiers in cmi.interactions.n.student_response for choice and matching activities be a character from [0-9a-z].\n   * When numeric identifiers are used this function attempts to map identifiers 10 to 35 to [a-z]. Resolves issues/1376.\n   */\n  checkResponse(response, responseType) {\n    if (!response) return response;\n    if (responseType !== 'choice' && responseType !== 'matching') return response;\n\n    response = response.split(/,|#/);\n\n    const self = this;\n\n    if (responseType === 'choice') {\n      response = response.map(checkIdentifier);\n    } else {\n      response = response.map(r => {\n        const identifiers = r.split('.');\n        return checkIdentifier(identifiers[0]) + '.' + checkIdentifier(identifiers[1]);\n      });\n    }\n\n    function checkIdentifier(r) {\n      // if [0-9] then ok\n      if (r.length === 1 && r >= '0' && r <= '9') return r;\n\n      // if [a-z] then ok\n      if (r.length === 1 && r >= 'a' && r <= 'z') return r;\n\n      // try to map integers 10-35 to [a-z]\n      const i = parseInt(r);\n\n      if (isNaN(i) || i < 10 || i > 35) {\n        self.handleError(new ScormError(CLIENT_INVALID_CHOICE_VALUE));\n      }\n\n      return Number(i).toString(36); // 10 maps to 'a', 11 maps to 'b', ..., 35 maps to 'z'\n    }\n\n    return response.join(',');\n  }\n\n  getExitState() {\n    const completionStatus = this.scorm.data.completionStatus;\n    const isIncomplete = completionStatus === 'incomplete' || completionStatus === 'not attempted';\n    const exitState = isIncomplete ? this.exitStateIfIncomplete : this.exitStateIfComplete;\n\n    if (exitState !== 'auto') return exitState;\n\n    if (this.isSCORM2004()) return (isIncomplete ? 'suspend' : 'normal');\n\n    return '';\n  }\n\n}\n\n// static\nScormWrapper.instance = null;\n\nexport default ScormWrapper;\n","define([\n  'underscore',\n  'libraries/lzma-min',\n  'libraries/lzma_worker-min.js'\n], function(_) {\n  const LZMAWorker = window.LZMAFactory('./libraries/lzma_worker-min.js');\n  /**\n   * 2020/05/06 SCORMSuspendData\n   *\n   * Serialize and deserialize arrays, booleans and numbers into a base64 string\n   * for transport over SCORM 1.2 based systems where storage space is restricted\n   * to only 4096 characters or 4KB.\n   *\n   * The algorithm is weighted heavily in efficiency towards storing data by\n   * its occurrence frequency when it is used to save Adapt question responses,\n   * booleans, arrays of <16 length and numbers of <4 value.\n   *\n   * Numbers can be 2 precision decimals, positive and negative numbers between\n   * -4294967295.99 and 4294967295.99. Arrays can have 0 to 65535 entries. Arrays\n   * can be nested. All arrays must have the same ES type (boolean, number or array).\n   *\n   * The appropriate binary type is chosen for each array according to the following table,\n   * an array must have one type which best fits its values:\n   *\n   *           VALUES                                VALUETYPE     PER ENTRY\n   * VALUETYPE MIN           MAX            DECIMAL  BITS          MIN BITS  MAX BITS  STORES\n   * ARRAY     0             65535 (items)  NO       2             6         23        Array length and valuetype\n   * BOOLEAN   0             1              NO       1             1         1         Entry value\n   * UINT3     0             7              NO       4             3         3         Entry value\n   * VINT8+    0             255            NO       3             3         9         Entry value\n   * VINT8-   -255           0              NO       6             3         9         Entry value\n   * SDEC15   -255.99        255.99         NO       6             8         22        Entry value\n   * SINT32   -4294967295    4294967295     NO       6             5         35        Entry value\n   * SDEC39   -4294967295.99 4294967295.99  YES      6             10        48        Entry value\n   *\n   * Output construction map:\n   *\n   *  OUTPUT = VALUETYPE + DATA\n   *  DATA = ( ARRAY | BOOLEAN | UINT3 | VINT8+ | VINT8- | SDEC15 | SINT32 | SDEC39 )\n   *  ARRAY = IS_SMALL_BIT( BOOLEAN ) + LENGTH( UINT4 | UINT16 ) + VALUETYPE + DATA[0-65535]\n   *\n   *  VALUETYPE = 0 to 111111\n   *   Signifies the type of value for the output or array data.\n   *\n   *   BINARY  NAME        USAGE RANKING\n   *   10      ARRAY       2\n   *   0       BOOLEAN     1\n   *   1110    UINT3       4\n   *   110     VINT8+      3\n   *   111100  VINT8-      7\n   *   111101  SDEC15      5\n   *   111110  SINT32      6\n   *   111111  SDEC39      8\n   *\n   *  ARRAY\n   *   Stores the number and type of items.\n   *\n   *          BINARY\n   *   BITS | SMALL LENGTH (UINT4/16) VALUETYPE = VALUE\n   *   6    | 1     0000              0         = zero length boolean array\n   *   6    | 1     1111              0         = 15 length boolean array\n   *   23   | 0     1000000000000000  111111    = 8 length sdec39 array\n   *   23   | 0     1111111111111111  111111    = 65535 length sdec39 array\n   *\n   *  BOOLEAN\n   *   A value of true or false.\n   *\n   *          BINARY\n   *   BITS | BOOL  = VALUE\n   *   1    | 0     = false\n   *   1    | 1     = true\n   *\n   *  UINT3\n   *   A value from 0 to 7 with a 3 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT3) = VALUE\n   *   3    | 000         = 0\n   *   3    | 111         = 7\n   *\n   *  UINT4\n   *   An array length from 0 to 15 with a 4 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT4) = VALUE\n   *   4    | 0000        = 0\n   *   4    | 1111        = 15\n   *\n   *  VINT8+\n   *   A value from 0 to 255 with variable length output.\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\n   *\n   *          BINARY\n   *   BITS | SMALL INT (UINT2/8) = VALUE\n   *   3    | 1     00           =  0\n   *   3    | 1     11           =  3\n   *   9    | 0     00000100     =  4\n   *   9    | 0     11111111     =  255\n   *\n   *  VINT8-\n   *   A value from -255 to 0 with variable length output.\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\n   *\n   *   BITS | SMALL INT (UINT2/8) = VALUE\n   *   3    | 1     00            =  0\n   *   3    | 1     11            = -3\n   *   9    | 0     00000100      = -4\n   *   9    | 0     11111111      = -255\n   *\n   *  SDEC15\n   *   A value from -255.99 to 255.99 preserving 2 decimals places\n   *   places and with variable length output.\n   *\n   *   BITS | SIGN INTSIZE INT (UINT2/8) DECSIZE DEC (UINT0/7)   = VALUE\n   *   5    | 0    0       00            0                       =  0\n   *   12   | 0    0       00            0       0000001         =  0.01\n   *   12   | 1    0       00            0       0000001         = -0.01\n   *   12   | 1    0       00            1       1100011         = -0.99\n   *   18   | 0    1       00001000      1       0000001         =  8.01\n   *   18   | 1    1       00001000      1       1100011         = -8.99\n   *   18   | 0    1       11111111      1       1100011         =  255.99\n   *   18   | 1    1       11111111      1       1100011         = -255.99\n   *\n   *  UINT16\n   *   An array length from 0 to 65535 with a 16 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT16)       = VALUE\n   *   16   | 0000000000000000  = 0\n   *   16   | 1111111111111111  = 65535\n   *\n   *  SINT32\n   *   A value from -4294967295 to 4294967295 with variable length output.\n   *   Output is a UINT2/4/16/32 bit integer with a 3 bit header.\n   *\n   *   BITS | SIGN SIZE  INT (UINT2/4/16/32)              = VALUE\n   *   5    | 0    00    00                               =  0\n   *   5    | 1    00    11                               = -3\n   *   7    | 0    01    1000                             =  8\n   *   7    | 1    01    1111                             = -15\n   *   19   | 0    10    0000000100000000                 =  256\n   *   19   | 1    10    1111111111111111                 = -65535\n   *   35   | 1    11    11111111111111111111111111111111 = -4294967295\n   *   35   | 0    11    11111111111111111111111111111111 =  4294967295\n   *\n   *  SDEC39\n   *   A value from -4294967295.99 to 4294967295.99 preserving 2 decimals places\n   *   places and with variable length output.\n   *\n   *   BITS | SIGN INTSIZE INT (UINT2/4/16/32)              DECSIZE DEC (UINT0/7)   = VALUE\n   *   6    | 0    00      00                               0                       =  0\n   *   13   | 0    00      11                               0       0000001         =  3.01\n   *   13   | 1    01      1000                             0       0000001         = -8.01\n   *   13   | 1    01      1111                             1       1100011         = -15.99\n   *   27   | 0    10      0000000100000000                 1       0000001         =  256.01\n   *   27   | 1    10      1111111111111111                 1       1100011         = -65535.99\n   *   37   | 0    11      11111111111111111111111111111111 0                       =  4294967295\n   *   37   | 1    11      11111111111111111111111111111111 0                       = -4294967295\n   *   43   | 0    11      11111111111111111111111111111111 1       1100011         =  4294967295.99\n   *   43   | 1    11      11111111111111111111111111111111 1       1100011         = -4294967295.99\n   *\n   * Output byte count formula:\n   *\n   *  byte_count = (bit_count * 1.5base64_expansion) / 8bits_per_byte\n   *\n   *  The output is in base64 so bit counts are always inflated by 1.5 from byte to base64.\n   *\n   * Example:\n   *\n   * [\n   *   [\n   *     0,\n   *     7,\n   *     1,\n   *     0\n   *   ],\n   *   [\n   *     true,\n   *     true,\n   *     true,\n   *     true,\n   *     true\n   *   ],\n   *   [\n   *     true,\n   *     false,\n   *     false,\n   *     false\n   *   ]\n   * ]\n   *\n   * In this example the parent array represents a completed question state for a\n   * single question. The first child number-array stores the block location,\n   * tracking id, score and attemptsLeft. The second child boolean-array stores\n   * the completion, correctness, submission state and user answer states. The\n   * third child boolean-array stores the user selections for a multiple choice question.\n   *\n   * When serialized with SCORMSuspendData.serialize() it becomes the following\n   * 10 characters:\n   *\n   *   hxOHIK-RAA\n   *\n   * These characters can be deserialized back into the nested arrays above using\n   * SCORMSuspendData.deserialize(\"hxOHIK-RAA\");\n   *\n   * In JSON this array would usually be 63 characters minified, at 10 characters this is\n   * a reduction of about 84%. At the worse case, storing an array containing just\n   * the largest possible number ([-4294967295.99]) the output will only be reduced\n   * by about 37% (g///////4w) when compared to the equivalent JSON. It is possible\n   * to store 500 of the above mcq state arrays in just 4088 characters. About 250\n   * question states will occupy about half of the available space in SCORM's 4096\n   * character suspend data.\n   */\n\n  // Cache for zero strings of various lengths\n  const ZeroString = {};\n  /**\n   * Make and cache a zero string up to the supplied length\n   * @param {number} length\n   * @returns {string}\n   */\n  function makeZeroString(length) {\n    ZeroString[length] = ZeroString[length] || (new Array(length + 1)).join('0');\n    return ZeroString[length];\n  }\n  // Initialize zero string cache up to 64 characters in length\n  for (let i = 1, l = 64; i <= l; i++) {\n    makeZeroString(i);\n  }\n\n  /**\n   * Zero pads to the right, making up to the supplied length\n   * @param {string} string\n   * @param {number} length\n   * @returns {string}\n   */\n  function zeroPadRightToLength(string, length) {\n    const padLength = (length - string.length);\n    if (padLength > 0) {\n      string += makeZeroString(padLength);\n    }\n    return string;\n  }\n\n  /**\n   * Zero pads to the left, making up to the supplied length\n   * @param {string} string\n   * @param {number} length\n   * @returns {string}\n   */\n  function zeroPadLeftToLength(string, length) {\n    const padLength = (length - string.length);\n    if (padLength > 0) {\n      string = makeZeroString(padLength) + string;\n    }\n    return string;\n  }\n\n  /**\n   * Zero pads to the right at even multiples\n   * @param {string} string\n   * @param {number} multiple\n   * @returns {string}\n   */\n  function zeroPadRightToMultiple(string, multiple) {\n    const padLength = multiple - (string.length % multiple);\n    if (padLength !== multiple) {\n      string += makeZeroString(padLength);\n    }\n    return string;\n  }\n\n  /**\n   * Returns a positive integer from the supplied binary string and binaryLength\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {number}\n   */\n  function binaryToUnsignedInteger(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return 0;\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\n    return integer;\n  }\n\n  /**\n   * Shifts a positive integer from the supplied binary string and binaryLength,\n   * returning the shifted integer and the next part of the binary string\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {[number, string]}\n   */\n  function shiftUnsignedIntegerFromBinary(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return [0, binary];\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\n    binary = binary.slice(binaryLength);\n    return [integer, binary];\n  }\n\n  /**\n   * Shifts binaryLength characters from the supplied binary string, returning the\n   * shifted binary string and the next part of the binary string\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {[string, string]}\n   */\n  function shiftBinary(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return ['', binary];\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const shifted = binary.slice(0, binaryLength);\n    binary = binary.slice(binaryLength);\n    return [shifted, binary];\n  }\n\n  /**\n   * Converts a positive integer to a binary string\n   * @param {number} integer\n   * @param {number} [binaryLength] Length of the output string\n   */\n  function unsignedIntegerToBinary(integer, binaryLength) {\n    if (binaryLength === 0) {\n      return '';\n    }\n    let binary = Math.abs(integer).toString(2);\n    if (typeof binaryLength === 'undefined') {\n      return binary;\n    }\n    const length = binary.length;\n    if (length > binaryLength) {\n      throw new Error(`Integer too big for specified binary length. integer: ${integer} binarylen: ${binaryLength}`);\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    return binary;\n  }\n\n  /**\n   * Converts a byte array to a string\n   * @param {[number]} array\n   * @returns {string}\n   */\n  function byteArrayToString(array) {\n    const arrayLength = array.length;\n    let string = new Array(arrayLength);\n    for (let i = 0, l = arrayLength; i < l; i++) {\n      string[i] = String.fromCharCode(array[i]);\n    }\n    string = string.join('');\n    return string;\n  }\n\n  /**\n   * Converts a string to a byte array\n   * @param {string} string\n   * @returns {[number]}\n   */\n  function stringToByteArray(string) {\n    const stringLength = string.length;\n    const array = new Array(stringLength);\n    for (let i = 0, l = stringLength; i < l; i++) {\n      array[i] = string.charCodeAt(i);\n    }\n    return array;\n  }\n\n  /** @type {number} Number of bits per byte */\n  const BYTE_BIT_LENGTH = 8;\n\n  /**\n   * Converts a binary string or nested arrays of binary strings to a base64 string\n   * @param {string|[string]} binary\n   * @returns {string}\n   */\n  function binaryToBase64(binary) {\n    binary = _.flatten(binary).join('');\n    binary = zeroPadRightToMultiple(binary, BYTE_BIT_LENGTH);\n    const bytesCount = binary.length / BYTE_BIT_LENGTH;\n    const charCodes = new Array(bytesCount);\n    for (let i = 0, l = bytesCount; i < l; i++) {\n      [ charCodes[i], binary ] = shiftUnsignedIntegerFromBinary(binary, BYTE_BIT_LENGTH);\n    }\n    let base64 = btoa(byteArrayToString(charCodes));\n    // Remove padding = or == as not necessary here\n    base64 = base64.replace(/=/g, '');\n    // Can't handle base64 with the + sign so swap with a -\n    base64 = base64.replace(/\\+/g, '-');\n    return base64;\n  }\n\n  /**\n   * Converts a base64 string to a binary string\n   * @param {string} base64\n   * @returns {string}\n   */\n  function base64ToBinary(base64) {\n    // base64 should have a + instead of a -\n    base64 = base64.replace(/-/g, '+');\n    const charCodes = stringToByteArray(atob(base64));\n    const bytesCount = charCodes.length;\n    let binary = new Array(bytesCount);\n    for (let i = 0, l = bytesCount; i < l; i++) {\n      binary[i] = unsignedIntegerToBinary(charCodes[i], BYTE_BIT_LENGTH);\n    }\n    binary = binary.join('');\n    return binary;\n  }\n\n  // Console output store\n  const logs = {\n    usedTypes: {},\n    typeLengths: {},\n    binarySamples: {}\n  };\n\n  /**\n   * An abstract base class for a ValueType value to and from binary string converter\n   */\n  class AbstractValueType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     */\n    constructor(options) {\n      Object.assign(this, options);\n      this.binaryTypeLength = this.binaryType.length;\n    }\n\n    /**\n     * Adds a record of the binary string production to the logging store\n     * @param {[Array|string]} binary\n     */\n    log(binary) {\n      const name = this.name;\n      logs.usedTypes[name] = logs.usedTypes[name] || 0;\n      logs.usedTypes[name]++;\n      logs.binarySamples[name] = logs.binarySamples[name] || [];\n      logs.binarySamples[name].push(binary);\n    }\n\n  };\n\n  /**\n   * Converts a fixed length positive integer to and from a binary string.\n   */\n  class FixedIntegerType extends AbstractValueType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.valueBinaryLength Bit length of the integer\n     */\n    constructor(options) {\n      super(options);\n      this.esType = 'number';\n      if (!this.valueBinaryLength) {\n        return;\n      }\n      this.minValue = options.minValue || 0;\n      this.maxValue = options.maxValue || Math.pow(2, this.valueBinaryLength) - 1;\n    }\n\n    /**\n     * Converts a fixed length positive integer to an array of binary strings\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      let binary = unsignedIntegerToBinary(integer, this.valueBinaryLength);\n      if (logStats) {\n        this.log(binary);\n      }\n      binary = [binary];\n      return binary;\n    }\n\n    /**\n     * Shifts a fixed length positive integer from the binary string, returning\n     * the integer and the next part of the binary string.\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let integer;\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, this.valueBinaryLength);\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a boolean to and from a binary string\n   */\n  class FixedBooleanType extends FixedIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     */\n    constructor(options) {\n      options.valueBinaryLength = 1;\n      super(options);\n      this.esType = 'boolean';\n    }\n\n    /**\n     * Shifts a boolean from the binary string, returning\n     * the boolean and the next part of the binary string\n     * @param {string} binary\n     * @returns {[boolean, string]}\n     */\n    shiftValueFromBinary(binary) {\n      const bool = (binary[0] === '1');\n      binary = binary.slice(1);\n      return [bool, binary];\n    }\n\n  }\n\n  /**\n   * A helper for converting variable length positive integers to and from a binary string\n   */\n  class LengthAndValueBinary {\n\n    /**\n     * @param {string} parent The parent AbstractValueType\n     * @param {string} name The sub parent value part name \"integer\" or \"decimal\"\n     * @param {[number]} bitSizes An ordered array of expressible bit lengths\n     */\n    constructor(parent, name, bitSizes) {\n      this.parent = parent;\n      this.name = name;\n      this.bitSizes = bitSizes;\n      this.maxValues = _.flatten(this.bitSizes).map(value => (Math.pow(2, value) - 1));\n      this.maxValue = this.maxValues[this.maxValues.length - 1];\n      this.sizeBinaryLength = unsignedIntegerToBinary(this.bitSizes.length - 1).length;\n    }\n\n    /**\n     * Converts a positive integer to a binary string array\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      const parentName = this.parent.name;\n      const sizeIndex = this.maxValues.findIndex(maxValue => (integer <= maxValue));\n      if (sizeIndex === -1) {\n        throw new Error(`Value is too large for type: ${parentName} value: ${integer} max: ${this.maxValue}`);\n      }\n      const sizeBinary = unsignedIntegerToBinary(sizeIndex, this.sizeBinaryLength);\n      const valueLength = this.bitSizes[sizeIndex];\n      const name = this.name;\n      if (logStats) {\n        logs.typeLengths[parentName] = logs.typeLengths[parentName] || {};\n        logs.typeLengths[parentName][name] = logs.typeLengths[parentName][name] || {};\n        logs.typeLengths[parentName][name][valueLength] = logs.typeLengths[parentName][name][valueLength] || 0;\n        logs.typeLengths[parentName][name][valueLength]++;\n      }\n      const integerBinary = unsignedIntegerToBinary(integer, valueLength);\n      const binary = [sizeBinary, integerBinary];\n      return binary;\n    }\n\n    /**\n     * Shifts a positive integer from the binary string, returning\n     * the integer and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let sizeBinary;\n      [sizeBinary, binary] = shiftBinary(binary, this.sizeBinaryLength);\n      const sizeIndex = binaryToUnsignedInteger(sizeBinary);\n      const valueLength = this.bitSizes[sizeIndex];\n      let integer;\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, valueLength);\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length positive or negative integer to and from a\n   * binary string\n   */\n  class VariableIntegerType extends FixedIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.minValue Minimum value for the integer\n     * @param {number} options.maxValue Maximum value for the integer\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.isNegative = (this.minValue < 0 && this.maxValue === 0);\n      this.integer = new LengthAndValueBinary(this, 'integer', options.integerBitSizes);\n    }\n\n    /**\n     * Converts a positive or negative integer to a array of binary strings\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      integer = integer.toFixed(0);\n      const binary = this.integer.valueToBinary(Math.abs(integer), logStats);\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts a positive or negative integer from the binary string, returning\n     * the integer and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let integer;\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\n      if (this.isNegative) {\n        integer = -integer;\n      }\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length array to and from a binary string\n   */\n  class VariableArrayType extends VariableIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.esType = 'array';\n    }\n\n    /**\n     * Converts an array to an array of binary strings\n     * @param {Array} array\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[Array|string]}\n     */\n    valueToBinary(array, logStats = null) {\n      const arrayLength = array.length;\n      const binary = super.valueToBinary(arrayLength);\n      if (arrayLength) {\n        const valueType = findValueTypeFromValues(array);\n        binary.push(valueType.binaryType);\n        binary.type = valueType.name;\n        binary.push(array.map(value => valueType.valueToBinary(value, logStats)));\n      }\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts an array from the binary string, returning\n     * the array and the next part of the binary string\n     * @param {string} binary\n     * @returns {[Array, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let arrayLength;\n      [arrayLength, binary] = super.shiftValueFromBinary(binary);\n      const value = new Array(arrayLength);\n      if (arrayLength) {\n        let valueType;\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\n        for (let i = 0, l = arrayLength; i < l; i++) {\n          [value[i], binary] = valueType.shiftValueFromBinary(binary);\n        }\n      }\n      return [value, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length signed integer to and from a binary string\n   */\n  class VariableSignedIntegerType extends VariableIntegerType {\n\n    /**\n     * Converts a signed positive or negative integer to a binary string array\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      integer = integer.toFixed(0);\n      const isNegative = (integer < 0);\n      const signBinary = isNegative ? '1' : '0';\n      const integerBinary = this.integer.valueToBinary(Math.abs(integer), logStats);\n      const binary = [signBinary, integerBinary];\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts the first signed integer value from the binary string, returning\n     * the integer value and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let isNegative;\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\n      let integer;\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\n      if (isNegative) {\n        integer = -integer;\n      }\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length 2 precision decimal to and from a binary string\n   */\n  class VariableDecimalType extends VariableIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.minValue Minimum value for the integer\n     * @param {number} options.maxValue Maximum value for the integer\n     * @param {[number]} options.integerBitSizes Expressible integer storage bit sizes\n     * @param {[number]} options.decimalBitSizes Expressible decimal storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.isFloat = true;\n      this.decimal = new LengthAndValueBinary(this, 'decimal', options.decimalBitSizes);\n    }\n\n    /**\n     * Converts a signed 2 precision decimal to an array of binary strings\n     * @param {number} float\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(float, logStats = null) {\n      float = float.toFixed(2);\n      const isNegative = (float < 0);\n      float = Math.abs(float);\n      const parts = String(float).split('.');\n      const higherInteger = parseInt(parts[0]);\n      const lowerInteger = parseInt(zeroPadRightToLength(parts[1] || 0, 2));\n      const signBinary = isNegative ? '1' : '0';\n      const integerValueBinary = this.integer.valueToBinary(higherInteger, logStats);\n      const decimalValueBinary = this.decimal.valueToBinary(lowerInteger, logStats);\n      const binary = [signBinary, integerValueBinary, decimalValueBinary];\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts the first signed 2 precision decimal value from the binary string,\n     * returning the decimal value and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let isNegative;\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\n      let higherInteger;\n      [higherInteger, binary] = this.integer.shiftValueFromBinary(binary);\n      let lowerInteger;\n      [lowerInteger, binary] = this.decimal.shiftValueFromBinary(binary);\n      lowerInteger = zeroPadLeftToLength(String(lowerInteger), 2);\n      let float = parseFloat(higherInteger + '.' + lowerInteger);\n      if (isNegative) {\n        float = -float;\n      }\n      return [float, binary];\n    }\n\n  }\n\n  const arrayType = new VariableArrayType({\n    name: 'array',\n    binaryType: '10',\n    integerBitSizes: [4, 16]\n  });\n\n  const booleanType = new FixedBooleanType({\n    name: 'boolean',\n    binaryType: '0'\n  });\n\n  /**\n   * @type {[FixedIntegerType|VariableIntegerType]}\n   */\n  const integerTypes = [\n    new FixedIntegerType({\n      name: 'uint3',\n      binaryType: '1110',\n      valueBinaryLength: 3\n    }),\n    new VariableIntegerType({\n      name: 'vint8+',\n      binaryType: '110',\n      minValue: 0,\n      maxValue: 255,\n      integerBitSizes: [2, 8]\n    }),\n    new VariableIntegerType({\n      name: 'vint8-',\n      binaryType: '111100',\n      minValue: -255,\n      maxValue: 0,\n      integerBitSizes: [2, 8]\n    }),\n    new VariableSignedIntegerType({\n      name: 'sint32',\n      binaryType: '111110',\n      minValue: -4294967295,\n      maxValue: 4294967295,\n      integerBitSizes: [2, 4, 16, 32]\n    })\n  ];\n\n  /**\n   * @type {[VariableDecimalType]}\n   */\n  const decimalTypes = [\n    new VariableDecimalType({\n      name: 'sdec15',\n      binaryType: '111101',\n      minValue: -255.99,\n      maxValue: 255.99,\n      integerBitSizes: [2, 8],\n      decimalBitSizes: [0, 7]\n    }),\n    new VariableDecimalType({\n      name: 'sdec39',\n      binaryType: '111111',\n      minValue: -4294967295.99,\n      maxValue: 4294967295.99,\n      integerBitSizes: [2, 4, 16, 32],\n      decimalBitSizes: [0, 7]\n    })\n  ];\n\n  // Store and index all of the value types for searching by binaryType and name\n  const ValueTypes = [booleanType, arrayType].concat(integerTypes).concat(decimalTypes);\n  ValueTypes.nameIndex = {};\n  ValueTypes.forEach(valueType => (ValueTypes.nameIndex[valueType.name] = valueType));\n\n  /**\n   * Extends the native typeof keyword with array and null\n   * @param {*} value\n   * @returns {string} \"undefined\"|\"null\"|\"boolean\"|\"number\"|\"array\"|\"object\"\n   */\n  function esTypeOf(value) {\n    if (Array.isArray(value)) {\n      return 'array';\n    }\n    if (value === null) {\n      return 'null';\n    }\n    return typeof value;\n  }\n\n  /**\n   * Returns matching ValueType for the given name\n   * @param {string} name\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromName(name) {\n    return ValueTypes.nameIndex[name.toLowerCase()];\n  }\n\n  /**\n   * Returns matching ValueType for the given value\n   * @param {number|boolean|Array} value\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromValue(value) {\n    const esType = esTypeOf(value);\n    switch (esType) {\n      case 'array':\n        return arrayType;\n      case 'boolean':\n        return booleanType;\n    }\n    value = value.toFixed(2);\n    const isFloat = !Number.isInteger(value);\n    const isValueInValueTypeRange = valueType => (value >= valueType.minValue && value <= valueType.maxValue);\n    const valueType = isFloat ?\n      decimalTypes.find(isValueInValueTypeRange) :\n      integerTypes.find(isValueInValueTypeRange);\n    if (!valueType) {\n      throw new Error(`Cannot find type from value: ${value}`);\n    }\n    return valueType;\n  }\n\n  /**\n   * Returns a common ValueType for an array of values\n   * @param {Array} values\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromValues(values) {\n    if (!values.length) {\n      return;\n    }\n    let minValue = 0;\n    let maxValue = 0;\n    let isFloat = false;\n    const esTypes = values.map(value => {\n      const valueType = findValueTypeFromValue(value, isFloat);\n      if (valueType.esType === 'number') {\n        minValue = Math.min(value, minValue);\n        maxValue = Math.max(value, maxValue);\n        isFloat = isFloat || !Number.isInteger(value);\n      }\n      return valueType.esType;\n    });\n    const uniqESTypes = [...new Set(esTypes)];\n    if (uniqESTypes.length > 1) {\n      throw new Error(`Cannot resolve array to one type: ${uniqESTypes.join()}`);\n    }\n    const esType = uniqESTypes[0];\n    switch (esType) {\n      case 'array':\n        return arrayType;\n      case 'boolean':\n        return booleanType;\n    }\n    const isRangeInValueTypeRange = valueType => (minValue >= valueType.minValue && maxValue <= valueType.maxValue);\n    const valueType = isFloat ?\n      decimalTypes.find(isRangeInValueTypeRange) :\n      integerTypes.find(isRangeInValueTypeRange);\n    if (!valueType) {\n      throw new Error(`Cannot find type from value. min: ${minValue} max: ${maxValue} isfloat: ${isFloat}`);\n    }\n    return valueType;\n  }\n\n  /**\n   * Shifts the first value type representation from the binary string, returning\n   * the the ValueType found and next part of the binary string\n   * @param {string} binary\n   * @returns {[AbstractValueType, string]}\n   */\n  function shiftValueTypeFromBinary(binary) {\n    const valueType = ValueTypes.find(valueType => {\n      const binaryType = binary.slice(0, valueType.binaryTypeLength);\n      return (binaryType === valueType.binaryType);\n    });\n    if (!valueType) {\n      throw new Error(`Cannot find type from binary: ${binary.slice(0, 6)}...`);\n    }\n    binary = binary.slice(valueType.binaryTypeLength);\n    return [valueType, binary];\n  }\n\n  /**\n   * Sanitize the input throwing errors on any incorrect variable types whilst\n   * cloning the input arrays\n   * @param {number|boolean|Array} value\n   * @returns {number|boolean|Array}\n   */\n  function convertValuesToNumbers(value) {\n    const esType = esTypeOf(value);\n    switch (esType) {\n      case 'array':\n        return value.map(convertValuesToNumbers);\n      case 'undefined':\n      case 'null':\n        return (value ? 1 : 0);\n      case 'boolean':\n      case 'number':\n        return value;\n    }\n    throw new Error(`Cannot convert ${esType} to number`);\n  }\n\n  /**\n   * Main API\n   */\n  class Converter {\n\n    /**\n     * Checks the given value for conversion errors and returns the error\n     * @param {string|number|Array} value\n     * @returns {undefined|Error}\n     */\n    getInvalidTypeError(value) {\n      try {\n        value = convertValuesToNumbers(value);\n        (esTypeOf(value) === 'array') ?\n          findValueTypeFromValues(value) :\n          findValueTypeFromValue(value);\n        return;\n      } catch (err) {\n        return err;\n      }\n    }\n\n    /**\n     * Convert an array, boolean or number into a string binary representation\n     * @param {number|boolean|Array} value\n     * @param {string} [typeName] To force an internal data type for testing\n     * @param {boolean} [logStats] Console logs statistics on type use\n     * @returns {string}\n     */\n    valueToBinary(value, typeName = null, logStats = null) {\n      this.clearLog();\n      const hasInitialType = (typeof typeName === 'string');\n      value = convertValuesToNumbers(value);\n      const valueType = hasInitialType ?\n        findValueTypeFromName(typeName) :\n        findValueTypeFromValue(value);\n      if (!valueType) {\n        throw new Error(`Could not find value type from ${hasInitialType ? `name ${typeName}` : `value ${value}`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\n      }\n      const binary = valueType.valueToBinary(value, logStats);\n      if (!hasInitialType) {\n        binary.unshift(valueType.binaryType);\n      }\n      if (logStats) {\n        this.printLog();\n      }\n      return binary;\n    }\n\n    /**\n     * Convert the string binary representation back into an array, boolean or number\n     * @param {string} binary A string binary representation of data from valueToBinary\n     * @param {string} [typeName] To force an internal data type for testing\n     * @returns {number|boolean|Array}\n     */\n    valueFromBinary(binary, typeName = null) {\n      binary = _.flatten(binary).join('');\n      const hasInitialType = typeof typeName === 'string';\n      let valueType;\n      if (hasInitialType) {\n        valueType = findValueTypeFromName(typeName);\n      } else {\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\n      }\n      if (!valueType || !(valueType instanceof AbstractValueType)) {\n        throw new Error(`Could not find value type from ${hasInitialType ? `name \"${typeName}\"` : `binary \"${binary.slice(0, 8)}\"...`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\n      }\n      const [value] = valueType.shiftValueFromBinary(binary);\n      return value;\n    }\n\n    /**\n     * Clears any previous logs\n     */\n    clearLog() {\n      logs.usedTypes = {};\n      logs.typeLengths = {};\n      logs.binarySamples = {};\n    }\n\n    /**\n     * Prints logs from last run\n     */\n    printLog() {\n      console.log('Types used count:', logs.usedTypes);\n      console.log('Type lengths used count:', logs.typeLengths);\n      console.log('Type binary samples:', logs.binarySamples);\n    }\n\n    /**\n     * Convert an array, boolean or number into a base64 string\n     * @param {number|boolean|Array} value\n     * @param {string} [typeName] To force an internal data type for testing\n     * @param {boolean} [logStats] Console logs statistics on type use\n     * @returns {string}\n     */\n    serialize(value, typeName = null, logStats = null) {\n      const binary = this.valueToBinary(value, typeName, logStats);\n      const base64 = binaryToBase64(binary);\n      return base64;\n    }\n\n    /**\n     * Convert an array, boolean or number into a base64 string, asynchronously\n     * @param {number|boolean|Array} value\n     * @returns {string}\n     */\n    async serializeAsync(value, typeName = null, logStats = null) {\n      const binary = this.valueToBinary(value, null, null);\n      const base64 = binaryToBase64(binary);\n      const isLargeArray = (Array.isArray(value) && value.length > 10);\n      if (isLargeArray) {\n        return new Promise(resolve => {\n          LZMAWorker.compress(JSON.stringify(value), 1, data => {\n            const compressedBase64 = `#${window.btoa(data.map(i => String.fromCharCode(i + 128)).join('')).replace(/=/g, '')}`;\n            const isCompressedSmaller = (compressedBase64.length < base64.length);\n            if (isCompressedSmaller) return resolve(compressedBase64);\n            return resolve(base64);\n          });\n        });\n      }\n      return base64;\n    }\n\n    /**\n     * Convert the base64 string back into an array, boolean or number\n     * @param {string} base64 A string representation of data from serialize\n     * @param {string} [typeName] To force an internal data type for testing\n     * @returns {number|boolean|Array}\n     */\n    deserialize(base64, typeName = null) {\n      const isLZMACompressed = (base64[0] === '#');\n      if (isLZMACompressed) return JSON.parse(window.LZMA.decompress(window.atob(base64.slice(1)).split('').map(c => c.charCodeAt(0) - 128)));\n      const binary = base64ToBinary(base64);\n      const value = this.valueFromBinary(binary, typeName);\n      return value;\n    }\n\n  }\n\n  return (window.SCORMSuspendData = new Converter());\n});\n","import logging from 'core/js/logging';\nimport data from 'core/js/data';\nimport SCORMSuspendData from './SCORMSuspendData';\n\nexport default class ComponentSerializer extends Backbone.Controller {\n\n  initialize(trackingIdType, shouldCompress) {\n    this.trackingIdType = trackingIdType;\n    this.shouldCompress = shouldCompress;\n  }\n\n  async serialize(shouldStoreResponses, shouldStoreAttempts) {\n    if (shouldStoreAttempts && !shouldStoreResponses) {\n      logging.warnOnce('SPOOR configuration error, cannot use \\'_shouldStoreAttempts\\' without \\'_shouldStoreResponses\\'');\n    }\n    const states = [];\n    data.each(model => {\n      if (model.get('_type') !== this.trackingIdType) {\n        return;\n      }\n      const trackingId = model.get('_trackingId');\n      if (typeof trackingId === 'undefined') {\n        return;\n      }\n      const isContainer = model.hasManagedChildren;\n      let components = isContainer ?\n        model.findDescendantModels('component') :\n        [model];\n      components = components.filter(component => component.get('_isTrackable') !== false);\n      components.forEach((component, index) => {\n        if (component.get('_isTrackable') === false) {\n          return;\n        }\n        if (!shouldStoreResponses) {\n          // Store only component completion\n          const state = [\n            [ trackingId, index ],\n            [ component.get('_isComplete') ]\n          ];\n          states.push(state);\n          return;\n        }\n        let modelState = null;\n        if (!component.getAttemptState) {\n          // Legacy components without getAttemptState API\n          modelState = component.get('_isQuestionType') ?\n            [\n              [\n                component.get('_score') || 0,\n                component.get('_attemptsLeft') || 0\n              ],\n              [\n                component.get('_isComplete') || false,\n                component.get('_isInteractionComplete') || false,\n                component.get('_isSubmitted') || false,\n                component.get('_isCorrect') || false\n              ],\n              [\n                component.get('_userAnswer')\n              ]\n            ] :\n            [\n              [],\n              [\n                component.get('_isComplete') || false,\n                component.get('_isInteractionComplete') || false\n              ],\n              [\n                component.get('_userAnswer')\n              ]\n            ];\n        } else {\n          modelState = component.getAttemptState();\n        }\n        // Correct the _userAnswer array as it is sometimes not an array\n        // incomplete components are undefined and slider is a number\n        const userAnswer = modelState[2][0];\n        const hasUserAnswer = typeof userAnswer !== 'undefined' && userAnswer !== null;\n        const isUserAnswerArray = Array.isArray(userAnswer);\n        if (!hasUserAnswer) {\n          modelState[2][0] = [];\n        } else if (!isUserAnswerArray) {\n          modelState[2][0] = [modelState[2][0]];\n        }\n        // _attemptStates is empty if not a question or not attempted\n        const attemptStates = component.get('_attemptStates');\n        const hasAttemptStates = shouldStoreAttempts && Array.isArray(attemptStates);\n        if (hasAttemptStates) {\n          modelState[2][1] = attemptStates;\n        }\n        // Create the restoration state object\n        const state = [\n          [ trackingId, index ],\n          [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ],\n          modelState\n        ];\n        states.push(state);\n      });\n    });\n    if (this.shouldCompress) return await SCORMSuspendData.serializeAsync(states);\n    return SCORMSuspendData.serialize(states);\n  }\n\n  deserialize(binary) {\n    // Build a table of models and their tracking ids\n    const trackingIdMap = data.toArray().reduce((trackingIdMap, model) => {\n      const trackingId = model.get('_trackingId');\n      if (typeof trackingId === 'undefined') return trackingIdMap;\n      trackingIdMap[trackingId] = model;\n      return trackingIdMap;\n    }, {});\n    const states = SCORMSuspendData.deserialize(binary);\n    // Derive the storage settings of the data from the states array, this will allow changes\n    // in the spoor configuration for _shouldStoreResponses and _shouldStoreAttempts\n    // to be non-breaking\n    const shouldStoreResponses = (states[0].length > 2);\n    states.forEach(state => {\n      const [ trackingId, index ] = state[0];\n      const model = trackingIdMap[trackingId];\n      if (!model) {\n        // Ignore any recently missing tracking ids if a course has been updated\n        return;\n      }\n      const isContainer = model.hasManagedChildren;\n      let components = isContainer ?\n        model.findDescendantModels('component') :\n        [model];\n      components = components.filter(component => component.get('_isTrackable') !== false);\n      const component = components[index];\n      if (!component) {\n        logging.warn(`SPOOR could not restore tracking id: ${trackingId}, index: ${index}`);\n        return;\n      }\n      if (!shouldStoreResponses) {\n        // Restore only component completion\n        const isComplete = state[1][0];\n        component.set('_isComplete', isComplete);\n        return;\n      }\n      const [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ] = state[1];\n      const modelState = state[2];\n      // Correct the _userAnswer value if it wasn't an array originally\n      if (!hasUserAnswer) {\n        modelState[2][0] = null;\n      } else if (!isUserAnswerArray) {\n        modelState[2][0] = modelState[2][0][0];\n      }\n      // Allow empty _attemptStates\n      if (!hasAttemptStates) {\n        modelState[2][1] = null;\n      }\n      if (component.setAttemptObject) {\n        // Restore component state with setAttemptObject API\n        component.set('_attemptStates', modelState[2][1]);\n        const attemptObject = component.getAttemptObject(modelState);\n        component.setAttemptObject(attemptObject, false);\n        return;\n      }\n      // Legacy components without getAttemptState\n      component.get('_isQuestionType') ?\n        component.set({\n          _score: modelState[0][0],\n          _attemptsLeft: modelState[0][1],\n          _isComplete: modelState[1][0],\n          _isInteractionComplete: modelState[1][1],\n          _isSubmitted: modelState[1][2],\n          _isCorrect: modelState[1][3],\n          _userAnswer: modelState[2][0],\n          _attemptStates: modelState[2][1]\n        }) :\n        component.set({\n          _isComplete: modelState[1][0],\n          _isInteractionComplete: modelState[1][1],\n          _userAnswer: modelState[2][0],\n          _attemptStates: modelState[2][1]\n        });\n    });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport ScormWrapper from './scorm/wrapper';\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\nimport ComponentSerializer from './serializers/ComponentSerializer';\nimport SCORMSuspendData from './serializers/SCORMSuspendData';\nimport offlineStorage from 'core/js/offlineStorage';\n\nexport default class StatefulSession extends Backbone.Controller {\n\n  initialize() {\n    _.bindAll(this, 'beginSession', 'onVisibilityChange', 'endSession');\n    this.debouncedSaveSession = _.debounce(this.saveSessionState.bind(this), 1);\n    this.scorm = ScormWrapper.getInstance();\n    this._trackingIdType = 'block';\n    this._componentSerializer = null;\n    this._shouldCompress = false;\n    this._shouldStoreResponses = true;\n    this._shouldStoreAttempts = false;\n    this._shouldRecordInteractions = true;\n    this.beginSession();\n  }\n\n  beginSession() {\n    this.listenTo(Adapt, 'app:dataReady', this.restoreSession);\n    this._trackingIdType = Adapt.build.get('trackingIdType') || 'block';\n    // suppress SCORM errors if 'nolmserrors' is found in the querystring\n    if (window.location.search.indexOf('nolmserrors') !== -1) {\n      this.scorm.suppressErrors = true;\n    }\n    const config = Adapt.spoor.config;\n    if (!config) return;\n    const tracking = config._tracking;\n    this._shouldStoreResponses = (tracking && tracking._shouldStoreResponses) || false;\n    this._shouldStoreAttempts = (tracking && tracking._shouldStoreAttempts) || false;\n    this._shouldCompress = (tracking && tracking._shouldCompress) || false;\n    this._componentSerializer = new ComponentSerializer(this._trackingIdType, this._shouldCompress);\n    // Default should be to record interactions, so only avoid doing that if\n    // _shouldRecordInteractions is set to false\n    if (tracking?._shouldRecordInteractions === false) {\n      this._shouldRecordInteractions = false;\n    }\n    const settings = config._advancedSettings;\n    if (!settings) {\n      // force use of SCORM 1.2 by default - some LMSes (SABA/Kallidus for instance)\n      // present both APIs to the SCO and, if given the choice, the pipwerks\n      // code will automatically select the SCORM 2004 API - which can lead to\n      // unexpected behaviour.\n      this.scorm.setVersion('1.2');\n      this.scorm.initialize();\n      return;\n    }\n    if (settings._showDebugWindow) {\n      this.scorm.showDebugWindow();\n    }\n    this.scorm.setVersion(settings._scormVersion || '1.2');\n    if (_.isBoolean(settings._suppressErrors)) {\n      this.scorm.suppressErrors = settings._suppressErrors;\n    }\n    if (_.isBoolean(settings._commitOnStatusChange)) {\n      this.scorm.commitOnStatusChange = settings._commitOnStatusChange;\n    }\n    if (_.isBoolean(settings._commitOnAnyChange)) {\n      this.scorm.commitOnAnyChange = settings._commitOnAnyChange;\n    }\n    if (_.isFinite(settings._timedCommitFrequency)) {\n      this.scorm.timedCommitFrequency = settings._timedCommitFrequency;\n    }\n    if (_.isFinite(settings._maxCommitRetries)) {\n      this.scorm.maxCommitRetries = settings._maxCommitRetries;\n    }\n    if (_.isFinite(settings._commitRetryDelay)) {\n      this.scorm.commitRetryDelay = settings._commitRetryDelay;\n    }\n    if ('_exitStateIfIncomplete' in settings) {\n      this.scorm.exitStateIfIncomplete = settings._exitStateIfIncomplete;\n    }\n    if ('_exitStateIfComplete' in settings) {\n      this.scorm.exitStateIfComplete = settings._exitStateIfComplete;\n    }\n    if (_.isBoolean(settings._setCompletedWhenFailed)) {\n      this.scorm.setCompletedWhenFailed = settings._setCompletedWhenFailed;\n    }\n    this.scorm.initialize();\n  }\n\n  restoreSession() {\n    this.setupLearnerInfo();\n    this.restoreSessionState();\n    // defer call because AdaptModel.check*Status functions are asynchronous\n    _.defer(this.setupEventListeners.bind(this));\n  }\n\n  setupLearnerInfo() {\n    // Replace the hard-coded _learnerInfo data in _globals with the actual data\n    // from the LMS\n    // If the course has been published from the AT, the _learnerInfo object\n    // won't exist so we'll need to create it\n    const globals = Adapt.course.get('_globals');\n    if (!globals._learnerInfo) {\n      globals._learnerInfo = {};\n    }\n    Object.assign(globals._learnerInfo, offlineStorage.get('learnerinfo'));\n  }\n\n  restoreSessionState() {\n    const sessionPairs = offlineStorage.get();\n    const hasNoPairs = !Object.keys(sessionPairs).length;\n    if (hasNoPairs) return;\n    if (sessionPairs.c) {\n      const [ _isComplete, _isAssessmentPassed ] = SCORMSuspendData.deserialize(sessionPairs.c);\n      Adapt.course.set({\n        _isComplete,\n        _isAssessmentPassed\n      });\n    }\n    if (!sessionPairs.q) return;\n    this._componentSerializer?.deserialize(sessionPairs.q);\n  }\n\n  setupEventListeners() {\n    this.removeEventListeners();\n    this.listenTo(Adapt.components, 'change:_isComplete', this.debouncedSaveSession);\n    this.listenTo(Adapt.course, 'change:_isComplete', this.debouncedSaveSession);\n    if (this._shouldStoreResponses) {\n      this.listenTo(data, 'change:_isSubmitted change:_userAnswer', this.debouncedSaveSession);\n    }\n    this.listenTo(Adapt, {\n      'app:dataReady': this.restoreSession,\n      'app:languageChanged': this.onLanguageChanged,\n      'questionView:recordInteraction': this.onQuestionRecordInteraction,\n      'tracking:complete': this.onTrackingComplete\n    });\n    const config = Adapt.spoor.config;\n    const advancedSettings = config._advancedSettings;\n    const shouldCommitOnVisibilityChange = (!advancedSettings ||\n        advancedSettings._commitOnVisibilityChangeHidden !== false);\n    if (shouldCommitOnVisibilityChange) {\n      document.addEventListener('visibilitychange', this.onVisibilityChange);\n    }\n    $(window).on('beforeunload unload', this.endSession);\n  }\n\n  async saveSessionState() {\n    const isMidRender = !Adapt.parentView?.model.get('_isReady');\n    // Wait until finished rendering to save\n    if (isMidRender) return this.debouncedSaveSession();\n    const courseState = SCORMSuspendData.serialize([\n      Boolean(Adapt.course.get('_isComplete')),\n      Boolean(Adapt.course.get('_isAssessmentPassed'))\n    ]);\n    const componentStates = await this._componentSerializer?.serialize(this._shouldStoreResponses, this._shouldStoreAttempts);\n    const sessionPairs = {\n      c: courseState,\n      q: componentStates\n    };\n    offlineStorage.set(sessionPairs);\n    this.printCompletionInformation(sessionPairs);\n  }\n\n  printCompletionInformation(suspendData) {\n    if (typeof suspendData === 'string') {\n      // In-case LMS data is passed as a string\n      suspendData = JSON.parse(suspendData);\n    }\n    const courseState = SCORMSuspendData.deserialize(suspendData.c);\n    const courseComplete = courseState[0];\n    const assessmentPassed = courseState[1];\n    const trackingIdModels = data.filter(model => model.get('_type') === this._trackingIdType && model.has('_trackingId'));\n    const trackingIds = trackingIdModels.map(model => model.get('_trackingId'));\n    if (!trackingIds.length) {\n      logging.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: no tracking ids found`);\n      return;\n    }\n    const completionData = SCORMSuspendData.deserialize(suspendData.q);\n    const max = Math.max(...completionData.map(item => item[0][0]));\n    const shouldStoreResponses = (completionData[0].length === 3);\n    const completionString = completionData.reduce((markers, item) => {\n      const trackingId = item[0][0];\n      const isComplete = shouldStoreResponses ?\n        item[2][1][0] :\n        item[1][0];\n      const mark = isComplete ? '1' : '0';\n      markers[trackingId] = (markers[trackingId] === '-' || markers[trackingId] === '1') ?\n        mark :\n        '0';\n      return markers;\n    }, (new Array(max + 1).join('-').split(''))).join('');\n    logging.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: ${completionString}`);\n  }\n\n  onLanguageChanged() {\n    const config = Adapt.spoor.config;\n    if (config?._reporting?._resetStatusOnLanguageChange !== true) return;\n    offlineStorage.set('status', 'incomplete');\n  }\n\n  onVisibilityChange() {\n    if (document.visibilityState === 'hidden') this.scorm.commit();\n  }\n\n  onQuestionRecordInteraction(questionView) {\n    if (!this._shouldRecordInteractions) return;\n    // View functions are deprecated: getResponseType, getResponse, isCorrect, getLatency\n    const questionModel = questionView.model;\n    const responseType = (questionModel.getResponseType ? questionModel.getResponseType() : questionView.getResponseType());\n    // If responseType doesn't contain any data, assume that the question\n    // component hasn't been set up for cmi.interaction tracking\n    if (_.isEmpty(responseType)) return;\n    const id = `${this.scorm.getInteractionCount()}-${questionModel.get('_id')}`;\n    const response = (questionModel.getResponse ? questionModel.getResponse() : questionView.getResponse());\n    const result = (questionModel.isCorrect ? questionModel.isCorrect() : questionView.isCorrect());\n    const latency = (questionModel.getLatency ? questionModel.getLatency() : questionView.getLatency());\n    offlineStorage.set('interaction', id, response, result, latency, responseType);\n  }\n\n  onTrackingComplete(completionData) {\n    const config = Adapt.spoor.config;\n    this.saveSessionState();\n    let completionStatus = completionData.status.asLowerCase;\n    // The config allows the user to override the completion state.\n    switch (completionData.status) {\n      case COMPLETION_STATE.COMPLETED:\n      case COMPLETION_STATE.PASSED: {\n        if (!config?._reporting?._onTrackingCriteriaMet) {\n          logging.warn(`No value defined for '_onTrackingCriteriaMet', so defaulting to '${completionStatus}'`);\n        } else {\n          completionStatus = config._reporting._onTrackingCriteriaMet;\n        }\n\n        break;\n      }\n      case COMPLETION_STATE.FAILED: {\n        if (!config?._reporting?._onAssessmentFailure) {\n          logging.warn(`No value defined for '_onAssessmentFailure', so defaulting to '${completionStatus}'`);\n        } else {\n          completionStatus = config._reporting._onAssessmentFailure;\n        }\n      }\n    }\n    offlineStorage.set('status', completionStatus);\n  }\n\n  endSession() {\n    if (!this.scorm.finishCalled) {\n      this.scorm.finish();\n    }\n    this.removeEventListeners();\n  }\n\n  removeEventListeners() {\n    $(window).off('beforeunload unload', this.endSession);\n    document.removeEventListener('visibilitychange', this.onVisibilityChange);\n    this.stopListening();\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport ScormWrapper from './scorm/wrapper';\nimport SCORMSuspendData from './serializers/SCORMSuspendData';\nimport offlineStorage from 'core/js/offlineStorage';\n\n/**\n * SCORM handler for offlineStorage interface.\n */\nexport default class OfflineStorageScorm extends Backbone.Controller {\n\n  initialize(statefulSession) {\n    this.offlineStorage = offlineStorage;\n    this.scorm = ScormWrapper.getInstance();\n    this.statefulSession = statefulSession;\n    this.temporaryStore = {};\n    this.suspendDataStore = {};\n    this.suspendDataRestored = false;\n    offlineStorage.initialize(this);\n  }\n\n  save() {\n    this.statefulSession.saveSessionState();\n    this.scorm.commit();\n  }\n\n  serialize(...args) {\n    return SCORMSuspendData.serialize(...args);\n  }\n\n  deserialize(...args) {\n    return SCORMSuspendData.deserialize(...args);\n  }\n\n  get(name) {\n    if (name === undefined) {\n      // If not connected return just temporary store.\n      if (this.useTemporaryStore()) return this.temporaryStore;\n\n      // Get all values as a combined object\n      this.suspendDataStore = this.getCustomStates();\n\n      const data = Object.assign(_.clone(this.suspendDataStore), {\n        location: this.scorm.getLessonLocation(),\n        score: this.scorm.getScore(),\n        status: this.scorm.getStatus(),\n        student: this.scorm.getStudentName(),\n        learnerInfo: this.getLearnerInfo()\n      });\n\n      this.suspendDataRestored = true;\n\n      return data;\n    }\n\n    // If not connected return just temporary store value.\n    if (this.useTemporaryStore()) return this.temporaryStore[name];\n\n    // Get by name\n    let courseState;\n    switch (name.toLowerCase()) {\n      case 'location':\n        return this.scorm.getLessonLocation();\n      case 'score':\n        return this.scorm.getScore();\n      case 'status':\n        return this.scorm.getStatus();\n      case 'student':\n        // for backwards-compatibility. learnerInfo is preferred now and will\n        // give you more information\n        return this.scorm.getStudentName();\n      case 'learnerinfo':\n        return this.getLearnerInfo();\n      case 'coursestate': {\n        courseState = this.getCustomState('c');\n        const stateArray = (courseState && SCORMSuspendData.deserialize(courseState)) || [];\n        return {\n          _isCourseComplete: Boolean(stateArray.slice(0, 1).map(Number)[0]),\n          _isAssessmentPassed: Boolean(stateArray.slice(1, 2).map(Number)[0]),\n          completion: stateArray.slice(2).map(Number).map(String).join('') || ''\n        };\n      }\n      case 'completion':\n        courseState = this.getCustomState('c');\n        return (courseState && SCORMSuspendData\n          .deserialize(courseState)\n          .slice(2)\n          .map(Number)\n          .map(String)\n          .join('')) || '';\n      case '_iscoursecomplete':\n        courseState = this.getCustomState('c');\n        return Boolean(courseState && SCORMSuspendData\n          .deserialize(courseState)\n          .slice(0, 1)\n          .map(Number)[0]);\n      case '_isassessmentpassed':\n        courseState = this.getCustomState('c');\n        return Boolean(courseState && SCORMSuspendData\n          .deserialize(courseState)\n          .slice(1, 2)\n          .map(Number)[0]);\n      case 'questions': {\n        const questionsState = this.getCustomState('q');\n        return questionsState || '';\n      }\n      default:\n        return this.getCustomState(name);\n    }\n  }\n\n  set(name, value) {\n    // Convert arguments to array and drop the 'name' parameter\n    const args = [...arguments].slice(1);\n    const isObject = typeof name === 'object';\n\n    if (isObject) {\n      value = name;\n      name = 'suspendData';\n    }\n\n    if (this.useTemporaryStore()) {\n      if (isObject) {\n        Object.assign(this.temporaryStore, value);\n      } else {\n        this.temporaryStore[name] = value;\n      }\n\n      return true;\n    }\n\n    switch (name.toLowerCase()) {\n      case 'interaction':\n        return this.scorm.recordInteraction(...args);\n      case 'location':\n        return this.scorm.setLessonLocation(...args);\n      case 'score':\n        return this.scorm.setScore(...args);\n      case 'status':\n        return this.scorm.setStatus(...args);\n      case 'student':\n      case 'learnerinfo':\n        return false;// these properties are read-only\n      case 'lang':\n        this.scorm.setLanguage(value);\n        // fall-through so that lang gets stored in suspend_data as well:\n        // because in SCORM 1.2 cmi.student_preference.language is an optional\n        // data element so we can't rely on the LMS having support for it.\n        // If it does support it we may as well save the user's choice there\n        // purely for reporting purposes\n        break;\n      case 'suspenddata':\n        break;\n    }\n\n    if (isObject) {\n      Object.assign(this.suspendDataStore, value);\n    } else {\n      this.suspendDataStore[name] = value;\n    }\n\n    const dataAsString = JSON.stringify(this.suspendDataStore);\n    return (this.suspendDataRestored) ? this.scorm.setSuspendData(dataAsString) : false;\n  }\n\n  clear() {\n    this.temporaryStore = {};\n    this.suspendDataStore = {};\n    const dataAsString = JSON.stringify(this.suspendDataStore);\n    this.scorm.setSuspendData(dataAsString);\n  }\n\n  getCustomStates() {\n    const isSuspendDataStoreEmpty = _.isEmpty(this.suspendDataStore);\n    if (!isSuspendDataStoreEmpty && this.suspendDataRestored) {\n      return _.clone(this.suspendDataStore);\n    }\n\n    const dataAsString = this.scorm.getSuspendData();\n    if (dataAsString === '' || dataAsString === ' ' || dataAsString === undefined) {\n      return {};\n    }\n\n    const dataAsJSON = JSON.parse(dataAsString);\n    if (!isSuspendDataStoreEmpty && !this.suspendDataRestored) {\n      Object.assign(dataAsJSON, this.suspendDataStore);\n    }\n    return dataAsJSON;\n  }\n\n  getCustomState(name) {\n    const dataAsJSON = this.getCustomStates();\n    return dataAsJSON[name];\n  }\n\n  useTemporaryStore() {\n    const cfg = Adapt.config.get('_spoor');\n\n    if (!this.scorm.lmsConnected || (cfg?._isEnabled === false)) return true;\n    return false;\n  }\n\n  /**\n   * Returns an object with the properties:\n   * - id (cmi.core.student_id)\n   * - name (cmi.core.student_name - which is usually in the format\n   *    'Lastname, Firstname' or 'Firstname Lastname' - but it sometimes doesn't\n   *    have the space after the comma\n   *   )\n   * - firstname\n   * - lastname\n   */\n  getLearnerInfo() {\n    const id = this.scorm.getStudentId();\n\n    let name = this.scorm.getStudentName();\n    let firstname = '';\n    let lastname = '';\n\n    let hasName = (name && name !== 'undefined');\n    const isNameCommaSeparated = hasName && name.includes(',');\n    const isNameSpaceSeparated = hasName && name.includes(' ');\n\n    // Name must have either a comma or a space\n    hasName = hasName && (isNameCommaSeparated || isNameSpaceSeparated);\n\n    if (!hasName) {\n      console.log('SPOOR: LMS learner_name not in \\'lastname, firstname\\' or \\'firstname lastname\\' format');\n      return { id, name, firstname, lastname };\n    }\n\n    const separator = isNameCommaSeparated ? ',' : ' ';\n    const nameParts = name.split(separator);\n    if (isNameCommaSeparated) {\n      // Assume lastname appears before the comma\n      nameParts.reverse();\n    }\n    [ firstname, lastname ] = nameParts.map(part => part.trim());\n    name = `${firstname} ${lastname}`;\n    return { id, name, firstname, lastname };\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport ScormWrapper from './scorm/wrapper';\nimport StatefulSession from './adapt-stateful-session';\nimport OfflineStorage from './adapt-offlineStorage-scorm';\nimport offlineStorage from 'core/js/offlineStorage';\n\nclass Spoor extends Backbone.Controller {\n\n  initialize() {\n    this.config = null;\n    this.scorm = ScormWrapper.getInstance();\n    this.listenToOnce(Adapt, 'offlineStorage:prepare', this._prepare);\n  }\n\n  _prepare() {\n    this.config = Adapt.config.get('_spoor');\n    if (!this.isEnabled) {\n      offlineStorage.setReadyStatus();\n      return;\n    }\n    this.statefulSession = new StatefulSession();\n    this.offlineStorage = new OfflineStorage(this.statefulSession);\n    // force offlineStorage-scorm to initialise suspendDataStore - this allows\n    // us to do things like store the user's chosen language before the rest\n    // of the course data loads\n    offlineStorage.get();\n    offlineStorage.setReadyStatus();\n    // setup debug window keyboard shortcut\n    require(['libraries/jquery.keycombo'], () => {\n      // listen for user holding 'd', 'e', 'v' keys together\n      $.onKeyCombo([68, 69, 86], () => {\n        Adapt.spoor.scorm.showDebugWindow();\n      });\n    });\n  }\n\n  get isEnabled() {\n    return (this.config && this.config._isEnabled);\n  }\n\n}\n\nAdapt.spoor = new Spoor();\n\nexport default Adapt.spoor;\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\nimport CourseModel from 'core/js/models/courseModel';\n\n/**\n * Utility function for applying deep defaults\n * @param {Object} original\n * @param  {...Object} defaultObjects\n * @returns {Object} Returns original\n */\nexport function _deepDefaults(original, ...defaultObjects) {\n  defaultObjects.reverse();\n  defaultObjects.forEach(defaults => {\n    const keyValuePairs = Object.entries(defaults);\n    keyValuePairs.forEach(([ key, defaultValue ]) => {\n      const isRecursiveObject = (typeof defaultValue === 'object' && !Array.isArray(defaultValue) && defaultValue !== null);\n      if (isRecursiveObject) {\n        original[key] = _deepDefaults(original[key] || {}, defaultValue);\n        return;\n      }\n      const isValueAlreadySet = Object.prototype.hasOwnProperty.call(original, key);\n      if (isValueAlreadySet) return;\n      original[key] = defaultValue;\n    });\n  });\n  return original;\n}\n\nexport const configDefaults = {\n  _isEnabled: false,\n  _isInherited: false,\n  _autoScroll: true,\n  _scrollTo: '@block +1',\n  _onChildren: false,\n  _button: {\n    _isEnabled: true,\n    _isFullWidth: true,\n    _autoHide: false,\n    _hasIcon: false,\n    _styleBeforeCompletion: 'hidden',\n    _styleAfterClick: 'hidden',\n    _component: 'trickle-button',\n    _className: '',\n    text: 'Continue',\n    ariaLabel: '',\n    startText: '',\n    startAriaLabel: '',\n    finalText: '',\n    finalAriaLabel: ''\n  },\n  _stepLocking: {\n    _isEnabled: true,\n    _isCompletionRequired: true,\n    _isLockedOnRevisit: false\n  }\n};\n\n/**\n * @param {Backbone.Model} model\n * @returns {Boolean}\n */\nexport function isModelArticleWithOnChildren(model) {\n  const type = model.get('_type');\n  const trickleConfig = model.get('_trickle');\n  return (type === 'article' && trickleConfig?._onChildren !== false);\n}\n\n/**\n * @param {Backbone.Model} model\n * @returns {Boolean}\n */\nexport function isModelBlockWithArticleNotChildren(model) {\n  const type = model.get('_type');\n  const parentTrickleConfig = model.getParent()?.get('_trickle');\n  return (type === 'block' && parentTrickleConfig?._isEnabled === true && parentTrickleConfig?._onChildren === false);\n}\n\n/**\n * Get the default trickle configuration for the given model\n * @param {Backbone.Model} model\n */\nexport function getModelConfigDefaults(model) {\n  const type = model.get('_type');\n  const config = {};\n  // Setup default legacy article behaviour, onChildren === isArticle if omitted\n  _deepDefaults(config, configDefaults, {\n    _onChildren: (type === 'article')\n  });\n  // Default startText and finalText when _onChildren: true\n  if (config._onChildren) {\n    config._button.startText = config._button.startText ?? 'Begin';\n    config._button.startAriaLabel = config._button.startAriaLabel ?? '';\n    config._button.finalText = config._button.finalText ?? 'Finish';\n    config._button.finalAriaLabel = config._button.finalAriaLabel ?? '';\n  }\n  // Force step locking for _isFullWidth buttons\n  if (config._button._isFullWidth) {\n    config._stepLocking._isEnabled = true;\n  }\n  return config;\n}\n\n/**\n * Returns an array of models from which to derive a trickle config or null\n * @param {Backbone.Model} configModel\n * @returns {[Backbone.Model]|null}\n */\nexport function getModelInheritanceChain(configModel) {\n  if (!data.isReady) throw new Error('Trickle cannot resolve inheritance chains until data is ready');\n  const type = configModel.get('_type');\n  if (type === 'block') {\n    const parentModel = configModel.getParent();\n    const parentConfig = parentModel.get('_trickle');\n    const blockConfig = configModel.get('_trickle');\n    const isParentEnabledNotOnChildren = (parentConfig?._isEnabled && parentConfig._onChildren === false);\n    const isNoChildConfig = (!blockConfig?._isEnabled);\n    if (isParentEnabledNotOnChildren && isNoChildConfig) {\n      return null;\n    }\n    return [ configModel, parentModel ].filter(ancestor => {\n      const config = ancestor.get('_trickle');\n      // Remove models with no config and models which explicitly require inheritance\n      return (config && !config._isInherited);\n    });\n  }\n  if (type === 'article') {\n    return [ configModel ];\n  }\n  return null;\n};\n\n/**\n * Returns the derived trickle configuration for the given model\n * @param {Backbone.Model} model\n * @returns {Object}\n */\nexport function getModelConfig(model) {\n  const inheritance = getModelInheritanceChain(model);\n  if (!inheritance?.length || isModelArticleWithOnChildren(model) || isModelBlockWithArticleNotChildren(model)) return null;\n  const config = $.extend(true, {}, ...inheritance.reverse().map((inheritModel, index, arr) => {\n    const isLast = (index === arr.length - 1);\n    const defaults = isLast ? getModelConfigDefaults(inheritModel) : null;\n    return $.extend(true, {}, defaults, inheritModel.get('_trickle'));\n  }));\n  if (!config._isEnabled) return null;\n  return config;\n}\n\n/**\n * Returns the first model in the inheritance chain with _onChildren: true\n * @param {Backbone.Model} model\n * @returns {Backbone.Model}\n */\nexport function getModelContainer(model) {\n  const inheritance = getModelInheritanceChain(model);\n  return inheritance?.find(inheritModel => {\n    const defaults = getModelConfigDefaults(inheritModel);\n    const config = $.extend(true, {}, defaults, inheritModel.get('_trickle'));\n    return config._onChildren;\n  });\n}\n\n/**\n * Fetch the defined or default completion attribute on which trickle should\n * listen for completion\n * @return {string}\n */\nexport function getCompletionAttribute(model = null) {\n  return getModelConfig(model)?._completionAttribute || Adapt.config.get('_trickle')?._completionAttribute || '_isComplete';\n}\n\n/**\n * Reapply trickle locks if the completion attribute has changed on the given model\n * @param {Backbone.Model} model\n */\nexport function checkApplyLocks(model) {\n  if (!data.isReady) return;\n  const completionAttribute = getCompletionAttribute(model);\n  const hasCompletionChanged = Object.prototype.hasOwnProperty.call(model.changed, completionAttribute);\n  const hasAvailabilityChanged = Object.prototype.hasOwnProperty.call(model.changed, '_isAvailable');\n  if (!hasCompletionChanged && !hasAvailabilityChanged) return;\n  // Apply the locks lazily\n  debouncedApplyLocks();\n}\n\n/**\n * Calculates and applies the new locking state for each sub-page model according\n * to each trickle configuration\n */\nexport function applyLocks() {\n  if (!data.isReady) return;\n  const locks = {};\n  const modelsById = {};\n  // Fetch the component model from the store incase it needs overriding by another extension\n  const TrickleButtonModel = components.getModelClass('trickle-button');\n  // Check all models for trickle potential\n  Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(siteModel => {\n    const trickleConfig = getModelConfig(siteModel);\n    if (!isEnabled(siteModel, { trickleConfig })) return;\n    const isModelLocked = isLocked(siteModel, { trickleConfig });\n    const id = siteModel.get('_id');\n    modelsById[id] = siteModel;\n    locks[id] = locks[id] || false;\n    // Apply lock to all subsequent models\n    const subsequentLockingModels = _getAncestorNextSiblings(siteModel);\n    subsequentLockingModels.forEach((model, index) => {\n      const id = model.get('_id');\n      const isButtonModel = (model instanceof TrickleButtonModel);\n      const isTrickled = model.get('_isTrickled');\n      // Do not stop at TrickleButtonModels\n      if (isTrickled !== isButtonModel) model.set('_isTrickled', !isButtonModel);\n      // Store the new locking state of each model in the locks variable\n      // Don't unlock anything that was locked in a previous group\n      modelsById[id] = model;\n      locks[id] = locks[id] || isModelLocked;\n      // Don't modify the children if they are managed by another locking mechanism\n      if (model.get('_lockType')) return;\n      // Cascade inherited locks through the hierarchyd\n      model.getAllDescendantModels().forEach(descendant => {\n        const descendantId = descendant.get('_id');\n        modelsById[descendantId] = descendant;\n        locks[descendantId] = locks[id];\n      });\n    });\n  });\n  // Apply only changed locking states\n  Object.entries(locks).forEach(([ id, isModelLocked ]) => {\n    const model = modelsById[id];\n    const wasLocked = model.get('_isLocked');\n    if (wasLocked === isModelLocked) return;\n    model.set('_isLocked', isModelLocked);\n  });\n  logTrickleState();\n}\n\nexport function isEnabled(model, { trickleConfig = getModelConfig(model) } = {}) {\n  return (trickleConfig?._isEnabled === true);\n}\n\nexport function isLocked(model, { trickleConfig = getModelConfig(model) } = {}) {\n  const isStepLocked = Boolean(trickleConfig?._stepLocking?._isEnabled);\n  if (!isStepLocked) return false;\n  const isCompletionRequired = Boolean(trickleConfig?._stepLocking?._isCompletionRequired);\n  const completionAttribute = getCompletionAttribute(model);\n  if (!isCompletionRequired) {\n    const TrickleModel = components.getModelClass('trickle-button');\n    const trickleButton = model.getAvailableChildModels().find(model => model instanceof TrickleModel);\n    const isTrickleButtonComplete = Boolean(trickleButton?.get(completionAttribute));\n    return !isTrickleButtonComplete;\n  }\n  const isModelLocked = !model?.get(completionAttribute) &&\n    !model?.get('_isOptional');\n  return isModelLocked;\n}\n\nexport const debouncedApplyLocks = _.debounce(applyLocks, 1);\n\n/**\n * Returns all of the contentobject descendant models directly subsequent to the\n * given model through each ancestor\n * If fromModel is a block; its block next siblings and article next siblings\n * @param {Backbone.Model} child\n * @returns {Array<Backbone.Model>}\n */\nexport function _getAncestorNextSiblings(fromModel) {\n  if (!fromModel) return [];\n  // Fetch all subsequent siblings\n  const allSiblings = fromModel.getParent().getAvailableChildModels();\n  const subsequentSiblings = allSiblings.slice(allSiblings.findIndex(sibling => sibling === fromModel) + 1);\n  // Fetch all ancestors between the page and the child\n  const allAncestors = fromModel.getAncestorModels();\n  const inPageAncestors = allAncestors.slice(0, allAncestors.findIndex(parent => parent instanceof ContentObjectModel) + 1);\n  // Move from the next ancestor down as we already have the parent's children (fromModel siblings)\n  // Collect all subsequent in-page ancestor siblings\n  const subsequentInPageAncestors = [];\n  inPageAncestors.slice(1).forEach((grandParent, previousIndex) => {\n    const parent = inPageAncestors[previousIndex];\n    const allGrandParentChildren = grandParent.getAvailableChildModels();\n    const subsequentAncestorSiblings = allGrandParentChildren.slice(allGrandParentChildren.findIndex(child => child === parent) + 1);\n    subsequentInPageAncestors.push(...subsequentAncestorSiblings);\n  });\n  // Combine and return entire set\n  const subsequentContentObjectDescendantModels = subsequentSiblings.concat(subsequentInPageAncestors);\n  return subsequentContentObjectDescendantModels;\n}\n\n/**\n * Adds trickle button components in their relevant places throughout the course\n */\nexport function addButtonComponents() {\n  // Fetch the component model from the store incase it needs overriding by another extension\n  const TrickleButtonModel = components.getModelClass('trickle-button');\n  let uid = 0;\n  data.forEach(buttonModelSite => {\n    if (buttonModelSite instanceof CourseModel) return;\n    const trickleConfig = getModelConfig(buttonModelSite);\n    if (!trickleConfig || !trickleConfig?._isEnabled || buttonModelSite.get('_isTrickleSiteConfigured')) return;\n    buttonModelSite.set('_isTrickleSiteConfigured', true);\n    const parentId = buttonModelSite.get('_id');\n    const trickleButtonModel = new TrickleButtonModel({\n      _id: `trickle-${uid++}`,\n      _type: 'component',\n      _component: 'trickle-button',\n      _parentId: parentId,\n      _isAvailable: true,\n      _layout: 'full',\n      _trickle: { _isEnabled: true },\n      _renderPosition: 'outer-append',\n      _isTrackable: false\n    });\n    trickleButtonModel.setupModel();\n    // This line would usually append a trickle button to an article or block\n    buttonModelSite.getChildren().add(trickleButtonModel);\n  });\n}\n\n/**\n * Pretty print locking state for current page\n */\nexport function logTrickleState() {\n  if (logging._config?._level !== 'debug') return;\n  if (!Adapt.parentView?.model?.isTypeGroup('page')) {\n    logging.debug('TRICKLE GLOBAL STATE');\n    Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\n      const isLocked = model.get('_isLocked');\n      const isTrickled = model.get('_isTrickled');\n      logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\n    });\n    return;\n  }\n  logging.debug('TRICKLE STATE');\n  Adapt.parentView.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\n    const isLocked = model.get('_isLocked');\n    const isTrickled = model.get('_isTrickled');\n    logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\n  });\n}\n\n/**\n * Utility functions for trickle model operations\n */\nexport default {\n  _deepDefaults,\n  configDefaults,\n  getModelConfigDefaults,\n  getModelInheritanceChain,\n  getModelConfig,\n  getModelContainer,\n  getCompletionAttribute,\n  checkApplyLocks,\n  applyLocks,\n  debouncedApplyLocks,\n  _getAncestorNextSiblings,\n  addButtonComponents,\n  logTrickleState\n};\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport {\n  checkApplyLocks,\n  addButtonComponents,\n  applyLocks,\n  debouncedApplyLocks,\n  getModelConfig,\n  isModelArticleWithOnChildren\n} from './models';\nimport router from 'core/js/router';\n\n/** @typedef {import('core/js/childEvent').default} ChildEvent  */\n\nclass TrickleController extends Backbone.Controller {\n\n  initialize() {\n    this.checkIsFinished = _.debounce(this.checkIsFinished, 1);\n\n    this.listenTo(data, {\n      ready: this.onDataReady\n    });\n  }\n\n  async onDataReady() {\n    const trickleConfig = Adapt.config.get('_trickle');\n    if (trickleConfig?._isEnabled === false) return;\n\n    this.setUpEventListeners();\n\n    wait.for(done => {\n      addButtonComponents();\n      applyLocks();\n      done();\n    });\n  }\n\n  setUpEventListeners() {\n    this.listenTo(data, {\n      // Check that the locking is accurate after any completion, this happens asynchronously\n      'change:_isInteractionComplete change:_isComplete change:_isAvailable add remove': checkApplyLocks,\n      // Check whether trickle is finished after any locking changes\n      'change:_isLocked': this.checkIsFinished\n    });\n\n    this.listenTo(Adapt, {\n      // Reapply locks after assessment reset, this happens asynchronously where possible\n      'assessments:reset': this.onAssessmentReset,\n      // Reset trickle's global state when changing content objects\n      'contentObjectView:preRender': this.reset,\n      // Stop rendering where necessary before a child is rendered\n      'view:addChild': this.onAddChildView,\n      // Temporarily remove trickle from the current content object\n      'trickle:kill': this.kill\n    });\n  }\n\n  onAssessmentReset() {\n    // If mid render then apply locks immediately\n    const isMidRender = !Adapt.parentView?.model.get('_isReady');\n    if (isMidRender) return applyLocks();\n    // Otherwise apply them lazily\n    debouncedApplyLocks();\n  }\n\n  /**\n   * Returns true if the current page is or was locked by trickle\n   */\n  get isStarted() {\n    return Boolean(Adapt.parentView?.model.get('_isTrickleStarted'));\n  }\n\n  set isStarted(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleStarted', value);\n    if (!value) return;\n    Adapt.trigger('trickle:started');\n  }\n\n  /**\n   * When each child view is added to its parent, check to see if trickle should\n   * stop the render at this child according to the locking state\n   * @param {ChildEvent} event\n   */\n  onAddChildView(event) {\n    if (this.isKilled) return;\n    if (event.hasRequestChild) applyLocks();\n    const isManagedByTrickleAndLocked = (event.model.get('_isTrickled') && event.model.get('_isLocked'));\n    if (!isManagedByTrickleAndLocked) return;\n    event.stop();\n  }\n\n  /**\n   * Returns true if the current page is locked by trickle\n   */\n  get isTrickling() {\n    const isTrickling = Adapt.parentView.model.getAllDescendantModels().some(model => {\n      return model.get('_isAvailable') && model.get('_isTrickled') && model.get('_isLocked');\n    });\n    return isTrickling;\n  }\n\n  /**\n   * Make the framework try to render the next set of children\n   */\n  async continue() {\n    applyLocks();\n    await Adapt.parentView.addChildren();\n    await Adapt.parentView.whenReady();\n  }\n\n  /**\n   * Scroll to the next section as defined by the trickle configuration on the\n   * specified model\n   * @param {Backbone.Model} fromModel\n   */\n  async scroll(fromModel) {\n    const trickleConfig = getModelConfig(fromModel);\n    if (!trickleConfig?._isEnabled) return false;\n\n    if (isModelArticleWithOnChildren(fromModel)) return false;\n\n    const isAutoScrollOff = !trickleConfig._autoScroll;\n    const hasTrickleButton = trickleConfig._button._isEnabled;\n    if (isAutoScrollOff && !hasTrickleButton) {\n      return;\n    }\n\n    const getScrollToId = () => {\n      const scrollTo = trickleConfig._scrollTo;\n      const firstCharacter = scrollTo.substr(0, 1);\n      switch (firstCharacter) {\n        case '@': {\n          // NAVIGATE BY RELATIVE TYPE\n          // Allows trickle to scroll to a sibling / cousin component\n          // relative to the current trickle item\n          const relativeModel = fromModel.findRelativeModel(scrollTo, {\n            filter: model => model.get('_isAvailable')\n          });\n          if (relativeModel === undefined) return;\n          return relativeModel.get('_id');\n        }\n        case '.':\n          // NAVIGATE BY CLASS\n          return scrollTo.substr(1, scrollTo.length - 1);\n        default:\n          return scrollTo;\n      }\n    };\n\n    let scrollToId = getScrollToId();\n    if (!scrollToId) {\n      logging.error(`Cannot scroll to the next id as none was found at id: \"${fromModel.get('_id')}\" with _scrollTo: \"${trickleConfig._scrollTo}\". Suggestion: Set _showEndOfPage to false.`)\n      return\n    }\n\n    const isDescendant = Adapt.parentView.model.getAllDescendantModels().some(model => {\n      return model.get('_id') === scrollToId;\n    });\n    if (!isDescendant) {\n      applyLocks();\n      // Navigate to another content object\n      const model = data.findById(scrollToId);\n      const contentObject = model.isTypeGroup('contentobject') ? model : model.findAncestor('contentobject');\n      await router.navigateToElement(contentObject.get('_id'));\n      // Recalculate the relative id after the page is ready as it may change\n      scrollToId = getScrollToId();\n      await router.navigateToElement(scrollToId);\n      return;\n    }\n\n    await Adapt.parentView.renderTo(scrollToId);\n\n    if (hasTrickleButton) {\n      // Only set focus if there is a trickle button - see https://github.com/adaptlearning/adapt_framework/issues/2813\n      a11y.focusFirst($('.' + scrollToId), { preventScroll: true });\n    }\n\n    if (isAutoScrollOff) return false;\n\n    const duration = trickleConfig._scrollDuration || 500;\n    router.navigateToElement('.' + scrollToId, { duration });\n  }\n\n  /**\n   * Returns true if the current page was locked by trickle and is now finished\n   */\n  get isFinished() {\n    if (!Adapt.parentView) return false;\n    return Boolean(!this.isStarted || Adapt.parentView.model.get('_isTrickleFinished') || this.isKilled);\n  }\n\n  set isFinished(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleFinished', value);\n    if (!value) return;\n    Adapt.trigger('trickle:finished');\n  }\n\n  checkIsFinished() {\n    if (!this.isStarted) return;\n    if (this.isKilled || this.isFinished) return;\n    if (this.isTrickling) return;\n    this.isFinished = true;\n  }\n\n  /**\n   * Turn off all trickle locking, continue rendering and set the page model state as killed\n   */\n  async kill() {\n    // Fetch the component model from the store incase it needs overriding by another extension\n    const TrickleModel = components.getModelClass('trickle-button');\n    this.isKilled = true;\n    Adapt.parentView.model.getAllDescendantModels().forEach(model => {\n      const isButtonModel = (model instanceof TrickleModel);\n      if (isButtonModel) {\n        model.setCompletionStatus();\n      }\n      if (!model.get('_isTrickled')) return;\n      model.set('_isLocked', false);\n    });\n    await this.continue();\n  }\n\n  /**\n   * Returns true if the current page was locked by trickle and is now killed\n   */\n  get isKilled() {\n    if (!Adapt.parentView) return false;\n    return !this.isStarted || Adapt.parentView.model.get('_isTrickleKilled');\n  }\n\n  set isKilled(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleKilled', value);\n    if (!value) return;\n    Adapt.trigger('trickle:killed');\n  }\n\n  /**\n   * Reset the page trickle state\n   */\n  reset() {\n    this.isKilled = false;\n    if (!this.isTrickling) {\n      this.isStarted = false;\n      this.isFinished = false;\n      return;\n    }\n    this.isStarted = true;\n    this.isFinished = false;\n  }\n\n}\n\nexport default new TrickleController();\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport ComponentView from 'core/js/views/componentView';\nimport controller from './controller';\nimport {\n  getModelConfig,\n  getCompletionAttribute\n} from './models';\n\n/** @typedef {import('core/js/modelEvent').default} ModelEvent  */\n\nclass TrickleButtonView extends ComponentView {\n\n  className() {\n    const config = getModelConfig(this.model.getParent());\n    return [\n      'trickle',\n      this.model.get('_id'),\n      config._button._component,\n      config._button._isFullWidth && 'is-full-width',\n      config._button._className\n    ].filter(Boolean).join(' ');\n  }\n\n  events() {\n    return {\n      'click .js-trickle-btn': 'onButtonClick'\n    };\n  }\n\n  initialize() {\n    this.openPopupCount = 0;\n    this.isAwaitingPopupClose = false;\n    this.wasButtonClicked = false;\n    this.model.calculateButtonText();\n    this.calculateButtonState();\n    this.setupEventListeners();\n    this.render();\n    if (!this.model.isEnabled()) {\n      this.setCompletionStatus();\n    }\n    _.defer(this.setReadyStatus.bind(this));\n  }\n\n  /**\n   * Taking account of open popups, recalculate the button visible and enabled states\n   */\n  calculateButtonState() {\n    const isDisabledByPopups = (this.openPopupCount > 0);\n    this.model.calculateButtonState(isDisabledByPopups, this.wasButtonClicked);\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    data._globals = Adapt.course.get('_globals');\n    data._trickle = getModelConfig(this.model.getParent());\n    this.$el.html(Handlebars.templates[TrickleButtonView.template](data));\n  }\n\n  setupEventListeners() {\n    this.tryButtonAutoHide = this.tryButtonAutoHide.bind(this);\n    // Add async delay on each call to onParent complete\n    // to wait for autoscroll question feedback notify to appear\n    const onParentComplete = this.onParentComplete.bind(this);\n    this.onParentComplete = (...args) => _.delay(() => onParentComplete(...args), 100);\n    this.listenTo(Adapt.parentView, 'postRemove', this.onRemove);\n    this.listenTo(Adapt, 'trickle:killed', this.updateButtonState);\n    if (this.model.isStepUnlocked() && this.model.isFinished()) {\n      // Already complete, no need to listen to anything else\n      return;\n    }\n    this.$el.on('onscreen', this.tryButtonAutoHide);\n    this.listenTo(Adapt, {\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed\n    });\n    const parentModel = this.model.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    this.listenTo(parentModel, {\n      'change:_requireCompletionOf': this.onStepUnlocked,\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\n      [`change:${completionAttribute}`]: this.onParentComplete\n    });\n  }\n\n  /**\n   * Keep count of the number of open popups\n   */\n  onPopupOpened() {\n    this.openPopupCount++;\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\n    if (!shouldUserInteractWithButton) return;\n    this.updateButtonState();\n  }\n\n  /**\n   * Keep count of the number of open popups\n   */\n  async onPopupClosed() {\n    this.openPopupCount--;\n    if (this.openPopupCount) return;\n    if (this.isAwaitingPopupClose) {\n      // Had completed with an open popup, perform final part of finishing\n      return this.finish();\n    }\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\n    if (!shouldUserInteractWithButton) return;\n    this.updateButtonState();\n    await Adapt.parentView.addChildren();\n  }\n\n  /**\n   * Modify the DOM according to the current button states\n   */\n  updateButtonState() {\n    this.calculateButtonState();\n    const isButtonHidden = !(this.model.get('_isButtonVisible') && !this.model.get('_isButtonAutoHidden'));\n    this.$('.js-trickle-btn-container').toggleClass('u-display-none', isButtonHidden);\n    const isButtonDisabled = this.model.get('_isButtonDisabled');\n    const $button = this.$('.js-trickle-btn');\n    const $ariaLabel = this.$('.aria-label');\n    a11y.toggleEnabled($button, !isButtonDisabled);\n    if (!isButtonDisabled) {\n      // move focus forward if it's on the aria-label\n      if (document.activeElement instanceof HTMLElement && document.activeElement.isSameNode($ariaLabel[0])) {\n        a11y.focusNext($ariaLabel);\n      }\n      // make label unfocusable as it is no longer needed\n      a11y.toggleAccessibleEnabled($ariaLabel, false);\n    }\n    const $buttonText = this.$('.js-trickle-btn-text');\n    const text = this.model.get('buttonText');\n    const ariaLabel = this.model.get('buttonAriaLabel');\n    $buttonText.html(text);\n    $button.attr('aria-label', ariaLabel);\n  }\n\n  /**\n   * Update the button state when any completion changes occur in the trickle button\n   * parent or descendants\n   * @param {ModelEvent} event\n   */\n  async onStepUnlocked(event) {\n    if (event.value === false) return;\n    // Defer to allow for a feedback notify to open\n    _.defer(this.updateButtonState.bind(this));\n  }\n\n  async onButtonClick() {\n    const wasComplete = this.model.get('_isComplete');\n    // Assuming step locking completion is required, setting this model as complete\n    // will cause onParentComplete to fire\n    this.model.setCompletionStatus();\n    this.wasButtonClicked = true;\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\n    if (isStepLockingCompletionRequired && !wasComplete) return;\n    // Assuming step locking completion is NOT required, continue and scroll\n    await this.continue();\n  }\n\n  /**\n   * Fires when all children in the button parent are complete, including the button\n   */\n  async onParentComplete(model, value) {\n    if (!value) return;\n    const parentModel = this.model.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    this.stopListening(parentModel, {\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\n      [`change:${completionAttribute}`]: this.onParentComplete\n    });\n    if (controller.isKilled) return;\n    if (this.openPopupCount > 0) {\n      // Has completed with an open popup, defer finish until popup closed\n      this.isAwaitingPopupClose = true;\n      return;\n    }\n    await this.finish();\n  }\n\n  /**\n   * Stop listening, update the button and continue if required\n   */\n  async finish() {\n    this.stopListening(Adapt, {\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed\n    });\n    this.updateButtonState();\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\n    if (!isStepLockingCompletionRequired) return;\n    // Continue and scroll only if steplocking completion is required\n    await this.continue();\n  }\n\n  /**\n   * Causes Adapt to attempt to render more children and scroll to the next content\n   * element if required\n   */\n  async continue() {\n    const parent = this.model.getParent();\n    await controller.continue();\n    await controller.scroll(parent);\n  }\n\n  tryButtonAutoHide() {\n    if (!this.model.get('_isButtonVisible')) return;\n    const trickleConfig = getModelConfig(this.model.getParent());\n    if (!trickleConfig._button._autoHide) {\n      this.model.set('_isButtonAutoHidden', false);\n      return;\n    }\n    const measurements = this.$el.onscreen();\n    // This is to fix common miscalculation issues\n    const isJustOffscreen = (measurements.bottom > -100);\n    const isButtonAutoHidden = !measurements.onscreen && !isJustOffscreen;\n    this.model.set('_isButtonAutoHidden', isButtonAutoHidden);\n    this.updateButtonState();\n  }\n\n  onRemove() {\n    this.$el.off('onscreen', this.tryButtonAutoHide);\n    this.remove();\n  }\n\n}\n\nTrickleButtonView.template = 'trickle-button';\n\nexport default TrickleButtonView;\n","import controller from './controller';\nimport ComponentModel from 'core/js/models/componentModel';\nimport {\n  getModelContainer,\n  getModelConfig,\n  getCompletionAttribute,\n  applyLocks\n} from './models';\n\nexport default class TrickleButtonModel extends ComponentModel {\n\n  init() {\n    super.init();\n    if (!this.isStepComplete()) return;\n    this.setCompletionStatus();\n  }\n\n  /**\n   * @returns {boolean} true if the button is enabled in its trickle configuration\n   */\n  isEnabled() {\n    const trickleConfig = getModelConfig(this.getParent());\n    const isEnabled = trickleConfig._isEnabled && trickleConfig._button?._isEnabled;\n    return isEnabled;\n  }\n\n  /**\n   * @return {boolean} true if page truncation (step locking) is active\n   */\n  isStepLocking() {\n    const config = getModelConfig(this.getParent());\n    const isStepLocking = config._stepLocking?._isEnabled;\n    return isStepLocking;\n  }\n\n  /**\n   * @return {boolean} true if completion is required to unlock this step\n   */\n  isStepLockingCompletionRequired() {\n    const config = getModelConfig(this.getParent());\n    const isStepLockingCompletionRequired = config._stepLocking &&\n      config._stepLocking._isEnabled &&\n      config._stepLocking._isCompletionRequired;\n    return isStepLockingCompletionRequired;\n  }\n\n  /**\n   * @returns {boolean} true if all available siblings are complete, optional or not available\n   */\n  isStepUnlocked() {\n    const parentModel = this.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    // Check if completion is blocked by another extension\n    const isCompletionBlocked = (parentModel.get('_requireCompletionOf') === Number.POSITIVE_INFINITY);\n    if (isCompletionBlocked) return;\n    return this.getSiblings().every(sibling => {\n      if (sibling === this) {\n        return true;\n      }\n      return sibling.get(completionAttribute) ||\n        sibling.get('_isOptional') ||\n        !sibling.get('_isAvailable');\n    });\n  }\n\n  /**\n   * @returns {boolean} true if the parent container is already complete\n   */\n  isStepComplete() {\n    const parentModel = this.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    const isParentComplete = parentModel.get(completionAttribute);\n    return isParentComplete;\n  }\n\n  /**\n   * @returns {boolean} true if this button should always be locked on revisit\n   */\n  isStepLockedOnRevisit() {\n    const trickleConfig = getModelConfig(this.getParent());\n    return Boolean(trickleConfig._stepLocking._isLockedOnRevisit);\n  }\n\n  /**\n   * @return {boolean} true if completion is not required or if completion has been fulfilled\n   * and the button has been clicked\n   */\n  isFinished() {\n    const isStepUnlocked = this.isStepUnlocked();\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\n    const isButtonComplete = this.get('_isComplete');\n    const isFinished = ((isStepUnlocked || !isStepLockingCompletionRequired) && isButtonComplete);\n    return isFinished;\n  }\n\n  isLastInContentObject() {\n    const contentObject = this.findAncestor('contentobject');\n    const allDescendants = contentObject.getAllDescendantModels(true);\n    const lastDescendant = allDescendants[allDescendants.length - 1];\n    const parentModel = this.getParent();\n    const trickleParent = getModelContainer(parentModel);\n    // Check if completion is blocked by another extension\n    const isParentFinished = (trickleParent.get('_requireCompletionOf') !== Number.POSITIVE_INFINITY);\n    return (isParentFinished && this === lastDescendant);\n  }\n\n  /**\n   * Apply start and final text amongst the current siblings\n   * Siblings in assessments can be randomised so this must be derived at runtime\n   */\n  calculateButtonText() {\n    const parentModel = this.getParent();\n    const trickleConfig = getModelConfig(parentModel);\n    let isStart = false;\n    let isFinal = false;\n    if (trickleConfig._onChildren) {\n      const parentId = parentModel.get('_id');\n      const trickleParent = getModelContainer(parentModel);\n      const trickleSiblings = trickleParent.getAllDescendantModels(true).filter(model => {\n        return model.get('_isAvailable') && model.get('_isTrickled');\n      });\n      const index = trickleSiblings.findIndex(model => model.get('_id') === parentId);\n      isStart = (index === 0);\n      isFinal = (index === trickleSiblings.length - 1 && !trickleParent.get('_canRequestChild'));\n    }\n    const text = (isStart && trickleConfig._button.startText) ?\n      trickleConfig._button.startText :\n      (isFinal && trickleConfig._button.finalText) ?\n        trickleConfig._button.finalText :\n        trickleConfig._button.text;\n    const ariaLabel = (isStart && trickleConfig._button.startAriaLabel) ?\n      trickleConfig._button.startAriaLabel :\n      (isFinal && trickleConfig._button.finalAriaLabel) ?\n        trickleConfig._button.finalAriaLabel :\n        trickleConfig._button.ariaLabel;\n    this.set({\n      buttonText: text,\n      buttonAriaLabel: ariaLabel\n    });\n  }\n\n  /**\n   * Will reset this button if the step has been unlocked and should be relocked\n   * on revisit\n   */\n  checkIfResetOnRevisit() {\n    if (this.isFinished() && !this.isStepLockedOnRevisit()) return;\n    if (!this.get('_isComplete') && !this.get('_isInteractionComplete')) return;\n    this.set({\n      _isComplete: false,\n      _isInteractionComplete: false\n    });\n    applyLocks();\n  }\n\n  /**\n   * Calculate the current button visible and enabled states\n   * @param {boolean} isButtonDisableForced Set to true to signify that the button must not be enabled\n   * @param {boolean} isButtonHiddenForced Set to true to signify that the button must not be visible\n   */\n  calculateButtonState(isButtonDisableForced = false, isButtonHiddenForced = false) {\n    if (!this.isEnabled()) {\n      this.set({\n        _isButtonVisible: false,\n        _isButtonDisabled: !this.isStepUnlocked()\n      });\n      return;\n    };\n\n    const trickleConfig = getModelConfig(this.getParent());\n    if (this.isLastInContentObject() && trickleConfig._button._showEndOfPage === false) {\n      return this.set({\n        _isButtonVisible: false,\n        _isButtonDisabled: true\n      });\n    }\n\n    const isTrickleKilled = controller.isKilled;\n    const isStepUnlocked = this.isStepUnlocked() || isTrickleKilled;\n    const isFinished = this.isFinished() || isTrickleKilled;\n    const isButtonVisibleBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'hidden');\n    // Force button to be hidden after completion if _isFullWidth, otherwise absolutely positioned buttons will stack\n    const isButtonVisibleAfterCompletion = (trickleConfig._button._styleAfterClick !== 'hidden') && !trickleConfig._button._isFullWidth;\n\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\n\n    const isNoCompletionRequiredAndLockedVisible = (!isStepLockingCompletionRequired && !isFinished && isButtonVisibleBeforeCompletion);\n    const isNoCompletionRequiredAndUnlockedVisible = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n    const isNoCompletionRequiredAndFinishedVisible = (!isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\n    const isStepLockedAndVisibleBeforeCompletion = (isStepLockingCompletionRequired && !isStepUnlocked && isButtonVisibleBeforeCompletion && !isButtonHiddenForced);\n    const isFinishedAndVisibleAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\n    const isStepUnlockedAndButtonIncomplete = (isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n\n    const isButtonVisible = isNoCompletionRequiredAndLockedVisible ||\n      isNoCompletionRequiredAndUnlockedVisible ||\n      isNoCompletionRequiredAndFinishedVisible ||\n      isStepLockedAndVisibleBeforeCompletion ||\n      isFinishedAndVisibleAfterCompletion ||\n      isStepUnlockedAndButtonIncomplete;\n\n    const isButtonEnabledBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'disabled');\n    const isButtonEnabledAfterCompletion = (trickleConfig._button._styleAfterClick !== 'disabled');\n\n    const isNoCompletionRequiredAndLockedEnabled = (!isStepLockingCompletionRequired && !isFinished && isButtonEnabledBeforeCompletion);\n    const isNoCompletionRequiredAndUnlockedEnabled = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n    const isNoCompletionRequiredAndFinishedEnabled = (!isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\n    const isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced = (isStepLockingCompletionRequired && isStepUnlockedAndButtonIncomplete && !isButtonDisableForced);\n    const isFinishedAndEnabledAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\n\n    const isButtonEnabled = isNoCompletionRequiredAndLockedEnabled ||\n      isNoCompletionRequiredAndUnlockedEnabled ||\n      isNoCompletionRequiredAndFinishedEnabled ||\n      isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced ||\n      isFinishedAndEnabledAfterCompletion ||\n      false;\n\n    this.set({\n      _isButtonVisible: isButtonVisible,\n      _isButtonDisabled: !isButtonEnabled\n    });\n  }\n\n}\n","import components from 'core/js/components';\nimport TrickleButtonView from './TrickleButtonView';\nimport TrickleButtonModel from './TrickleButtonModel';\n\nexport default components.register('trickle-button', {\n  view: TrickleButtonView,\n  model: TrickleButtonModel\n});\n","import Adapt from 'core/js/adapt';\nimport controller from './controller';\nimport models from './models';\nimport trickleButton from './trickleButton';\nimport TrickleButtonModel from './TrickleButtonModel';\nimport TrickleButtonView from './TrickleButtonView';\n\n// Export main API\nexport default (Adapt.trickle = controller);\n\n// Export everything\nexport {\n  controller,\n  models,\n  trickleButton,\n  TrickleButtonModel,\n  TrickleButtonView\n};\n","const TUTOR_TYPE = ENUM([\n  'NOTIFY',\n  'INLINE',\n  'OVERLAY',\n  'NONE'\n]);\n\nexport default TUTOR_TYPE;\n","import Adapt from 'core/js/adapt';\nimport TUTOR_TYPE from './TUTOR_TYPE';\n\nexport default class TutorModel extends Backbone.Model {\n\n  defaults() {\n    return {\n      _type: TUTOR_TYPE.NOTIFY.asLowerCase,\n      _classes: '',\n      _hasNotifyBottomButton: false,\n      _button: {\n        text: '{{_globals._extensions._tutor.hideFeedback}}',\n        ariaLabel: '{{_globals._extensions._tutor.hideFeedback}}'\n      },\n      ...Adapt.course.get('_tutor')\n    };\n  }\n\n  initialize(data, parentModel) {\n    data = $.extend(true, this.defaults(), data?._isInherited === true ? null : data, {\n      _attributes: { 'data-adapt-id': parentModel.get('_id') },\n      _id: parentModel.get('_id'),\n      _shouldRenderId: false,\n      ...(\n        parentModel.getFeedback?.() ||\n        {\n          altTitle: parentModel.get('altFeedbackTitle'),\n          title: parentModel.get('feedbackTitle'),\n          body: parentModel.get('feedbackMessage')\n        }\n      )\n    });\n    data._classes += ` tutor ${this.getOriginClasses(parentModel)}`;\n    this.set(data);\n  }\n\n  getOriginClasses(model) {\n    const component = model.get('_component');\n    const extension = model.get('_extension');\n\n    return [\n      model.get('_isCorrect') ?\n        'is-correct' :\n        model.get('_isAtLeastOneCorrectSelection') ?\n          'is-partially-correct' :\n          'is-incorrect',\n      component && `is-component is-${component}`,\n      extension && `is-extension is-${extension}`\n    ].filter(Boolean).join(' ');\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport notify from 'core/js/notify';\n\nexport default class TutorNotify extends Backbone.Controller {\n\n  initialize(options) {\n    this.parentView = options.parentView;\n    this.listenToOnce(Adapt, 'notify:closed', this.onNotifyClosed);\n    this.triggerNotify();\n  }\n\n  triggerNotify() {\n    const {\n      _hasNotifyBottomButton: isButtonEnabled,\n      _button: { text: promptText }\n    } = this.model.toJSON();\n\n    this.notifyOptions = {\n      ...this.model.toJSON(),\n      _prompts: isButtonEnabled && [{\n        promptText: Handlebars.compile(promptText)({ _globals: Adapt.course.get('_globals') })\n      }],\n      _type: isButtonEnabled ? 'prompt' : 'popup'\n    };\n\n    notify.create(this.notifyOptions);\n    Adapt.trigger('tutor:opened', this.parentView, this.notifyOptions);\n  }\n\n  onNotifyClosed() {\n    Adapt.trigger('tutor:closed', this.parentView, this.notifyOptions);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\nimport a11y from 'core/js/a11y';\n\nexport default class TutorView extends Backbone.View {\n\n  className() {\n    return [\n      'tutor',\n      `tutor-type-${this.model.get('_type')}`,\n      this.model.get('_classes')\n    ].join(' ');\n  }\n\n  events() {\n    return { 'click .js-tutor-btn': 'onCloseClick' };\n  }\n\n  initialize(options) {\n    this.parentView = options.parentView;\n    this.buttonsView = this.parentView.buttonsView;\n    this.listenTo(this.parentView, 'postRemove', this.onTutorClosed);\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonsStateUpdate);\n    this.render();\n  }\n\n  render() {\n    this.$el.html(Handlebars.templates.tutor(this.model.toJSON()));\n    _.defer(this.postRender.bind(this));\n  }\n\n  postRender() {\n    this.toggleFeedback({ shouldOpen: true });\n  }\n\n  toggleFeedback({ shouldOpen, shouldManageFocus = true } = {}) {\n    const animation = this.model.get('_type') === 'inline' ? 'slide' : 'fade';\n\n    const onAnimationEnd = shouldOpen ?\n      this.onTutorOpened.bind(this, shouldManageFocus) :\n      this.onTutorClosed.bind(this, shouldManageFocus);\n\n    if (shouldManageFocus) {\n      a11y.toggleEnabled(this.buttonsView.$('.js-btn-feedback'), !shouldOpen);\n    }\n\n    this.$('.tutor__inner').stop()[`${animation}Toggle`](200, onAnimationEnd);\n  }\n\n  onCloseClick() {\n    this.toggleFeedback({ shouldOpen: false });\n  }\n\n  onTutorOpened(shouldManageFocus) {\n    if (shouldManageFocus) {\n      a11y.focus(this.$('.tutor__inner'), { defer: true, preventScroll: true });\n    }\n    Adapt.trigger('tutor:opened', this.parentView, this.model.toJSON());\n  }\n\n  onTutorClosed(shouldManageFocus) {\n    if (shouldManageFocus) {\n      const $showFeedbackButton = this.buttonsView.$('.js-btn-feedback');\n      a11y.focus($showFeedbackButton, { defer: true, preventScroll: true });\n    }\n    Adapt.trigger('tutor:closed', this.parentView, this.model.toJSON());\n    this.remove();\n  }\n\n  onButtonsStateUpdate(state) {\n    if (state !== BUTTON_STATE.RESET) return;\n    this.toggleFeedback({ shouldOpen: false, shouldManageFocus: false });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport TutorModel from './TutorModel';\nimport TutorNotify from './TutorNotify';\nimport TutorView from './TutorView';\nimport TUTOR_TYPE from './TUTOR_TYPE';\n\nclass Tutor extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'questionView:showFeedback', this.onQuestionViewShowFeedback);\n  }\n\n  onQuestionViewShowFeedback(view) {\n    const parentModel = view.model;\n    const tutorModel = new TutorModel(parentModel.get('_tutor'), parentModel);\n    const options = { model: tutorModel, parentView: view };\n\n    switch (TUTOR_TYPE(tutorModel.get('_type').toUpperCase())) {\n      case TUTOR_TYPE.NOTIFY:\n        new TutorNotify(options);\n        break;\n      case TUTOR_TYPE.INLINE:\n      case TUTOR_TYPE.OVERLAY:\n        view.$('.component__inner').append(new TutorView(options).$el);\n        break;\n      case TUTOR_TYPE.NONE:\n      default:\n        // do nothing\n    }\n  }\n\n}\n\nexport default (Adapt.tutor = new Tutor());\n","import Adapt from 'core/js/adapt';\nimport Backbone from 'backbone';\nimport { templates } from 'core/js/reactHelpers';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nclass CourseNotesView extends Backbone.View {\n\n  className() { return 'coursenotes'; }\n\n  initialize() {\n    this.listenTo(Adapt, 'remove', this.remove);\n    this.render();\n  }\n\n  render() {\n    const props = { ...this.model.toJSON() };\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\n    ReactDOM.render(<Template {...props} />, this.el);\n    return this;\n  }\n\n}\n\nCourseNotesView.template = 'courseNotes';\n\nexport default CourseNotesView;\n","\nimport { templates } from 'core/js/reactHelpers';\nimport Adapt from 'core/js/adapt';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nclass CourseNotesNavView extends Backbone.View {\n  tagName() {\n    return 'button';\n  }\n\n  className() {\n    return 'btn-icon nav__btn coursenotes__nav-btn';\n  }\n\n  attributes() {\n    return {\n      'aria-label': (Adapt.course.get('_globals')?._extensions?._courseNotes?.buttonNav || 'Open Course Notes')\n    };\n  }\n\n  events() {\n    return {\n      click: 'onClick'\n    };\n  }\n\n  initialize() {\n\n    this.onClick = this.onClick.bind(this);\n    this.render();\n  }\n\n  render() {\n    const props = { ...this.model.toJSON() };\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\n    ReactDOM.render(<Template {...props} />, this.el);\n  }\n\n  onClick(event) {\n    if (event && event.preventDefault) event.preventDefault();\n    Adapt.trigger('courseNotes:open');\n  }\n}\nCourseNotesNavView.template = 'courseNotesNav';\nexport default CourseNotesNavView;\n","import Adapt from 'core/js/adapt';\nimport Backbone from 'backbone';\nimport notify from 'core/js/notify';\nimport CourseNotesView from './CourseNotesView';\nimport CourseNotesNavView from './CourseNotesNavView';\nclass CourseNotes extends Backbone.Controller {\n  initialize() {\n    this.listenTo(Adapt, 'app:dataReady', this.onDataReady);\n  }\n\n  onDataReady() {\n    if (!this.checkIsEnabled()) return;\n    this.setupEventListeners();\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      'adapt:initialize': this.onInitialize,\n      'courseNotes:open': this.openCourseNotes,\n      'pageView:ready': this.handlePageViewReady,\n      'pageView:preRemove': this.handlePageViewPreRemove\n    });\n  }\n\n  onInitialize() {\n    this._isPopupOpen = false;\n    const navView = new CourseNotesNavView({ model: new Backbone.Model(Adapt.course.get('_courseNotes')) });\n    $('.nav__drawer-btn').after(navView.el);\n  }\n\n  openCourseNotes() {\n    if (this._isPopupOpen) return;\n\n    this._isPopupOpen = true;\n\n    this.popupView = new CourseNotesView({ model: new Backbone.Model(Adapt.course.get('_courseNotes')) });\n\n    notify.popup({\n      _attributes: { 'data-adapt-id': 'coursenotes' },\n      _view: this.popupView,\n      _isCancellable: true,\n      _showCloseButton: true,\n      _classes: 'coursenotes'\n    });\n\n    this.listenToOnce(Adapt, {\n      'popup:closed': this.closeCourseNotes\n    });\n  }\n\n  closeCourseNotes() {\n    this._isPopupOpen = false;\n  }\n\n  handleClick(event) {\n    event && event.preventDefault();\n    Adapt.trigger('courseNotes:open');\n  }\n\n  handlePageViewReady(view) {\n    $('.js-coursenotes-click').on('click', this.handleClick.bind(this));\n  }\n\n  handlePageViewPreRemove() {\n    $('.js-coursenotes-click').off('click', this.handleClick.bind(this));\n  }\n\n  checkIsEnabled() {\n    const _model = Adapt.course.get('_courseNotes');\n    if (!_model || !_model._isEnabled) return false;\n    return true;\n  }\n}\nexport default new CourseNotes();\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n\n  const DevtoolsModel = Backbone.Model.extend({\n\n    initialize: function() {\n      const config = Adapt.config.has('_devtools') ? Adapt.config.get('_devtools') : this.getDefaultConfig();\n      this.set(_.extend({\n        _trickleEnabled: false,\n        _hintingAvailable: true,\n        _hintingEnabled: false,\n        _toggleFeedbackAvailable: true,\n        _feedbackEnabled: true,\n        _autoCorrectAvailable: true,\n        _autoCorrectEnabled: false,\n        _altTextAvailable: true,\n        _altTextEnabled: false,\n        _tutorListener: null,\n        _unlockAvailable: true,\n        _unlocked: false,\n        _toggleBankingAvailable: true,\n        _traceFocusAvailable: true,\n        _traceFocusEnabled: false,\n        _extended: true\n      }, config));\n    },\n\n    getDefaultConfig: function() {\n      return {\n        _isEnabled: false,\n        _extended: true\n      };\n    },\n\n    toggleFeedback: function() {\n      this.set('_feedbackEnabled', !this.get('_feedbackEnabled'));\n    },\n\n    toggleHinting: function() {\n      this.set('_hintingEnabled', !this.get('_hintingEnabled'));\n    },\n\n    toggleAutoCorrect: function() {\n      this.set('_autoCorrectEnabled', !this.get('_autoCorrectEnabled'));\n    },\n\n    toggleAltText: function() {\n      this.set('_altTextEnabled', !this.get('_altTextEnabled'));\n    },\n\n    toggleTraceFocus: function() {\n      this.set('_traceFocusEnabled', !this.get('_traceFocusEnabled'));\n    }\n  });\n\n  return DevtoolsModel;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n\n  const Hinting = _.extend({\n\n    initialize: function() {\n      this.listenTo(Adapt.devtools, 'change:_hintingEnabled', this.toggleHints);\n    },\n\n    toggleHints: function() {\n      const contentObject = Adapt.findById(Adapt.location._currentId);\n      const components = contentObject.findDescendantModels('components');\n      const renderedQuestions = _.filter(components, function(m) {\n        return m.get('_isQuestionType') === true && m.get('_isReady') === true;\n      });\n\n      _.each(renderedQuestions, function(model) {\n        this.setHinting($('.' + model.get('_id')), model, Adapt.devtools.get('_hintingEnabled'));\n      }, this);\n\n      if (Adapt.devtools.get('_hintingEnabled')) this.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n      else this.stopListening(Adapt, 'componentView:postRender');\n    },\n\n    onComponentRendered: function(view, hintingEnabled) {\n      if (view.model.get('_isQuestionType')) this.setHinting(view.$el, view.model);\n    },\n\n    setHinting: function($el, model, hintingEnabled) {\n      switch (model.get('_component')) {\n        case 'mcq':this.setMcqHinting($el, model, hintingEnabled !== false); break;\n        case 'gmcq':this.setGmcqHinting($el, model, hintingEnabled !== false); break;\n        case 'matching':this.setMatchingHinting($el, model, hintingEnabled !== false); break;\n        case 'ppq':this.setPpqHinting($el, model, hintingEnabled !== false); break;\n        case 'slider':this.setSliderHinting($el, model, hintingEnabled !== false); break;\n        case 'textinput':this.setTextInputHinting($el, model, hintingEnabled !== false); break;\n        case 'questionStrip':this.setQuestionStripHinting($el, model, hintingEnabled !== false); break;\n      }\n    },\n\n    setMcqHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          $el.find('.js-mcq-item').eq(index).addClass(item._shouldBeSelected ? 'hint-is-correct' : 'hint-is-incorrect');\n        });\n      } else {\n        $el.find('.js-mcq-item').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setGmcqHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          $el.find('.js-mcq-item').eq(index).addClass(item._shouldBeSelected ? 'hint-is-correct' : 'hint-is-incorrect');\n        });\n      } else {\n        $el.find('.js-mcq-item').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setMatchingHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, itemIndex) {\n          const $item = $el.find('.item').eq(itemIndex);\n          const $options = $item.find('.js-dropdown-list-item');\n          _.each(item._options, function(option, optionIndex) {\n            /* if (Modernizr.touch) { */\n            if (option._isCorrect) $options.eq(optionIndex + 1).find('.js-dropdown-list-item-inner').append('<span class=\"hint\"> (correct)</span>');\n            /* }\n            else {\n              $options.eq(optionIndex+1).addClass(option._isCorrect ? 'hintCorrect' : 'hintIncorrect');\n            } */\n          });\n        });\n      } else {\n        /* if (Modernizr.touch) */\n        $el.find('.js-dropdown-list-item-inner .hint').remove();\n        /* else $el.find('option').removeClass('hintCorrect hintIncorrect'); */\n      }\n    },\n\n    setSliderHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        const correctAnswer = model.get('_correctAnswer');\n        if (correctAnswer) {\n          $el.find('.js-slider-number').addClass('hint-is-incorrect');\n          $el.find('.js-slider-number[data-id=\"' + correctAnswer + '\"]').removeClass('hint-is-incorrect').addClass('hint-is-correct');\n        } else {\n          $el.find('.js-slider-number').addClass('hint-is-incorrect');\n          const bottom = model.get('_correctRange')._bottom;\n          const top = model.get('_correctRange')._top;\n          for (let i = bottom; i <= top; i++) { $el.find('.js-slider-number[data-id=\"' + i + '\"]').removeClass('hint-is-incorrect').addClass('hint-is-correct'); }\n        }\n      } else {\n        $el.find('.js-slider-number').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setTextInputHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          if (model.get('_answers')) {\n            // generic answers\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', model.get('_answers')[index][0]);\n          } else {\n            // specific answers\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', item._answers[0]);\n          }\n        });\n      } else {\n        _.each(model.get('_items'), function(item, index) {\n          if (model.get('_answers')) {\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', item.placeholder);\n          }\n        });\n      }\n    },\n\n    // --------------------------------------------------\n    // --------------------------------------------------\n    // NEEDS UPDATING?\n    // --------------------------------------------------\n    // --------------------------------------------------\n    setQuestionStripHinting: function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, itemIndex) {\n          const $item = $el.find('.component-item').eq(itemIndex);\n          const $subItems = $item.find('.qs-strapline-header-inner:not(.qs-noop) .qs-strapline-title-inner');\n          _.each(item._subItems, function(subItem, subItemIndex) {\n            if (subItem._isCorrect) $subItems.eq(subItemIndex).append('<span class=\"hint\"> (correct)</span>');\n          });\n        });\n      } else {\n        $el.find('.qs-strapline-title-inner .hint').remove();\n      }\n    },\n\n    setPpqHinting: function($el, model, hintingEnabled) {\n      console.log('setPpqHinting', hintingEnabled);\n      if (!model.get('_developerMode')) {\n        $el.find('.ppq-correct-zone').toggleClass('display-none', !hintingEnabled);\n        $el.find('.ppq-pinboard').toggleClass('developer-mode', hintingEnabled);\n      }\n    }\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    Hinting.initialize();\n  });\n\n  return Hinting;\n\n});\n","define([], function(require) {\n\n  function isQuestionSupported(model) {\n    switch (model.get('_component')) {\n      case 'mcq':\n      case 'gmcq':\n      case 'matching':\n      case 'ppq':\n      case 'slider':\n      case 'textinput':\n      case 'questionStrip':return true;\n      default: return false;\n    }\n  }\n\n  return isQuestionSupported;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n  let ItemsQuestionModel;\n  const Hinting = require('./hinting');\n  const isQuestionSupported = require('./is-question-supported');\n\n  const AutoAnswer = _.extend({\n\n    mousedownHandlers: [],\n\n    initialize: function() {\n      this.listenTo(Adapt, {\n        'componentView:postRender': this.componentRendered,\n        remove: this.onRemove\n      });\n    },\n\n    componentRendered: function(view) {\n      if (isQuestionSupported(view.model)) {\n        if (view.buttonsView) {\n          const handler = _.bind(this.onQuestionMouseDown, this, view);\n          view.$el.on('mousedown', handler);\n          this.mousedownHandlers.push({\n            element: view.$el,\n            handler: handler\n          });\n        } else if (Adapt.devtools.get('_debug')) {\n          console.warn('adapt-devtools: could not find submit button on ' + view.model.get('_id'));\n        }\n      }\n    },\n\n    onQuestionMouseDown: function(view, e) {\n      // remove hinting if enabled\n      if (Adapt.devtools.get('_hintingEnabled')) Hinting.setHinting(view.$el, view.model, false);\n\n      if ((e.ctrlKey && !e.shiftKey) || Adapt.devtools.get('_autoCorrectEnabled')) {\n        this.answer(view);\n      } else if (e.ctrlKey && e.shiftKey) {\n        this.answer(view, true);\n      }\n    },\n\n    isItemsQuestionModel: function(model) {\n      if (ItemsQuestionModel) {\n        return model instanceof ItemsQuestionModel;\n      } else if (ItemsQuestionModel === null) {\n        return false;\n      }\n\n      if (require.defined('core/js/models/' + 'itemsQuestionModel')) {\n        ItemsQuestionModel = require('core/js/models/' + 'itemsQuestionModel');\n        return model instanceof ItemsQuestionModel;\n      } else {\n        ItemsQuestionModel = null;\n        return false;\n      }\n    },\n\n    answer: function(view, incorrectly) {\n      if (view.model.get('_isSubmitted')) return;\n\n      if (Adapt.devtools.get('_debug')) {\n        console.log('adapt-devtools: answer ' + view.model.get('_id') + (incorrectly === true ? ' incorrectly' : ''));\n      }\n\n      if (incorrectly === true) {\n        switch (view.model.get('_component')) {\n          case 'mcq':this.answerMultipleChoiceIncorrectly(view); break;\n          case 'gmcq':this.answerMultipleChoiceIncorrectly(view, true); break;\n          case 'matching':this.answerMatchingIncorrectly(view); break;\n          case 'ppq':this.answerPpqIncorrectly(view); break;\n          case 'slider':this.answerSliderIncorrectly(view); break;\n          case 'textinput':this.answerTextInputIncorrectly(view); break;\n          case 'questionStrip':this.answerQuestionStripIncorrectly(view); break;\n          default:this.answerUnsupportedIncorrectly(view);\n        }\n      } else {\n        switch (view.model.get('_component')) {\n          case 'mcq':this.answerMultipleChoice(view); break;\n          case 'gmcq':this.answerMultipleChoice(view, true); break;\n          case 'matching':this.answerMatching(view); break;\n          case 'ppq':this.answerPpq(view); break;\n          case 'slider':this.answerSlider(view); break;\n          case 'textinput':this.answerTextInput(view); break;\n          case 'questionStrip':this.answerQuestionStrip(view); break;\n          default:this.answerUnsupported(view);\n        }\n      }\n\n      view.$('.js-btn-action').trigger('click');\n    },\n\n    answerMultipleChoice: function(view, isGraphical) {\n      const items = this.isItemsQuestionModel(view.model) ? view.model.getChildren().toJSON() : view.model.get('_items');\n      const noCorrectOptions = _.where(items, { _shouldBeSelected: true }).length == 0;\n\n      if (this.isItemsQuestionModel(view.model)) {\n        if (noCorrectOptions) {\n          view.model.getItem(_.random(items.length - 1)).set('_isActive', true);\n        } else {\n          view.model.getChildren().forEach(item => {\n            if (item.get('_shouldBeSelected') && !item.get('_isActive') || !item.get('_shouldBeSelected') && item.get('_isActive')) {\n              item.toggleActive();\n            }\n          });\n        }\n        return;\n      }\n\n      if (noCorrectOptions) {\n        if (_.where(items, { _isSelected: true }).length == 0) {\n          view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(_.random(items.length - 1)).trigger('change');\n        }\n      } else {\n        _.each(items, function(item, index) {\n          if (item._shouldBeSelected && !item._isSelected || !item._shouldBeSelected && item._isSelected) {\n            view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(index).trigger('change');\n          }\n        });\n      }\n    },\n\n    answerMultipleChoiceIncorrectly: function(view, isGraphical) {\n      const model = view.model;\n      const items = this.isItemsQuestionModel(model) ? model.getChildren().toJSON() : model.get('_items');\n      const itemCount = items.length;\n      const selectionStates = _.times(itemCount, function() { return false; });\n      // number of items that should be selected\n      const nShould = _.where(items, { _shouldBeSelected: true }).length;\n      // and number that should not\n      const nShouldNot = itemCount - nShould;\n      // decide how many items to select\n      const nSelect = model.get('_selectable');\n      // decide how many of these should be incorrect\n      const nIncorrect = nShouldNot == 0 ? 0 : _.random(nShould == 1 ? 1 : 0, Math.min(nShouldNot, nSelect));\n      // and how many should be correct\n      const nCorrect = nIncorrect == 0 ? _.random(1, Math.min(nShould - 1, nSelect)) : _.random(0, Math.min(nShould, nSelect - nIncorrect));\n\n      if (itemCount == 1 || nSelect == 0) {\n        console.warn('adapt-devtools: not possible to answer ' + model.get('_id') + ' incorrectly');\n        return;\n      }\n\n      for (var j = 0; j < nIncorrect; j++) {\n        // start at a random position in items to avoid bias (err is contingency for bad data)\n        for (var k = _.random(itemCount), err = itemCount, found = false; !found && err >= 0; k++, err--) {\n          var index = k % itemCount;\n          if (selectionStates[index] === false) {\n            if (!items[index]._shouldBeSelected) selectionStates[index] = found = true;\n          }\n        }\n      }\n      for (var j = 0; j < nCorrect; j++) {\n        // start at a random position in items to avoid bias (err is contingency for bad data)\n        for (var k = _.random(itemCount), err = itemCount, found = false; !found && err >= 0; k++, err--) {\n          var index = k % itemCount;\n          if (selectionStates[index] === false) {\n            if (items[index]._shouldBeSelected) selectionStates[index] = found = true;\n          }\n        }\n      }\n\n      if (this.isItemsQuestionModel(view.model)) {\n        view.model.getChildren().forEach((item, index) => {\n          if (selectionStates[index] && !item.get('_isActive') || !selectionStates[index] && item.get('_isActive')) {\n            item.toggleActive();\n          }\n        });\n        return;\n      }\n\n      _.each(items, function(item, index) {\n        if (selectionStates[index] && !item._isSelected || !selectionStates[index] && item._isSelected) {\n          view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(index).trigger('change');\n        }\n      });\n    },\n\n    answerMatching: function(view) {\n      _.each(view.model.get('_items'), function(item, itemIndex) {\n        const noCorrectOptions = _.where(item._options, { _isCorrect: true }).length == 0;\n\n        if (noCorrectOptions) {\n          if (!view.dropdowns[itemIndex].getFirstSelectedItem()) {\n            const i = _.random(item._options.length - 1);\n            if (view.model.setActiveOption) {\n              view.model.setActiveOption(item._options[i]._index);\n            } else {\n              view.selectValue(itemIndex, i);\n            }\n          }\n        } else {\n          _.each(item._options, function(option, optionIndex) {\n            if (option._isCorrect) {\n              if (view.model.setActiveOption) {\n                view.model.setActiveOption(option._index);\n              } else {\n                view.selectValue(itemIndex, option._index);\n              }\n            }\n          });\n        }\n      });\n    },\n\n    answerMatchingIncorrectly: function(view) {\n      const items = view.model.get('_items'); const itemCount = items.length; const nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      const selectionStates = _.shuffle(_.times(itemCount, function(i) { return i < nIncorrect; }));\n\n      _.each(items, function(item, itemIndex) {\n        const $select = view.$('select').eq(itemIndex);\n        const $options = $select.find('option');\n        // check if this item is to be answered incorrectly\n        if (selectionStates[itemIndex]) {\n          // start at a random position in options to avoid bias (err is contingency for bad data)\n          for (let count = item._options.length, i = _.random(count), err = count; err >= 0; i++, err--) {\n            if (!item._options[i % count]._isCorrect) {\n              const option = item._options[i % count];\n              if (view.model.setActiveOption) {\n                view.model.setActiveOption(option._index);\n              } else if (view.selectValue) {\n                view.selectValue(itemIndex, option._index);\n              } else if (view.model.setOptionSelected) {\n                $select.val(option.text);\n                $select.trigger('change');\n                view.model.setOptionSelected(itemIndex, i % count, true);\n              } else {\n                $options.eq((i % count) + 1).prop('selected', true);\n              }\n              return;\n            }\n          }\n        } else {\n          _.each(item._options, function(option, optionIndex) {\n            if (option._isCorrect) {\n              if (view.model.setActiveOption) {\n                view.model.setActiveOption(option._index);\n              } else if (view.selectValue) {\n                view.selectValue(itemIndex, option._index);\n              } else if (view.model.setOptionSelected) {\n                $select.val(option.text);\n                $select.trigger('change');\n                view.model.setOptionSelected(itemIndex, optionIndex, true);\n              } else {\n                $options.eq(optionIndex + 1).prop('selected', true);\n              }\n            }\n          });\n        }\n      });\n    },\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n    answerSlider: function(view) {\n      const correctAnswer = view.model.get('_correctAnswer');\n      if (correctAnswer) {\n        view.$('.js-slider-number[data-id=\"' + correctAnswer + '\"]').trigger('click');\n      } else {\n        const bottom = view.model.get('_correctRange')._bottom;\n        const top = view.model.get('_correctRange')._top;\n        const d = top - bottom;\n        // select from range at random\n        view.$('.js-slider-number[data-id=\"' + (bottom + Math.floor(Math.random() * (d + 1))) + '\"]').trigger('click');\n      }\n    },\n\n    answerSliderIncorrectly: function(view) {\n      const correctAnswer = view.model.get('_correctAnswer');\n      const start = view.model.get('_scaleStart'); const end = view.model.get('_scaleEnd');\n      const incorrect = _.times(end - start + 1, function(i) { return start + i; });\n      if (correctAnswer) {\n        incorrect.splice(correctAnswer - start, 1);\n      } else {\n        const bottom = view.model.get('_correctRange')._bottom;\n        const top = view.model.get('_correctRange')._top;\n        incorrect.splice(bottom - start, top - bottom + 1);\n      }\n      view.$('.js-slider-number[data-id=\"' + _.shuffle(incorrect)[0] + '\"]').trigger('click');\n    },\n\n    answerTextInput: function(view) {\n      const answers = view.model.get('_answers');\n      _.each(view.model.get('_items'), function(item, index) {\n        if (answers) view.$('.js-textinput-textbox').eq(index).val(answers[index][0]).trigger('change'); // generic answers\n        else view.$('.js-textinput-textbox').eq(index).val(item._answers[0]).trigger('change'); // specific answers\n      });\n    },\n\n    answerTextInputIncorrectly: function(view) {\n      const items = view.model.get('_items'); const itemCount = items.length; const nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      const selectionStates = _.shuffle(_.times(itemCount, function(i) { return i < nIncorrect; }));\n      const answers = view.model.get('_answers');\n      _.each(items, function(item, index) {\n        if (selectionStates[index]) {\n          view.$('.js-textinput-textbox').eq(index).val('***4n 1nc0rr3ct 4nsw3r***').trigger('change'); // probably\n        } else {\n          if (answers) view.$('.js-textinput-textbox').eq(index).val(answers[index][0]).trigger('change');\n          else view.$('.js-textinput-textbox').eq(index).val(item._answers[0]).trigger('change');\n        }\n      });\n    },\n\n    // --------------------------------------------------\n    // --------------------------------------------------\n    // NEEDS UPDATING?\n    // --------------------------------------------------\n    // --------------------------------------------------\n    answerQuestionStrip: function(view) {\n      _.each(view.model.get('_items'), function(item, itemIndex) {\n        _.each(item._subItems, function(subItem, subItemIndex) {\n          if (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n        });\n      });\n    },\n\n    answerQuestionStripIncorrectly: function(view) {\n      const items = view.model.get('_items'); const itemCount = items.length; const nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      const selectionStates = _.shuffle(_.times(itemCount, function(i) { return i < nIncorrect; }));\n\n      _.each(items, function(item, itemIndex) {\n        // check if this item is to be answered incorrectly\n        if (selectionStates[itemIndex]) {\n          // start at a random position in subitems to avoid bias (err is contingency for bad data)\n          for (let count = item._subItems.length, i = _.random(count), err = count; err >= 0; i++, err--) {\n            if (!item._subItems[i % count]._isCorrect) {\n              view.setStage(itemIndex, i % count, true);\n              return;\n            }\n          }\n        } else {\n          _.each(item._subItems, function(subItem, subItemIndex) {\n            if (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n          });\n        }\n      });\n    },\n\n    answerPpq: function(view) {\n      const model = view.model; var items = model.get('_items'); const itemCount = items.length;\n      // determine screen size\n      const isDesktop = Adapt.device.screenSize != 'small';\n      // select appropriate pinboard\n      var items = _.pluck(model.get('_items'), isDesktop ? 'desktop' : 'mobile');\n\n      const $pinboard = view.$('.ppq-pinboard');\n      const boardw = $pinboard.width();\n      const boardh = $pinboard.height();\n\n      for (i = 0; i < itemCount; i++) {\n        const zone = items[i];\n        const pin = view.getNextUnusedPin();\n        const x = zone.left + zone.width / 2;\n        const y = zone.top + zone.height / 2;\n\n        console.log('using correct position', x + ',' + y);\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          left: boardw * x / 100 - pin.$el.width() / 2,\n          top: boardh * y / 100 - pin.$el.height()\n        });\n      }\n    },\n\n    answerPpqIncorrectly: function(view) {\n      const model = view.model; var items = model.get('_items'); const itemCount = items.length;\n      // determine screen size\n      const isDesktop = Adapt.device.screenSize != 'small';\n      // select appropriate pinboard\n      var items = _.pluck(model.get('_items'), isDesktop ? 'desktop' : 'mobile');\n      // decide how many items to select\n      const nSelect = _.random(model.get('_minSelection'), model.get('_maxSelection'));\n      // decide how many of these should be incorrect\n      const nIncorrect = _.random(1, nSelect);\n      // and how many should be correct\n      const nCorrect = nSelect - nIncorrect;\n\n      const $pinboard = view.$('.ppq-pinboard');\n      const boardw = $pinboard.width();\n      const boardh = $pinboard.height();\n\n      console.log('nIncorrect=', nIncorrect, 'nCorrect=', nCorrect);\n\n      const maxSize = function(zone) {\n        return zone.left < 1 && zone.top < 1 && zone.width > 9999 && zone.height > 9999;\n      };\n\n      // work with integers for accuracy and simplicity\n      items = _.map(items, function(item) {\n        return {\n          left: Math.round(item.left * 100),\n          top: Math.round(item.top * 100),\n          width: Math.round(item.width * 100),\n          height: Math.round(item.height * 100)\n        };\n      });\n\n      if (_.some(items, maxSize) || nSelect == 0) {\n        console.warn('adapt-devtools: not possible to answer ' + model.get('_id') + ' incorrectly');\n        return;\n      }\n\n      view.resetPins();\n\n      // simplified approach for readability; statistically probable that finding pin positions will be extremely quick\n\n      for (var i = 0; i < nIncorrect; i++) {\n        let ok = false;\n        var x, y;\n\n        // find a suitable x-coordinate\n        while (!ok) {\n          x = _.random(1, 10000);\n          ok = !_.some(items, function(zone) {\n            return x >= zone.left && x < zone.left + zone.width && zone.top < 1 && zone.height > 9999;\n          });\n        }\n\n        ok = false;\n\n        // find a suitable y-coordinate\n        while (!ok) {\n          y = _.random(1, 10000);\n          ok = !_.some(items, function(zone) {\n            return x >= zone.left && x < zone.left + zone.width && y >= zone.top && y < zone.top + zone.height;\n          });\n        }\n\n        x = x / 100;\n        y = y / 100;\n\n        console.log('using incorrect position', x + ',' + y);\n\n        var pin = view.getNextUnusedPin();\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          left: boardw * x / 100 - pin.$el.width() / 2,\n          top: boardh * y / 100 - pin.$el.height()\n        });\n      }\n\n      // decide in which zones to place a pin\n      const correct = _.shuffle(_.times(itemCount, function(i) { return i; }));\n\n      for (i = 0; i < nCorrect; i++) {\n        const zone = items[correct[i]];\n        var pin = view.getNextUnusedPin();\n        var x = zone.left + zone.width / 2;\n        var y = zone.top + zone.height / 2;\n\n        x = x / 100;\n        y = y / 100;\n\n        console.log('using correct position', x + ',' + y);\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          left: boardw * x / 100 - pin.$el.width() / 2,\n          top: boardh * y / 100 - pin.$el.height()\n        });\n      }\n    },\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n    answerUnsupported: function(view) {\n      const model = view.model;\n\n      model.set({ _isComplete: true, _isInteractionComplete: true, _isCorrect: true, _isSubmitted: true, _score: 1 });\n      model.set('_attemptsLeft', Math.max(0, model.get('_attempts') - 1));\n    },\n\n    answerUnsupportedIncorrectly: function(view) {\n      const model = view.model;\n\n      model.set({ _isComplete: true, _isInteractionComplete: true, _isCorrect: false, _isSubmitted: true, _score: 0 });\n      model.set('_attemptsLeft', Math.max(0, model.get('_attempts') - 1));\n    },\n\n    onRemove: function() {\n      this.mousedownHandlers.forEach(tuple => {\n        tuple.element.off('mousedown', tuple.handler);\n      });\n    }\n  }, Backbone.Events);\n\n  Adapt.on('app:dataReady devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    AutoAnswer.initialize();\n  });\n\n  return AutoAnswer;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n  const AutoAnswer = require('./auto-answer');\n\n  const PassHalfFail = _.extend({\n    syncIterations: 1,\n    mouseTarget: null,\n\n    initialize: function() {\n      _.bindAll(this, 'onMouseDown', 'onMouseUp', 'onKeypress', 'onPassHalfFailComplete');\n      this._questionViews = [];\n      this._currentPageId = null;\n      this.listenTo(Adapt, 'pageView:preRender', this.onPagePreRender);\n      this.listenTo(Adapt, 'remove', this.onRemove);\n      $(window).off('keypress', this.onKeypress);\n      $(window).off('mousedown', this.onMouseDown);\n      $(window).off('mouseup', this.onMouseUp);\n      $(window).on('keypress', this.onKeypress);\n      $(window).on('mousedown', this.onMouseDown);\n      $(window).on('mouseup', this.onMouseUp);\n    },\n\n    _completeNonQuestions: function() {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n      const nonQuestions = _.filter(currentModel.findDescendantModels('components'), function(m) { return m.get('_isQuestionType') !== true; });\n\n      _.each(nonQuestions, function(item) {\n        item.set('_isComplete', true);\n        item.set('_isInteractionComplete', true);\n      });\n    },\n\n    pass: function(callback) {\n      let i = 0; const qs = this._questionViews; const len = qs.length;\n\n      // this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (let j = 0, count = Math.min(PassHalfFail.syncIterations, len - i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i]);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    half: function(callback) {\n      const notSubmitted = function(view) { return !view.model.get('_isSubmitted'); };\n      const qs = _.shuffle(_.filter(this._questionViews, notSubmitted));\n      let i = 0; const len = qs.length;\n\n      // this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (let j = 0, count = Math.min(PassHalfFail.syncIterations, len - i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i], i % 2 == 0);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    fail: function(callback) {\n      let i = 0; const qs = this._questionViews; const len = qs.length;\n\n      // this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (let j = 0, count = Math.min(PassHalfFail.syncIterations, len - i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i], true);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    onPagePreRender: function(view) {\n      this._currentPageId = view.model.get('_id');\n      this.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n    },\n\n    onRemove: function() {\n      this.stopListening(Adapt, 'componentView:postRender', this.onComponentRendered);\n      this._questionViews = [];\n    },\n\n    onComponentRendered: function(view) {\n      // check component is part of current page\n      if (view.model.has('_parentId') && view.model.findAncestor('contentObjects').get('_id') == this._currentPageId) {\n        if (view.model.get('_isQuestionType')) {\n          this._questionViews.push(view);\n        }\n      }\n    },\n\n    onMouseDown: function(e) {\n      if (e.which === 1) this.mouseTarget = e.target;\n    },\n\n    onMouseUp: function(e) {\n      if (e.which === 1) this.mouseTarget = null;\n    },\n\n    onKeypress: function(e) {\n      const char = String.fromCharCode(e.which).toLowerCase();\n\n      const perform = function(type) {\n        if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n        const tutorEnabled = Adapt.devtools.get('_feedbackEnabled');\n\n        if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', false);\n\n        if (type == 'pass') this.pass(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n        else if (type == 'half') this.half(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n        else this.fail(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n\n        Adapt.trigger('drawer:closeDrawer');\n      }.bind(this);\n\n      if (this.mouseTarget) {\n        switch (char) {\n          case 'p': return perform('pass');\n          case 'h': return perform('half');\n          case 'f': return perform('fail');\n        }\n      } else if ($('.drawer .devtools').is(':visible')) {\n        switch (char) {\n          case 'p': return perform('pass');\n          case 'h': return perform('half');\n          case 'f': return perform('fail');\n        }\n      }\n    },\n\n    onPassHalfFailComplete: function(tutorEnabled) {\n      console.log('onPassHalfFailComplete');\n\n      if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', true);\n    }\n  }, Backbone.Events);\n\n  Adapt.on('app:dataReady devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    PassHalfFail.initialize();\n  });\n\n  return PassHalfFail;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/router'\n], function(Adapt, Router) {\n\n  const ToggleBanking = {\n\n    initialize: function() {\n      Adapt.articles.each(function(m) {\n        const config = this.getConfig(m);\n        if (m.has('_assessment') && m.get('_assessment')._banks && !m.get('_assessment')._banks._isEnabled) {\n          config._assessmentBankDisabled = true;\n        }\n      }, this);\n    },\n\n    getConfig: function(articleModel) {\n      if (!articleModel.has('_devtools')) articleModel.set('_devtools', {});\n      return articleModel.get('_devtools');\n    },\n\n    getBankedAssessmentsInCurrentPage: function() {\n      const pageModel = Adapt.findById(Adapt.location._currentId);\n      const f = function(m) {\n        const config = this.getConfig(m);\n        if (!config._assessmentBankDisabled &&\n          m.has('_assessment') &&\n          m.get('_assessment')._isEnabled &&\n          m.get('_assessment')._banks._split.length > 1) return true;\n\n        return false;\n      };\n\n      return Adapt.location._contentType === 'menu' ? [] : _.filter(pageModel.findDescendantModels('articles'), f, this);\n    },\n\n    toggle: function() {\n      const bankedAssessments = this.getBankedAssessmentsInCurrentPage();\n      const isBankingEnabled = function(m) { return m.get('_assessment')._banks._isEnabled; };\n      const enable = !_.some(bankedAssessments, isBankingEnabled);\n\n      _.each(bankedAssessments, function(articleModel) {\n        articleModel.get('_assessment')._banks._isEnabled = enable;\n        // set properties to trigger setup of assessment data\n        articleModel.set({\n          _attemptInProgress: false,\n          _isPass: false\n        });\n      });\n\n      // reload page\n      Router.handleId(Adapt.location._currentId);\n    }\n  };\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    ToggleBanking.initialize();\n  });\n\n  return ToggleBanking;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/router'\n], function(Adapt, Router) {\n\n  const MapView = Backbone.View.extend({\n\n    events: {\n      'click a': 'onLinkClicked'\n    },\n\n    initialize: function() {\n      this.$('html').addClass('has-devtools-map');\n      this._renderIntervalId = setInterval(this._checkRenderInterval.bind(this), 500);\n      this.listenTo(Adapt.components, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.blocks, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.articles, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.contentObjects, 'change:_isComplete', this.onModelCompletionChanged);\n      this.render();\n    },\n\n    render: function() {\n      const data = this.model;\n      // var startTime = new Date().getTime();\n\n      const template = Handlebars.templates.devtoolsMap;\n      this.$('body').html(template(data));\n\n      // console.log('adapt-devtools: map rendered in ' + ((new Date().getTime())-startTime) + ' ms');\n    },\n\n    remove: function() {\n      clearInterval(this._renderIntervalId);\n      this.$('body').html('Course closed!');\n      this.stopListening();\n      return this;\n    },\n\n    _checkRenderInterval: function() {\n      if (this._invalid) {\n        this._invalid = false;\n        this.render();\n      }\n    },\n\n    _getConfig: function(pageModel) {\n      if (!pageModel.has('_devtools')) pageModel.set('_devtools', {});\n      return pageModel.get('_devtools');\n    },\n\n    _disablePageIncompletePrompt: function(pageModel) {\n      const config = this._getConfig(pageModel);\n\n      if (pageModel.has('_pageIncompletePrompt')) {\n        config._pageIncompletePromptExists = true;\n        if (pageModel.get('_pageIncompletePrompt').hasOwnProperty('_isEnabled')) {\n          config._pageIncompletePromptEnabled = pageModel.get('_pageIncompletePrompt')._isEnabled;\n        }\n      } else {\n        config._pageIncompletePromptExists = false;\n        pageModel.set('_pageIncompletePrompt', {});\n      }\n\n      pageModel.get('_pageIncompletePrompt')._isEnabled = false;\n    },\n\n    _restorePageIncompletePrompt: function(pageModel) {\n      const config = this._getConfig(pageModel);\n\n      if (config._pageIncompletePromptExists) {\n        if (config.hasOwnProperty('_pageIncompletePromptEnabled')) pageModel.get('_pageIncompletePrompt')._isEnabled = config._pageIncompletePromptEnabled;\n        else delete pageModel.get('_pageIncompletePrompt')._isEnabled;\n      } else {\n        pageModel.unset('_pageIncompletePrompt');\n      }\n      delete config._pageIncompletePromptExists;\n      delete config._pageIncompletePromptEnabled;\n    },\n\n    onModelCompletionChanged: function() {\n      this.invalidate();\n    },\n\n    onLinkClicked: function(e) {\n      const $target = $(e.currentTarget);\n      let id = $target.attr('href').slice(1);\n      const model = Adapt.findById(id);\n\n      e.preventDefault();\n\n      if (e.ctrlKey && this.el.defaultView) {\n        id = id.replace(/-/g, '');\n        this.el.defaultView[id] = model;\n        this.el.defaultView.console.log('devtools: add property window.' + id + ':');\n        this.el.defaultView.console.log(model);\n      } else if (e.shiftKey) {\n        this.navigateAndDisableTrickle(id);\n      } else {\n        this.navigateAndDisableTrickleUpTo(id);\n      }\n    },\n\n    invalidate: function() {\n      this._invalid = true;\n    },\n\n    /**\n    * Navigate to the element with the given id (or as closely to it as possible). Disable trickle up to the given id.\n    * N.B. because trickle cannot be reliably manipulated in situ we must reload the page. Trickle remains disabled on\n    * affected article(s)|block(s).\n    */\n    navigateAndDisableTrickleUpTo: function(id) {\n      const model = Adapt.findById(id);\n      const pageModel = Adapt.findById(Adapt.location._currentId);\n\n      // first ensure page incomplete prompt won't activate\n      this._disablePageIncompletePrompt(pageModel);\n\n      // now navigate\n\n      if (model._siblings === 'contentObjects') {\n        Backbone.history.navigate('#/id/' + id, { trigger: true });\n      } else {\n        const level = model.get('_type') === 'component' ? model.getParent() : model;\n        const siblings = level.getParent().getChildren(); let sibling = null;\n        // disable trickle on all preceeding article(s)|block(s)\n        for (let i = 0, count = siblings.indexOf(level); i < count; i++) {\n          sibling = siblings.at(i);\n          console.log('disabling trickle on ' + sibling.get('_id'));\n          if (sibling.has('_trickle')) {\n            sibling.get('_trickle')._isEnabled = false;\n          } else {\n            sibling.set('_trickle', { _isEnabled: false });\n          }\n        }\n        // check if already on page\n        if (Adapt.location._currentId === model.findAncestor('contentObjects').get('_id')) {\n          this.listenToOnce(Adapt, 'pageView:ready', function(view) {\n            _.defer(function() {\n              Adapt.scrollTo($('.' + id));\n              this.checkVisibility(id);\n            }.bind(this));\n          });\n          if (Adapt.location._currentId === Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n          else Router.handleId(Adapt.location._currentId);\n        } else {\n          this.listenToOnce(Adapt, 'pageView:ready', function() {\n            _.defer(function() {\n              this.checkVisibility(id);\n            }.bind(this));\n          });\n          Backbone.history.navigate('#/id/' + id, { trigger: true });\n        }\n      }\n\n      // restore pageIncompletePrompt config\n      this._restorePageIncompletePrompt(pageModel);\n\n      this.invalidate();\n    },\n\n    /**\n    * Navigate to the element with the given id (or as closely to it as possible). Disable trickle on containing\n    * page temporarily.\n    */\n    navigateAndDisableTrickle: function(id) {\n      const model = Adapt.findById(id);\n      const pageModel = Adapt.findById(Adapt.location._currentId);\n\n      // first ensure page incomplete prompt won't activate\n      this._disablePageIncompletePrompt(pageModel);\n\n      if (model._siblings === 'contentObjects') {\n        Backbone.history.navigate('#/id/' + id, { trigger: true });\n      } else {\n        // if already on page ensure trickle is disabled\n        if (Adapt.location._currentId === model.findAncestor('contentObjects').get('_id')) {\n          Adapt.devtools.set('_trickleEnabled', false);\n          Adapt.scrollTo($('.' + id));\n          this.checkVisibility(id);\n        } else {\n          // pick target model to determine trickle config according to trickle version (2.1 or 2.0.x)\n          const targetModel = Adapt.trickle ? model.findAncestor('contentObjects') : Adapt.course;\n\n          // if necessary disable trickle (until page is ready)\n          if (!targetModel.has('_trickle')) {\n            targetModel.set('_trickle', { _isEnabled: false });\n            this.listenToOnce(Adapt, 'pageView:ready', function() {\n              _.defer(function() {\n                targetModel.get('_trickle')._isEnabled = true;\n                this.checkVisibility(id);\n              }.bind(this));\n            });\n          } else if (targetModel.get('_trickle')._isEnabled) {\n            targetModel.get('_trickle')._isEnabled = false;\n            this.listenToOnce(Adapt, 'pageView:ready', function() {\n              _.defer(function() {\n                targetModel.get('_trickle')._isEnabled = true;\n                this.checkVisibility(id);\n              }.bind(this));\n            });\n          }\n\n          Backbone.history.navigate('#/id/' + id, { trigger: true });\n        }\n      }\n\n      // restore pageIncompletePrompt config\n      this._restorePageIncompletePrompt(pageModel);\n\n      this.invalidate();\n    },\n\n    checkVisibility: function(id) {\n      let model = Adapt.findById(id);\n      if ($('.' + id).is(':visible') || model === Adapt.course) return;\n\n      while (!$('.' + id).is(':visible') && model !== Adapt.course) {\n        model = model.getParent();\n        id = model.get('_id');\n      }\n      console.log('adapt-devtools::checkVisibility scrolling to ancestor ' + id);\n      Adapt.scrollTo($('.' + id));\n    }\n  });\n\n  const CourseMap = _.extend({\n    initialize: function() {\n      const courseId = Adapt.course.get('_id');\n      // a long alphanumeric identifier is likely to be Authoring Tool\n      this.truncateIds = courseId.length >= 6 && /[a-z]+[0-9]+|[0-9]+[a-z]+/.test(courseId);\n      this.listenTo(Adapt, 'devtools:mapLoaded', this.onMapLoaded);\n      $(window).on('unload', this.onCourseClosed.bind(this));\n\n      function isMenu(options) {\n        if (this.get('_type') !== 'page') {\n          return options.fn(this);\n        }\n        return options.inverse(this);\n      }\n\n      function eachChild(options) {\n        let ret = '';\n        const children = this.getChildren().models;\n\n        for (let i = 0, j = children.length; i < j; i++) {\n          ret = ret + options.fn(children[i], { data: { index: i, first: i === 0, last: i === j - 1 } });\n        }\n\n        return ret;\n      }\n\n      function getId(options) {\n        const val = this.get('_id') || '';\n        return CourseMap.truncateIds ? '...' + val.slice(-4) : val;\n      }\n\n      function getProp(prop, options) {\n        return this.get(prop);\n      }\n\n      function isStringEmpty(str) {\n        return !str || (str.trim && str.trim().length === 0) || ($.trim(str).length === 0);\n      }\n\n      function getTitle(options) {\n        let t = this.get('displayTitle');\n        if (isStringEmpty(t)) t = this.get('title');\n        if (isStringEmpty(t)) t = this.get('_id');\n        return t;\n      }\n\n      function when(prop, options) {\n        if (this.get(prop)) {\n          return options.fn(this);\n        } else {\n          return options.inverse(this);\n        }\n      }\n\n      function isTrickled(options) {\n        let trickleConfig = this.get('_trickle');\n        let trickled = false;\n        const isBlock = this.get('_type') === 'block';\n\n        if (trickleConfig) trickled = (isBlock || trickleConfig._onChildren !== true) && trickleConfig._isEnabled;\n        else if (isBlock) {\n          trickleConfig = this.getParent().get('_trickle');\n          if (trickleConfig) trickled = trickleConfig._onChildren && trickleConfig._isEnabled;\n        }\n\n        if (trickled) {\n          return options.fn(this);\n        } else {\n          return options.inverse(this);\n        }\n      }\n\n      Handlebars.registerHelper('isMenu', isMenu);\n      Handlebars.registerHelper('eachChild', eachChild);\n      Handlebars.registerHelper('getId', getId);\n      Handlebars.registerHelper('getProp', getProp);\n      Handlebars.registerHelper('getTitle', getTitle);\n      Handlebars.registerHelper('when', when);\n      Handlebars.registerHelper('isTrickled', isTrickled);\n    },\n\n    open: function() {\n      if (!this.mapWindow) {\n        this.mapWindow = window.open('assets/map.html', 'Map');\n      } else {\n        this.mapWindow.focus();\n      }\n    },\n\n    onMapClosed: function() {\n      console.log('onMapClosed');\n      this.mapWindow = null;\n    },\n\n    onMapLoaded: function(mapWindow) {\n      console.log('onMapLoaded');\n      this.mapWindow = mapWindow;\n      this.mapWindow.focus();\n      $('html', this.mapWindow.document).addClass($('html', window.document).attr('class'));\n      this.mapView = new MapView({ model: Adapt, el: this.mapWindow.document });\n      $(this.mapWindow).on('unload', this.onMapClosed.bind(this));\n    },\n\n    onCourseClosed: function() {\n      if (this.mapView) {\n        this.mapView.remove();\n        // this.mapWindow.close();\n      }\n    }\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    CourseMap.initialize();\n  });\n\n  return CourseMap;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n  const AdaptModel = require('coreModels/adaptModel');\n  const QuestionView = require('coreViews/questionView');\n\n  let mouseTarget = null;\n\n  function onMouseDown(e) {\n    if (e.which == 1) mouseTarget = e.target;\n  }\n\n  function onMouseUp(e) {\n    if (e.which == 1) mouseTarget = null;\n  }\n\n  function onKeypress(e) {\n    const char = String.fromCharCode(e.which).toLowerCase();\n\n    if (mouseTarget) {\n      if (char == 'm') {\n        const model = Utils.getModelForElement(mouseTarget);\n\n        if (model) {\n          const id = model.get('_id').replace(/-/g, '');\n          window[id] = model;\n          console.log('devtools: add property window.' + id + ':');\n          console.log(model.attributes);\n        }\n      }\n    }\n  }\n\n  function getAdaptCoreVersion() {\n    try {\n      if (Adapt.build && Adapt.build.has('package')) return Adapt.build.get('package').version || '>=v3.0.0';\n      // v2.2.4-v2.2.5 not possible to distinguish\n      if (typeof AdaptModel.prototype.checkCompletionStatusFor === 'function') return '>=v2.2.3';\n      if (typeof AdaptModel.prototype.setCompletionStatus === 'function') return '>=v2.0.10';\n      if (typeof AdaptModel.prototype.checkLocking === 'function') return 'v2.0.9';\n      if (typeof Adapt.checkingCompletion === 'function') return 'v2.0.8';\n      if (typeof AdaptModel.prototype.getParents === 'function') return 'v2.0.7';\n      if ($.a11y && $.a11y.options.hasOwnProperty('isIOSFixesEnabled')) return 'v2.0.5-v2.0.6';\n      if (Adapt instanceof Backbone.Model) return 'v2.0.4';\n      if (typeof QuestionView.prototype.recordInteraction === 'function') return 'v2.0.2-v2.0.3';\n      if (typeof Adapt.findById === 'function') return 'v2.0.0-v2.0.1';\n      return 'v1.x';\n    } catch (e) {\n      return 'unknown version';\n    }\n  }\n\n  var Utils = {\n    getModelForElement: function(element) {\n      const $target = $(element);\n\n      if ($target.length == 0) return false;\n\n      const id = $target.parents('[data-adapt-id]').data('adapt-id');\n\n      return !id ? false : Adapt.findById(id);\n    }\n  };\n\n  Adapt.once('adapt:initialize', function() {\n    const str = 'Version of Adapt core detected: ' + getAdaptCoreVersion();\n    const horz = getHorzLine();\n\n    console.log(horz + '\\nVersion of Adapt core detected: ' + getAdaptCoreVersion() + '\\n' + horz);\n\n    function getHorzLine() {\n      for (var s = '', i = 0, c = str.length; i < c; i++) s += '*';\n      return s;\n    }\n  });\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    $(window).on('keypress', onKeypress);\n    $(window).on('mousedown', onMouseDown);\n    $(window).on('mouseup', onMouseUp);\n\n    // useful for command-line debugging\n    if (!window.Adapt) window.Adapt = Adapt;\n  });\n\n  return Utils;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n\n  function onTrickleBegun() {\n    if (!Adapt.devtools.get('_trickleEnabled')) {\n      console.log('Trickle started');\n      Adapt.devtools.set('_trickleEnabled', true);\n      // listen for user request to end trickle\n      Adapt.devtools.once('change:_trickleEnabled', onTrickleChange);\n    }\n  }\n\n  function onTrickleEnded() {\n    console.log('Trickle ended');\n    Adapt.devtools.off('change:_trickleEnabled', onTrickleChange);\n    Adapt.devtools.set('_trickleEnabled', false);\n  }\n\n  function onTrickleChange() {\n    if (!Adapt.devtools.get('_trickleEnabled')) {\n      // user triggered\n      Adapt.trigger('trickle:kill');\n    }\n  }\n\n  function remove() {\n    if (Adapt.devtools.get('_trickleEnabled')) {\n      onTrickleEnded();\n    }\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    Adapt.on('trickle:interactionInitialize trickle:started', onTrickleBegun);\n    Adapt.on('trickle:kill trickle:finished', onTrickleEnded);\n    Adapt.on('remove', remove);\n  });\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n\n  function onShowFeedback() {\n    // trickle waits for tutor to close so pretend that this happens\n    // Adapt.trigger('tutor:opened'); trickle-tutorPlugin doesn't actually listen to this(!)\n    Adapt.trigger('tutor:closed');\n  }\n\n  function hushTutor() {\n    Adapt.devtools.set('_tutorListener', Adapt._events['questionView:showFeedback'].pop());\n    Adapt.on('questionView:showFeedback', onShowFeedback);\n  }\n\n  function reinstateTutor() {\n    Adapt.off('questionView:showFeedback', onShowFeedback);\n\n    if (!Adapt._events.hasOwnProperty('questionView:showFeedback')) {\n      Adapt._events['questionView:showFeedback'] = [];\n    }\n\n    Adapt._events['questionView:showFeedback'].push(Adapt.devtools.get('_tutorListener'));\n  }\n\n  function onFeedbackToggled() {\n    if (Adapt.devtools.get('_feedbackEnabled')) {\n      reinstateTutor();\n      $(document).off('mouseup', '.js-btn-feedback');\n    } else {\n      hushTutor();\n      $(document).on('mouseup', '.js-btn-feedback', onFeedbackButtonClicked);\n    }\n  }\n\n  function onFeedbackButtonClicked(e) {\n    const classes = $(e.currentTarget).parents('.component').attr('class');\n    const componentId = /[\\s]+(c\\-[^\\s]+)/.exec(classes)[1];\n\n    if (componentId) {\n      // bring tutor back temporarily\n      reinstateTutor();\n      // tutor expects a view, but it's not actually needed\n      Adapt.trigger('questionView:showFeedback', { model: Adapt.findById(componentId) });\n      // and hush it again\n      hushTutor();\n    } else console.error('devtools:onFeedbackButtonClicked: malformed component class name');\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n      // assume single registrant is adapt-contrib-tutor\n      if (Adapt._events.hasOwnProperty('questionView:showFeedback') && Adapt._events['questionView:showFeedback'].length == 1) {\n        Adapt.devtools.on('change:_feedbackEnabled', onFeedbackToggled);\n      } else {\n        console.warn('devtools: no tutor or multiple registrants of questionView:showFeedback so disabling ability to toggle feedback.');\n        Adapt.devtools.set('_toggleFeedbackAvailable', false);\n      }\n    }\n  });\n\n});\n","define([], function(require) {\n\n  function findLabel($element) {\n    const id = $element.attr('id');\n    if (!id) return false;\n    const $label = $(`[for=${id}]`);\n    if (!$label.length) return false;\n    return computeAccesibleName($label, true);\n  }\n\n  function getText(domElement) {\n    if ($(domElement).attr('aria-hidden') === 'true') return;\n    const text = [];\n    function traverseTree(root) {\n      if ($(root).attr('aria-hidden') === 'true') return;\n      Array.prototype.forEach.call(root.childNodes, child => {\n        if (child.nodeType !== 3) return traverseTree(child);\n        const str = child.nodeValue.trim();\n        if (str.length === 0) return;\n        text.push(str);\n      });\n    }\n    traverseTree(domElement);\n    return text.join(' ');\n  }\n\n  function followId($element, property) {\n    const id = $element.attr(property);\n    if (!id) return false;\n    const $toElement = $(`#${id}`);\n    if (!$toElement.length) return false;\n    return computeAccesibleName($toElement, true);\n  }\n\n  function computeAccesibleName($element, allowText = false) {\n    if ($element.is('input:not([type=checkbox], [type=radio]), select, [role=range], textarea') && $element.val()) return $element.val();\n    const labelledByText = followId($element, 'aria-labelledby');\n    if (labelledByText) return labelledByText;\n    const activeDescendantText = followId($element, 'aria-activedescendant');\n    if (activeDescendantText) return activeDescendantText;\n    const ariaLabel = $element.attr('aria-label');\n    if (ariaLabel) return ariaLabel;\n    const findLabelText = findLabel($element);\n    if (findLabelText) return findLabelText;\n    const valueText = $element.attr('aria-valuetext');\n    if (valueText) return valueText;\n    const valueNow = $element.attr('aria-valuenow');\n    if (valueNow) return valueNow;\n    if (!allowText) return '';\n    return computeHeadingLevel($element) + getText($element[0]);\n  }\n\n  function computeHeadingLevel($element) {\n    const $heading = $element.parents().add($element).filter('h1, h2, h3, h4, h5, h6, h7, [role=heading]');\n    if (!$heading.length) return '';\n    const headingLevel = parseInt($heading[0].tagName) || $heading.attr('aria-level');\n    return `h${headingLevel}: `;\n  }\n\n  function computeAccessibleDescription($element) {\n    const describedByText = followId($element, 'aria-describedby');\n    if (describedByText) return describedByText;\n    return '';\n  }\n\n  function getAnnotationPosition($element, $annotation) {\n    const targetBoundingRect = $element[0].getBoundingClientRect();\n\n    const availableWidth = $('html')[0].clientWidth;\n    const availableHeight = $('html')[0].clientHeight;\n    const tooltipsWidth = $annotation.width();\n    const tooltipsHeight = $annotation.height();\n    const elementWidth = $element.width();\n    const elementHeight = $element.height();\n\n    const canAlignBottom = targetBoundingRect.bottom + tooltipsHeight < availableHeight;\n    const canAlignRight = targetBoundingRect.right + tooltipsWidth < availableWidth;\n    const canAlignBottomRight = canAlignBottom && canAlignRight;\n    const canBeContained = elementHeight === 0 || (elementHeight * elementWidth >= tooltipsHeight * tooltipsWidth) || $element.is('img');\n\n    const isFixedPosition = Boolean($element.parents().add($element).filter((index, el) => $(el).css('position') === 'fixed').length);\n    const scrollOffsetTop = isFixedPosition ? 0 : $(window).scrollTop();\n    const scrollOffsetLeft = isFixedPosition ? 0 : $(window).scrollLeft();\n\n    function getPosition() {\n      if (canBeContained) {\n        return {\n          className: 'is-contained',\n          css: {\n            left: targetBoundingRect.left + scrollOffsetLeft,\n            top: targetBoundingRect.top + scrollOffsetTop,\n            'max-width': (elementHeight === 0) ? '' : elementWidth\n          }\n        };\n      }\n      if (!canAlignBottomRight) {\n        // Find the 'corner' with the most space from the viewport edge\n        const isTopPreferred = availableHeight - (targetBoundingRect.bottom + tooltipsHeight) < targetBoundingRect.top - tooltipsHeight;\n        const isLeftPreferred = availableWidth - (targetBoundingRect.right + tooltipsWidth) < targetBoundingRect.left - tooltipsWidth;\n        if (isTopPreferred && isLeftPreferred) {\n          // Top left\n          return {\n            className: 'is-left is-top',\n            css: {\n              left: targetBoundingRect.left - tooltipsWidth + scrollOffsetLeft,\n              top: targetBoundingRect.top - tooltipsHeight + scrollOffsetTop,\n              'max-width': ''\n            }\n          };\n        }\n        if (isTopPreferred) {\n          // Top right\n          return {\n            className: 'is-right is-top',\n            css: {\n              left: targetBoundingRect.right + scrollOffsetLeft,\n              top: targetBoundingRect.top - tooltipsHeight + scrollOffsetTop,\n              'max-width': ''\n            }\n          };\n        }\n        if (isLeftPreferred) {\n          // Bottom left\n          return {\n            className: 'is-left is-bottom',\n            css: {\n              left: targetBoundingRect.left - tooltipsWidth + scrollOffsetLeft,\n              top: targetBoundingRect.bottom + scrollOffsetTop,\n              'max-width': ''\n            }\n          };\n        }\n      }\n      // Bottom right, default\n      return {\n        className: 'is-right, is-bottom',\n        css: {\n          left: targetBoundingRect.right + scrollOffsetLeft,\n          top: targetBoundingRect.bottom + scrollOffsetTop,\n          'max-width': ''\n        }\n      };\n    }\n    const position = getPosition();\n    position.css.position = isFixedPosition ? 'fixed' : 'absolute';\n    if (position.css.left < 0) position.css.left = 0;\n    position.css.left += 'px';\n    position.css.top += 'px';\n    if (position.css['max-width']) position.css['max-width'] += 'px';\n    return position;\n  }\n\n  return {\n    computeAccesibleName,\n    computeAccessibleDescription,\n    computeHeadingLevel,\n    getAnnotationPosition\n  };\n});\n","define([\n  'core/js/adapt',\n  './helpers'\n], function(Adapt, helpers) {\n\n  const computeAccesibleName = helpers.computeAccesibleName;\n  const computeAccessibleDescription = helpers.computeAccessibleDescription;\n  const getAnnotationPosition = helpers.getAnnotationPosition;\n\n  const Annotation = Backbone.View.extend({\n\n    className: function() {\n      return 'devtools__annotation';\n    },\n\n    tagName: function() {\n      return 'span';\n    },\n\n    initialize: function(options) {\n      this.$parent = options.$parent;\n      this.allowText = options.allowText;\n      this.$el.data('annotating', this.$parent);\n      this.$el.data('view', this);\n    },\n\n    render: function() {\n      const template = Handlebars.templates.devtoolsAnnotation;\n      const name = computeAccesibleName(this.$parent, this.allowText);\n      const description = computeAccessibleDescription(this.$parent);\n      this.$el.html(template({ name, description }));\n      if (!name) this.$el.addClass('has-annotation-warning');\n      const position = getAnnotationPosition(this.$parent, this.$el);\n      this.$el.css(position.css);\n      this.$el.removeClass('is-top is-left is-right is-bottom is-contained');\n      this.$el.addClass(position.className);\n    },\n\n    showOutline: function() {\n      this.$parent.addClass('devtools__annotation-outline');\n      this.$el.addClass('has-mouse-over');\n    },\n\n    hideOutline: function() {\n      this.$parent.removeClass('devtools__annotation-outline');\n      this.$el.removeClass('has-mouse-over');\n    }\n\n  });\n\n  const AltText = _.extend({\n\n    initialize: function() {\n      _.bindAll(this, 'onDomMutation', 'render', 'onMouseOver');\n      this.mutations = [];\n      this.mutated = false;\n      this.listenTo(Adapt.devtools, 'change:_altTextEnabled', this.toggleAltText);\n      $('body').append($('<div class=\"devtools__annotations\" aria-hidden=\"true\"></div>'));\n      // if available we can use to avoid unnecessary checks\n      if (typeof MutationObserver === 'function') {\n        this.observer = new MutationObserver(_.bind(this.onDomMutation, this));\n      }\n    },\n\n    connectObserver: function() {\n      if (this.observer) {\n        this.observer.observe(document.querySelector('html'), {\n          childList: true,\n          subtree: true,\n          attributes: true,\n          attributeFilter: [\n            'class',\n            'style',\n            'aria-label',\n            'aria-labelledby',\n            'alt',\n            'aria-describedby',\n            'for',\n            'aria-valuetext',\n            'aria-valuenow',\n            'tabindex',\n            'aria-hidden'\n          ]\n        });\n      }\n      this.listenTo(Adapt, {\n        'popup:closed notify:closed drawer:closed': this.onDomMutation,\n        remove: this.removeAllAnnotations\n      });\n      $(window).on('scroll', this.onDomMutation);\n      $(document).on('mouseover', '*', this.onMouseOver);\n    },\n\n    onMouseOver: function(event) {\n      // Ignore propagated events\n      if (event.currentTarget !== event.target) return;\n      // Fetch first found tooltip element from target, through parents to html\n      const $mouseoverEl = $(event.currentTarget).parents().add(event.currentTarget).filter('.devtools__annotation').last();\n      if (this._outlineEl === $mouseoverEl) return;\n      this._outlineEl = $mouseoverEl;\n      if (!$mouseoverEl.length) return this.hideOutline();\n      this.showOutline($mouseoverEl);\n    },\n\n    hideOutline: function() {\n      $('.devtools__annotation').each(_.bind(function(index, element) {\n        const $annotation = $(element);\n        const annotation = $annotation.data('view');\n        annotation.hideOutline();\n      }, this));\n    },\n\n    showOutline: function($mouseoverEl) {\n      const annotation = $mouseoverEl.data('view');\n      annotation.showOutline();\n    },\n\n    disconnectObserver: function() {\n      if (this.observer) {\n        this.observer.disconnect();\n      }\n      this.stopListening(Adapt, 'popup:closed notify:closed drawer:closed', this.onDomMutation);\n      $(window).off('scroll', this.onDomMutation);\n      $(document).off('mouseover', '*', this.onMouseOver);\n    },\n\n    toggleAltText: function() {\n      if (!Adapt.devtools.get('_altTextEnabled')) {\n        this.mutated = false;\n        this.disconnectObserver();\n        this.removeAllAnnotations();\n        return;\n      }\n      this.onDomMutation();\n      this.connectObserver();\n    },\n\n    addAnnotation: function($element, allowText) {\n      const annotation = new Annotation({ $parent: $element, allowText: allowText });\n      $('.devtools__annotations').append(annotation.$el);\n      $element.data('annotation', annotation);\n      $element.attr('data-annotated', true);\n      this.updateAnnotation($element, annotation, allowText);\n    },\n\n    removeAnnotation: function($element, annotation) {\n      annotation.remove();\n      $element.removeAttr('data-annotated');\n      $element.removeData('annotation');\n    },\n\n    removeAllAnnotations: function() {\n      $('.devtools__annotation').each(_.bind(function(index, element) {\n        const $annotation = $(element);\n        const $element = $annotation.data('annotating');\n        const annotation = $annotation.data('view');\n        if (!$element) return;\n        this.removeAnnotation($element, annotation);\n      }, this));\n    },\n\n    clearUpAnnotations: function() {\n      $('.devtools__annotation').each(_.bind(function(index, element) {\n        const $annotation = $(element);\n        const $element = $annotation.data('annotating');\n        const annotation = $annotation.data('view');\n        if (!$element) return;\n        const isOutOfDom = ($element.parents('html').length === 0);\n        const isHeadingHeightZero = $element.is('h1,h2,h3,h4,h5,h6,h7,[role=heading]') && $element.height() === 0;\n        if (!isOutOfDom && ($element.onscreen().onscreen || isHeadingHeightZero)) return;\n        this.removeAnnotation($element, annotation);\n      }, this));\n    },\n\n    updateAnnotation: function($element, annotation, allowText) {\n      annotation.render();\n    },\n\n    onDomMutation: function(mutations) {\n      if (this.mutated) return;\n      requestAnimationFrame(this.render);\n      this.mutated = true;\n    },\n\n    render: function() {\n      if (this.mutated === false) return;\n\n      this.clearUpAnnotations();\n\n      const $headings = $('h1,h2,h3,h4,h5,h6,h7,[role=heading]');\n\n      const $labelled = $([\n        '.aria-label',\n        '[alt]',\n        '[aria-label]',\n        '[aria-labelledby]',\n        '[aria-describedby]',\n        '[aria-activedescendant]',\n        '[aria-valuetext]',\n        '[aria-valuenow]',\n        '[role=listbox]',\n        '[aria-hidden]'\n      ].join(','));\n\n      $labelled\n        .filter(function (index, element) {\n          return !$(element).parents().filter($headings).length;\n        })\n        .add($headings)\n        .each(_.bind(function(index, element) {\n          const $element = $(element);\n          const annotation = $element.data('annotation');\n          const isVisible = $element.onscreen().onscreen;\n          const isParentAriaHidden = Boolean($element.parents().filter('[aria-hidden=true]').length);\n          const isAriaHidden = Boolean($element.filter('[aria-hidden=true]').length);\n          const isNotAriaHidden = Boolean($element.filter('[aria-hidden=false]').length);\n          const isImg = $element.is('img');\n          const allowText = $element.is('.aria-label,h1,h2,h3,h4,h5,h6,h7,[role=heading]');\n          const isOutOfDom = ($element.parents('html').length === 0);\n          const isHeadingHeightZero = $element.is('h1,h2,h3,h4,h5,h6,h7,[role=heading]') && $element.height() === 0;\n          if (!isOutOfDom && (isVisible || isHeadingHeightZero) && (isNotAriaHidden || (!isAriaHidden && !isParentAriaHidden) || (isImg && !isParentAriaHidden))) {\n            if (!annotation) this.addAnnotation($element, allowText);\n            else this.updateAnnotation($element, annotation, allowText);\n          } else if (annotation) {\n            this.removeAnnotation($element, annotation);\n          }\n        }, this));\n\n      if (this.observer) this.observer.takeRecords();\n      this.mutated = false;\n    }\n\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n    AltText.initialize();\n  });\n\n  return AltText;\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n  const Router = require('coreJS/router');\n\n  function breakCoreLocking() {\n    Adapt.course.unset('_lockType');\n\n    breakLocks(Adapt.contentObjects);\n    breakLocks(Adapt.articles);\n    breakLocks(Adapt.blocks);\n\n    function breakLocks(collection) {\n      collection.each(function(model) {\n        model.unset('_lockType');\n        model.unset('_isLocked');\n      });\n    }\n  }\n\n  function onUnlocked() {\n    if (Adapt.devtools.get('_unlocked')) {\n      breakCoreLocking();\n      // reload the page/menu\n      if (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n      else Router.handleId(Adapt.location._currentId);\n    }\n  }\n\n  // menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n  function onMenuPreRender(view) {\n    if (Adapt.devtools.get('_unlocked')) {\n      if (Adapt.location._currentId == view.model.get('_id')) {\n        view.model.once('change:_isReady', _.bind(onMenuReady, view));\n        view.model.getChildren().each(function(item) {\n          // first pass: attempt to manipulate commonly employed locking mechanisms\n          if (item.has('_lock')) item.set('_lock', item.get('_lock').length > -1 ? [] : false);\n          if (item._lock) item._lock = item._lock.length > -1 ? [] : false;\n          if (item._locked === true) item._locked = false;\n          if (item._isLocked === true) item._isLocked = false;\n        });\n      }\n    }\n  }\n\n  // menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n  function onMenuReady() {\n    if (Adapt.devtools.get('_unlocked')) {\n      // second pass: attempt to enable clickable elements\n      this.$('a, button').prop('disabled', false).css('pointer-events', 'auto');\n    }\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (Adapt.devtools.get('_unlockAvailable')) {\n      Adapt.devtools.on('change:_unlocked', onUnlocked);\n      Adapt.on('menuView:preRender', onMenuPreRender);\n    }\n  });\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n  const Router = require('coreJS/router');\n\n  let buffer = '';\n  let isMouseDown = false;\n  const hitArea = 100;\n  const coords = {};\n  let topLeftTapHold = false;\n  let topRightTapHold = false;\n  let listenType = 0;\n  let timeoutId;\n  const focusableElements = 'a,button,input,select,textarea,[tabindex],label';\n\n  function onKeypress(e) {\n    const c = String.fromCharCode(e.which).toLowerCase();\n    buffer += c;\n    if (isMouseDown && c == '5' && !Adapt.devtools.get('_isEnabled')) enable();\n    else processBuffer();\n  }\n\n  function onMouseDown() {\n    isMouseDown = true;\n  }\n\n  function onMouseUp() {\n    isMouseDown = false;\n  }\n\n  function processBuffer() {\n    let blen = buffer.length;\n    if (blen > 100) buffer = buffer.substr(1, 100);\n    blen = buffer.length;\n\n    if (buffer.substr(blen - ('kcheat').length, ('kcheat').length) == 'kcheat') {\n      if (!Adapt.devtools.get('_isEnabled')) enable();\n    }\n  }\n\n  function enable() {\n    removeHooks();\n    Adapt.devtools.set('_isEnabled', true);\n    Adapt.trigger('devtools:enable');\n\n    // reload the menu/page\n    if (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n    else Router.handleId(Adapt.location._currentId);\n  }\n\n  function addHooks() {\n    $(window).on('keypress', onKeypress);\n    $(window).on('mousedown', onMouseDown);\n    $(window).on('mouseup', onMouseUp);\n\n    window.kcheat = function() {\n      buffer = 'kcheat';\n      processBuffer();\n    };\n\n    Router.route('kcheat', 'kcheat', function() {\n      if (window.kcheat) window.kcheat();\n    });\n\n    if (Modernizr.touch) addTouchHook();\n  }\n\n  function removeHooks() {\n    $(window).off('keypress', onKeypress);\n    $(window).off('mousedown', onMouseDown);\n    $(window).off('mouseup', onMouseUp);\n    window.kcheat = undefined;\n    if (Modernizr.touch) removeTouchHook();\n  }\n\n  function addTouchHook() {\n    $('body').on('touchstart', onTouchStart);\n    $('body').on('touchend', onTouchEnd);\n\n    // a11y will stop propagation of event on focusable elements so we need to listen specifically to these\n    $('body').on('touchstart', focusableElements, onTouchStart);\n  }\n\n  function removeTouchHook() {\n    clearTimeout(timeoutId);\n\n    $('body').off('touchstart', onTouchStart);\n    $('body').off('touchend', onTouchEnd);\n    $('body').off('touchstart', focusableElements, onTouchStart);\n  }\n\n  function onTouchStart(event) {\n    const touches = event.originalEvent.touches;\n\n    if (touches.length != 1) return;\n\n    coords.x = touches[0].pageX;\n    coords.y = touches[0].pageY;\n\n    if (coords.x >= 0 && coords.x < hitArea && coords.y >= 0 && coords.y < hitArea) {\n      listenType = 1;\n    } else if (coords.x >= $(window).width() - hitArea && coords.x < $(window).width() && coords.y >= 0 && coords.y < hitArea) {\n      listenType = 2;\n    } else {\n      listenType = topLeftTapHold = topRightTapHold = false;\n    }\n\n    if (listenType) {\n      timeoutId = setTimeout(function() {\n        // if finger still held\n        if (listenType) {\n          if (listenType == 1) topLeftTapHold = true;\n          else if (listenType == 2) topRightTapHold = true;\n\n          if (topLeftTapHold && topRightTapHold) {\n            if (window.kcheat) window.kcheat();\n          }\n        }\n      }, 200);\n    }\n  }\n\n  function onTouchEnd(event) {\n    listenType = false;\n    clearTimeout(timeoutId);\n  }\n\n  Adapt.once('adapt:initialize', function() {\n    if (Adapt.devtools.get('_isEnabled')) return;\n\n    // some plugins (e.g. bookmarking) will manipulate the router so defer the call\n    _.defer(function () { addHooks(); });\n  });\n\n});\n","define([], function(require) {\n\n  const Adapt = require('coreJS/adapt');\n\n  const TraceFocus = _.extend({\n\n    openingTags: new RegExp(\"<[\\\\w-]+((\\\\s+[\\\\w-]+(\\\\s*=\\\\s*(?:\\\".*?\\\"|'.*?'|[^'\\\">\\\\s]+))*)+\\\\s*|\\\\s*)/?>\"),\n    consoleStyle: 'background: lightgray; color: blue',\n\n    initialize: function() {\n      this.onFocusIn = _.bind(this.onFocusIn, this);\n\n      this.listenTo(Adapt.devtools, 'change:_traceFocusEnabled', this.toggleTraceFocus);\n\n      this.toggleTraceFocus();\n    },\n\n    toggleTraceFocus: function() {\n      if (Adapt.devtools.get('_traceFocusEnabled')) {\n        $('body').on('focusin', this.onFocusIn);\n      } else {\n        $('body').off('focusin', this.onFocusIn);\n      }\n    },\n\n    onFocusIn: function(e) {\n      if (!$('html').is('.ie, .Edge')) return console.log('%cfocussed', this.consoleStyle, e.target);\n\n      const $el = $(e.target);\n\n      if (!$el[0] || !$el[0].outerHTML) return console.log('focussed: ', e.target);\n\n      let openingTag = this.openingTags.exec($el[0].outerHTML)[0];\n\n      if (openingTag) {\n        // add some context if possible\n        // strip leading whitespace/nbsp and get first line of text\n        const tokens = $el.text().replace(/[\\s\\xA0]*/, '').split(/\\r\\n|\\r|\\n/);\n\n        if (tokens[0]) openingTag = openingTag.slice(0, 20) + '[...]';\n\n        if ($('html').is('.ie8')) {\n          console.log('focussed: ', openingTag, tokens[0]);\n        } else {\n          console.log('focussed: ', openingTag, tokens[0], $el);\n        }\n      } else {\n        console.log('focussed: ' + e.target);\n      }\n    }\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    TraceFocus.initialize();\n  });\n\n  return TraceFocus;\n\n});\n","define([\n  'core/js/adapt',\n  './utils'\n], function(Adapt, Utils) {\n\n  let mouseTarget = null;\n\n  function init() {\n    $(window).on('keypress', onKeypress);\n    $(window).on('mousedown', onMouseDown);\n    $(window).on('mouseup', onMouseUp);\n  }\n\n  function onKeypress(e) {\n    const char = String.fromCharCode(e.which).toLowerCase();\n\n    if (mouseTarget) {\n      switch (char) {\n        case 'c': return complete(mouseTarget);\n        case 'r': return reset(mouseTarget);\n      }\n    }\n  }\n\n  function complete(element) {\n    const model = Utils.getModelForElement(element) || Adapt.findById(Adapt.location._currentId);\n    if (!model) return;\n\n    function doCompletion(component) {\n      component.set('_isComplete', true);\n    }\n\n    const descendantComponents = model.findDescendantModels('components');\n    if (!descendantComponents || descendantComponents.length === 0) {\n      console.log('devtools: completing', model.get('_id'));\n      doCompletion(model);\n      return;\n    }\n\n    console.log('devtools: completing all components in', model.get('_id'));\n    _.each(descendantComponents, function(model) {\n      doCompletion(model);\n    });\n  }\n\n  function reset(element) {\n    const model = Utils.getModelForElement(element);\n    if (!model) return;\n\n    const descendantComponents = model.findDescendantModels('components');\n    if (!descendantComponents || descendantComponents.length === 0) {\n      console.log('devtools: resetting', model.get('_id'));\n      model.reset(true, true);\n      return;\n    }\n    console.log('devtools: resetting all components in', model.get('_id'));\n    _.each(descendantComponents, function(model) {\n      model.reset(true, true);\n    });\n  }\n\n  function onMouseDown(e) {\n    if (e.which === 1) mouseTarget = e.target;\n  }\n\n  function onMouseUp(e) {\n    if (e.which === 1) mouseTarget = null;\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    init();\n  });\n\n});\n","/*\n* adapt-devtools\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\n* Maintainers - Chris Steele <chris.steele@kineo.com>, Oliver Foster <oliver.foster@kineo.com>\n*/\n\ndefine([\n  'core/js/adapt',\n  'core/js/data',\n  'core/js/wait',\n  'core/js/models/adaptModel',\n  './devtools-model',\n  './pass-half-fail',\n  './toggle-banking',\n  './map',\n  './auto-answer',\n  './utils',\n  './end-trickle',\n  './hinting',\n  './toggle-feedback',\n  './toggle-alt-text',\n  './unlock',\n  './enable',\n  './toggle-trace-focus',\n  './toggle-completion'\n], function(Adapt, data, wait, AdaptModel, DevtoolsModel, PassHalfFail, ToggleBanking, CourseMap) {\n\n  let navigationView;\n\n  const DevtoolsView = Backbone.View.extend({\n\n    className: 'devtools',\n\n    events: {\n      'click .end-trickle': 'onEndTrickle',\n      'change .hinting input': 'onToggleHinting',\n      'change .banking input': 'onToggleBanking',\n      'change .feedback input': 'onToggleFeedback',\n      'change .auto-correct input': 'onToggleAutoCorrect',\n      'change .alt-text input': 'onToggleAltText',\n      'click .unlock': 'onUnlock',\n      'click .open-map': 'onOpenMap',\n      'click .open-spoor-log': 'onOpenSpoorLog',\n      'click .complete-page': 'onCompletePage',\n      'click .complete-menu': 'onCompleteMenu',\n      'click .pass': 'onPassHalfFail',\n      'click .half': 'onPassHalfFail',\n      'click .fail': 'onPassHalfFail',\n      'change .trace-focus input': 'onToggleTraceFocus'\n    },\n\n    initialize: function() {\n      this.render();\n\n      this._checkUnlockVisibility();\n      this._checkSpoorLogVisibility();\n      this._checkTrickleEndVisibility();\n      this._checkBankingVisibility();\n      this._checkFeedbackVisibility();\n      this._checkHintingVisibility();\n      this._checkAutoCorrectVisibility();\n      this._checkAltTextVisibility();\n      this._checkPassHalfFailVisibility();\n      this._checkCompletePageVisibility();\n      this._checkCompleteMenuVisibility();\n      this._checkTraceFocusVisibility();\n    },\n\n    render: function() {\n      const data = Adapt.devtools.toJSON();\n      const template = Handlebars.templates.devtools;\n      this.$el.html(template(data));\n      return this;\n    },\n\n    /*************************************************/\n    /** ******************* UNLOCK *******************/\n    /*************************************************/\n\n    _checkUnlockVisibility: function() {\n      // check if function available and not already activated\n      if (!Adapt.devtools.get('_unlockAvailable') || Adapt.devtools.get('_unlocked')) this.$('.unlock').addClass('u-display-none');\n      else this.$('.unlock').toggleClass('u-display-none', !this._checkForLocks());\n    },\n\n    _checkForLocks: function() {\n      if (typeof AdaptModel.prototype.checkLocking !== 'function') return Adapt.location._contentType === 'menu';\n\n      const hasLock = function(model) { return model.has('_lockType'); };\n\n      if (hasLock(Adapt.course)) return true;\n      if (Adapt.contentObjects.some(hasLock)) return true;\n      if (Adapt.articles.some(hasLock)) return true;\n      if (Adapt.blocks.some(hasLock)) return true;\n\n      return false;\n    },\n\n    onUnlock: function() {\n      Adapt.devtools.set('_unlocked', true);\n      this._checkUnlockVisibility();\n    },\n\n    /*************************************************/\n    /** ******************** MAP *********************/\n    /*************************************************/\n\n    onOpenMap: function() {\n      CourseMap.open();\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /*************************************************/\n    /** ******************* SPOOR ********************/\n    /*************************************************/\n\n    _checkSpoorLogVisibility: function() {\n      const spoorInstalled = require.defined('extensions/adapt-contrib-spoor/js/adapt-contrib-spoor');\n      if (spoorInstalled) return;\n      this.$('.open-spoor-log').addClass('is-disabled').attr('disabled', 'disabled');\n    },\n\n    onOpenSpoorLog: function() {\n      Adapt.trigger('drawer:closeDrawer');\n      if (Adapt.spoor) {\n        Adapt.spoor.scorm.showDebugWindow();\n        return;\n      }\n      require('extensions/adapt-contrib-spoor/js/scorm').showDebugWindow();\n    },\n\n    /*************************************************/\n    /** ****************** TRICKLE *******************/\n    /*************************************************/\n\n    _checkTrickleEndVisibility: function() {\n      this.$('.end-trickle').toggleClass('u-display-none', !Adapt.devtools.get('_trickleEnabled'));\n    },\n\n    onEndTrickle: function() {\n      Adapt.devtools.set('_trickleEnabled', false);\n      this._checkTrickleEndVisibility();\n    },\n\n    /*************************************************/\n    /** ************* QUESTION BANKING ***************/\n    /*************************************************/\n\n    _checkBankingVisibility: function() {\n      if (!Adapt.devtools.get('_toggleFeedbackAvailable')) {\n        this.$('.banking').addClass('u-display-none');\n        return;\n      }\n\n      const bankedAssessments = ToggleBanking.getBankedAssessmentsInCurrentPage();\n      const isBankingEnabled = function(m) { return m.get('_assessment')._banks._isEnabled; };\n\n      if (bankedAssessments.length > 0) {\n        this.$('.banking').removeClass('u-display-none');\n        this.$('.banking label').toggleClass('is-selected', _.some(bankedAssessments, isBankingEnabled));\n        return;\n      }\n      this.$('.banking').addClass('u-display-none');\n    },\n\n    onToggleBanking: function() {\n      ToggleBanking.toggle();\n      this._checkBankingVisibility();\n    },\n\n    /*************************************************/\n    /** ********* QUESTION FEEDBACK (TUTOR) **********/\n    /*************************************************/\n\n    _checkFeedbackVisibility: function() {\n      if (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n        this.$('.feedback').removeClass('u-display-none');\n        this.$('.feedback label').toggleClass('is-selected', Adapt.devtools.get('_feedbackEnabled'));\n        return;\n      }\n      this.$('.feedback').addClass('u-display-none');\n    },\n\n    onToggleFeedback: function() {\n      Adapt.devtools.toggleFeedback();\n      this._checkFeedbackVisibility();\n    },\n\n    /*************************************************/\n    /** ************* QUESTION HINTING ***************/\n    /*************************************************/\n\n    _checkHintingVisibility: function() {\n      if (Adapt.devtools.get('_hintingAvailable')) {\n        this.$('.hinting').removeClass('u-display-none');\n        this.$('.hinting label').toggleClass('is-selected', Adapt.devtools.get('_hintingEnabled'));\n        return;\n      }\n      this.$('.hinting').addClass('u-display-none');\n    },\n\n    onToggleHinting: function() {\n      Adapt.devtools.toggleHinting();\n      this._checkHintingVisibility();\n    },\n\n    /*************************************************/\n    /** *************** AUTO CORRECT *****************/\n    /*************************************************/\n\n    _checkAutoCorrectVisibility: function() {\n      if (Adapt.devtools.get('_autoCorrectAvailable')) {\n        this.$('.is-toggle.auto-correct').removeClass('u-display-none');\n        this.$('.is-toggle.auto-correct label').toggleClass('is-selected', Adapt.devtools.get('_autoCorrectEnabled'));\n        this.$('.is-tip.auto-correct').toggleClass('u-display-none', Adapt.devtools.get('_autoCorrectEnabled'));\n        return;\n      }\n      this.$('.auto-correct').addClass('u-display-none');\n    },\n\n    onToggleAutoCorrect: function() {\n      Adapt.devtools.toggleAutoCorrect();\n      this._checkAutoCorrectVisibility();\n    },\n\n    /*************************************************/\n    /** ***************** ALT TEXT *******************/\n    /*************************************************/\n\n    _checkAltTextVisibility: function() {\n      if (Adapt.devtools.get('_altTextAvailable')) {\n        this.$('.is-toggle.alt-text').removeClass('u-display-none');\n        this.$('.is-toggle.alt-text label').toggleClass('is-selected', Adapt.devtools.get('_altTextEnabled'));\n        this.$('.is-tip.alt-text').toggleClass('u-display-none', Adapt.devtools.get('_altTextEnabled'));\n        return;\n      }\n      this.$('.alt-text').addClass('u-display-none');\n    },\n\n    onToggleAltText: function() {\n      Adapt.devtools.toggleAltText();\n      this._checkAltTextVisibility();\n    },\n\n    /*************************************************/\n    /** *************** COMPLETE PAGE ****************/\n    /*************************************************/\n\n    _checkCompletePageVisibility: function() {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'page') {\n        this.$('.complete-page').addClass('u-display-none');\n        return;\n      }\n\n      const incomplete = currentModel.findDescendantModels('components', { where: { _isInteractionComplete: false } });\n\n      this.$('.complete-page').toggleClass('u-display-none', incomplete.length === 0);\n\n    },\n\n    onCompletePage: function(e) {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      const incomplete = currentModel.findDescendantModels('components', { where: { _isInteractionComplete: false } });\n\n      incomplete.forEach(function(component) {\n        if (component.get('_isQuestionType')) {\n          component.set({\n            _isCorrect: true,\n            _isSubmitted: true,\n            _score: 1\n          });\n          component.set('_attemptsLeft', Math.max(0, component.set('_attempts') - 1));\n        }\n\n        component.set('_isComplete', true);\n        component.set(currentModel.has('_isInteractionsComplete') ? '_isInteractionsComplete' : '_isInteractionComplete', true);\n      });\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /*************************************************/\n    /** *************** COMPLETE MENU ****************/\n    /*************************************************/\n\n    _checkCompleteMenuVisibility: function() {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'menu' && currentModel.get('_type') !== 'course') {\n        this.$('.complete-menu').addClass('u-display-none');\n        return;\n      }\n\n      const incomplete = currentModel.findDescendantModels('components', { where: { _isComplete: false } });\n\n      this.$('.complete-menu').toggleClass('u-display-none', incomplete.length === 0);\n\n    },\n\n    onCompleteMenu: function(e) {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      const incomplete = currentModel.findDescendantModels('components', { where: { _isComplete: false } });\n      _.invoke(incomplete, 'set', '_isComplete', true);\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /************************************************************/\n    /** ***** Similar to original adapt-cheat functionality *****/\n    /************************************************************/\n\n    _checkPassHalfFailVisibility: function() {\n      const currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'page') {\n        this.$('.pass, .half, .fail').addClass('u-display-none');\n        return;\n      }\n\n      const unanswered = currentModel.findDescendantModels('components', { where: { _isQuestionType: true, _isSubmitted: false } });\n\n      if (unanswered.length === 0) this.$('.tip.pass-half-fail').html('');\n      else this.$('.is-tip.pass-half-fail').html('With the ' + unanswered.length + ' unanswered question(s) in this page do the following:');\n\n      this.$('.pass, .half, .fail').toggleClass('u-display-none', unanswered.length === 0);\n\n    },\n\n    onPassHalfFail: function(e) {\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      // potentially large operation so show some feedback\n      $('.js-loading').show();\n\n      const tutorEnabled = Adapt.devtools.get('_feedbackEnabled');\n\n      if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', false);\n\n      if ($(e.currentTarget).hasClass('pass')) PassHalfFail.pass(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n      else if ($(e.currentTarget).hasClass('half')) PassHalfFail.half(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n      else PassHalfFail.fail(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    onPassHalfFailComplete: function(tutorEnabled) {\n      console.log('onPassHalfFailComplete');\n\n      if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', true);\n\n      $('.js-loading').hide();\n    },\n\n    /*************************************************/\n    /** ***************** EXTENDED *******************/\n    /*************************************************/\n\n    _checkTraceFocusVisibility: function() {\n      if (Adapt.devtools.get('_traceFocusAvailable')) {\n        this.$('.is-toggle.trace-focus').removeClass('u-display-none');\n        this.$('.is-toggle.trace-focus label').toggleClass('is-selected', Adapt.devtools.get('_traceFocusEnabled'));\n        return;\n      }\n      this.$('.trace-focus').addClass('u-display-none');\n    },\n\n    onToggleTraceFocus: function() {\n      Adapt.devtools.toggleTraceFocus();\n      this._checkTraceFocusVisibility();\n    }\n  });\n\n  const DevtoolsNavigationView = Backbone.View.extend({\n\n    initialize: function() {\n      const template = Handlebars.templates.devtoolsNavigation;\n\n      this.$el = $(template());\n\n      $('html').addClass('devtools-enabled').toggleClass('devtools-extended', Adapt.devtools.get('_extended'));\n\n      if (this.$el.is('a') || this.$el.is('button')) this.$el.on('click', this.onDevtoolsClicked.bind(this));\n      else this.$el.find('a, button').on('click', this.onDevtoolsClicked.bind(this));\n\n      // keep drawer item to left of PLP, resources, close button etc\n      this.listenTo(Adapt, 'pageView:postRender menuView:postRender', this.onContentRendered);\n      // ensure render occurs at least once (_isReady will not change to true on menus that exclude content objects)\n      this.listenToOnce(Adapt, 'pageView:postRender menuView:postRender', this.render);\n    },\n\n    render: function() {\n      $('.nav__inner').append(this.$el);\n      return this;\n    },\n\n    remove: function() {\n      this.$el.remove();\n      this.stopListening();\n      return this;\n    },\n\n    deferredRender: function() {\n      _.defer(this.render.bind(this));\n    },\n\n    onContentRendered: function(view) {\n      if (view.model.get('_id') === Adapt.location._currentId) {\n        this.stopListening(view.model, 'change:_isReady', this.deferredRender);\n        this.listenToOnce(view.model, 'change:_isReady', this.deferredRender);\n      }\n    },\n\n    onDevtoolsClicked: function(event) {\n      if (event && event.preventDefault) event.preventDefault();\n      Adapt.drawer.triggerCustomView(new DevtoolsView().$el, false);\n    }\n\n  });\n\n  Adapt.once('courseModel:dataLoaded', function() {\n    Adapt.devtools = new DevtoolsModel();\n  });\n\n  function initNavigationView() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (navigationView) navigationView.remove();\n\n    navigationView = new DevtoolsNavigationView();\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    initNavigationView();\n    Adapt.on('app:languageChanged', initNavigationView);\n  });\n\n  data.on('loaded', async () => {\n    const isDescendant = (model, ancestor) => {\n      let parent;\n      while (parent = data._byAdaptID[model.get('_parentId')]) {\n        if (parent === ancestor) {\n          return true;\n        }\n        model = parent;\n      }\n      return false;\n    }\n\n    const removeDescendants = (ancestor) => {\n      const prunable = [];\n      for (const id in data._byAdaptID) {\n        const model = data._byAdaptID[id];\n        if (isDescendant(model, ancestor)) {\n          prunable.push(model)\n        }\n      }\n      prunable.forEach(model => data.remove(model));\n    }\n\n    const removeModel = (id) => {\n      const model = data._byAdaptID[id];\n      removeDescendants(model);\n      data.remove(model);\n    }\n\n    const processConfig = (cfg) => {\n      if (!cfg || cfg._isEnabled === false) return;\n\n      if (Array.isArray(cfg._modelsToRemove)) {\n        cfg._modelsToRemove.forEach(id => removeModel(id));\n\n        // things like AdaptSubsetCollection instances need to update\n        data.trigger('reset');\n      }\n    }\n\n    wait.begin();\n\n    try {\n      const devConfig = await data.getJSON('dev.json');\n      processConfig(devConfig);\n    } catch (err) {\n    } finally {\n      wait.end();\n    }\n  })\n\n});\n","import Adapt from 'core/js/adapt';\nimport notify from 'core/js/notify';\nimport { templates } from 'core/js/reactHelpers';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nclass GraphicExpandView extends Backbone.View {\n  className() {\n    return 'graphicexpand';\n  }\n\n  attributes() {\n    const attributes = { 'data-component': this.model.get('_component') };\n    return attributes;\n  }\n\n  initialize() {\n\n    this.onClick = this.onClick.bind(this);\n    this.render();\n  }\n\n  render() {\n    const props = { ...this.model.toJSON(), onClick: this.onClick };\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\n    ReactDOM.render(<Template {...props} />, this.el);\n  }\n\n  onClick(event) {\n    event.preventDefault();\n    const $graphicexpand = $(event.currentTarget);\n \n    const $img = $graphicexpand.parent().parent().find('img');\n    let imgsrc = $img.attr('data-large') || $img.attr('src');\n    if (imgsrc === undefined) {\n      const imgsrcLottie = $graphicexpand.parent().parent().find('div[data-graphiclottie=\"true\"]')\n      if (imgsrcLottie.length > 0) {\n        imgsrc = imgsrcLottie.attr('src')\n      }\n    };\n    if(imgsrc === undefined) return;\n    notify.popup({\n      _type: 'popup',\n      title: '',\n      body: '<img src=\"' + imgsrc + '\" />',\n      _classes: 'graphicexpand-popup'\n    });\n  }\n}\nGraphicExpandView.template = 'graphic-expand';\nexport default GraphicExpandView;\n","\nimport Adapt from 'core/js/adapt';\nimport GraphicExpandView from './graphicExpandView';\nclass GraphicExpand extends Backbone.Controller {\n  initialize() {\n    this.listenTo(Adapt, {\n      'componentView:postRender': this.onComponentPostRender\n    });\n  }\n\n  onComponentPostRender(view) {\n\n    const model = view.model;\n    if (!this.checkIsEnabled(model)) return;\n\n    const _graphicExpand = model.get('_graphicExpand');\n    const $insertElement = view.$el.find(_graphicExpand._selector || '.component__widget');\n    if ($insertElement.length === 0) return;\n\n    if ($insertElement.length > 1) {\n      _.each($insertElement, (element) => {\n        const graphicExpandView = new GraphicExpandView({ model: model });\n        $(element).after(graphicExpandView.el).parent().addClass('has-graphicexpand');\n      });\n\n    } else {\n      const graphicExpandView = new GraphicExpandView({ model: model });\n      $insertElement.after(graphicExpandView.el).parent().addClass('has-graphicexpand');\n    }\n\n  }\n\n  checkIsEnabled(model) {\n    const _model = model.get('_graphicExpand');\n    if (!_model || !_model._isEnabled) return false;\n    return true;\n  }\n}\nexport default new GraphicExpand();\n","define([\n   'core/js/adapt',\n], function(Adapt) {\n\n    var footerLink = _.extend({\n  \n    initialize: function() {\n    \tthis.listenTo(Adapt, 'router:course', this.updateCourse);\n    \tthis.listenTo(Adapt, 'pageView:ready', this.addLinks);\n        this.listenTo(Adapt, 'menuView:ready', this.addLinks);\n        this.listenTo(Adapt, 'router:page', this.updatePage);\n    },\n\n    updateCourse: function(target) {\n    \tthis.currentCourse = target;\n    },\n\n    getCourse: function() {\n    \treturn this.currentCourse;\n    },\n    \n    updatePage: function(target) {\n        this.contentObject = target;\n    },\n\n    getPage: function() {\n        return this.contentObject;\n    },\n\n    addLinks: function() {\n        var items = [];\n        try {\n            items = this.contentObject.get('_FooterLink')._items;\n        } catch(err) {}\n        if (items.length < 1) {\n            items = Adapt.course.get('_FooterLink')._items;\n        }\n        _.each(items, function(item) {\n            var title = item.title;\n            var link = item.link;\n            try {\n                if( $('.about-links').prop('innerHTML').trim().length > 0) {\n                    $('.about-links').append(' | ');\n                } \n                $('.about-links').append('<a class=\"about\" target=\"_blank\"; href=\\''+link+'\\'>'+title+'</a>');\n            } catch(err) {}\n        });\n    }\n\n  }, Backbone.Events);\n  \n  footerLink.initialize();\n\n  return (footerLink);\n});","define([\n  'core/js/adapt',\n], function(Adapt) {\n\n    var licencePage = _.extend({\n  \n    initialize: function() {\n    \tthis.listenTo(Adapt, 'licencePage:showLicencePage', this.showLicencePage);\n    \tthis.listenTo(Adapt, 'router:course', this.updateCourse);\n    \tthis.listenTo(Adapt, 'pageView:ready', this.addLink);\n        this.listenTo(Adapt, 'menuView:ready', this.addLink);\n        this.listenTo(Adapt, 'router:page', this.updatePage);\n    },\n\n    updateCourse: function(target) {\n    \tthis.currentCourse = target;\n    },\n\n    getCourse: function() {\n    \treturn this.currentCourse;\n    },\n    \n    updatePage: function(target) {\n        this.contentObject = target;\n    },\n\n    getPage: function() {\n        return this.contentObject;\n    },\n\n    addLink: function() {\n        var title = \"Licence\";\n        try {\n            title = Adapt.course.get('_globals')._extensions._ODILicence.linkText;\n        \n            if( $('.about-links').prop('innerHTML').trim().length > 0) {\n            \t$('.about-links').append(' | ');\n            } \n            $('.about-links').append('<a class=\"about\" onClick=\"require(\\'core/js/adapt\\').trigger(\\'licencePage:showLicencePage\\'); return false;\">'+title+'</a>');\n\t} catch(err) {}\n    },\n    \n    showLicencePage: function() {\n        var items = [];\n        try {\n            items = this.contentObject.get('_ODILicence')._items;\n        } catch(err) {}\n        if (items.length < 1) {\n            items = Adapt.course.get('_ODILicence')._items;\n        }\n        \n        var title = \"Licence\";\n        try {\n            title = Adapt.course.get('_globals')._extensions._ODILicence.titleText;\n        } catch(err) {}\n    \tvar string = \"\";\n    \tvar count = 1;\n \t\t_.each(items, function(item) {\n\t\t\tvar graphic = item._graphic;\n\t\t\tif (graphic.src) {\n\t\t\t\tstring += \"<div class='licencePageGraphicElement'><img class='licencePageGraphic' src='\" + graphic.src + \"'/></div>\";\n\t\t\t}\n\t \t\tstring += \"<div class='licencePageText'>\";\n\t\t\tstring += \"<h2>\" + item.title + \"</h2>\";\n \t\t\tstring += \"<p>\" + item.description + \"</p>\";\n\t\t\tstring += \"</div>\";\n \t\t\tstring += \"<hr class='licencePageRule'/>\";\n    \t});\n\t\n\t\tvar alertObject = {\n            title: title,\n            body: string\n        };\n\n        Adapt.once(\"notify:closed\", function() {\n            Adapt.trigger(\"tutor:closed\");\n        });\n\n        Adapt.trigger('notify:popup', alertObject);\n\n        Adapt.trigger('tutor:opened');\n    }\n\n  }, Backbone.Events);\n  \n  licencePage.initialize();\n\n  return (licencePage);\n});","import AdaptView from 'core/js/views/adaptView';\n\nclass MenuItemView extends AdaptView {\n\n  attributes() {\n    return AdaptView.resultExtend('attributes', {\n      'role': 'listitem',\n      'aria-labelledby': this.model.get('_id') + '-heading'\n    }, this);\n  }\n\n  className() {\n    return [\n      'menu-item',\n      this.constructor.className,\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isVisited') ? 'is-visited' : ''),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isLocked') ? 'is-locked' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n  preRender() {\n    this.model.checkCompletionStatus();\n    this.model.checkInteractionCompletionStatus();\n  }\n\n  postRender() {\n    this.$el.imageready(this.setReadyStatus.bind(this));\n  }\n\n}\n\nMenuItemView.type = 'menuItem';\n\nexport default MenuItemView;\n","import ContentObjectView from 'core/js/views/contentObjectView';\nimport MenuItemView from 'core/js/views/menuItemView';\n\nclass MenuView extends ContentObjectView {}\n\nObject.assign(MenuView, {\n  /**\n   * TODO:\n   * child view here should not be fixed to the MenuItemView\n   * menus may currently rely on this\n   */\n  childContainer: '.js-children',\n  childView: MenuItemView,\n  type: 'menu',\n  template: 'menu'\n});\n\nexport default MenuView;\n","import MenuItemView from 'core/js/views/menuItemView';\nimport router from 'core/js/router';\n\nclass BoxMenuItemView extends MenuItemView {\n\n  className() {\n    return `${super.className()} boxmenu-item`;\n  }\n\n  events() {\n    return {\n      'click .js-btn-click': 'onClickMenuItemButton'\n    };\n  }\n\n  onClickMenuItemButton(event) {\n    if (event && event.preventDefault) event.preventDefault();\n    if (this.model.get('_isLocked')) return;\n    router.navigateToElement(this.model.get('_id'));\n  }\n}\n\nBoxMenuItemView.template = 'boxMenuItem';\n\nexport default BoxMenuItemView;\n","import MenuItemView from 'core/js/views/menuItemView';\nimport BoxMenuItemView from './BoxMenuItemView';\n\nclass BoxMenuGroupView extends MenuItemView {\n\n  className() {\n    return `${super.className()} boxmenu-group`;\n  }\n\n  postRender() {\n    _.defer(this.addChildren.bind(this));\n    this.$el.imageready(this.setReadyStatus.bind(this));\n    this.$el.parents('.boxmenu__item-container').addClass('has-groups');\n  }\n}\n\nBoxMenuGroupView.template = 'boxMenuGroup';\nBoxMenuGroupView.childContainer = '.js-group-children';\nBoxMenuGroupView.childView = BoxMenuItemView;\n\nexport default BoxMenuGroupView;\n","import Adapt from 'core/js/adapt';\nimport MenuView from 'core/js/views/menuView';\nimport BoxMenuItemView from './BoxMenuItemView';\nimport BoxMenuGroupView from './BoxMenuGroupView';\n\nclass BoxMenuView extends MenuView {\n\n  className() {\n    return `${super.className()} boxmenu`;\n  }\n\n  initialize() {\n    super.initialize();\n    this.setStyles();\n\n    this.listenTo(Adapt, 'device:changed', this.onDeviceResize);\n  }\n\n  onDeviceResize() {\n    this.setStyles();\n  }\n\n  addChildren() {\n    let nthChild = 0;\n    const models = this.model.getChildren().models;\n    const childViews = [];\n    models.forEach(model => {\n      if (!model.get('_isAvailable')) return;\n\n      if (model.get('_isHidden')) {\n        model.set('_isReady', true);\n        return;\n      }\n\n      nthChild++;\n      model.set('_nthChild', nthChild);\n\n      const ChildView = (model.get('_type') === 'menu' && model.get('_boxMenu') && model.get('_boxMenu')._renderAsGroup) ?\n        BoxMenuGroupView :\n        BoxMenuItemView;\n\n      const $parentContainer = this.$(this.constructor.childContainer);\n      const childView = new ChildView({ model });\n\n      childViews.push(childView);\n\n      $parentContainer.append(childView.$el);\n    });\n\n    this.setChildViews(childViews);\n  }\n\n  setStyles() {\n    this.addBackgroundLayer();\n    this.setBackgroundImage();\n    this.setBackgroundStyles();\n    this.processHeader();\n  }\n\n  addBackgroundLayer() {\n    if (this.$el.find(' > .background').length) return;\n    this.$background = $('<div class=\"background\" aria-hidden=\"true\"></div>')\n      .prependTo(this.$el);\n  }\n\n  setBackgroundImage() {\n    const config = this.model.get('_boxMenu');\n    const backgroundImages = config?._backgroundImage;\n    if (!backgroundImages) return;\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\n    this.$el.toggleClass('has-bg-image', Boolean(backgroundImage));\n    this.$background\n      .css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\n  }\n\n  setBackgroundStyles() {\n    const config = this.model.get('_boxMenu');\n    const styles = config?._backgroundStyles;\n    if (!styles) return;\n    this.$background.css({\n      'background-repeat': styles._backgroundRepeat,\n      'background-size': styles._backgroundSize,\n      'background-position': styles._backgroundPosition\n    });\n  }\n\n  processHeader() {\n    const config = this.model.get('_boxMenu');\n    const header = config?._menuHeader;\n    if (!header) return;\n    const $header = this.$('.menu__header');\n    this.addHeaderBackgroundLayer($header);\n    this.setHeaderBackgroundImage(header, $header);\n    this.setHeaderBackgroundStyles(header, $header);\n    this.setHeaderMinimumHeight(header, $header);\n  }\n\n  addHeaderBackgroundLayer($header) {\n    if ($header.find(' > .background').length) return;\n    this.$headerBackground = $('<div class=\"background\" aria-hidden=\"true\"></div>')\n      .prependTo($header);\n  }\n\n  setHeaderBackgroundImage(config, $header) {\n    const backgroundImages = config._backgroundImage;\n    if (!backgroundImages) return;\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\n    $header.toggleClass('has-bg-image', Boolean(backgroundImage));\n    this.$headerBackground.css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\n  }\n\n  setHeaderBackgroundStyles(config, $header) {\n    const styles = config._backgroundStyles;\n    if (!styles) return;\n    this.$headerBackground.css({\n      'background-repeat': styles._backgroundRepeat,\n      'background-size': styles._backgroundSize,\n      'background-position': styles._backgroundPosition\n    });\n  }\n\n  setHeaderMinimumHeight(config, $header) {\n    const minimumHeights = config._minimumHeights;\n    if (!minimumHeights) return;\n    const minimumHeight = minimumHeights[`_${Adapt.device.screenSize}`] ?? minimumHeights._small;\n    $header\n      .toggleClass('has-min-height', Boolean(minimumHeight))\n      .css('min-height', minimumHeight ? minimumHeight + 'px' : '');\n  }\n\n}\n\nBoxMenuView.template = 'boxMenu';\n\nexport default BoxMenuView;\n","import components from 'core/js/components';\nimport MenuModel from 'core/js/models/menuModel';\nimport BoxMenuView from './BoxMenuView';\n\n// Use as default \"_type\": \"course\" or \"_type\": \"menu\" view.\n// Note: This is necessary to maintain legacy behaviour in the AAT where\n// only one menu is usable per course and the course / menu is assumed to be\n// a core model and use the only installed MenuView.\ncomponents.register('course menu', {\n  view: BoxMenuView\n});\n\n// Use for \"_component\": \"boxMenu\", or \"_view\": \"boxMenu\" and \"_model\": \"boxMenu\"\ncomponents.register('boxMenu', {\n  view: BoxMenuView,\n  model: MenuModel.extend({})\n});\n","define([\n  \"core/js/adapt\"\n], function(Adapt) {\n\n  var ThemeView = Backbone.View.extend({\n\n    className: function() {},\n\n    initialize: function() {\n      this.setStyles();\n\n      this.listenTo(Adapt, {\n        \"device:changed\": this.onDeviceResize,\n        \"remove\": this.remove\n      });\n    },\n\n    onDeviceResize: function() {\n      this.setStyles();\n    },\n\n    remove: function() {\n      Backbone.View.prototype.remove.call(this);\n\n      this.onRemove();\n    },\n\n    setStyles: function() {\n      this.setClasses();\n      this.setBackgroundImage();\n      this.setBackgroundStyles();\n      this.setMinimumHeight();\n      this.setCustomStyles();\n    },\n\n    setClasses: function() {\n      this.$el.addClass(this.className());\n    },\n\n    setBackgroundImage: function() {\n      \n      var backgroundImages = this.model.get(\"_backgroundImage\");\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          backgroundImage = backgroundImages._large;\n          break;\n        case \"medium\":\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        this.$el\n          .addClass(\"has-bg-image\")\n          .css(\"background-image\", \"url(\" + backgroundImage + \")\");\n      } else {\n        this.$el\n          .removeClass(\"has-bg-image\")\n          .css(\"background-image\", \"\");\n      }\n    },\n\n    setBackgroundStyles: function () {\n      var styles = this.model.get(\"_backgroundStyles\");\n\n      if (!styles) return;\n\n      this.$el.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setMinimumHeight: function() {\n      var minimumHeights = this.model.get(\"_minimumHeights\");\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          minimumHeight = minimumHeights._large;\n          break;\n        case \"medium\":\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        this.$el\n          .addClass(\"has-min-height\")\n          .css(\"min-height\", minimumHeight + \"px\");\n      } else {\n        this.$el\n          .removeClass(\"has-min-height\")\n          .css(\"min-height\", \"\");\n      }\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeView;\n\n});\n","define([\n  './themeView',\n  'core/js/adapt'\n], function(ThemeView, Adapt) {\n\n  var ThemePageView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {\n      this.processHeader();\n    },\n\n    processHeader: function() {\n      var header = this.model.get('_pageHeader');\n\n      if (!header) return;\n\n      var $header = this.$('.page__header');\n\n      this.setHeaderBackgroundImage(header, $header);\n      this.setHeaderBackgroundStyles(header, $header);\n      this.setHeaderMinimumHeight(header, $header);\n    },\n\n    setHeaderBackgroundImage: function(config, $header) {\n      var backgroundImages = config._backgroundImage;\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          backgroundImage = backgroundImages._large;\n          break;\n        case \"medium\":\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        $header\n          .addClass(\"has-bg-image\")\n          .css(\"background-image\", \"url(\" + backgroundImage + \")\");\n      } else {\n        $header\n          .removeClass(\"has-bg-image\")\n          .css(\"background-image\", \"\");\n      }\n    },\n\n    setHeaderBackgroundStyles: function (config, $header) {\n      var styles = config._backgroundStyles;\n\n      if (!styles) return;\n\n      $header.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setHeaderMinimumHeight: function(config, $header) {\n      var minimumHeights = config._minimumHeights;\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          minimumHeight = minimumHeights._large;\n          break;\n        case \"medium\":\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        $header\n          .addClass(\"has-min-height\")\n          .css(\"min-height\", minimumHeight + \"px\");\n      } else {\n        $header\n          .removeClass(\"has-min-height\")\n          .css(\"min-height\", \"\");\n      }\n    },\n\n    onRemove: function() {}\n\n  });\n\n  return ThemePageView;\n\n});\n","define([\n  \"./themeView\",\n  \"core/js/adapt\"\n], function(ThemeView, Adapt) {\n\n  var ThemeArticleView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeArticleView;\n\n});\n","define([\n  \"./themeView\",\n  \"core/js/adapt\"\n], function(ThemeView, Adapt) {\n\n  var ThemeBlockView = ThemeView.extend({\n\n    className: function() {\n      return this.model.get(\"_isDividerBlock\") ? \"is-divider-block\" : \"\";\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeBlockView;\n\n});\n","define([\n  \"core/js/adapt\",\n  \"./themePageView\",\n  \"./themeArticleView\",\n  \"./themeBlockView\",\n  \"./themeView\"\n], function(Adapt, ThemePageView, ThemeArticleView, ThemeBlockView, ThemeView) {\n\n  function onDataReady() {\n    $(\"html\").addClass(Adapt.course.get(\"_courseStyle\"));\n  }\n\n  function onPostRender(view) {\n    var model = view.model;\n    var theme = model.get(\"_odi-theme\");\n\n    if (!theme) return;\n\n    switch (model.get(\"_type\")) {\n      case \"page\":\n        new ThemePageView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case \"article\":\n        new ThemeArticleView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case \"block\":\n        new ThemeBlockView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      default:\n        new ThemeView({ model: new Backbone.Model(theme), el: view.$el });\n    }\n  }\n\n  Adapt.on({\n    \"app:dataReady\": onDataReady,\n    \"pageView:postRender articleView:postRender blockView:postRender\": onPostRender\n  });\n});\n","import Adapt from 'core/js/adapt';\nimport device from 'core/js/device';\nimport React, { useRef } from 'react';\nimport { prefixClasses, compile } from 'core/js/reactHelpers';\n\n/**\n * Content header for displayTitle, body, instruction text, etc.\n * instruction and mobileInstruction will switch automatically\n * @param {Object} props\n * @param {string} [props.displayTitle]\n * @param {string} [props.body]\n * @param {string} [props.instruction]\n * @param {string} [props.mobileInstruction]\n * @param {string} [props._type]\n * @param {string} [props._component]\n * @param {string} [props._disableAccessibilityState]\n */\nexport default function Header(props) {\n  // Create references to un-controlled view containers\n  const jsxHeading = useRef(null);\n  const {\n    _id,\n    displayTitle,\n    body,\n    instruction,\n    mobileInstruction,\n    _type,\n    _component,\n    _disableAccessibilityState,\n    _isA11yComponentDescriptionEnabled,\n    classNamePrefixes = [\n      _type && _type.toLowerCase(),\n      _component && _component.toLowerCase()\n    ].filter(Boolean)\n  } = props;\n  const sizedInstruction = (mobileInstruction && device.screenSize !== 'large') ?\n    mobileInstruction :\n    instruction;\n  const _globals = Adapt.course.get('_globals');\n  const ariaRegion = _globals?._components?.[`_${_component}`]?.ariaRegion;\n  const isSet = (displayTitle || body || sizedInstruction);\n  if (!isSet && _isA11yComponentDescriptionEnabled && ariaRegion) {\n    // If no title, displaytitle, body or instruction is specified\n    // Output only the component description\n    return (\n      <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion) }}>\n      </div>\n    );\n  }\n  if (!isSet) return null;\n  return (\n    <div id={`${_id}-header`} className={prefixClasses(classNamePrefixes, ['__header'])}>\n      <div className={prefixClasses(classNamePrefixes, ['__header-inner'])}>\n        {displayTitle &&\n        <div className={prefixClasses(classNamePrefixes, ['__title'])}>\n\n          {!_disableAccessibilityState &&\n          <div className=\"js-heading\" ref={jsxHeading}></div>\n          }\n\n          <div className={prefixClasses(classNamePrefixes, ['__title-inner'])} aria-hidden={!_disableAccessibilityState} dangerouslySetInnerHTML={{ __html: compile(displayTitle, props) }} >\n          </div>\n\n        </div>\n        }\n\n        {_isA11yComponentDescriptionEnabled && ariaRegion &&\n        <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion, props) }}>\n        </div>\n        }\n\n        {body &&\n        <div className={prefixClasses(classNamePrefixes, ['__body'])}>\n          <div className={prefixClasses(classNamePrefixes, ['__body-inner'])} dangerouslySetInnerHTML={{ __html: compile(body, props) }}>\n          </div>\n        </div>\n        }\n\n        {sizedInstruction &&\n        <div className={prefixClasses(classNamePrefixes, ['__instruction'])}>\n          <div className={prefixClasses(classNamePrefixes, ['__instruction-inner'])} dangerouslySetInnerHTML={{ __html: compile(sizedInstruction, props) }}>\n          </div>\n        </div>\n        }\n\n      </div>\n    </div>\n  );\n}\n","import device from 'core/js/device';\nimport a11y from 'core/js/a11y';\nimport React from 'react';\nimport { html, classes, prefixClasses } from 'core/js/reactHelpers';\n\n/**\n * Size switching content image\n * @param {Object} props\n * @param {Array} props.classNamePrefixes\n * @param {Array} [props.attributionClassNamePrefixes]\n */\nexport default function Image(props) {\n  const hasMediumSetting = (Object.prototype.hasOwnProperty.call(props, '_medium') || Object.prototype.hasOwnProperty.call(props, 'medium'));\n  const screenSize = hasMediumSetting\n    ? device.screenSize\n    : (device.screenSize === 'large' ? 'large' : 'small');\n  const src = (\n    props[`_${screenSize}`] ||\n    props[`${screenSize}`] ||\n    props._src ||\n    props.src\n  );\n  const hasSource = Boolean(src);\n  if (!hasSource) return null;\n  const attributionClassNamePrefixes = (props.attributionClassNamePrefixes || props.classNamePrefixes);\n  return (\n    <span\n      id={props.id}\n      className={classes([\n        prefixClasses(props.classNamePrefixes, ['__image-container']),\n        props.classes,\n        props.attribution && 'has-attribution'\n      ])}\n    >\n\n      <img\n        className={prefixClasses(props.classNamePrefixes, ['__image'])}\n        src={src}\n        aria-label={a11y.normalize(props.alt)}\n        aria-hidden={!props.alt}\n        loading='eager'\n        aria-describedby={props.longdescription ? props.longDescriptionId : undefined}\n      />\n\n      {props.attribution &&\n      <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution'])}>\n        <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution-inner'])}>\n          {html(props.attribution)}\n        </span>\n      </span>\n      }\n\n    </span>\n  );\n}\n","import React from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nconst LinkWrapper = ({ href, children, target, className, role }) =>\n  href\n    ? <a href={href} target={target} className={className} role={role}>{children}</a>\n    : children;\n\nexport default function Graphic(props) {\n  const {\n    _id,\n    _isScrollable,\n    _scrollPercent,\n    _graphic,\n    _globals\n  } = props;\n\n  const scrollableProperties = _isScrollable\n    ? {\n      role: 'slider',\n      className: 'component__widget graphic__widget js-graphic-scrollbar',\n      'aria-controls': `graphic__scroll__container__${_id}`,\n      'aria-orientation': 'horizontal',\n      'aria-valuemax': '100',\n      'aria-valuemin': '0',\n      'aria-valuenow': _scrollPercent,\n      'aria-label': Handlebars.compile(_globals._components._graphic.scrollAriaLabel)(props),\n      'aria-describedby': _graphic.longdescription ? `graphic__longdescription__${_id}` : undefined,\n      tabIndex: '0'\n    }\n    : {};\n  return (\n    <div className='component__inner graphic__inner'>\n\n      <templates.header {...props} />\n\n      <div className='component__widget graphic__widget' {...scrollableProperties}>\n\n        <LinkWrapper\n          href = {_graphic._url}\n          target = {_graphic._target}\n          className = 'graphic__link js-graphic-link'\n          role = 'link'\n        >\n\n          <templates.image {..._graphic}\n            aria-hidden={_isScrollable}\n            id={`graphic__scroll__container__${_id}`}\n            longDescriptionId={`graphic__longdescription__${_id}`}\n            classes=\"js-graphic-scroll-container\"\n            classNamePrefixes={[\n              'component',\n              'graphic'\n            ]}\n          />\n\n          {_graphic.longdescription &&\n          <div\n            id={`graphic__longdescription__${_id}`}\n            className=\"graphic__longdescription\"\n          >\n            <div className=\"graphic__longdescription-inner\">\n              {_graphic.longdescription}\n            </div>\n          </div>\n          }\n\n        </LinkWrapper>\n\n      </div>\n\n    </div>\n  );\n}\n","import React from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nexport default function Text(props) {\n  return (\n    <div className=\"component__inner text__inner\">\n      <templates.header {...props} />\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nimport { DragDropContext } from './libraries/react-beautiful-dnd.min.js';\n\nexport default function DndMultiple(props) {\n  const { _isEnabled, _isCorrectAnswerShown, _items, _correctItems, setItems } =\n    props;\n\n  const [dragItems, setDragItems] = useState(_items);\n  const countItems = Object.keys(dragItems).length;\n  useEffect(() => {\n    if (_isCorrectAnswerShown) {\n      setDragItems(_correctItems);\n    } else {\n      if (!_isEnabled) {\n        setDragItems(_items);\n      }\n    }\n  }, [_isCorrectAnswerShown]);\n\n  useEffect(() => {\n    if (!_isEnabled) return null;\n\n    setItems(dragItems);\n  }, [dragItems]);\n\n  const onDragEnd = ({ source, destination }) => {\n    if (destination === undefined || destination === null) return null;\n\n    if (\n      source.droppableId === destination.droppableId &&\n      destination.index === source.index\n    ) {\n      return null;\n    }\n\n    const start = dragItems[source.droppableId];\n    const end = dragItems[destination.droppableId];\n\n    if (start === end) {\n      const newList = start._options.filter((_, idx) => idx !== source.index);\n\n      newList.splice(destination.index, 0, start._options[source.index]);\n\n      const newCol = {\n        id: start.id,\n        droppableId: start.droppableId,\n        title: start.title,\n        _options: newList\n      };\n\n      setDragItems((state) => ({ ...state, [newCol.id]: newCol }));\n\n      return null;\n    } else {\n      const newStartList = start._options.filter(\n        (_, idx) => idx !== source.index\n      );\n\n      const newStartCol = {\n        id: start.id,\n        droppableId: start.droppableId,\n        title: start.title,\n        _options: newStartList\n      };\n\n      const newEndList = end._options;\n\n      newEndList.splice(destination.index, 0, start._options[source.index]);\n\n      const newEndCol = {\n        id: end.id,\n        droppableId: end.droppableId,\n        title: end.title,\n        _options: newEndList\n      };\n\n      setDragItems((state) => ({\n        ...state,\n        [newStartCol.id]: newStartCol,\n        [newEndCol.id]: newEndCol\n      }));\n\n      return null;\n    }\n  };\n\n  return (\n    <div className='component__inner dnd-multiple__inner'>\n      <templates.header {...props} />\n      <div className='dnd-multiple__widget component__widget'>\n        <DragDropContext onDragEnd={onDragEnd}>\n          {Object.values(dragItems).map((col) => (\n            <templates.dndMultipleDroppable\n              {...props}\n              col={col}\n              key={col.id}\n              width={`${100 / countItems}%`}\n              isEnabled={_isEnabled}\n            />\n          ))}\n        </DragDropContext>\n      </div>\n      <div className='btn__container'></div>\n    </div>\n  );\n}\n","import { Draggable } from './libraries/react-beautiful-dnd.min.js';\nimport React from 'react';\nimport { templates, classes } from 'core/js/reactHelpers';\nexport default function DndMultipleDragable({\n  title,\n  _graphic,\n  index,\n  isEnabled,\n  isCorrect,\n  _globals\n}) {\n  const DragItemGraphic = () => {\n    if (_graphic.isBackground) {\n      return (\n        <div\n          className='dnd-multiple__dragitem__image-container'\n          style={{\n            backgroundImage: `url(${_graphic.src})`\n          }}\n        ></div>\n      );\n    }\n    return (\n      <templates.image\n        {..._graphic}\n        classNamePrefixes={['dnd-multiple__dragitem']}\n        attributionClassNamePrefixes={['component', 'dnd-multiple']}\n      />\n    );\n  };\n\n  return (\n    <Draggable draggableId={title} index={index} isDragDisabled={!isEnabled}>\n      {(provided) => (\n        <div\n          className={classes([\n            'dnd-multiple__dragitem',\n            _graphic.isBackground && 'has-graphic-background',\n            isCorrect && 'is-correct',\n            !isCorrect && isCorrect !== undefined && 'is-incorrect'\n          ])}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n          {...provided.dragHandleProps}\n        >\n          {DragItemGraphic()}\n          <span\n            className='dnd-multiple__dragitem__title'\n            dangerouslySetInnerHTML={{ __html: title }}\n          ></span>\n          <div className='dnd-multiple__dragitem__state'>\n            <div\n              className='dnd-multiple__dragitem__icon dnd-multiple__dragitem__correct-icon'\n              aria-label={_globals._accessibility._ariaLabels.correct}\n            >\n              <div className='icon' aria-hidden='true'></div>\n            </div>\n            <div\n              className='dnd-multiple__dragitem__icon dnd-multiple__dragitem__incorrect-icon'\n              aria-label={_globals._accessibility._ariaLabels.incorrect}\n            >\n              <div className='icon' aria-hidden='true'></div>\n            </div>\n          </div>\n        </div>\n      )}\n    </Draggable>\n  );\n}\n","import React from 'react';\nimport { templates, classes } from 'core/js/reactHelpers';\nimport { Droppable } from './libraries/react-beautiful-dnd.min.js';\n\nexport default function DndMultipleDroppable({\n  col: { _isCorrect, _options, droppableId, title },\n  width,\n  isEnabled,\n  _allOptions,\n  _itemMinHeight,\n  _globals\n}) {\n  const minHeight = droppableId === '0' ? 'auto' : `${_allOptions.length * _itemMinHeight}rem`;\n  return (\n    <>\n      <Droppable droppableId={droppableId}>\n        {(provided) => (\n          <div\n            className={classes([\n              'dnd-multiple__items',\n              `dnd-multiple__items-${droppableId}`,\n              _options.length === 0 && 'is-empty',\n              _isCorrect && 'is-correct',\n              !_isCorrect && _isCorrect !== undefined && 'is-incorrect'\n            ])}\n            style={{ width }}\n          >\n            <div className='dnd-multiple__item-title' dangerouslySetInnerHTML={{ __html: title }}></div>\n            <div style={{ minHeight }} className='dnd-multiple__dropitem' {...provided.droppableProps} ref={provided.innerRef}>\n              {_options.map((option, index) => (\n                <templates.dndMultipleDraggable\n                  key={option.id}\n                  title={option.title}\n                  _graphic={option._graphic}\n                  index={index}\n                  isEnabled={isEnabled}\n                  isCorrect={option._isCorrect}\n                  _globals={_globals}\n                />\n              ))}\n              {provided.placeholder}\n            </div>\n          </div>\n        )}\n      </Droppable>\n    </>\n  );\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nexport default function Trialogue(props) {\n  const { _items, onClick } = props;\n  const [messagesHistory, setMessageHistory] = useState([]);\n  const [message, setMessage] = useState([]);\n  const [isAnim, setIsAnim] = useState(true);\n  const [activeItem, setActiveItem] = useState(null);\n\n  const messageRef = useRef(null);\n  function handleOnClick(item, option) {\n    onClick(item, option);\n\n    setIsAnim(true);\n    messageRef?.current?.scrollIntoView();\n  }\n\n  useEffect(() => {\n    const activeItemModel = _items.find((item) => item._isActive);\n\n    if (!activeItemModel || activeItemModel === activeItem) return;\n\n    setActiveItem(activeItemModel);\n    const visitedItems = _items.filter((item) => item._isVisited);\n    setMessageHistory(visitedItems);\n    setMessage(activeItemModel);\n\n    const animationTimeout = setTimeout(() => {\n      setIsAnim(false);\n      setTimeout(() => {\n        messageRef?.current?.scrollIntoView();\n      }, 500);\n    }, 1000);\n\n    return () => {\n      clearTimeout(animationTimeout);\n    };\n  }, [_items]);\n  return (\n    <div className='component__inner trialogue__inner'>\n      <templates.header {...props} />\n      <div className='component__widget trialogue__widget'>\n        <templates.trialogueMessagesHistory messages={messagesHistory} />\n        <templates.trialogueMessage message={message} innerRef={messageRef} isAnim={isAnim} />\n        <templates.trialogueBottomBar onClick={handleOnClick} activeItem={activeItem} isAnim={isAnim} />\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\r\nimport { classes } from 'core/js/reactHelpers';\r\nexport default function trialogueBottomBar({ activeItem, onClick, isAnim }) {\r\n  return (\r\n    <div className='trialogue__bottom-bar'>\r\n      <div className='trialogue__bottom-bar__inner'>\r\n        <div className='trialogue__bottom-bar__buttons'>\r\n          {activeItem?.next === 'feedback' && (\r\n            <button\r\n              className={classes(['btn-text', isAnim && 'is-disabled'])}\r\n              disabled={isAnim}\r\n              onClick={() => onClick(activeItem, { text: 'restart' })}\r\n            >\r\n              start again\r\n            </button>\r\n          )}\r\n\r\n          {activeItem?.next === 'item' &&\r\n            activeItem?._options.map((option, index) => (\r\n              <button\r\n                className={classes(['btn-text', isAnim && 'is-disabled'])}\r\n                key={index}\r\n                disabled={isAnim}\r\n                onClick={() => onClick(activeItem, option)}\r\n              >\r\n                {option.text}\r\n              </button>\r\n            ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { compile, classes } from 'core/js/reactHelpers';\r\nexport default function trialogueMessage({ message, innerRef, isAnim }) {\r\n  const { text, sender } = message;\r\n\r\n  return (\r\n    <div\r\n      className={classes([\r\n        'trialogue__message',\r\n        sender === 'guest' ? 'trialogue__message-guest' : sender === '' ? 'trialogue__message-meta' : 'trialogue__message-host'\r\n      ])}\r\n      ref={innerRef}\r\n    >\r\n      <div className='trialogue__message__inner'>\r\n        {text && !isAnim && (\r\n          <div className='trialogue__message__text'>\r\n            <div className='trialogue__message__text-inner' dangerouslySetInnerHTML={{ __html: compile(text) }}></div>\r\n          </div>\r\n        )}\r\n        {text && isAnim && (\r\n          <div className='trialogue__message__anim'>\r\n            <div className='wave'>\r\n              <span className='dot'></span>\r\n              <span className='dot'></span>\r\n              <span className='dot'></span>\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div className='trialogue__message-sender'></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { compile, classes } from 'core/js/reactHelpers';\r\nexport default function trialogueMessagesHistory({ messages }) {\r\n  return (\r\n    <div className='trialogue__messages-history'>\r\n      <div className='trialogue__messages-history__inner'>\r\n        {messages.map((item) => (\r\n          <div key={item._index}>\r\n            <div\r\n              className={classes([\r\n                'trialogue__messages-history',\r\n                item.sender === 'guest' ? 'trialogue__message-guest' : item.sender === '' ? 'trialogue__message-meta' : 'trialogue__message-host'\r\n              ])}\r\n            >\r\n              <div className='trialogue__messages-history__inner'>\r\n                <div className='trialogue__messages-history__content__text'>\r\n                  <div className='trialogue__messages-history__text-inner' dangerouslySetInnerHTML={{ __html: compile(item.text) }}></div>\r\n                </div>\r\n                <div className='trialogue__messages-history-sender'></div>\r\n              </div>\r\n            </div>\r\n            {item?._options?.map(\r\n              ({ text, sender, _index, _isSelected }) =>\r\n                _isSelected &&\r\n                text !== 'restart' && (\r\n                  <div key={_index} className='trialogue__messages-history trialogue__message-guest'>\r\n                    <div className='trialogue__messages-history__inner'>\r\n                      <div className='trialogue__messages-history__text'>\r\n                        <div className='trialogue__messages-history__text-inner' dangerouslySetInnerHTML={{ __html: compile(text) }}></div>\r\n                      </div>\r\n                      <div className='trialogue__messages-history-sender'></div>\r\n                    </div>\r\n                  </div>\r\n                )\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\nimport { compile, templates } from 'core/js/reactHelpers';\n\nexport default function PageLevelProgress(props) {\n  const {\n    _items,\n    _item,\n    _globals\n  } = props;\n\n  return (\n    <div className=\"pagelevelprogress__inner\">\n      <span className='aria-label'>{compile(_globals._extensions._pageLevelProgress.pageLevelProgress)}</span>\n\n      <div role=\"list\" className=\"js-children\">\n        {_items && _items.map(item => <templates.pageLevelProgressItem {...item} _globals={_globals} key={item._id} />)}\n        {_item && <templates.pageLevelProgressItem {..._item} _globals={_globals} key={_item._id} />}\n      </div>\n\n    </div>\n  );\n}\n","import React, { useEffect } from 'react';\nimport { compile, classes } from 'core/js/reactHelpers';\nimport a11y from 'core/js/a11y';\nimport data from 'core/js/data';\nimport completionCalculations from '../js/completionCalculations';\nimport PageLevelProgressIndicatorView from '../js/PageLevelProgressIndicatorView';\n\nexport default function PageLevelProgressItem(props) {\n  const {\n    _globals,\n    _isOptional,\n    _isLocked,\n    _isVisible,\n    _isComplete,\n    title,\n    _id,\n    _type,\n    _children\n  } = props;\n\n  const indicatorSeat = React.createRef();\n  useEffect(() => {\n    if (_isOptional) return;\n    const model = data.findById(_id);\n    const item = new PageLevelProgressIndicatorView({\n      model,\n      calculatePercentage: model.isTypeGroup('contentobject') && completionCalculations.calculatePercentageComplete.bind(this, model, true)\n    });\n    $(indicatorSeat.current).append(item.$el);\n  });\n\n  return (\n    <div\n      className={classes([\n        'pagelevelprogress__item drawer__item',\n        `${_type}__indicator`\n      ])}\n      role='listitem'\n    >\n      <button\n        className={classes([\n          'pagelevelprogress__item-btn drawer__item-btn',\n          'js-indicator js-pagelevelprogress-item-click',\n          (_isLocked || !_isVisible) && 'is-disabled'\n        ])}\n        ref={indicatorSeat}\n        data-pagelevelprogress-id={_id}\n        aria-label={classes([\n          (_isLocked || !_isVisible) && `${_globals._accessibility._ariaLabels.locked}.`,\n          _isOptional && `${_globals._extensions._pageLevelProgress.optionalContent}.`,\n          !_isOptional && _isComplete && `${_globals._accessibility._ariaLabels.complete}.`,\n          !_isOptional && !_isComplete && `${_globals._accessibility._ariaLabels.incomplete}.`,\n          compile(a11y.normalize(title))\n        ])}\n      >\n\n        <span className=\"pagelevelprogress__item-title drawer__item-title\">\n          <span className=\"pagelevelprogress__item-title-inner drawer__item-title-inner\" dangerouslySetInnerHTML={{ __html: compile(title) }}>\n          </span>\n        </span>\n\n        {_isOptional &&\n        <span className=\"pagelevelprogress__item-optional\">\n          <span className=\"pagelevelprogress__item-optional-inner\">\n            {_globals._extensions._pageLevelProgress.optionalContent}\n          </span>\n        </span>\n        }\n\n      </button>\n      <div className='pagelevelprogress__item-children'>\n        <div role=\"list\" className=\"js-children\">\n          {_children && _children.map(item => <PageLevelProgressItem {...item} key={item._id} _globals={_globals} />)}\n        </div>\n      </div>\n    </div>\n  );\n\n}\n","import React, { useCallback, useState } from 'react';\nimport { compile } from 'core/js/reactHelpers';\nexport default function CourseNotes(props) {\n\n  const localStorageKey = 'adaptCourseNotes';\n  const { displayTitle, instruction, placeholder } = props;\n\n  const storage = localStorage.getItem(localStorageKey) || '';\n  const [valueTextArea, setValueTextArea] = useState(storage);\n  const [isSaved, setIsSaved] = useState(true);\n  const [wasChanged, setWasChanged] = useState(false);\n  const saveNotes = useCallback(\n    _.debounce(valueTextArea => {\n      localStorage.setItem(localStorageKey, valueTextArea);\n      setIsSaved(true);\n    }, 1000),\n    []\n  );\n\n  const handleChange = (event) => {\n    setWasChanged(true);\n    setIsSaved(false);\n    setValueTextArea(event.target.value);\n    saveNotes(event.target.value);\n  };\n\n  return (\n    <div className=\"coursenotes__header\">\n      {displayTitle &&\n      <div className='coursenotes__title'>\n        <div className='coursenotes__title-inner' dangerouslySetInnerHTML={{ __html: compile(displayTitle, props) }}>\n        </div>\n      </div>\n      }\n\n      {instruction &&\n        <div className='coursenotes__instruction'>\n          <div className='coursenotes__instruction-inner' dangerouslySetInnerHTML={{ __html: compile(instruction, props) }}>\n          </div>\n        </div>\n      }\n      <div className=\"coursenotes__widget\">\n        {wasChanged && <div className={`coursenotes__status icon ${isSaved ? 'icon-tick' : 'icon-ellipsis'}`}></div>}\n        <textarea\n          placeholder={placeholder}\n          value={valueTextArea}\n          onChange={handleChange}\n        ></textarea>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function CourseNotesNav(props) {\n  return (\n    <span className='icon'></span>\n  );\n}\n","import React from 'react';\nimport { classes } from 'core/js/reactHelpers';\nexport default function GraphicExpand(props) {\n\n  const { _graphicExpand, onClick } = props;\n  return (\n    <button onClick={onClick} className=\"button\" aria-label={_graphicExpand._button.ariaLabel}>\n      <div className={classes(['icon-expand-graphic', 'icon', _graphicExpand._button.iconClass])}></div>\n      {_graphicExpand._button.buttonText}\n    </button>\n  );\n\n}\n","import Adapt from 'core/js/adapt';\nimport 'core/js/wait';\nimport 'core/js/deprecated.js';\nimport 'core/js/components';\nimport 'core/js/location';\nimport 'core/js/templates';\nimport 'core/js/fixes';\nimport data from 'core/js/data';\nimport 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\nimport 'core/js/tracking';\nimport 'core/js/device';\nimport 'core/js/drawer';\nimport 'core/js/notify';\nimport 'core/js/router';\nimport 'core/js/models/lockingModel';\nimport 'core/js/mpabc';\nimport 'core/js/helpers';\nimport 'core/js/scrolling';\nimport 'core/js/headings';\nimport 'core/js/navigation';\nimport 'core/js/startController';\nimport 'plugins';\n\n$('body').append(Handlebars.templates.loading());\n\ndata.on('ready', () => {\n  logging.debug('Calling Adapt.init');\n  Adapt.init();\n  Adapt.off('adaptCollection:dataLoaded courseModel:dataLoaded');\n}).init();\n"],"names":["Wait","Backbone","Controller","initialize","_waitCount","_callbackHandle","being","begin","bind","end","isWaiting","trigger","clearTimeout","setTimeout","queue","callback","Promise","resolve","once","for","_","defer","wait","LockingModel","Model","set","attrName","attrVal","options","stopProcessing","isLocking","arguments","isSettingValueForSpecificPlugin","pluginName","console","error","defaults","undefined","_lockedAttributes","lockingValue","isAttemptingToLock","setLockState","skipcheck","totalLockValue","getLockCount","setLocking","defaultLockValue","unsetLocking","_lockedAttributesValues","Object","keys","length","isCheckingGeneralLockingState","isUsingLockedAttributes","Boolean","lockedAttributes","result","isAttributeALockingAttribute","hasOwnProperty","isLocked","shouldSkipCheck","isGettingValueForSpecificPlugin","lockingAttributeValues","values","lockingAttributeValuesSum","reduce","sum","value","AdaptSingleton","loadScript","window","__loadScript","_canScroll","_outstandingCompletionChecks","_pluginWaitCount","_isStarted","_shouldDestroyContentObjects","init","addDirection","disableAnimation","deferUntilCompletionChecked","History","started","history","start","checkingCompletion","outstandingChecks","get","checkedCompletion","checkIfAnyChecksOutstanding","model","off","on","isWaitingForPlugins","log","deprecated","checkPluginsReady","parseRelativeString","relativeString","parts","replace","split","filter","parsed","map","part","splitIndex","search","symbol","slice","type","offset","inset","parseInt","trim","defaultDirection","config","$","addClass","attr","disableAnimationArray","i","l","is","toggleClass","remove","currentView","parentView","setOnChildren","_isReady","_isRendered","destroy","a11y","componentStore","data","device","drawer","location","notify","offlineStorage","router","scrolling","startController","store","tracking","navigateToElement","scrollTo","register","name","object","getViewName","getViewClass","getModelName","getModelClass","findById","findViewByModelId","findByTrackingPosition","Adapt","OfflineStorage","handler","ready","_handler","hasHandler","save","serialize","JSON","stringify","deserialize","parse","clear","setReadyStatus","Device","bindAll","bowser","Bowser","navigator","userAgent","$html","$window","touch","Modernizr","touchevents","screenWidth","getScreenWidth","screenHeight","getScreenHeight","setViewportHeight","browser","toLowerCase","version","OS","getOperatingSystem","osVersion","os","renderingEngine","getRenderingEngine","listenTo","onConfigDataLoaded","browserString","getAppleDeviceType","pixelDensity","orientation","aspectRatio","screenSize","checkScreenSize","onWindowResize","screenSizeConfig","screensizeEmThreshold","baseFontSize","mediumEmBreakpoint","medium","smallEmBreakpoint","small","fontSize","parseFloat","css","screenSizeEmWidth","innerWidth","isAppleDevice","getAppleScreenWidth","width","getAppleScreenHeight","innerHeight","height","document","documentElement","style","setProperty","platform","match","engine","hasWindowResized","requestAnimationFrame","calculateResize","previousWidth","previousHeight","newScreenSize","test","MSStream","maxTouchPoints","shouldReportInvertedAppleScreenSize","windowRatio","screenRatio","screen","isWindowPortrait","isScreenPortrait","isDeviceBadlyReportingScreenOrientation","platformType","browserName","isIPhone","isIPad","devicePixelRatio","Location","_previousId","_previousContentType","_previousModel","_previousClasses","_lastVisitedType","_lastVisitedMenu","_lastVisitedPage","_currentId","_currentModel","_currentLocation","_contentType","BrowserFocus","_onBlur","_onClick","$body","_attachEventListeners","addEventListener","event","_isEnabled","_options","_isFocusNextOnDisabled","$element","target","removeAttr","currentTarget","focusNext","isAriaDisabled","closest","preventDefault","stopImmediatePropagation","_isFocusOnClickEnabled","$stack","toArray","parents","$focusable","_tabbableElements","focus","FocusOptions","constructor","preventScroll","KeyboardFocusOutline","_onKeyDown","showOnKeys","_start","_isFocusOutlineDisabled","_isFocusOutlineKeyboardOnlyEnabled","keyCode","_focusOutlineKeyboardOnlyIgnore","removeClass","LOG_LEVEL","ENUM","Logging","_config","_level","INFO","asLowerCase","_console","_warnFirstOnly","_warned","listenToOnce","onLoadConfigData","loadConfig","debug","has","checkQueryStringOverride","matches","override","toUpperCase","args","_log","DEBUG","info","warn","WARN","ERROR","fatal","FATAL","removed","concat","warnOnce","_hasWarned","level","isEnabled","configLevel","isLogLevelAllowed","_logToConsole","shouldLogToConsole","asUpperCase","push","hash","String","join","logging","Log","_canWarn","_warn","Scroll","_onTouchStart","_onTouchEnd","_onScrollEvent","_scrollDisabledElements","_preventScrollOnKeys","_ignoreKeysOnElementsMatching","_isRunning","_touchStartEventObject","disable","$elements","add","_checkRunning","enable","not","_stop","passive","fix","_preventScroll","$target","isGesture","touches","scrollingParent","_getScrollingParent","scroll","isTouchEvent","hasTouchStartEvent","originalEvent","directionY","_getScrollDirection","$parent","_isScrollable","_isScrolling","scrollType","pointerEvents","scrollTop","Math","ceil","outerHeight","scrollHeight","hasScrollingSpace","deltaY","_getScrollDelta","startOriginalEvent","currentY","pageY","previousY","hasDeltaY","wheelDeltaY","wheelDelta","removeEventListener","WrapFocus","_focusguard","_onWrapAround","_isPopupWrapFocusEnabled","stopPropagation","focusFirst","Popup","_floorStack","_focusStack","_tabIndexes","_ariaHiddens","_elementUIDIndex","ignoreInternalTrigger","opened","closed","$popupElement","silent","activeElement","_addPopupLayer","_isPopupManagementEnabled","_tabbableElementsExcludes","$branch","$siblings","siblings","each","index","item","$item","a11y_uid","elementUID","tabindex","ariaHidden","_isPopupTabIndexManagementEnabled","_isPopupAriaHiddenManagementEnabled","$items","find","_ariaHiddenExcludes","$focusElement","$previousFocusElement","_removeLastPopupLayer","pop","previousTabIndex","previousAriaHidden","setCloseTo","$original","_menu","_menuGroup","_menuItem","_page","_article","_block","_component","_componentItem","_notify","assign","fn","isFixedPostion","a11y_aria_label","limitedScrollTo","a11y_text","a11y_selected","a11y_on","isOn","$tabbable","findTabbable","toggleAccessible","a11y_only","scrollDisable","_isScrollDisableEnabled","scrollEnable","a11y_popup","popupOpened","a11y_cntrl","withDisabled","toggleEnabled","a11y_cntrl_enabled","toggleAccessibleEnabled","isReadable","findForward","selector","_findFirstForward","findWalk","_findFindForwardDescendant","focusNoScroll","returnOnly","findFirstReadable","focusOrNext","a11y_focus","dontDefer","a11y_alert","a11y_update","text","toggleHidden","a11y_popdown","$focusTarget","popupClosed","a11y_normalize","html","normalize","a11y_remove_breaks","removeBreaks","Components","_register","Array","isArray","forEach","view","View","template","isModelSetAndInvalid","prototype","Function","Error","isViewSetAndInvalid","nameModelViewOrData","toJSON","foundName","entries","key","entry","names","_view","_type","isBackboneView","nameModelOrData","isViewOnlyQuestion","_isQuestionType","_model","isBackboneModel","components","AdaptCollection","Collection","models","loadedData","BuildModel","jsonext","attrs","url","fetch","success","isLoaded","isFrameworkVersion","semver","satisfies","includePrerelease","isPluginInstalled","plugin","whenReady","ConfigModel","large","_forceRouteLocking","_canLoadData","_disableAnimation","setValuesFromURLParams","paramMappings","dir","lang","params","URLSearchParams","passedVal","build","includes","loadData","Data","json","ModelClass","onAdded","onRemoved","reset","_byAdaptID","loadConfigData","onLoadCourseData","onLanguageChange","onDirectionChange","direction","loadCourseData","language","newLanguage","courseFolder","loadManifestFiles","triggerDataLoaded","triggerDataReady","triggerInit","getJSON","path","reject","__path__","fail","languagePath","manifestPath","manifest","err","allFileData","all","filePath","allModelData","fileData","datum","__index__","course","modelData","call","checkData","setupModel","e","isReady","hasId","id","idPathToView","currentLocationId","currentLocationModel","getAncestorModels","modelId","unshift","foundView","currentId","childViews","getChildViews","trackingPosition","trackingId","indexInTrackingIdDescendants","trackingIdModel","trackingIdDescendants","getAllDescendantModels","isTypeGroup","trackingIdAncestors","ancestorDistance","abs","logReadyError","notReadyDescendants","reverse","checkIds","checkTrackingIds","items","idIndex","indexBy","idGroups","groupBy","parentIdGroups","orphanedIds","emptyIds","duplicateIds","missingIds","o","isCourseType","isComponentType","_id","_parentId","hasErrored","number","trackingIdType","trackingIdCounts","missingTrackingIds","_trackingId","duplicateTrackingIds","group","A11y","_isFocusAssignmentEnabled","_isAriaHiddenManagementEnabled","_focusableElements","_readableElements","_focusForwardElementsExcludes","_wrapStyleElements","isFocusable","isTabbable","_htmlCharRegex","_browserFocus","_keyboardFocusOutline","_wrapFocus","_popup","_scroll","_removeLegacyElements","_onConfigDataLoaded","_setupNoSelect","_onNavigationStart","_onNavigationEnd","_isActive","_addFocuserDiv","_disableTextSelectOnClasses","classes","isMatch","some","className","append","$legacyElements","children","$navigationElements","isActive","ariaLevel","ariaLevels","_ariaLevels","defaultAriaLevels","calculateLevel","isNumber","isNaN","isTypeName","relativeDescriptor","nextLevel","hasModelId","nextModel","findAncestor","nextModelId","hasNextTitle","nextModelOverride","accumulatedOffset","resolvedLevel","isHidden","isAccessibleEnabled","toggleTabbableDescendants","element","isAdaptTabHidden","adaptPreviousTabIndex","findFirstTabbable","first","findFirstFocusable","findReadable","findFocusable","checkParents","isNotVisible","hasReadableContent","hasNativeFocusOrIsScreenReadable","childNodes","c","cl","childNode","isTextNode","nodeType","isOnlyWhiteSpace","nodeValue","iterator","$tag","$found","_findFirstForwardDescendant","nextAll","sibling","$sibling","parent","$notFound","stack","stackIndexPosition","childIndexPosition","stackEntry","$stackItem","splice","perform","y","htmls","isString","$div","stackIndex","outputs","nodes","usable","node","isStyleElement","apply","rtnText","outerHTML","textContent","setPopupCloseTo","DrawerItemView","attributes","role","render","events","Handlebars","templates","el","appendTo","onDrawerItemClicked","eventCallback","DrawerView","_isVisible","drawerDir","drawerDuration","_duration","setupEventListeners","toggleDrawer","openCustomView","onCloseDrawer","onRemove","onKeyUp","setupEscapeKey","which","_globals","prependTo","shadowTemplate","shadow","postRender","checkIfDrawerIsAvailable","hasBackButton","_hasBackButton","_isCustomViewVisible","showDrawer","isEmptyDrawer","collection","onBackButtonClicked","onCloseClicked","hideDrawer","$toElement","emptyDrawer","$el","renderItems","hideDrawerBackButton","complete","addShadowEvent","velocity","opacity","duration","easing","_showEasing","empty","isList","_hideEasing","removeShadowEvent","one","childContainer","childView","DrawerCollection","comparator","Drawer","addItem","drawerObject","triggerCustomView","AdaptSubsetCollection","loadSubset","ModelEvent","canBubble","deepPath","timeStamp","addPath","AdaptModel","_children","_parent","extend","_canShowFeedback","_classes","_canReset","_canRequestChild","_isComplete","_isInteractionComplete","_isA11yRegionEnabled","_isA11yCompletionDescriptionEnabled","_requireCompletionOf","_isResetOnRevisit","_isAvailable","_isOptional","_isVisited","_isLocked","_isHidden","firstDescendant","nearestTrackingIdModel","findIndex","descendant","ancestor","trackable","trackableType","bubblingEvents","hasManagedChildren","setupChildListeners","checkCompletionStatus","checkInteractionCompletionStatus","checkLocking","checkVisitedStatus","setupTrackables","originalTrackableStateFunction","triggerTrackableState","compose","isQueued","debounce","changed","trackablePropertyNames","changedPropertyNames","isTrackable","getChildren","onAll","bubble","checkReadyStatus","onIsComplete","getTrackableState","resultExtend","pick","setTrackableState","state","canReset","getAvailableChildModels","child","isVisited","setVisitedStatus","setCompletionStatus","checkCompletionStatusFor","completionAttribute","completed","requireCompletionOf","every","getTypeGroup","typeGroup","hasUpperCase","isPluralized","lowerCased","singular","singularLowerCased","pluralizedLowerCaseTypes","typeGroups","getTypeGroups","intersection","_typeGroups","parentClass","getPrototypeOf","uniq","s","ancestorType","getParent","findDescendantModels","descendants","allDescendantsModels","returnedDescendants","where","property","isParentFirst","subDescendants","findRelativeModel","relativeDescriptorObjects","isInset","isOffset","rootModel","limitParentId","increment","searchBackwards","moveBy","movementCount","hasDescendantsOfType","searchDescendants","searchFromIndex","searchDescendant","hasFilterFunction","loop","totalOfType","count","isSelf","nextDescriptor","output","foundModel","_childrenCollection","childrenCollection","sort","setChildren","_parentModel","parentId","setParent","shouldIncludeChild","context","getSiblings","passSiblingsAndIncludeSelf","_hasSiblingsAndSelf","siblingsCollection","setOptional","lockType","setSequentialLocking","setUnlockFirstLocking","setLockLastLocking","setCustomLocking","previousChild","isLockedByPreviousChild","firstChild","shift","isLockedByFirstChild","lastChild","isLockedByChildren","shouldLock","lockedBy","anotherModel","checkIfResetOnRevisit","isResetOnRevisit","deepClone","modifier","clonedModel","clonedId","shouldAssignUniqueId","cid","uniqueId","cidPrefix","clone","ContentObjectModel","isParentCourse","_siblings","ArticleModel","BlockModel","ComponentModel","_isA11yComponentDescriptionEnabled","_shouldStoreAttempts","_userAnswer","_attemptStates","onAdaptInitialize","restoreUserAnswers","storeUserAnswer","resetUserAnswer","wasReset","getAttemptState","trackables","types","n","booleans","v","numbers","Number","arrays","getAttemptObject","setAttemptObject","addAttemptObject","attemptStates","getAttemptObjects","states","MenuModel","CourseModel","PageModel","ChildEvent","isForced","isStoppedImmediate","isStoppedNext","hasRequestChild","force","stop","immediate","stopNext","close","TemplateRenderEvent","mode","component","preRenderEvent","postRenderEvent","original","React","createElement","__html","compile","flatten","prefixClasses","prefixes","prefixed","prefix","AdaptView","toggleVisibility","onIsCompleteChange","isJSX","_classSet","Set","_isRemoved","preRender","setupOnScreenHandler","addChildren","eventName","startsWith","props","Template","updateViewProperties","ReactDOM","classesToAdd","classesToRemove","delete","_setAttributes","onscreen","m","minVerticalInview","_percentInviewVertical","percentInviewVertical","nthChild","addedCount","addDescendants","_getAddChildEvent","subsequentModels","_nthChild","ChildView","addChildView","setChildViews","$parentContainer","addedDescendantCount","onReadyChange","stopListening","isRequestChild","canRequestChild","findDescendantViews","resetCompletionStatus","descendantComponents","preRemove","unmountComponentAtNode","setVisibility","setHidden","isComplete","_childViews","ContentObjectView","inview","lock","_loadingErrorTimeout","isReact","_isTriggeredReady","performIsReady","hide","unlock","styleOptions","renderTo","isRenderToSelf","ids","forceUntilId","addingId","PageView","$pageLabel","ArticleView","BlockView","MPABC","loading","waitForDataLoaded","loaded","onDataLoaded","setupSubsetCollections","contentObjects","articles","blocks","mpabc","NotifyPushView","updateIndexPosition","updatePushPosition","hasBeenRemoved","notifyPush","delay","closePush","triggerEvent","elementHeight","navigationHeight","currentIndex","flippedIndex","positionLowerPush","NotifyModel","_showIcon","_timeout","NotifyPushCollection","onPushAdded","onRemovePush","checkPushCanShow","canShowPush","showPush","availablePushNotifications","inactivePushNotifications","NotifyPopupView","isOpen","hasOpened","closeNotify","resetNotifySize","cancelNotify","notifyPopup","showNotify","onAlertButtonClicked","onPromptButtonClicked","onCloseButtonClicked","onShadowClicked","resizeNotify","windowHeight","notifyHeight","isFullWindow","top","addSubView","$previousActiveElement","imageready","onLoaded","onOpened","subView","check","stackItem","onCloseReady","removeSubView","views","NotifyView","_stack","notifyPushes","_deprecated","notifyObject","create","notifyTemplate","_shouldRenderId","_isCancellable","_showCloseButton","_closeOnShadowClick","popup","alert","prompt","RouterModel","_canNavigate","_shouldNavigateFocus","Router","routes","_isBackward","_navigationRoot","_isCircularNavigationInProgress","showLoading","$wrapper","setDocumentTitle","navigateToArguments","show","hideLoading","currentModel","hasSubTitle","title","escapedTitle","navigate","handleRoute","handleId","handlePluginRouter","action","pluginLocation","updateLocation","isContentObject","navigateToId","isRoot","_isMenuDisabled","navigateBack","isCourse","newLocation","handleNavigationFocus","ViewClass","isMenu","invoke","isScrolling","currentLocation","setGlobalClasses","htmlClasses","currentClasses","back","navigateToCurrentRoute","route","navigateToPreviousRoute","previousModel","navigateToParent","parentModel","navigateToHomeRoute","settings","currentModelId","isSelectorAnId","contentObject","contentObjectId","isNotInCurrentContentObject","shouldReplace","isElementUnavailable","disableScrollToAnimation","offsetTop","hasClass","left","axis","Scrolling","isLegacyScrolling","_loadConfig","limitTo","_limitToSelector","isIncluded","_windowScrollFix","_addStyling","_updateScrollbarWidth","$tester","scrollBarWidth","outerWidth","documentStyle","body","scrollY","scrollX","scrollLeft","scrollWidth","defineProperties","pageYOffset","pageXOffset","isObject","MouseEvent","pageX","clientX","clientY","StartController","setStartLocation","replaceState","getStartHash","returnToStartLocation","startIds","startId","_skipIfComplete","alwaysForce","getStartId","isRouteSpecified","href","indexOf","shouldForceStartId","shouldNavigateToStartId","_className","skipIfComplete","done","COMPLETION_STATE","Tracking","_requireContentCompleted","_requireAssessmentCompleted","_shouldSubmitScore","_assessmentState","onAssessmentComplete","onAssessmentRestored","checkCompletion","assessmentState","submitScore","isPercentageBased","scoreAsPercent","score","minScore","maxScore","completionData","getCompletionData","status","INCOMPLETE","canRetry","assessment","FAILED","isPass","PASSED","COMPLETED","newShouldSubmitScore","legacyShouldSubmitScore","_tracking","beginWait","endWait","isEventListening","_events","accessibility","onRender","cb","intercept","partials","_imgLazyLoad","applyImgLoadingFix","findImgTag","hasLoadingAttr","imgTagsFound","img","_jsxReactHelpersHTML","applyReactHelpersHTML","tagName","hasSomeUnsafeConversions","hasManyChildren","HTMLReactParser","dangerouslySetInnerHTML","helpers","lowercase","capitalise","charAt","inc","dec","odd","equals","block","compare","operator","inverse","math","lvalue","rvalue","any","specified","none","toString","root","compile_a11y_text","compile_a11y_normalize","compile_a11y_remove_breaks","import_globals","import_adapt","adapt","directImport","indexedImport","importArray","importIndex","i1","l1","component_description","isNotDefined","_components","hasOverride","description","ariaRegion","SafeString","a11y_aria_label_relative","a11y_aria_image","texts","a11y_wrap_focus","cfg","a11y_attrs_heading","from","lastItem","_ariaLevel","a11y_aria_level","a11y_attrs_tabbable","a11y_alt_text","visible","alternatives","if_value_equals","lowerCase","registerHelper","HeadingView","updateAria","customHeadingType","$rendered","Headings","onViewRender","$headingSeats","NavigationView","sortNavigationButtons","onNavigate","_accessibility","insertBefore","currentEvent","skipNavigation","hideNavigationButton","shouldHide","container","a","b","appendChild","showNavigationButton","NavigationController","addNavigationBar","adaptConfig","_isDefaultNavigationDisabled","navigation","ComponentView","renderState","setupInviewCompletion","inviewElementSelector","$inviewElement","inviewCallback","onInview","removeInviewListener","visiblePartX","visiblePartY","hasSeenTop","hasSeenBottom","GraphicView","setupScrollable","onScroll","$scrollbar","$scrollContainer","onKeyDown","clientWidth","scrollableWidth","calculatedScrollPercent","step","definedScrollPercent","max","min","onClick","_url","_target","isNewWindow","open","isRouterNavigation","substr","GraphicModel","TextView","setupInview","getInviewElementSelector","TextModel","BUTTON_STATE","textPropertyName","SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET","ButtonsView","onButtonStateChanged","onFeedbackMessageChanged","onAttemptsChanged","onCanSubmitChange","buttons","refresh","checkResetSubmittedState","isSubmitted","onActionClicked","buttonState","correctAnswer","getCorrectAnswerAsText","updateAnswerLiveRegion","userAnswer","getUserAnswerAsText","onFeedbackClicked","changedAttribute","updateAttemptsCount","$buttonsAction","propertyName","asString","ariaLabel","buttonText","checkFeedbackState","canShowFeedback","isInteractionComplete","attemptsLeft","shouldDisplayAttempts","attemptsString","remainingAttemptText","remainingAttemptsText","showMarking","answer","shouldShowMarking","isCorrect","ariaLabels","_ariaLabels","$marking","$ariaLabel","hasSpanAriaLabel","answeredCorrectly","answeredIncorrectly","QuestionModel","_shouldDisplayAttempts","_shouldShowMarking","_canShowModelAnswer","_canShowMarking","_canSubmit","_isSubmitted","_isCorrectAnswerShown","_questionWeight","_hasItemScoring","_items","setupDefaultSettings","updateRawScore","setupWeightSettings","setupButtonSettings","globalButtons","componentButtons","canSubmit","checkCanSubmit","updateAttempts","setQuestionAsSubmitted","markQuestion","_isCorrect","_isPartlyCorrect","isPartlyCorrect","setScore","questionWeight","_rawScore","_maxScore","_minScore","checkQuestionCompletion","updateButtons","canShowModelAnswer","setupFeedback","setupCorrectFeedback","setupPartlyCorrectFeedback","setupIncorrectFeedback","feedbackTitle","getFeedbackTitle","feedbackMessage","correct","feedback","_partlyCorrect","final","setAttemptSpecificFeedback","_incorrect","notFinal","altFeedbackTitle","getAltFeedbackTitle","altTitle","isInteractive","attempts","_attemptsLeft","_buttonState","setQuestionAsReset","resetQuestion","getButtonState","getInteractionObject","getResponse","getResponseType","onSubmitted","QuestionView","onEnabledChanged","ensureLegacyLifecycleState","_runModelCompatibleFunction","setupQuestion","disableQuestion","enableQuestion","resetQuestionOnRevisit","onHideCorrectAnswerClicked","onResetClicked","addButtonsView","onQuestionRendered","buttonsView","onButtonStateUpdate","onSubmitClicked","onShowCorrectAnswerClicked","showFeedback","showInstructionError","onCannotSubmit","recordInteraction","resize","setQuestionAsShowCorrect","showCorrectAnswer","setQuestionAsHideCorrect","hideCorrectAnswer","getLatency","lookForViewOnlyFunction","ViewOnlyQuestionViewCompatibilityLayer","_isInViewOnlyCompatibleMode","checkForFunction","hasCompatibleVersion","usingCompatibleVersion","DndMultipleView","preinitialize","setItems","DnDMultipleModel","openTextComponent","onOpenTextComplete","updateItems","updatedValuesHtml","getUserAnswer","newOptions","htmlToItems","existingItems","updated","setUpItems","setUpItemsOptions","htmlString","parser","DOMParser","doc","parseFromString","liElements","querySelectorAll","li","_graphic","src","isBackground","alt","_optionIndex","_itemIndex","floor","_itemId","_isAtLeastOneCorrectSelection","itemIndex","droppableId","itemOptions","option","optionIndex","_correctItems","random","intialItems","_allOptions","itemId","optionId","markItems","objItems","getDraggableItems","hasAllCorrectAnswers","hasIncorrectAnswers","hasPartlyCorrectAnswers","_numberOfCorrectAnswers","numberOfCorrectAnswers","optionsLength","resetItems","objectItems","response","DndMultipleModel","OpenTextInputModel","formatPlaceholder","placeholder","localUserAnswer","setUserAnswer","modelAnswer","_hideCorrectAnswer","_showUserAnswer","_showCorrectAnswer","_showModelAnswer","answerArray","fromCharCode","char","codePointAt","correctResponsesPattern","HIDE_MODEL_ANSWER_CLASS","SHOW_MODEL_ANSWER_CLASS","OpenTextInputView","onKeyUpTextarea","countandLimitCharacters","throttle","editor","getData","onCompleteChanged","loadLocalAnswer","enableReadOnlyMode","$textbox","isEmpty","$countChars","$modelAnswer","identifier","supportsHtml5Storage","localStorage","getItem","limitCharacters","allowedCharacters","val","substringValue","substring","setItem","$container","$progressCircle","$charactersBox","$wordsBox","$circleCircumference","PI","maxCharacters","ClassicEditor","querySelector","wordCount","onUpdate","stats","charactersProgress","characters","isLimitExceeded","isCloseToLimit","circleDashArray","words","then","wordCountPlugin","plugins","wordCountWrapper","getElementById","wordCountContainer","catch","restoreQuestionStatusPolyfill","TrialogueView","setupTrialogue","activeItem","getActiveItem","toggleActive","_isSelected","itemModel","_index","optionModel","nextItem","isFeedback","hasSender","ItemModel","_score","toggleVisited","ItemsComponentModel","booleanArray","findWhere","getVisitedItems","getActiveItems","areAllItemsCompleted","resetActiveItems","setActiveItem","TrialogueModel","aboutPage","showAboutPage","updateCourse","addLink","updatePage","currentCourse","getPage","getCourse","contactEmail","contactLinkText","_extensions","_aboutPage","linkText","prop","contactEMail","aboutcredit","aboutCredit","aboutSLtext","SL_text","titleText","string","graphic","alertObject","Events","AssessmentView","AdaptArticleView","isAssessmentEnabled","_setupEventListeners","getConfig","_questions","_onAssessmentComplete","_onAssessmentReset","_onRemove","_removeEventListeners","QuestionBank","quizBankId","articleId","_bankId","_articleId","_unusedQuestionBlocks","_count","calculateAvailableQuestionBlocks","articleModel","_availableQuestionBlocks","blockModel","_quizBankID","availableQuestionBlockIds","unusedQuestionBlockIds","haveBlocksChanged","difference","getRandomQuestionBlocks","unusedQuestionBlocks","questionBlocks","nextBlock","hasUnusedQuestion","shuffle","givenIdCount","assessmentConfigDefaults","_resetType","_suppressMarking","_isPercentageBased","_scoreToPass","_correctToPass","_includeInTotalScore","_assessmentWeight","_reloadPageOnReset","_attempts","_allowResetIfPassed","AssessmentModel","_getCurrentQuestionComponents","questions","_getAllQuestionComponents","_postInitialize","assessmentConfig","_originalChildModels","_questionBanks","_forceResetOnRevisit","_assessmentCompleteInSession","_attemptInProgress","_isAssessmentComplete","_numberOfQuestionsAnswered","_lastAttemptScoreAsPercent","_attemptsSpent","_onDataReady","setupCurrentQuestionComponents","_setAssessmentOwnershipOnChildrenModels","_updateQuestionsState","assessmentQuestionsConfig","childConfig","_isPartOfAssessment","_assessmentId","q","POSITIVE_INFINITY","_setupAssessmentData","getState","hasAttemptsLeft","isFirstAttempt","attemptsSpent","shouldResetOnRevisit","shouldResetAssessment","shouldResetQuestions","allowResetIfPassed","quizModels","_banks","_split","_setupBankedAssessment","_randomisation","_setupRandomisedAssessment","_resetQuestions","_overrideQuestionComponentSettings","_setupQuestionListeners","_checkNumberOfQuestionsAnswered","saveState","_setupBanks","questionModels","flatMap","questionBank","bankSplits","_quizBankId","isInvalidNumber","isOutOfBounds","hasBankSplitsChanged","bankId","randomisationModel","blockModels","_blockCount","newSettings","_getMarkingSettings","questionConfig","questionComponents","_removeQuestionListeners","_onCompletionEvent","numberOfQuestionsAnswered","_onBlockCompleted","_onQuestionCompleted","questionModel","_checkAssessmentComplete","question","allQuestionsAdded","allQuestionsAnswered","wasAttemptInProgess","_spendAttempt","_scoreAsPercent","_getScoreAsPercent","_getScore","_getMaxScore","_getMinScore","_correctCount","_getCorrectCount","_correctAsPercent","_getCorrectAsPercent","_questionCount","_getQuestionCount","_checkIsPass","_isMarkingSuppressionEnabled","_isAttemptsLeft","_isPassed","_overrideMarkingSettings","_refreshQuestions","scoreToPass","correctToPass","correctAsPercent","correctCount","markingSettings","_shouldSuppressMarking","newMarkingSettings","range","round","questionCount","_getLastAttemptScoreAsPercent","_checkReloadPage","canResetInPage","_reloadPage","_scrollToOnReset","_setCompletionStatus","_checkIfQuestionsWereRestored","wereQuestionsRestored","isPageReload","getSaveState","banksActive","randomisationActive","blockTrackingPositions","blockCompletion","blockData","attemptInProgress","dataPackage","setRestoreState","restoreState","nonBlockChildren","blockIndex","blockQuestions","questionIndex","pageId","includeInTotalScore","assessmentWeight","lastAttemptScoreAsPercent","resetType","assessmentsConfigDefaults","_isDefaultsLoaded","Assessment","_assessments","_byPageId","_byAssessmentId","_onAssessmentsComplete","_checkResetAssessmentsOnRevisit","_handleRoute","assessmentId","_getStateByAssessmentId","_setPageProgress","_checkAssessmentsComplete","_restoreModelState","assessmentModel","_saveStateModel","toObject","pageAssessmentModels","_getAssessmentByPageId","resetAllAssessments","allAssessmentHaveReset","numberOfAssessments","numberOfResetAssessments","forceAssessmentReset","haveAllModelsReset","_restoredCount","allAssessmentsComplete","assessmentToPostBack","_getStatesByAssessmentId","assessmentStates","_setupSingleAssessmentConfiguration","assessmentsConfig","assessments","availableAssessments","assessmentsTotal","assessmentsPassed","pageModel","_subProgressTotal","_subProgressComplete","_addToAssessmentIdMap","_setupQuestionNumbering","getRelatedQuestions","currentAssessmentId","currentAssessment","getQuestionNumber","related","pluck","getTotalQuestions","assessmentsComplete","scoreRange","isFailed","ArticleViewInitialize","AdaptAssessmentArticleView","ArticleModelInitialize","AdaptAssessmentArticleModel","returnValue","getCorrectness","numberOfCorrect","numberOfPartlyCorrect","BranchingSet","setupModels","containerId","_containerId","isDirectChild","_isBranchChild","_isBranchClone","_wasInitialized","disableParentCompletion","wasRestored","restore","getNextModel","addNextModel","addFirstModel","enableParentCompletion","checkResetOnStartChange","isAtCorrectStart","isAtStart","branchedModels","isEffectivelyComplete","removeViews","branching","trackingPositions","isLast","isAtEnd","isTheoretical","branchingModels","isBeforeStart","hasStartId","firstModel","lastChildModel","isLastIncomplete","lastChildConfig","correctness","nextId","_force","findNextModel","isRelativeId","originalLastChildModel","wasModelAlreadyUsed","nextBranchingSet","getSubsetByModelId","shouldSave","shouldRestore","_branchLastPreviousIndex","attemptIndex","isAnyPartRestored","cloned","unset","attemptObjects","hasAttemptRecord","areAllDescendantsComplete","saveNextModel","trackingIds","childModel","hasStandardCompletionCriteria","areAllAvailableTrackableChildrenComplete","_isInReset","Branching","_rawSets","openPopupCount","shouldContinueOnPopupClose","onAppDataReady","onPopupOpened","onPopupClosed","onAssessmentReset","onArticleReset","_isAwaitingDataReady","warnForSpoorMisconfiguration","setupBranchingModels","isMisconfigured","containerModels","_onChildren","containerModel","subsets","onRequestChild","onComplete","continue","continueAfterBranchChild","saveBranchQuestionAttemptHistory","checkIfIsEffectivelyComplete","isBranchChild","branchOriginModelId","originModel","Completion","subProgressCompleted","subProgressTotal","nonAssessmentCompleted","nonAssessmentTotal","assessmentCompleted","assessmentTotal","calculateCompletion","contentObjectModel","setGlobal","completion","viewType","availableChildren","filterAvailableChildren","getPageLevelProgressEnabledModels","nonAssessmentComponents","getNonAssessmentComponents","getComponentsCompleted","assessmentComponents","getAssessmentComponents","getComponentsInteractionCompleted","_excludeAssessments","showPageCompletionCourse","_showPageCompletion","showPageCompletionPage","unavailableInHierarchy","calculatePercentageComplete","completionObject","total","percentageComplete","PageLevelProgressView","scrollToPageElement","isNavigateToContentObject","currentComponentSelector","Component","pageLevelProgress","PageLevelProgressIndicatorView","calculatePercentage","addClasses","setUpEventListeners","setPercentageComplete","checkAria","getRenderData","percentage","getPageLevelProgressItemsJSON","_showAtCourseLevel","isInAPage","allDescendants","currentPageItems","isDescendantContentObject","isDescendantCurrentPage","availableItems","completionCalculations","enabledProgressItems","jsonOutput","PageLevelProgressNavigationView","_pageLevelProgress","_navOrder","click","refreshProgressBar","addIndicator","deferredUpdate","updateProgressBar","pageLevelProgressNavigation","indicatorView","_getPageCompletionPercentage","pageLevelProgressIndicatorBar","prepend","onProgressClicked","PageLevelProgress","onDataReady","getCourseConfig","coursePLPConfig","headerIndicatorTypes","headerIndicatorEventNames","renderHeaderIndicatorView","renderMenuItemIndicatorView","renderNavigationView","onCompletionChange","completionState","hasChanged","_previousCompletionState","_isCompletionIndicatorEnabled","pageConfig","$headings","isBackwardCompatible","classList","insertAfter","_getMenuItemCompletionPercentage","pageLevelProgressMenuBar","_isShownInNavigationBar","pagePLPConfig","getPageLevelProgressItems","after","Logger","logArr","registeredViews","getInstance","instance","getEntries","getLastEntry","str","LOG_TYPE_INFO","time","Date","now","updateViews","LOG_TYPE_WARN","LOG_TYPE_ERROR","LOG_TYPE_DEBUG","registerView","unregisterView","update","ScormError","CLIENT_COULD_NOT_CONNECT","SERVER_STATUS_UNSUPPORTED","CLIENT_STATUS_UNSUPPORTED","CLIENT_COULD_NOT_COMMIT","CLIENT_NOT_CONNECTED","CLIENT_COULD_NOT_FINISH","CLIENT_COULD_NOT_GET_PROPERTY","CLIENT_COULD_NOT_SET_PROPERTY","CLIENT_INVALID_CHOICE_VALUE","defaultMessages","pressOk","ScormWrapper","setCompletedWhenFailed","commitOnStatusChange","commitOnAnyChange","timedCommitFrequency","maxCommitRetries","commitRetryDelay","commitRetryPending","commitRetries","lastCommitSuccessTime","exitStateIfIncomplete","exitStateIfComplete","timedCommitIntervalID","retryCommitTimeoutID","logOutputWin","startTime","endTime","lmsConnected","finishCalled","logger","scorm","pipwerks","SCORM","handleExitMode","suppressErrors","debouncedCommit","commit","__debug","showDebugWindow","API","__offlineAPIWrapper","API_1484_11","getVersion","setVersion","handleError","initTimedCommit","isFirstSession","getValue","isSCORM2004","setIncomplete","setValue","setCompleted","setPassed","setFailed","getStatus","setStatus","getScore","scaledScore","toFixed","isSupported","getLessonLocation","setLessonLocation","getSuspendData","setSuspendData","getStudentName","getStudentId","setLanguage","initRetryCommit","errorCode","getCode","errorInfo","getInfo","diagnosticInfo","getDiagnosticInfo","finish","clearInterval","convertToSCORM2004Time","getTime","getExitState","convertToSCORM12Time","quit","latency","recordInteractionMultipleChoice","recordInteractionMatching","recordInteractionScorm2004","recordInteractionScorm12","recordInteractionFillIn","setInterval","doRetryCommit","messages","_messages","message","confirm","getInteractionCount","cmiPrefix","getCMITime","getISO8601Timestamp","checkResponse","scormRecordInteraction","maxLength","msConvert","msPerSec","msPerMin","msPerHour","ms","secs","mins","hrs","padWithZeroes","csConvert","csPerSec","csPerMin","csPerHour","csPerDay","days","hours","cs","seconds","hms","date","getHours","getMinutes","sec","getSeconds","toISOString","numToPad","padBy","len","responseType","self","checkIdentifier","r","identifiers","completionStatus","isIncomplete","exitState","LZMAWorker","LZMAFactory","ZeroString","makeZeroString","zeroPadRightToLength","padLength","zeroPadLeftToLength","zeroPadRightToMultiple","multiple","binaryToUnsignedInteger","binary","binaryLength","integer","shiftUnsignedIntegerFromBinary","shiftBinary","shifted","unsignedIntegerToBinary","byteArrayToString","array","arrayLength","stringToByteArray","stringLength","charCodeAt","BYTE_BIT_LENGTH","binaryToBase64","bytesCount","charCodes","base64","btoa","base64ToBinary","atob","logs","usedTypes","typeLengths","binarySamples","AbstractValueType","binaryTypeLength","binaryType","FixedIntegerType","esType","valueBinaryLength","minValue","maxValue","pow","valueToBinary","logStats","shiftValueFromBinary","FixedBooleanType","bool","LengthAndValueBinary","bitSizes","maxValues","sizeBinaryLength","parentName","sizeIndex","sizeBinary","valueLength","integerBinary","VariableIntegerType","isNegative","integerBitSizes","VariableArrayType","valueType","findValueTypeFromValues","shiftValueTypeFromBinary","VariableSignedIntegerType","signBinary","VariableDecimalType","isFloat","decimal","decimalBitSizes","float","higherInteger","lowerInteger","integerValueBinary","decimalValueBinary","arrayType","booleanType","integerTypes","decimalTypes","ValueTypes","nameIndex","esTypeOf","findValueTypeFromName","findValueTypeFromValue","isInteger","isValueInValueTypeRange","esTypes","uniqESTypes","isRangeInValueTypeRange","convertValuesToNumbers","Converter","getInvalidTypeError","typeName","clearLog","hasInitialType","printLog","valueFromBinary","serializeAsync","isLargeArray","compress","compressedBase64","isCompressedSmaller","isLZMACompressed","LZMA","decompress","SCORMSuspendData","ComponentSerializer","shouldCompress","shouldStoreResponses","shouldStoreAttempts","isContainer","modelState","hasUserAnswer","isUserAnswerArray","hasAttemptStates","trackingIdMap","attemptObject","StatefulSession","debouncedSaveSession","saveSessionState","_trackingIdType","_componentSerializer","_shouldCompress","_shouldStoreResponses","_shouldRecordInteractions","beginSession","restoreSession","spoor","_advancedSettings","_showDebugWindow","_scormVersion","isBoolean","_suppressErrors","_commitOnStatusChange","_commitOnAnyChange","isFinite","_timedCommitFrequency","_maxCommitRetries","_commitRetryDelay","_exitStateIfIncomplete","_exitStateIfComplete","_setCompletedWhenFailed","setupLearnerInfo","restoreSessionState","globals","_learnerInfo","sessionPairs","hasNoPairs","_isAssessmentPassed","removeEventListeners","onLanguageChanged","onQuestionRecordInteraction","onTrackingComplete","advancedSettings","shouldCommitOnVisibilityChange","_commitOnVisibilityChangeHidden","onVisibilityChange","endSession","isMidRender","courseState","componentStates","printCompletionInformation","suspendData","courseComplete","assessmentPassed","trackingIdModels","completionString","markers","mark","_reporting","_resetStatusOnLanguageChange","visibilityState","questionView","_onTrackingCriteriaMet","_onAssessmentFailure","OfflineStorageScorm","statefulSession","temporaryStore","suspendDataStore","suspendDataRestored","useTemporaryStore","getCustomStates","student","learnerInfo","getLearnerInfo","getCustomState","stateArray","_isCourseComplete","questionsState","dataAsString","isSuspendDataStoreEmpty","dataAsJSON","firstname","lastname","hasName","isNameCommaSeparated","isNameSpaceSeparated","separator","nameParts","Spoor","_prepare","require","onKeyCombo","_deepDefaults","defaultObjects","keyValuePairs","defaultValue","isRecursiveObject","isValueAlreadySet","configDefaults","_isInherited","_autoScroll","_scrollTo","_button","_isFullWidth","_autoHide","_hasIcon","_styleBeforeCompletion","_styleAfterClick","startText","startAriaLabel","finalText","finalAriaLabel","_stepLocking","_isCompletionRequired","_isLockedOnRevisit","isModelArticleWithOnChildren","trickleConfig","isModelBlockWithArticleNotChildren","parentTrickleConfig","getModelConfigDefaults","getModelInheritanceChain","configModel","parentConfig","blockConfig","isParentEnabledNotOnChildren","isNoChildConfig","getModelConfig","inheritance","inheritModel","arr","getModelContainer","getCompletionAttribute","_completionAttribute","checkApplyLocks","hasCompletionChanged","hasAvailabilityChanged","debouncedApplyLocks","applyLocks","locks","modelsById","TrickleButtonModel","siteModel","isModelLocked","subsequentLockingModels","_getAncestorNextSiblings","isButtonModel","isTrickled","descendantId","wasLocked","logTrickleState","isStepLocked","isCompletionRequired","TrickleModel","trickleButton","isTrickleButtonComplete","fromModel","allSiblings","subsequentSiblings","allAncestors","inPageAncestors","subsequentInPageAncestors","grandParent","previousIndex","allGrandParentChildren","subsequentAncestorSiblings","subsequentContentObjectDescendantModels","addButtonComponents","uid","buttonModelSite","trickleButtonModel","_layout","_trickle","_renderPosition","_isTrackable","repeat","TrickleController","checkIsFinished","onAddChildView","kill","isStarted","isKilled","isManagedByTrickleAndLocked","isTrickling","isAutoScrollOff","hasTrickleButton","getScrollToId","firstCharacter","relativeModel","scrollToId","isDescendant","_scrollDuration","isFinished","TrickleButtonView","isAwaitingPopupClose","wasButtonClicked","calculateButtonText","calculateButtonState","isDisabledByPopups","tryButtonAutoHide","onParentComplete","updateButtonState","isStepUnlocked","onStepUnlocked","shouldUserInteractWithButton","isButtonHidden","isButtonDisabled","$button","HTMLElement","isSameNode","$buttonText","onButtonClick","wasComplete","isStepLockingCompletionRequired","controller","measurements","isJustOffscreen","bottom","isButtonAutoHidden","isStepComplete","isStepLocking","isCompletionBlocked","isParentComplete","isStepLockedOnRevisit","isButtonComplete","isLastInContentObject","lastDescendant","trickleParent","isParentFinished","isStart","isFinal","trickleSiblings","buttonAriaLabel","isButtonDisableForced","isButtonHiddenForced","_isButtonVisible","_isButtonDisabled","_showEndOfPage","isTrickleKilled","isButtonVisibleBeforeCompletion","isButtonVisibleAfterCompletion","isNoCompletionRequiredAndLockedVisible","isNoCompletionRequiredAndUnlockedVisible","isNoCompletionRequiredAndFinishedVisible","isStepLockedAndVisibleBeforeCompletion","isFinishedAndVisibleAfterCompletion","isStepUnlockedAndButtonIncomplete","isButtonVisible","isButtonEnabledBeforeCompletion","isButtonEnabledAfterCompletion","isNoCompletionRequiredAndLockedEnabled","isNoCompletionRequiredAndUnlockedEnabled","isNoCompletionRequiredAndFinishedEnabled","isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced","isFinishedAndEnabledAfterCompletion","isButtonEnabled","trickle","TUTOR_TYPE","TutorModel","NOTIFY","_hasNotifyBottomButton","_attributes","getFeedback","getOriginClasses","extension","TutorNotify","onNotifyClosed","triggerNotify","promptText","notifyOptions","_prompts","TutorView","onTutorClosed","onButtonsStateUpdate","tutor","toggleFeedback","shouldOpen","shouldManageFocus","animation","onAnimationEnd","onTutorOpened","onCloseClick","$showFeedbackButton","Tutor","onQuestionViewShowFeedback","tutorModel","INLINE","OVERLAY","NONE","CourseNotesView","CourseNotesNavView","_courseNotes","buttonNav","CourseNotes","checkIsEnabled","onInitialize","openCourseNotes","handlePageViewReady","handlePageViewPreRemove","_isPopupOpen","navView","popupView","closeCourseNotes","handleClick","DevtoolsModel","getDefaultConfig","_trickleEnabled","_hintingAvailable","_hintingEnabled","_toggleFeedbackAvailable","_feedbackEnabled","_autoCorrectAvailable","_autoCorrectEnabled","_altTextAvailable","_altTextEnabled","_tutorListener","_unlockAvailable","_unlocked","_toggleBankingAvailable","_traceFocusAvailable","_traceFocusEnabled","_extended","toggleHinting","toggleAutoCorrect","toggleAltText","toggleTraceFocus","Hinting","devtools","toggleHints","renderedQuestions","setHinting","onComponentRendered","hintingEnabled","setMcqHinting","setGmcqHinting","setMatchingHinting","setPpqHinting","setSliderHinting","setTextInputHinting","setQuestionStripHinting","eq","_shouldBeSelected","$options","_bottom","_top","_answers","$subItems","_subItems","subItem","subItemIndex","isQuestionSupported","ItemsQuestionModel","AutoAnswer","mousedownHandlers","componentRendered","onQuestionMouseDown","ctrlKey","shiftKey","isItemsQuestionModel","defined","incorrectly","answerMultipleChoiceIncorrectly","answerMatchingIncorrectly","answerPpqIncorrectly","answerSliderIncorrectly","answerTextInputIncorrectly","answerQuestionStripIncorrectly","answerUnsupportedIncorrectly","answerMultipleChoice","answerMatching","answerPpq","answerSlider","answerTextInput","answerQuestionStrip","answerUnsupported","isGraphical","noCorrectOptions","itemCount","selectionStates","times","nShould","nShouldNot","nSelect","nIncorrect","nCorrect","j","k","found","dropdowns","getFirstSelectedItem","setActiveOption","selectValue","$select","setOptionSelected","d","incorrect","answers","setStage","isDesktop","$pinboard","boardw","boardh","zone","pin","getNextUnusedPin","x","setPosition","maxSize","resetPins","ok","tuple","PassHalfFail","syncIterations","mouseTarget","_questionViews","_currentPageId","onPagePreRender","onKeypress","onMouseDown","onMouseUp","_completeNonQuestions","nonQuestions","pass","qs","half","notSubmitted","tutorEnabled","partial","onPassHalfFailComplete","ToggleBanking","_assessmentBankDisabled","getBankedAssessmentsInCurrentPage","f","toggle","bankedAssessments","isBankingEnabled","_isPass","MapView","_renderIntervalId","_checkRenderInterval","onModelCompletionChanged","devtoolsMap","_invalid","_getConfig","_disablePageIncompletePrompt","_pageIncompletePromptExists","_pageIncompletePromptEnabled","_restorePageIncompletePrompt","invalidate","onLinkClicked","defaultView","navigateAndDisableTrickle","navigateAndDisableTrickleUpTo","at","checkVisibility","handleCourse","targetModel","CourseMap","courseId","truncateIds","onMapLoaded","onCourseClosed","eachChild","ret","last","getId","getProp","isStringEmpty","getTitle","t","when","trickled","isBlock","mapWindow","onMapClosed","mapView","Utils","getModelForElement","getAdaptCoreVersion","getParents","horz","getHorzLine","onTrickleBegun","onTrickleChange","onTrickleEnded","onShowFeedback","hushTutor","reinstateTutor","onFeedbackToggled","onFeedbackButtonClicked","componentId","exec","findLabel","$label","computeAccesibleName","getText","domElement","traverseTree","followId","allowText","labelledByText","activeDescendantText","findLabelText","valueText","valueNow","computeHeadingLevel","$heading","headingLevel","computeAccessibleDescription","describedByText","getAnnotationPosition","$annotation","targetBoundingRect","getBoundingClientRect","availableWidth","availableHeight","clientHeight","tooltipsWidth","tooltipsHeight","elementWidth","canAlignBottom","canAlignRight","right","canAlignBottomRight","canBeContained","isFixedPosition","scrollOffsetTop","scrollOffsetLeft","getPosition","isTopPreferred","isLeftPreferred","position","Annotation","devtoolsAnnotation","showOutline","hideOutline","AltText","mutations","mutated","MutationObserver","observer","onDomMutation","connectObserver","observe","childList","subtree","attributeFilter","removeAllAnnotations","onMouseOver","$mouseoverEl","_outlineEl","annotation","disconnectObserver","disconnect","addAnnotation","updateAnnotation","removeAnnotation","removeData","clearUpAnnotations","isOutOfDom","isHeadingHeightZero","$labelled","isVisible","isParentAriaHidden","isAriaHidden","isNotAriaHidden","isImg","takeRecords","breakCoreLocking","breakLocks","onUnlocked","onMenuPreRender","onMenuReady","_lock","_locked","buffer","isMouseDown","hitArea","coords","topLeftTapHold","topRightTapHold","listenType","timeoutId","focusableElements","processBuffer","blen","removeHooks","addHooks","kcheat","addTouchHook","removeTouchHook","onTouchStart","onTouchEnd","TraceFocus","openingTags","RegExp","consoleStyle","onFocusIn","openingTag","tokens","doCompletion","navigationView","DevtoolsView","_checkUnlockVisibility","_checkSpoorLogVisibility","_checkTrickleEndVisibility","_checkBankingVisibility","_checkFeedbackVisibility","_checkHintingVisibility","_checkAutoCorrectVisibility","_checkAltTextVisibility","_checkPassHalfFailVisibility","_checkCompletePageVisibility","_checkCompleteMenuVisibility","_checkTraceFocusVisibility","_checkForLocks","hasLock","onUnlock","onOpenMap","spoorInstalled","onOpenSpoorLog","onEndTrickle","onToggleBanking","onToggleFeedback","onToggleHinting","onToggleAutoCorrect","onToggleAltText","incomplete","onCompletePage","onCompleteMenu","unanswered","onPassHalfFail","onToggleTraceFocus","DevtoolsNavigationView","devtoolsNavigation","onDevtoolsClicked","onContentRendered","deferredRender","initNavigationView","removeDescendants","prunable","removeModel","processConfig","_modelsToRemove","devConfig","GraphicExpandView","$graphicexpand","$img","imgsrc","imgsrcLottie","GraphicExpand","onComponentPostRender","_graphicExpand","$insertElement","_selector","graphicExpandView","footerLink","addLinks","link","licencePage","showLicencePage","_ODILicence","MenuItemView","MenuView","BoxMenuItemView","onClickMenuItemButton","BoxMenuGroupView","BoxMenuView","setStyles","onDeviceResize","_renderAsGroup","addBackgroundLayer","setBackgroundImage","setBackgroundStyles","processHeader","$background","backgroundImages","_backgroundImage","backgroundImage","_small","styles","_backgroundStyles","_backgroundRepeat","_backgroundSize","_backgroundPosition","header","_menuHeader","$header","addHeaderBackgroundLayer","setHeaderBackgroundImage","setHeaderBackgroundStyles","setHeaderMinimumHeight","$headerBackground","minimumHeights","_minimumHeights","minimumHeight","ThemeView","setClasses","setMinimumHeight","setCustomStyles","_large","_medium","ThemePageView","ThemeArticleView","ThemeBlockView","onPostRender","theme","Header","jsxHeading","useRef","displayTitle","instruction","mobileInstruction","_disableAccessibilityState","classNamePrefixes","sizedInstruction","isSet","Image","hasMediumSetting","_src","hasSource","attributionClassNamePrefixes","attribution","longdescription","longDescriptionId","LinkWrapper","Graphic","_scrollPercent","scrollableProperties","scrollAriaLabel","tabIndex","Text","DndMultiple","dragItems","setDragItems","useState","countItems","useEffect","onDragEnd","source","destination","newList","idx","newCol","newStartList","newStartCol","newEndList","newEndCol","DragDropContext","col","DndMultipleDragable","DragItemGraphic","Draggable","provided","innerRef","draggableProps","dragHandleProps","DndMultipleDroppable","_itemMinHeight","minHeight","Droppable","droppableProps","Trialogue","messagesHistory","setMessageHistory","setMessage","isAnim","setIsAnim","messageRef","handleOnClick","current","scrollIntoView","activeItemModel","visitedItems","animationTimeout","trialogueBottomBar","next","trialogueMessage","sender","trialogueMessagesHistory","_item","PageLevelProgressItem","indicatorSeat","createRef","locked","optionalContent","localStorageKey","storage","valueTextArea","setValueTextArea","isSaved","setIsSaved","wasChanged","setWasChanged","saveNotes","useCallback","handleChange","CourseNotesNav","iconClass"],"mappings":"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"}